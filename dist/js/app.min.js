"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports)))module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var r;try{r=window}catch(t){r=self}r.SparkMD5=t()}}(function(t){var i=function(t,r){return t+r&4294967295},e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function h(t,r,n,e,f,o){return r=i(i(r,t),i(e,o)),i(r<<f|r>>>32-f,n)}function u(t,r,n,e,f,o,i){return h(r&n|~r&e,t,r,f,o,i)}function s(t,r,n,e,f,o,i){return h(r&e|n&~e,t,r,f,o,i)}function a(t,r,n,e,f,o,i){return h(r^n^e,t,r,f,o,i)}function p(t,r,n,e,f,o,i){return h(n^(r|~e),t,r,f,o,i)}function y(t,r){var n=t[0],e=t[1],f=t[2],o=t[3];e=p(e=p(e=p(e=p(e=a(e=a(e=a(e=a(e=s(e=s(e=s(e=s(e=u(e=u(e=u(e=u(e,f=u(f,o=u(o,n=u(n,e,f,o,r[0],7,-680876936),e,f,r[1],12,-389564586),n,e,r[2],17,606105819),o,n,r[3],22,-1044525330),f=u(f,o=u(o,n=u(n,e,f,o,r[4],7,-176418897),e,f,r[5],12,1200080426),n,e,r[6],17,-1473231341),o,n,r[7],22,-45705983),f=u(f,o=u(o,n=u(n,e,f,o,r[8],7,1770035416),e,f,r[9],12,-1958414417),n,e,r[10],17,-42063),o,n,r[11],22,-1990404162),f=u(f,o=u(o,n=u(n,e,f,o,r[12],7,1804603682),e,f,r[13],12,-40341101),n,e,r[14],17,-1502002290),o,n,r[15],22,1236535329),f=s(f,o=s(o,n=s(n,e,f,o,r[1],5,-165796510),e,f,r[6],9,-1069501632),n,e,r[11],14,643717713),o,n,r[0],20,-373897302),f=s(f,o=s(o,n=s(n,e,f,o,r[5],5,-701558691),e,f,r[10],9,38016083),n,e,r[15],14,-660478335),o,n,r[4],20,-405537848),f=s(f,o=s(o,n=s(n,e,f,o,r[9],5,568446438),e,f,r[14],9,-1019803690),n,e,r[3],14,-187363961),o,n,r[8],20,1163531501),f=s(f,o=s(o,n=s(n,e,f,o,r[13],5,-1444681467),e,f,r[2],9,-51403784),n,e,r[7],14,1735328473),o,n,r[12],20,-1926607734),f=a(f,o=a(o,n=a(n,e,f,o,r[5],4,-378558),e,f,r[8],11,-2022574463),n,e,r[11],16,1839030562),o,n,r[14],23,-35309556),f=a(f,o=a(o,n=a(n,e,f,o,r[1],4,-1530992060),e,f,r[4],11,1272893353),n,e,r[7],16,-155497632),o,n,r[10],23,-1094730640),f=a(f,o=a(o,n=a(n,e,f,o,r[13],4,681279174),e,f,r[0],11,-358537222),n,e,r[3],16,-722521979),o,n,r[6],23,76029189),f=a(f,o=a(o,n=a(n,e,f,o,r[9],4,-640364487),e,f,r[12],11,-421815835),n,e,r[15],16,530742520),o,n,r[2],23,-995338651),f=p(f,o=p(o,n=p(n,e,f,o,r[0],6,-198630844),e,f,r[7],10,1126891415),n,e,r[14],15,-1416354905),o,n,r[5],21,-57434055),f=p(f,o=p(o,n=p(n,e,f,o,r[12],6,1700485571),e,f,r[3],10,-1894986606),n,e,r[10],15,-1051523),o,n,r[1],21,-2054922799),f=p(f,o=p(o,n=p(n,e,f,o,r[8],6,1873313359),e,f,r[15],10,-30611744),n,e,r[6],15,-1560198380),o,n,r[13],21,1309151649),f=p(f,o=p(o,n=p(n,e,f,o,r[4],6,-145523070),e,f,r[11],10,-1120210379),n,e,r[2],15,718787259),o,n,r[9],21,-343485551),t[0]=i(n,t[0]),t[1]=i(e,t[1]),t[2]=i(f,t[2]),t[3]=i(o,t[3])}function c(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return n}function b(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+(t[r+3]<<24);return n}function f(t){var r,n,e,f,o,i,h=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=h;r+=64)y(u,c(t.substring(r-64,r)));for(n=(t=t.substring(r-64)).length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)e[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(e[r>>2]|=128<<(r%4<<3),55<r)for(y(u,e),r=0;r<16;r+=1)e[r]=0;return f=(f=8*h).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(f[2],16),i=parseInt(f[1],16)||0,e[14]=o,e[15]=i,y(u,e),u}function n(t){var r,n="";for(r=0;r<4;r+=1)n+=e[t>>8*r+4&15]+e[t>>8*r&15];return n}function l(t){var r;for(r=0;r<t.length;r+=1)t[r]=n(t[r]);return t.join("")}function o(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function _(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==l(f("hello"))&&(i=function(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n}),_.prototype.append=function(t){return this.appendBinary(o(t)),this},_.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,n=this._buff.length;for(r=64;r<=n;r+=64)y(this._hash,c(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},_.prototype.end=function(t){var r,n,e=this._buff,f=e.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)o[r>>2]|=e.charCodeAt(r)<<(r%4<<3);return this._finish(o,f),n=t?this._hash:l(this._hash),this.reset(),n},_.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},_.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},_.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},_.prototype._finish=function(t,r){var n,e,f,o=r;if(t[o>>2]|=128<<(o%4<<3),55<o)for(y(this._hash,t),o=0;o<16;o+=1)t[o]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),e=parseInt(n[2],16),f=parseInt(n[1],16)||0,t[14]=e,t[15]=f,y(this._hash,t)},_.hash=function(t,r){return _.hashBinary(o(t),r)},_.hashBinary=function(t,r){var n=f(t);return r?n:l(n)},(_.ArrayBuffer=function(){this.reset()}).prototype.append=function(t){var r,n,e,f,o,i=(n=this._buff.buffer,e=t,f=!0,(o=new Uint8Array(n.byteLength+e.byteLength)).set(new Uint8Array(n)),o.set(new Uint8Array(e),n.byteLength),f?o:o.buffer),h=i.length;for(this._length+=t.byteLength,r=64;r<=h;r+=64)y(this._hash,b(i.subarray(r-64,r)));return this._buff=r-64<h?i.subarray(r-64):new Uint8Array(0),this},_.ArrayBuffer.prototype.end=function(t){var r,n,e=this._buff,f=e.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)o[r>>2]|=e[r]<<(r%4<<3);return this._finish(o,f),n=t?this._hash:l(this._hash),this.reset(),n},_.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.ArrayBuffer.prototype.getState=function(){var t,r=_.prototype.getState.call(this);return r.buff=(t=r.buff,String.fromCharCode.apply(null,new Uint8Array(t))),r},_.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,r){var n,e=t.length,f=new ArrayBuffer(e),o=new Uint8Array(f);for(n=0;n<e;n++)o[n]=t.charCodeAt(n);return r?o:f}(t.buff,!0),_.prototype.setState.call(this,t)},_.ArrayBuffer.prototype.destroy=_.prototype.destroy,_.ArrayBuffer.prototype._finish=_.prototype._finish,_.ArrayBuffer.hash=function(t,r){r=r||{};var n=function(t){var r,n,e,f,o,i,h=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=h;r+=64)y(u,b(t.subarray(r-64,r)));for(n=(t=r-64<h?t.subarray(r-64):new Uint8Array(0)).length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)e[r>>2]|=t[r]<<(r%4<<3);if(e[r>>2]|=128<<(r%4<<3),55<r)for(y(u,e),r=0;r<16;r+=1)e[r]=0;return f=(f=8*h).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(f[2],16),i=parseInt(f[1],16)||0,e[14]=o,e[15]=i,y(u,e),u}(new Uint8Array(t,r.start||0,r.length));return r.raw?n:l(n)},_});
"use strict";var _slicedToArray=function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,e){var t=[],n=!0,a=!1,o=void 0;try{for(var i,l=r[Symbol.iterator]();!(n=(i=l.next()).done)&&(t.push(i.value),!e||t.length!==e);n=!0);}catch(r){a=!0,o=r}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}return t}(r,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};window.THREEToOBJ=function(i,l){function e(r,e,t){if(r.isBufferGeometry)r=(new l).fromBufferGeometry(r);else{if(!r.isGeometry)throw new Error("Geometry is not an instance of BufferGeometry or Geometry");r=r.clone()}e&&e.isMatrix4&&r.applyMatrix(e);var n=new i,a=function(r,a){var o=r.faces,e=r.vertices,i=_slicedToArray(r.faceVertexUvs,1)[0],l="";a&&(l+="mtllib material.mtl\n");for(var t=0;t<e.length;t++){var n=e[t];l+="v "+n.x+" "+n.y+" "+n.z+"\n"}for(var f=0;f<i.length;f++)for(var m=i[f],c=0;c<m.length;c++){var u=m[c];l+="vt "+u.x+" "+u.y+"\n"}for(var v=0;v<o.length;v++)for(var y=o[v],s=0;s<y.vertexNormals.length;s++){var d=y.vertexNormals[s];l+="vn "+d.x+" "+d.y+" "+d.z+"\n"}for(var h=null,x=function(t){var r=o[t];if(a&&r.materialIndex!==h){var e=a instanceof Array?a[r.materialIndex]:a;l+="usemtl "+(""!==e.name?e.name:"material "+e.id)+"\n",h=r.materialIndex}var n=[r.a+1,r.b+1,r.c+1].map(function(r,e){return r+"/"+(0<i.length?e:"")+"/"+(3*t+e+1)}).join(" ");l+="f "+n+"\n"},b=0;b<o.length;b++)x(b);return l}(r,t);if(n.file("object.obj",a),t){var o=function r(e){var t="";if(e instanceof Array){var n=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done);n=!0)t+=r(i.value)}catch(r){a=!0,o=r}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}}else t+="newmtl "+(""!==e.name?e.name:"material "+e.id)+"\n",t+="Ns 10.0000\n",t+="Ni 1.5000\n",t+="d 1.0000\n",t+="Tr 0.0000\n",t+="Tf 1.0000 1.0000 1.0000\n",t+="illum 2\n",t+="Ka "+e.color.r+" "+e.color.g+" "+e.color.b+"\n",t+="Kd "+e.color.r+" "+e.color.g+" "+e.color.b+"\n",t+="Ks 0.0000 0.0000 0.0000\n",t+="Ke 0.0000 0.0000 0.0000\n";return t}(t);n.file("material.mtl",o)}return n.generateAsync({type:"blob"})}return{fromGeometry:e,fromMesh:function(r){return r.updateMatrix(),e(r.geometry,r.matrix,r.material)}}}(JSZip,THREE.Geometry);
"use strict";THREE.OrbitControls=function(e,t){var n,o,a,i,r;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),u=d.NONE},this.update=(n=new THREE.Vector3,o=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),a=o.clone().inverse(),i=new THREE.Vector3,r=new THREE.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(o),h.setFromVector3(n),s.autoRotate&&u===d.NONE&&C(2*Math.PI/60/60*s.autoRotateSpeed),h.theta+=p.theta,h.phi+=p.phi,h.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,h.theta)),h.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=b,h.radius=Math.max(s.minDistance,Math.min(s.maxDistance,h.radius)),s.target.add(T),n.setFromSpherical(h),n.applyQuaternion(a),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(p.theta*=1-s.dampingFactor,p.phi*=1-s.dampingFactor):p.set(0,0,0),b=1,T.set(0,0,0),!(!(f||i.distanceToSquared(s.object.position)>E||8*(1-r.dot(s.object.quaternion))>E)||(s.dispatchEvent(c),i.copy(s.object.position),r.copy(s.object.quaternion),f=!1))}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",B,!1),s.domElement.removeEventListener("mousedown",Z,!1),s.domElement.removeEventListener("mousewheel",F,!1),s.domElement.removeEventListener("MozMousePixelScroll",F,!1),s.domElement.removeEventListener("touchstart",X,!1),s.domElement.removeEventListener("touchend",_,!1),s.domElement.removeEventListener("touchmove",K,!1),document.removeEventListener("mousemove",z,!1),document.removeEventListener("mouseup",Y,!1),window.removeEventListener("keydown",I,!1)};var s=this,c={type:"change"},m={type:"start"},l={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},u=d.NONE,E=1e-6,h=new THREE.Spherical,p=new THREE.Spherical,b=1,T=new THREE.Vector3,f=!1,g=new THREE.Vector2,R=new THREE.Vector2,v=new THREE.Vector2,O=new THREE.Vector2,H=new THREE.Vector2,y=new THREE.Vector2,w=new THREE.Vector2,P=new THREE.Vector2,j=new THREE.Vector2;function M(){return Math.pow(.95,s.zoomSpeed)}function C(e){p.theta-=e}function L(e){p.phi-=e}var N,A,x,D=(N=new THREE.Vector3,function(e,t){N.setFromMatrixColumn(t,0),N.multiplyScalar(-e),T.add(N)}),k=(A=new THREE.Vector3,function(e,t){A.setFromMatrixColumn(t,1),A.multiplyScalar(e),T.add(A)}),U=(x=new THREE.Vector3,function(e,t){var n=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof THREE.PerspectiveCamera){var o=s.object.position;x.copy(o).sub(s.target);var a=x.length();a*=Math.tan(s.object.fov/2*Math.PI/180),D(2*e*a/n.clientHeight,s.object.matrix),k(2*t*a/n.clientHeight,s.object.matrix)}else s.object instanceof THREE.OrthographicCamera?(D(e*(s.object.right-s.object.left)/s.object.zoom/n.clientWidth,s.object.matrix),k(t*(s.object.top-s.object.bottom)/s.object.zoom/n.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)});function S(e){s.object instanceof THREE.PerspectiveCamera?b/=e:s.object instanceof THREE.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function V(e){s.object instanceof THREE.PerspectiveCamera?b*=e:s.object instanceof THREE.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function Z(e){if(!1!==s.enabled){if(e.preventDefault(),e.button===s.mouseButtons.ORBIT){if(!1===s.enableRotate)return;o=e,g.set(o.clientX,o.clientY),u=d.ROTATE}else if(e.button===s.mouseButtons.ZOOM){if(!1===s.enableZoom)return;n=e,w.set(n.clientX,n.clientY),u=d.DOLLY}else if(e.button===s.mouseButtons.PAN){if(!1===s.enablePan)return;t=e,O.set(t.clientX,t.clientY),u=d.PAN}var t,n,o;u!==d.NONE&&(document.addEventListener("mousemove",z,!1),document.addEventListener("mouseup",Y,!1),s.dispatchEvent(m))}}function z(e){var t,n;if(!1!==s.enabled)if(e.preventDefault(),u===d.ROTATE){if(!1===s.enableRotate)return;!function(e){R.set(e.clientX,e.clientY),v.subVectors(R,g);var t=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*v.x/t.clientWidth*s.rotateSpeed),L(2*Math.PI*v.y/t.clientHeight*s.rotateSpeed),g.copy(R),s.update()}(e)}else if(u===d.DOLLY){if(!1===s.enableZoom)return;n=e,P.set(n.clientX,n.clientY),j.subVectors(P,w),0<j.y?S(M()):j.y<0&&V(M()),w.copy(P),s.update()}else if(u===d.PAN){if(!1===s.enablePan)return;t=e,H.set(t.clientX,t.clientY),y.subVectors(H,O),U(y.x,y.y),O.copy(H),s.update()}}function Y(e){!1!==s.enabled&&(document.removeEventListener("mousemove",z,!1),document.removeEventListener("mouseup",Y,!1),s.dispatchEvent(l),u=d.NONE)}function F(e){var t,n;!1===s.enabled||!1===s.enableZoom||u!==d.NONE&&u!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),void(n=0)!==(t=e).wheelDelta?n=t.wheelDelta:void 0!==t.detail&&(n=-t.detail),0<n?V(M()):n<0&&S(M()),s.update(),s.dispatchEvent(m),s.dispatchEvent(l))}function I(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){switch(e.keyCode){case s.keys.UP:U(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:U(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:U(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:U(-s.keyPanSpeed,0),s.update()}}(e)}function X(e){if(!1!==s.enabled){switch(e.touches.length){case 1:if(!1===s.enableRotate)return;r=e,g.set(r.touches[0].pageX,r.touches[0].pageY),u=d.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom)return;o=(n=e).touches[0].pageX-n.touches[1].pageX,a=n.touches[0].pageY-n.touches[1].pageY,i=Math.sqrt(o*o+a*a),w.set(0,i),u=d.TOUCH_DOLLY;break;case 3:if(!1===s.enablePan)return;t=e,O.set(t.touches[0].pageX,t.touches[0].pageY),u=d.TOUCH_PAN;break;default:u=d.NONE}var t,n,o,a,i,r;u!==d.NONE&&s.dispatchEvent(m)}}function K(e){var t,n,o,a,i;if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(u!==d.TOUCH_ROTATE)return;!function(e){R.set(e.touches[0].pageX,e.touches[0].pageY),v.subVectors(R,g);var t=s.domElement===document?s.domElement.body:s.domElement;C(2*Math.PI*v.x/t.clientWidth*s.rotateSpeed),L(2*Math.PI*v.y/t.clientHeight*s.rotateSpeed),g.copy(R),s.update()}(e);break;case 2:if(!1===s.enableZoom)return;if(u!==d.TOUCH_DOLLY)return;o=(n=e).touches[0].pageX-n.touches[1].pageX,a=n.touches[0].pageY-n.touches[1].pageY,i=Math.sqrt(o*o+a*a),P.set(0,i),j.subVectors(P,w),0<j.y?V(M()):j.y<0&&S(M()),w.copy(P),s.update();break;case 3:if(!1===s.enablePan)return;if(u!==d.TOUCH_PAN)return;t=e,H.set(t.touches[0].pageX,t.touches[0].pageY),y.subVectors(H,O),U(y.x,y.y),O.copy(H),s.update();break;default:u=d.NONE}}function _(e){!1!==s.enabled&&(s.dispatchEvent(l),u=d.NONE)}function B(e){e.preventDefault()}s.domElement.addEventListener("contextmenu",B,!1),s.domElement.addEventListener("mousedown",Z,!1),s.domElement.addEventListener("mousewheel",F,!1),s.domElement.addEventListener("MozMousePixelScroll",F,!1),s.domElement.addEventListener("touchstart",X,!1),s.domElement.addEventListener("touchend",_,!1),s.domElement.addEventListener("touchmove",K,!1),window.addEventListener("keydown",I,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});
"use strict";var $$debug=!1;function BowserRevolution(){window.localStorage&&window.localStorage.clear()}window.PP64=Object.create(null),PP64.ns=function(e){var l=e.split(".");if(l.length&&("PP64"===l[0]&&l.splice(0,1),l.length))for(var t=0,n=PP64;t<l.length;)n[l[t]]=n[l[t]]||Object.create(null),n=n[l[t]],t++};
"use strict";PP64.ns("utils"),PP64.utils.arrays={copyRange:function(t,e,n,r,a){t instanceof ArrayBuffer&&(t=new DataView(t)),e instanceof ArrayBuffer&&(e=new DataView(e));for(var i=0;i<a;i++)t.setUint8(n+i,e.getUint8(r+i))},arrayToArrayBuffer:function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;r++)n[r]=t[r];return e},hash:function(t,e,n){return e+n>t.byteLength?"":SparkMD5.ArrayBuffer.hash(t,{start:e,length:n})},hashEqual:function(t,e){return PP64.utils.arrays.hash.apply(this,t).toLowerCase()===e.toLowerCase()},toHexString:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t.byteLength,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r="",a=t;t instanceof ArrayBuffer&&(a=new DataView(t));for(var i=0;i<e;i++)r+=$$hex(a.getUint8(i),"")+(i&&n&&(i+1)%n==0?"\n":" ");return r},print:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t.byteLength,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;console.log(PP64.utils.arrays.toHexString(t,e,n))},readBitAtOffset:function(t,e){var n=t;n instanceof ArrayBuffer&&(n=new DataView(t));var r=Math.floor(e/8),a=128>>>e%8;return n.getUint8(r)&a?1:0},readByteAtBitOffset:function(t,e){var n=t;n instanceof ArrayBuffer&&(n=new DataView(t));var r=Math.floor(e/8),a=e%8,i=65280>>>a;return(n.getUint16(r)&i)>>>8-a},arrayBufferToImageData:function(t,e,n){for(var r=PP64.utils.canvas.createContext(e,n).createImageData(e,n),a=new Uint8Array(t),i=0;i<t.byteLength;i++)r.data[i]=a[i];return r},arrayBufferToDataURL:function(t,e,n){var r=PP64.utils.arrays.arrayBufferToImageData(t,e,n),a=PP64.utils.canvas.createContext(e,n);return a.putImageData(r,0,0),a.canvas.toDataURL()},arrayBuffersEqual:function(t,e){if(t.byteLength!==e.byteLength)return!1;for(var n=new Uint8Array(t),r=new Uint8Array(e),a=0;a<n.byteLength;a++)if(n[a]!==r[a])return!1;return!0},join:function(t,e){if(!t||!e)return t||e;var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer},equal:function(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},intersection:function(t,e){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(t,e){return t===e},r=[],a=0;a<t.length;a++)for(var i=t[a],o=0;o<e.length;o++)if(n(i,e[o])){r.push(i);break}return r}},PP64.ns("utils.img"),PP64.utils.img.cutFromWhole=function(t,e,n,r,a,i,o,u){for(var l=o*(r/8),f=new ArrayBuffer(l*u),c=new Uint8Array(f),s=new Uint8Array(t),g=e*(r/8),d=a*(r/8),h=0,P=i;P<i+u;P++)for(var y=d+g*P,v=0;v<l;v++)c[h++]=s[y+v];return f},PP64.utils.img.toArrayBuffer=function(t,e,n){var r=PP64.utils.canvas.createContext(e,n);return r.drawImage(t,0,0,e,n),r.getImageData(0,0,e,n).data.buffer},PP64.utils.img.invertColor=function(t){return 255-(t>>>16&255)<<16|255-(t>>>8&255)<<8|255-(255&t)},PP64.utils.browser={updateWindowTitle:function(t){t=t||PP64.boards.getCurrentBoard().name,t=PP64.utils.string.mpFormatToPlainText(t),document.title=t?"PartyPlanner64 - "+t:"PartyPlanner64"}},PP64.utils.drag={showDragZone:function(){var e=document.getElementById("dragZone");document.getElementById("dragZone").style.display="inline-block",e.ondragover||(e.ondragover=function(t){t.preventDefault()}),e.ondragenter||(e.ondragenter=function(t){e.className="hover"}),e.ondragleave||(e.ondragleave=function(t){e.className=""})},hideDragZone:function(){var t=document.getElementById("dragZone");t.style.display="none",t.className="",PP64.utils.drag.clearHandlers()},setDropHandler:function(t){document.getElementById("dragZone").ondrop=t},clearHandlers:function(){document.getElementById("dragZone").ondrop=null},setEventParamDropHandler:function(t){PP64.utils.drag.__eventParamDropHandler=t},getEventParamDropHandler:function(){return PP64.utils.drag.__eventParamDropHandler}},PP64.utils.input={openFile:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=arguments[1],e=PP64.utils.input._inputs;e||(e=PP64.utils.input._inputs={});var r=t||"default",a=e[r];a||((a=e[r]=document.createElement("input")).type="file"),a.accept=t;a.addEventListener("change",function t(e){n(e),a.removeEventListener("change",t),a.value=null}),a.click()}},PP64.utils.obj={copy:function(t){return JSON.parse(JSON.stringify(t))},equals:function(t,e){return JSON.stringify(t)===JSON.stringify(e)}},PP64.utils.string={fromU32:function(t){return String.fromCharCode((4278190080&t)>>>24)+String.fromCharCode((16711680&t)>>>16)+String.fromCharCode((65280&t)>>>8)+String.fromCharCode(255&t)},toU32:function(t){var e=PP64.utils.string.toCharCodes(t),n=0;return n|=e[0]<<24,n|=e[1]<<16,n|=e[2]<<8,n|=e[3]},toCharCodes:function(t){for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t.charCodeAt(n);return e},pad:function(t,e,n){for(;t.length<e;)t=n+t;return t},splice:function(t,e,n,r){return t.slice(0,e)+r+t.slice(e+Math.abs(n))},normalizeLineEndings:function(t){return t?t.replace(/\r\n|\r/g,"\n"):t},mpFormatToPlainText:function(t){return t?t.replace(/<\w+>/g,"").replace("„ÄÄ","‚í∂").replace("„ÄÅ","‚í∑").replace("„ÄÇ","‚ñ≤").replace("„ÄÉ","‚ñ∫").replace("„ÄÑ","‚óÑ").replace("„ÄÖ","‚ñº").replace("„ÄÜ","‚ìè").replace("„Äá","üïπÔ∏è").replace("„Äà","‚ú™").replace("„Äâ","‚òÖ").replace("„Äê","‚ìà").replace("„Äë","‚ìá"):""}};var $$number=PP64.utils.number={distance:function(t,e,n,r){return Math.sqrt((t-n)*(t-n)+(e-r)*(e-r))},midpoint:function(t,e,n,r){return{x:(t+n)/2,y:(e+r)/2}},lineDistance:function(t,e,n,r,a,i){return Math.abs((i-r)*t-(a-n)*e+a*r-i*n)/Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2))},pointFallsWithin:function(t,e,n,r,a,i){var o=[Math.min(n,a),Math.max(n,a)],u=o[0],l=o[1],f=[Math.min(r,i),Math.max(r,i)];return u<=t&&t<=l&&f[0]<=e&&e<=f[1]},makeDivisibleBy:function(t,e){return e*Math.ceil(t/e)},degreesToRadians:function(t){return t*Math.PI/180},radiansToDegrees:function(t){return 180*t/Math.PI},determineAngle:function(t,e,n,r){var a=n-t,i=r-e,o=Math.atan2(i,a);return o<0?Math.abs(o):Math.abs(o-Math.PI)+Math.PI},getRawFloat32Format:function(t){var e=new ArrayBuffer(4),n=new DataView(e);return n.setFloat32(0,t),n.getUint32(0)}};PP64.utils.debug={log:function(){$$debug&&console.log.apply(console,arguments)},hex:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"0x",n=Number(Math.abs(t)).toString(16).toUpperCase();return 1===n.length&&(n="0"+n),(t<0?"-":"")+e+n}},PP64.utils.canvas={createContext:function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n.getContext("2d")}},PP64.utils.react={makeKeyClick:function(e,t){return t&&(e=e.bind(t)),function(t){13!==t.keyCode&&32!==t.keyCode||(e(t),t.stopPropagation(),t.preventDefault())}}},PP64.utils.analytics={recordEvent:function(t,e){try{window.gtag&&gtag("event",t,e)}catch(t){console.error(t)}}};var $$log=PP64.utils.debug.log,$$hex=PP64.utils.debug.hex;
"use strict";PP64.ns("utils"),PP64.utils.localstorage=(window.addEventListener("beforeunload",function(t){var e=!0;if(window.localStorage){var r=PP64.adapters.events.getCustomEvents();try{localStorage.setItem("events",JSON.stringify(r)),e=!1}catch(t){}var a=PP64.boards.getBoards().filter(function(t){return!PP64.boards.boardIsROM(t)});try{localStorage.setItem("boards",JSON.stringify(a)),e=!1}catch(t){}}if(e){var o="Cannot save all your boards. Return to the editor and export them?";return t.returnValue=o}}),{getSavedBoards:function(){var t=window.localStorage&&localStorage.getItem("boards");return t&&(t=JSON.parse(t)),t&&t.length?t:null},getSavedEvents:function(){var t=window.localStorage&&localStorage.getItem("events");return t&&(t=JSON.parse(t)),t&&t.length?t:null}});
"use strict";PP64.ns("utils"),PP64.utils.compression=function(){var l=1024;function U(e,t,n){for(var r=0,i=0,s=958,a=new ArrayBuffer(l),U=new DataView(a),c=0;i<n;){if(0==(256&c)&&(c=e.getUint8(r),c|=65280,++r),1==(1&c))t.setUint8(i,e.getUint8(r)),U.setUint8(s,e.getUint8(r)),++i,++r,s=(s+1)%l;else{var o=e.getUint8(r),f=e.getUint8(r+1);r+=2;for(var u,g=(192&f)<<2|o,v=3+(63&f),w=0;w<v;++w)u=U.getUint8(g%l),U.setUint8(s,u),s=(s+1)%l,t.setUint8(i,u),++i,++g}c>>=1}return r}function c(e,t,n){for(var r=0,i=0,s=0,a=0;i<n;){if(0===a&&(s=e.getUint32(r),a=32,r+=4),0!=(2147483648&s))t.setUint8(i,e.getUint8(r)),++i,++r;else{var U=e.getUint8(r),c=e.getUint8(r+1);r+=2;var o,f,u=1+((15&U)<<8|c),g=2+((240&U)>>4);for(2===g&&(g=e.getUint8(r)+18,++r),o=0;o<g&&i<n;++o)f=i<u?0:t.getUint8(i-u),t.setUint8(i,f),++i}s<<=1,--a}return r}function o(e,t,n){for(var r=0,i=0;i<n;){var s=e.getUint8(r);r++;var a=127&s;if(128&s)for(var U=0;U<a;U++){var c=e.getUint8(r);r++,t.setUint8(i,c),i++}else{var o=e.getUint8(r);r++;for(var f=0;f<a;f++)t.setUint8(i,o),i++}}return r}return{decompress:function(e,t,n){var r=new ArrayBuffer(n),i=new DataView(r),s=void 0;switch(e){case 1:s=U(t,i,n);break;case 2:case 3:case 4:s=c(t,i,n);break;case 5:s=o(t,i,n);break;case 0:s=n;for(var a=0;a<n;a++)i.setUint8(a,t.getUint8(a));break;default:$$log("decompression "+e+" not implemented.")}return r.compressedSize=s,r},compress:function(e,t){switch(e){case 1:return function(e){for(var t=Math.ceil(e.byteLength/8),n=e.byteLength+t,r=new ArrayBuffer(n),i=new DataView(r),s=0,a=0;s<n;)s&&s%9?(i.setUint8(s,e.getUint8(a)),a++):i.setUint8(s,255),s++;return r}(t);case 2:case 3:return function(e){for(var t=e.byteLength/32,n=e.byteLength+4*t,r=new ArrayBuffer(n),i=new DataView(r),s=0,a=0;a<n;a+=36,s+=32)i.setUint32(a,4294967295),i.setUint32(a+4,e.getUint32(s)),i.setUint32(a+8,e.getUint32(s+4)),i.setUint32(a+12,e.getUint32(s+8)),i.setUint32(a+16,e.getUint32(s+12)),i.setUint32(a+20,e.getUint32(s+16)),i.setUint32(a+24,e.getUint32(s+20)),i.setUint32(a+28,e.getUint32(s+24)),i.setUint32(a+32,e.getUint32(s+28));return r}(t);case 4:case 5:console.log("compress "+e+" not implemented.");break;case 0:default:return t.buffer.slice(0)}},getCompressedSize:function(e,t,n){var r=new ArrayBuffer(n),i=new DataView(r);switch(e){case 1:return U(t,i,n);case 2:case 3:case 4:return c(t,i,n);case 5:return o(t,i,n);case 0:return n;default:$$log("getCompressedSize "+e+" not implemented.")}}}}();
"use strict";var _class,_temp,_createClass=function(){function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.MIPS=(_temp=_class=function(){function u(){_classCallCheck(this,u)}return _createClass(u,null,[{key:"makeInst",value:function(e){if(!arguments.length)return null;for(var n=new Array(arguments.length-1),t=1;t<arguments.length;t++)n[t-1]=arguments[t];var r="_"+e.toLowerCase();if("function"==typeof u[r])return u[r].apply(u,n);throw"MIPS.makeInst: Unrecognized instruction "+e}},{key:"getJALAddr",value:function(e){if(201326592!=(201326592&e))throw"MIPS.getJALAddr: "+e.toString(16)+" is not a JAL instruction.";return(67108863&e)<<2}},{key:"getRegSetUpperAndLower",value:function(e){var n=65535&e,t=e>>>16;return 32768&n&&(t+=1),[t,n]}},{key:"getRegSetAddress",value:function(e,n){return e&=65535,32768&(n&=65535)&&(e-=1),2147483647&(e<<16|n)}},{key:"getFunctionLength",value:function(e,n){for(var t=n+4;65011720!==e.getUint32(t)&&t<n+8192;)t+=4;return 65011720!==e.getUint32(t)?null:(t+=8)-n}},{key:"findCalls",value:function(e,n){for(var t=MIPSInst.parse("JAL "+n),r=[],u=0;u<e.byteLength;u+=4){e.getUint32(u)===t&&r.push(u)}return r}},{key:"_addiu",value:function(e,n,t){var r=603979776;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_addu",value:function(e,n,t){var r=33;return r|=n<<21,r|=t<<16,r|=e<<11}},{key:"_beq",value:function(e,n,t){var r=268435456;return r|=e<<21,(r|=n<<16)|t>>2&65535}},{key:"_bne",value:function(e,n,t){var r=335544320;return r|=e<<21,(r|=n<<16)|t>>2&65535}},{key:"_bgtz",value:function(e,n){var t=469762048;return(t|=e<<21)|n>>2&65535}},{key:"_blez",value:function(e,n){var t=402653184;return(t|=e<<21)|n>>2&65535}},{key:"_j",value:function(e){return 134217728|e>>>2}},{key:"_jr",value:function(e){return 8|e<<21}},{key:"_jal",value:function(e){return 201326592|e>>>2}},{key:"_lb",value:function(e,n,t){var r=2147483648;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_sb",value:function(e,n,t){var r=2684354560;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_lh",value:function(e,n,t){var r=2214592512;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_sh",value:function(e,n,t){var r=2751463424;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_lui",value:function(e,n){var t=1006632960;return(t|=e<<16)|65535&n}},{key:"_lw",value:function(e,n,t){var r=2348810240;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_sw",value:function(e,n,t){var r=2885681152;return r|=n<<21,(r|=e<<16)|65535&t}},{key:"_ori",value:function(e,n,t){var r=872415232;return r|=e<<21,(r|=n<<16)|65535&t}}]),u}(),_class.REG={R0:0,AT:1,V0:2,V1:3,A0:4,A1:5,A2:6,A3:7,T0:8,T1:9,T2:10,T3:11,T4:12,T5:13,T6:14,T7:15,S0:16,S1:17,S2:18,S3:19,S4:20,S5:21,S6:22,S7:23,T8:24,T9:25,K0:26,K1:27,GP:28,SP:29,S8:30,RA:31},_temp);var $MIPS=PP64.utils.MIPS;
"use strict";var _createClass=function(){function C(e,t){for(var r=0;r<t.length;r++){var C=t[r];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(e,C.key,C)}}return function(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.CIC=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"fixChecksum",value:function(e){var t=PP64.utils.CIC._getGameCIC(e),r=PP64.utils.CIC._getChecksumSeed(t),C=r,n=r,u=r,a=r,s=r,c=r;$$log("CIC.fixChecksum -> Bootcode: "+t+", seed: "+$$hex(r));for(var i,l,o=new DataView(e),P=4096;P<1052672;){var f=o.getUint32(P);c+f>>>0<c&&a++,a>>>=0,c+=f,c>>>=0,u^=f,u>>>=0;var v=((i=f)<<(l=31&f)|i>>>32-l)>>>0;s+=v,s>>>=0,n^=f<n?v:(c^f)>>>0,n>>>=0,C+=6105===t?o.getUint32(1872+(255&P))^f:(s^f)>>>0,C>>>=0,P+=4}var I=void 0,h=void 0;6103===t?(I=c^a,I>>>=0,I+=u,I>>>=0,h=s^n,h>>>=0,h+=C):6106===t?(I=c*a,I>>>=0,I+=u,I>>>=0,h=s*n,h>>>=0,h+=C):(I=c^a,I>>>=0,I^=u,I>>>=0,h=s^n,h>>>=0,h^=C),h>>>=0,o.setUint32(16,I),o.setUint32(20,h),$$log("CIC.fixChecksum -> CRC1: "+$$hex(I)+", CRC2: "+$$hex(h))}},{key:"_getChecksumSeed",value:function(e){switch(e){case 6101:case 6102:return 4174007772;case 6103:return 2743625561;case 6105:return 3743872054;case 6106:return 535454074}throw"CIC._getChecksumSeed: Bad bootcode "+e}},{key:"_getGameCIC",value:function(e){var t=new Uint8Array(e,64,4032);switch(PP64.utils.CIC._crc32(t)){case 1634772129:return PP64.utils.CIC.Type[6101];case 2428202165:return PP64.utils.CIC.Type[6102];case 184880864:return PP64.utils.CIC.Type[6103];case 2562468998:return PP64.utils.CIC.Type[6105];case 2898810890:return PP64.utils.CIC.Type[6106]}return PP64.utils.CIC.Type[6105]}},{key:"_crc32",value:function(e){for(var t=e.byteLength,r=4294967295,C=PP64.utils.CIC._CRCTable,n=0;n<t;n++)r=(r>>>8^C[(r^e[n])>>>0&255])>>>0;return~r>>>0}}]),e}(),PP64.utils.CIC.Type={6101:6101,6102:6102,6103:6103,6105:6105,6106:6106},PP64.utils.CIC._CRCTable=new Array(256),function(){for(var e=PP64.utils.CIC._CRCTable,t=0;t<256;t++){for(var r=t,C=8;0<C;C--)1&r?r=(r>>>1^3988292384)>>>0:r>>>=1;e[t]=r>>>0}}();
"use strict";window.CodeMirror?CodeMirror.defineMode("mips-pp64",function(){var c=/\.(ascii|asciiz|align|byte|definelabel|fill|float|halfword|skip|word)\b/i,e=/\$?(a([0-3]|t)|f(p)|g(p)|k([0-1])|r(0|a)|s([0-8]|p)|t(\d)|v([0-1])|zero)\b/i,r=/\b(abs\.s|abs\.d|add|add\.s|add\.d|addi|addiu|addu|and|andi|bc1f|bc1fl|bc1t|bc1tl|beq|beql|bgez|bgezal|bgezall|bgezl|bgtz|bgtzl|blez|blezl|bltz|bltzal|bltzall|bltzl|bne|bnel|break|c\.f\.s|c\.un\.s|c\.eq\.s|c\.ueq\.s|c\.olt\.s|c\.ult\.s|c\.ole\.s|c\.ule\.s|c\.sf\.s|c\.ngle\.s|c\.seq\.s|c\.ngl\.s|c\.lt\.s|c\.nge\.s|c\.le\.s|c\.ngt\.s|c\.f\.d|c\.un\.d|c\.eq\.d|c\.ueq\.d|c\.olt\.d|c\.ult\.d|c\.ole\.d|c\.ule\.d|c\.sf\.d|c\.ngle\.d|c\.seq\.d|c\.ngl\.d|c\.lt\.d|c\.nge\.d|c\.le\.d|c\.ngt\.d|ceil\.l\.s|ceil\.l\.d|ceil\.w\.s|ceil\.w\.d|cfc1|ctc1|cop0|cop1|cop2|cop3|cvt\.d\.s|cvt\.d\.w|cvt\.d\.l|cvt\.l\.d|cvt\.l\.d|cvt\.s\.d|cvt\.s\.w|cvt\.s\.l|cvt\.w\.s|cvt\.w\.d|dadd|daddi|daddiu|daddu|ddiv|ddivu|div|div\.s|div\.d|divu|dmfc1|dmult|dmultu|dmtc1|dsll|dsll32|dsllv|dsra|dsra32|dsrav|dsrl|dsrl32|dsrlv|dsub|dsubu|floor\.l\.s|floor\.l\.d|floor\.w\.s|floor\.w\.d|j|jal|jalr|jr|lb|lbu|ld|ldc1|ldc2|ldl|ldr|lh|lhu|ll|lld|lui|lw|lwc1|lwc2|lwc3|lwl|lwr|lwu|madd\.s|madd\.d|mfc1|mfhi|mflo|mov\.s|mov\.d|movt|msub\.s|msub\.d|mtc1|mthi|mtlo|mul\.s|mul\.d|mult|multu|neg\.s|neg\.d|nop|nor|or|ori|round\.l\.s|round\.l\.d|round\.w\.s|round\.w\.d|sb|sc|scd|sd|sdc1|sdc2|sdl|sdr|sh|sll|sllv|slt|slti|sltiu|sltu|sqrt\.s|sqrt\.d|sra|srav|srl|srlv|sub|sub\.s|sub\.d|subu|sw|swc1|swc2|swc3|swl|swr|sync|syscall|teq|teqi|tge|tgei|tgeiu|tgeu|tlt|tlti|tltiu|tltu|tne|tnei|trunc\.l\.s|trunc\.l\.d|trunc\.w\.s|trunc\.w\.d|xor|xori)\b/i,u=/\b(0x[\da-f]+|o[0-7]+|b[0-1]+|\d+)\b/i;return{startState:function(){return{context:0}},token:function(l,d){if(l.eatSpace())return null;var t=void 0;if(l.eat(";")||l.match("//"))return l.skipToEnd(),"comment";if(l.eat('"')){for(;(t=l.next())&&'"'!=t;);return"string"}if(l.eat(".")){if(l.eatWhile(/\w/))return t=l.current(),c.test(t)?"def":null}else if(l.eatWhile(/[\$\w\.]/)){if(t=l.current(),r.test(t)){var s="keyword";return"nop"===t.toLowerCase()&&(s+=" nop"),s}if(e.test(t))return"atom";if(u.test(t))return"number"}return l.next(),null}}}):console.error("mips-pp64: CodeMirror global not found");
"use strict";CodeMirror.registerHelper("hint","mips-pp64",function(r){var i=r.getCursor(),t=r.getTokenAt(i),n=t.string,o=t.start,s=i.ch,e=r.getLine(i.line);if("."===e[0]){return{list:["ascii","asciiz","align","byte","definelabel","fill","float","halfword","skip","word"],from:CodeMirror.Pos(i.line,1),to:CodeMirror.Pos(i.line,s)}}var l=PP64.events.getActiveEditorSupportedGames();function a(r,t){if(!r.length)return[];if(1===r.length)return PP64.symbols.getSymbols(r[0],t);for(var e=PP64.symbols.getSymbols(r[0],t),i=0;i<r.length-1;i++){var n=PP64.symbols.getSymbols(r[i+1],t);e=PP64.utils.arrays.intersection(e,n,function(r,t){return r.name===t.name})}return e}if(/^(j|jal)\s+/i.test(e))return u(a(l,"code"));if(/^\w+\s+/.test(e))return u(a(l));function u(r){r=r.map(function(r){return r.name});var t,e=1;n.trim()&&(e=n.lastIndexOf("(")+1,n.substring(e)&&(t=n,r=r.filter(function(r){return r.startsWith(t)})));return{list:r.sort(),from:CodeMirror.Pos(i.line,o+e),to:CodeMirror.Pos(i.line,s)}}});
"use strict";var _slicedToArray=function(e,A){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,A){var E=[],D=!0,t=!1,T=void 0;try{for(var r,_=e[Symbol.iterator]();!(D=(r=_.next()).done)&&(E.push(r.value),!A||E.length!==A);D=!0);}catch(e){t=!0,T=e}finally{try{!D&&_.return&&_.return()}finally{if(t)throw T}}return E}(e,A);throw new TypeError("Invalid attempt to destructure non-iterable instance")};PP64.types={View:{EDITOR:0,DETAILS:1,SETTINGS:2,ABOUT:3,MODELS:4,PATCHES:5,STRINGS:6,EVENTS:7,CREATEEVENT:8},Space:{OTHER:0,BLUE:1,RED:2,MINIGAME:3,HAPPENING:4,STAR:5,CHANCE:6,START:7,SHROOM:8,BOWSER:9,ITEM:10,BATTLE:11,BANK:12,ARROW:13,BLACKSTAR:14,GAMEGUY:15,DUEL_BASIC:16,DUEL_START_BLUE:17,DUEL_START_RED:18,DUEL_POWERUP:19,DUEL_REVERSE:20},isKnownSpaceType:function(e){for(var A in $spaceType)if($spaceType[A]===e)return!0;return!1},SpaceSubtype:{TOAD:0,BOWSER:1,KOOPA:2,BOO:3,GOOMBA:4,BANK:5,BANKCOIN:6,ITEMSHOP:7,GATE:8},BoardType:{NORMAL:"NORMAL",DUEL:"DUEL"},Action:{MOVE:0,LINE:1,LINE_STICKY:2,ROTATE:3,ERASE:4,ROM_LOAD:5,ROM_UNLOAD:6,BOARD_LOAD:7,BOARD_SAVE:8,BOARD_NEW:9,BOARD_WRITE:10,BOARD_DETAILS:11,BOARD_EDITOR:12,BOARD_COPY:13,DUMP_LOAD:13.1,DUMP_SAVE:13.2,MODEL_VIEWER:13.3,STRINGS_EDITOR:13.4,EVENTS:13.5,CREATEEVENT:13.6,BACK_TO_EVENTS:13.7,SAVE_EVENT:13.8,EVENT_LOAD:13.9,SET_BG:14,SCREENSHOT:14.1,ROM_SAVE:15,SETTINGS:15.1,ABOUT:15.2,PATCHES:15.3,ADD_OTHER:16,ADD_BLUE:17,ADD_RED:18,ADD_MINIGAME:19,ADD_HAPPENING:20,ADD_STAR:21,ADD_BLACKSTAR:21.2,ADD_START:21.3,ADD_CHANCE:22,ADD_SHROOM:23,ADD_BOWSER:24,ADD_TOAD_CHARACTER:25,ADD_BOWSER_CHARACTER:26,ADD_KOOPA_CHARACTER:27,ADD_BOO_CHARACTER:28,ADD_ITEM:29,ADD_BATTLE:30,ADD_BANK:31,ADD_GAMEGUY:32,ADD_ARROW:32.2,MARK_STAR:33,MARK_GATE:33.1,ADD_BANK_SUBTYPE:34,ADD_BANKCOIN_SUBTYPE:35,ADD_ITEMSHOP_SUBTYPE:36,ADD_DUEL_BASIC:37,ADD_DUEL_REVERSE:38,ADD_DUEL_POWERUP:39,ADD_DUEL_START_BLUE:40,ADD_DUEL_START_RED:41},Game:{MP1_USA:"CLBE",MP1_JPN:"CLBJ",MP1_PAL:"NLBP",MP2_USA:"NMWE",MP2_JPN:"NMWJ",MP2_PAL:"NMWP",MP3_USA:"NMVE",MP3_JPN:"NMVJ",MP3_PAL:"NMVP"},getGameName:function(e){var A=!0,E=!1,D=void 0;try{for(var t,T=Object.entries(PP64.types.Game)[Symbol.iterator]();!(A=(t=T.next()).done);A=!0){var r=_slicedToArray(t.value,2),_=r[0];if(r[1]===e)return _}}catch(e){E=!0,D=e}finally{try{!A&&T.return&&T.return()}finally{if(E)throw D}}return null},EventActivationType:{WALKOVER:1,LANDON:3,BEGINORWALKOVER:8},EventExecutionType:{DIRECT:1,PROCESS:2},getExecutionTypeName:function(e){switch(e){case 1:return"Direct";case 2:return"Process"}throw new Error("Unknown execution type "+e+".")},getExecutionTypeByName:function(e){switch(e){case"Direct":return 1;case"Process":return 2}},ValidationLevel:{ERROR:1,WARNING:2},EventParameterTypes:["Boolean","Number","+Number","Space"]};var $viewType=PP64.types.View,$actType=PP64.types.Action,$gameType=PP64.types.Game,$spaceType=PP64.types.Space,$spaceSubType=PP64.types.SpaceSubtype,$activationType=PP64.types.EventActivationType,$executionType=PP64.types.EventExecutionType,$validationLevel=PP64.types.ValidationLevel;
"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var $setting={uiAdvanced:"ui.advanced",uiDebug:"ui.debug",uiSkipValidation:"ui.skipvalidation",uiAllowAllRoms:"ui.allowallroms",writeBranding:"write.branding",writeDecompressed:"write.decompressed",limitModelFPS:"models.limitfps",limitModelAnimations:"models.limitAnimations"};PP64.settings=function(){var n=[{name:"UI",type:"section"},{id:"ui.advanced",type:"checkbox",default:!1,name:"Advanced features",desc:"Enables infrequently used, potentially complicated, and developer features."},{id:"ui.debug",type:"checkbox",default:$$debug,name:"Debug features",advanced:!0,desc:"Enables debug output and UI that may aid development."},{id:"ui.skipvalidation",type:"checkbox",default:!1,name:"Skip Overwrite Validation",advanced:!0,desc:"Allow all boards to be written regardless of warnings."},{id:"ui.allowallroms",type:"checkbox",default:!1,name:"Allow All ROMs",advanced:!0,desc:"Allows more than just the officially supported ROMs to attempt to load."},{name:"ROM",type:"section"},{id:"write.branding",type:"checkbox",default:!0,name:"Include branding",desc:"Adds the PartyPlanner64 logo to the game boot splashscreens."},{id:"write.decompressed",type:"checkbox",default:!1,name:"Leave ROM decompressed",advanced:!0,desc:"Leaves all files decompressed when saving a ROM, resulting in larger file size."},{name:"Model Viewer",type:"section"},{id:"models.limitfps",type:"checkbox",default:!0,name:"Limit FPS",desc:"Reduce the refresh rate for better performance."},{id:"models.limitAnimations",type:"checkbox",default:!0,name:"Limit animations",desc:"Limit animations to those in the same directory as the model."}];function i(e){return(t=e,n.find(function(e){return e.id===t})).default;var t}var s=new(function(){function e(){_classCallCheck(this,e),Cookies.defaults={expires:1/0},this._tempSettings={}}return _createClass(e,[{key:"getSetting",value:function(e){if(!Cookies.enabled)return this._tempSettings.hasOwnProperty(e)?this._tempSettings[e]:this._tempSettings[e]=i(e);var t=Cookies.get(e);return void 0===t?i(e):JSON.parse(t)}},{key:"setSetting",value:function(e,t){Cookies.enabled?Cookies.set(e,JSON.stringify(t)):this._tempSettings[e]=t}},{key:"reset",value:function(){n.forEach(function(e){e.id&&Cookies.expire(e.id)})}}]),e}());$$debug=s.getSetting($setting.uiDebug);var e=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(i)))).state={},a.onCheckChanged=function(e,t){var n,i;n=e,i=t,s.setSetting(n,i),"ui.debug"===n&&($$debug=i),a.setState({id:t})},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var e,i=this,t=(e=n,s.getSetting($setting.uiAdvanced)||(e=e.filter(function(e){return!e.advanced})),e).map(function(e){var t,n=(t=e.id)?s.getSetting(t):"";switch(e.type){case"checkbox":return React.createElement(a,{id:e.id,name:e.name,desc:e.desc,key:e.id,value:n,onCheckChanged:i.onCheckChanged});case"section":return React.createElement("h3",{key:e.name},e.name)}});return React.createElement("div",{id:"settingsForm"},React.createElement("h2",null,"Settings"),t)}}]),o}(),a=function(e){function o(){var e,t,n;_classCallCheck(this,o);for(var i=arguments.length,a=Array(i),r=0;r<i;r++)a[r]=arguments[r];return(t=n=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(a)))).state={},n.onToggled=function(){n.props.onCheckChanged(n.props.id,!n.props.value)},_possibleConstructorReturn(n,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var e=this.props.id+"-main",t=this.props.id+"-desc";return React.createElement("div",{className:"checkboxSetting",onClick:this.onToggled},React.createElement("input",{type:"checkbox",className:"checkboxSettingChk",checked:this.props.value,onChange:this.onToggled,"aria-labelledby":e,"aria-describedby":t}),React.createElement("div",{className:"checkboxSettingLines"},React.createElement("span",{id:e,className:"checkboxSettingMain"},this.props.name),React.createElement("br",null),React.createElement("span",{id:t,className:"checkboxSettingDesc"},this.props.desc)))}}]),o}();return{Settings:e,get:function(e){return s.getSetting(e)},set:function(e,t){return s.setSetting(e,t)}}}();
"use strict";PP64.images=function(){var i={},p={},a=0;function e(e,g){p[e]=g,i[e]=new Image,a+=1,i[e].onload=n}function n(){(a-=1)||PP64.renderer.render()}return e("toadImg","img/editor/toad.png"),e("mstarImg","img/editor/mstar.png"),e("bowserImg","img/editor/bowser.png"),e("koopaImg","img/editor/koopa.png"),e("booImg","img/editor/boo.png"),e("goombaImg","img/editor/goomba.png"),e("eventImg","img/editor/event.png"),e("eventErrorImg","img/editor/eventerrors.png"),e("starImg","img/editor/star.png"),e("bank2Img","img/editor/bank2.png"),e("bank3Img","img/editor/bank.png"),e("bankcoinImg","img/editor/bankcoin.png"),e("itemShop2Img","img/editor/itemshop2.png"),e("itemShop3Img","img/editor/itemshop.png"),e("gateImg","img/editor/gate.png"),e("spaceBowser","img/editor/spaces/bowser.png"),e("spaceItem2","img/editor/spaces/item2.png"),e("spaceBlue3","img/editor/spaces/blue3.png"),e("spaceRed3","img/editor/spaces/red3.png"),e("spaceHappening3","img/editor/spaces/happening3.png"),e("spaceChance3","img/editor/spaces/chance3.png"),e("spaceBowser3","img/editor/spaces/bowser3.png"),e("spaceItem3","img/editor/spaces/item3.png"),e("spaceBattle3","img/editor/spaces/battle3.png"),e("spaceBank3","img/editor/spaces/bank3.png"),e("spaceGameGuy3","img/editor/spaces/gameguy.png"),e("spaceDuelBasic3","img/editor/spaces/basic3.png"),e("spaceDuelPowerup3","img/editor/spaces/powerup3.png"),e("spaceDuelReverse3","img/editor/spaces/reverse3.png"),e("spaceGameGuyDuel3","img/editor/spaces/gameguyduel.png"),e("spaceMiniGameDuel3","img/editor/spaces/minigameduel3.png"),e("spaceHappeningDuel3","img/editor/spaces/happeningduel3.png"),e("targetImg","img/events/target.png"),function(){for(var e in p)if(p.hasOwnProperty(e)){var g=p[e];i[e].src=g}p=null}(),{get:function(e){return i[e]}}}();
"use strict";var _createClass=function(){function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.controls=function(){var t=function(t){function i(){var t,e,r;_classCallCheck(this,i);for(var o=arguments.length,n=Array(o),s=0;s<o;s++)n[s]=arguments[s];return(e=r=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(n)))).state={},r.onClick=function(){r.props.onClick(r.props.id)},_possibleConstructorReturn(r,e)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){var t="nbButton";return this.props.css&&(t+=" "+this.props.css),React.createElement("div",{className:t,title:this.props.title,tabIndex:0,onClick:this.onClick,onKeyDown:PP64.utils.react.makeKeyClick(this.onClick,this)},this.props.children)}}]),i}(),r=function(t){function i(){var t,e,r;_classCallCheck(this,i);for(var o=arguments.length,n=Array(o),s=0;s<o;s++)n[s]=arguments[s];return(e=r=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(n)))).state={},r.onClick=function(){!1===r.props.allowDeselect&&r.props.pressed||r.props.onToggled(r.props.id,!r.props.pressed)},_possibleConstructorReturn(r,e)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){var t="toggleButton"+(this.props.pressed?" pressed":"");return this.props.css&&(t+=" "+this.props.css),React.createElement("div",{className:t,title:this.props.title,tabIndex:0,onClick:this.onClick,onKeyDown:PP64.utils.react.makeKeyClick(this.onClick,this)},this.props.children)}}]),i}(),e=function(t){function i(){var t,e,r;_classCallCheck(this,i);for(var o=arguments.length,n=Array(o),s=0;s<o;s++)n[s]=arguments[s];return(e=r=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(n)))).state={},_possibleConstructorReturn(r,e)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){var e=this,t=this.props.items.map(function(t){return React.createElement(r,{id:t.id,key:t.id,pressed:t.selected,allowDeselect:e.props.allowDeselect,title:t.title,onToggled:e.props.onToggleClick},t.text)});return React.createElement("div",{className:this.props.groupCssClass},t)}}]),i}();return{Button:t,ToggleButton:r,ToggleGroup:e}}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};PP64.boards=function(){var r=0;function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:PP64.types.BoardType.NORMAL,r={name:"Untitled",description:"Use your Star Power to finish\nthis board.",type:n,difficulty:3,spaces:[],links:{},game:e};switch(e){case 1:r.bg={width:960,height:720,src:!0},r.otherbg={boardselect:!0,boardlogo:!0,largescene:!0,conversation:!0,splashscreen:!0},r.audioIndex=24;break;case 2:r.bg={width:1152,height:864,src:!0},r.animbg=[],r.otherbg={boardselect:!0,boardselecticon:!0,boardlogo:!0,largescene:!0};break;case 3:switch(n){case PP64.types.BoardType.NORMAL:r.bg={width:1152,height:864,src:!0};break;case PP64.types.BoardType.DUEL:r.bg={width:896,height:672,src:!0}}r.otherbg={boardselect:!0,boardlogo:!0,boardlogotext:!0,largescene:!0}}return n===PP64.types.BoardType.DUEL?(r.spaces.push({x:200,y:200,type:$spaceType.DUEL_START_BLUE}),r.spaces.push({x:r.bg.width-200,y:r.bg.height-200,type:$spaceType.DUEL_START_RED})):r.spaces.push({x:r.bg.width-200,y:r.bg.height-200,type:$spaceType.START}),function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default",r="img/themes/";e.otherbg.boardselect&&(e.otherbg.boardselect=r+n+"/boardselect.png");e.otherbg.boardselecticon&&(e.otherbg.boardselecticon=r+n+"/boardselecticon.png");e.otherbg.boardlogo&&(e.otherbg.boardlogo=r+n+"/boardlogo.png");e.otherbg.boardlogotext&&(e.otherbg.boardlogotext=r+n+"/boardlogotext.png");e.otherbg.largescene&&(e.otherbg.largescene=r+n+"/largescene.png");e.otherbg.conversation&&(e.otherbg.conversation=r+n+"/conversation.png");e.otherbg.splashscreen&&(e.otherbg.splashscreen=r+n+"/splashscreen.png");switch(e.game){case 1:e.bg.src=r+n+"/bg.png";break;case 2:case 3:e.bg.src=r+n+"/bg2.png"}}(r),r}var a=void 0,e=PP64.utils.localstorage.getSavedBoards();function n(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e||(e=t(n.game||1,n.type||PP64.types.BoardType.NORMAL)),n.rom&&(e._rom=!0),function(e){if(!e.spaces)return;if(!PP64.adapters)return;for(var n=0;n<e.spaces.length;n++){var r=e.spaces[n];if(r.events)for(var t=0;t<r.events.length;t++){var a=r.events[t];if(a.asm&&!PP64.adapters.events.getEvent(a.id))try{PP64.adapters.events.createCustomEvent(a.asm)}catch(t){console.error("Error reading custom event from loaded board: "+t.toString()),r.events.splice(t,1)}}}}(e),a.push(e),PP64.app&&PP64.app.boardsChanged(),a.length-1}function c(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=a[r];return e&&(n=function e(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if("object"!==(void 0===n?"undefined":_typeof(n)))return n;n=JSON.parse(JSON.stringify(n));for(var r in n)n.hasOwnProperty(r)&&("_"===r.charAt(0)&&delete n[r],"object"===_typeof(n[r])&&null!==n[r]&&(n[r]=e(n[r])));return n}(n)),n}function o(e){r=e,PP64.app.currentBoardChanged()}function s(e){return!!e._rom}function i(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:c();return Array.isArray(r.links[e])?"*"===n||void 0===n||0<=r.links[e].indexOf(n):void 0!==r.links[e]&&null!==r.links[e]&&("*"===n||void 0===n||r.links[e]===n)}function l(e,n){var r=e.spaces;if(r&&r.length)for(var t=0;t<r.length;t++){var a=r[t];if(a.events&&a.events.length)for(var o=0;o<a.events.length;o++){var s=a.events[o];if(s.parameters)for(var i=0;i<s.parameters.length;i++){n(s.parameters[i],s,a)}}}}function p(e,n,r){e.events=e.events||[],n&&(r?e.events.unshift(n):e.events.push(n))}return e&&e.length?(a=[],e.forEach(n)):a=[t(1)],{getCurrentBoard:c,indexOf:function(e){return a.indexOf(e)},getCurrentBoardIndex:function(){return r},setCurrentBoard:o,currentBoardIsROM:function(){return!!c()._rom},boardIsROM:s,getBoardCount:function(){return a.length},getBoards:function(){return a},getROMBoards:function(){return a.filter(function(e){return s(e)})},setBG:function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:c()).bg.src=e},addAnimBG:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c();n.animbg=n.animbg||[],n.animbg.push(e)},removeAnimBG:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c();!n.animbg||n.animbg.length<=e||e<0||n.animbg.splice(e,1)},addBoard:n,deleteBoard:function(e){isNaN(e)||e<0||e>=a.length||(1===a.length&&n(),a.splice(e,1),e<r?o(r-1):1===a.length?o(0):r===e&&r===a.length&&o(r-1),PP64.app.boardsChanged(),PP64.app.currentBoardChanged())},copyCurrentBoard:function(){var e=a[r],n=JSON.parse(JSON.stringify(e));delete n._rom,n.name="Copy of "+n.name,a.splice(r+1,0,n),PP64.app.boardsChanged()},addSpace:function(e,n,r,t){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:c(),o={x:e,y:n,z:0,type:r};void 0!==t&&(o.subtype=t);var s=PP64.adapters.getAdapter(a.game||1);s&&s.hydrateSpace(o);for(var i=0;i<a.spaces.length;i++)if(null===a.spaces)return a.spaces[i]=o,i;return a.spaces.push(o),a.spaces.length-1},removeSpace:function(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c();if(!(n<0||n>=e.spaces.length)){var r;!function(e,n){if(n.links)for(var r in delete n.links[e],n.links){var t=n.links[r];if(Array.isArray(t)){var a=t.indexOf(e);-1!==a&&t.splice(a,1),1===t.length?n.links[r]=t[0]:t.length||delete n.links[r]}else t===e&&delete n.links[r]}}(n,e),r=n,l(e,function(e,n){"Space"===e.type&&n.parameterValues&&n.parameterValues.hasOwnProperty(e.name)&&n.parameterValues[e.name]===r&&delete n.parameterValues[e.name]});var t=e.spaces.length;e.spaces.splice(n,1);for(var a=void 0,o=void 0,s=0;s<t;s++)e.links.hasOwnProperty(s)&&(a=i(s),o=e.links[s],a!==s&&delete e.links[s],Array.isArray(o)?e.links[a]=o.map(i):e.links[a]=i(o));l(e,function(e,n){"Space"===e.type&&n.parameterValues&&n.parameterValues.hasOwnProperty(e.name)&&(n.parameterValues[e.name]=i(n.parameterValues[e.name]))})}function i(e){return parseInt(e)>parseInt(n)?e-1:e}},getSpaceIndex:function(e){return(1<arguments.length&&void 0!==arguments[1]?arguments[1]:c()).spaces.indexOf(e)},getStartSpaceIndex:function(e){for(var n=e.spaces,r=0;r<n.length;r++)if(n[r]&&n[r].type===PP64.types.Space.START)return r;return-1},getSpacesOfType:function(e){for(var n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:c()).spaces,r=[],t=0;t<n.length;t++)n[t]&&n[t].type===e&&r.push(t);return r},getSpacesOfSubType:function(e){for(var n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:c()).spaces,r=[],t=0;t<n.length;t++)n[t]&&n[t].subtype===e&&r.push(t);return r},hasConnection:i,getConnections:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c();return e<0?null:(n.links=n.links||{},Array.isArray(n.links[e])?n.links[e].slice(0):"number"==typeof n.links[e]?[n.links[e]]:[])},addConnection:function(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:c();e===n||i(e,n,r)||(r.links=r.links||{},Array.isArray(r.links[e])?r.links[e].push(n):"number"==typeof r.links[e]?r.links[e]=[r.links[e],n]:0<=n&&(r.links[e]=n))},addAssociation:function(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:c();r.associations=r.associations||{};isNaN(r.spaces[e].subtype),isNaN(r.spaces[n].subtype)},setSpaceRotation:function(e,n){var r=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:c()).spaces[e];if(!r)throw new Error("setSpaceRotation: Invalid space index "+e);r.rotation=Math.round(n)},addEventByIndex:function(e,n,r,t){p(e.spaces[n],r,t)},addEventToSpace:p,removeEventFromSpace:function(e,n){if(e&&n&&e.events){var r=e.events.indexOf(n);-1===r||e.events.splice(r,1)}},getDeadEnds:function(a){var e,o=[],s=(e=a,PP64.utils.obj.copy(e.spaces));function i(e){if(s[e]._seen)return!1;if(!a.links.hasOwnProperty(e))return o.push(e),!0;s[e]._seen=!0;var n=a.links[e],r=void 0;if(Array.isArray(n)){for(var t=0;t<n.length;t++)if(r=i(n[t]))return r}else if(r=i(n))return r}for(var r={},n=0;n<s.length;n++)s[n]&&(r[n]=[]);var t=function(n){PP64.boards.getConnections(n,a).forEach(function(e){r[e].push(Number(n))})};for(var c in a.links)t(c);var l,p,d=PP64.boards.getStartSpaceIndex(a);0<=d&&i(d);for(var g=0;g<s.length;g++)s[g]&&(s[g]._seen||(l=g,!((p=void 0)===p?r[l].length:r[l].length&&(-1===r[l].indexOf(Number(p))||1<r[l].length))&&PP64.boards.hasConnection(g,null,a)&&i(g)));return o},loadBoardsFromROM:function(){var e=PP64.adapters.getROMAdapter();if(e){for(var n=e.loadBoards(),r=0;r<n.length;r++)n[r]._rom=!0,a.push(n[r]);PP64.app.boardsChanged()}},clearBoardsFromROM:function(){for(var e=a.length-1;0<=e;e--)a[e]._rom&&a.splice(e,1);a.length||n()}}}();
"use strict";var _createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.boardmenu=new function e(){_classCallCheck(this,e),this.BoardMenu=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var r=0,e=this.props.boards.map(function(e){var t=r++;return React.createElement(n,{key:t,board:e,index:t})});return React.createElement("div",{className:"boardMenu",role:"listbox"},React.createElement("div",{className:"boardMenuInner",role:"presentation"},e))}}]),t}();var n=function(e){function i(){var e,t,r;_classCallCheck(this,i);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(o)))).handleClick=function(){PP64.boards.setCurrentBoard(r.props.index)},r.onDragStart=function(e){r.props.board._rom?e.preventDefault():(PP64.utils.drag.showDragZone(),e.nativeEvent.dataTransfer.setData("text/plain",r.props.index),PP64.utils.drag.setDropHandler(function(e){e.preventDefault();var t=parseInt(e.dataTransfer.getData("text/plain"));isNaN(t)||(PP64.utils.drag.hideDragZone(),PP64.boards.deleteBoard(t),PP64.renderer.render())}))},r.onDragEnd=function(e){PP64.utils.drag.hideDragZone()},r.onRightClick=function(e){e.preventDefault();var t=[{title:"Copy",fn:r.onCopyBoard},{title:"Delete",fn:r.onDeleteBoard,visible:!PP64.boards.boardIsROM(r.props.board)}];basicContext.show(t,e.nativeEvent)},r.onDeleteBoard=function(){PP64.boards.deleteBoard(r.props.index),PP64.renderer.render()},r.onCopyBoard=function(){PP64.boards.copyCurrentBoard()},_possibleConstructorReturn(r,t)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){var e='Open "'+this.props.board.name+'"',t="boardEntry";PP64.boards.getCurrentBoardIndex()===this.props.index&&(t+=" boardEntryCurrent");var r=this.props.board.otherbg.boardlogo||"",n=void 0;n=r?React.createElement("img",{className:"boardEntryImg",src:r,width:"200",height:"88"}):React.createElement("div",{className:"boardEntryNoImg"});var o=this.props.board.name,a=PP64.boards.boardIsROM(this.props.board),i=PP64.utils.react.makeKeyClick(this.handleClick,this);return React.createElement("div",{className:t,title:e,role:"option",tabIndex:"0",onClick:this.handleClick,onKeyDown:i,onContextMenu:this.onRightClick,draggable:"true",onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},n,React.createElement(s,{rom:a}),React.createElement(c,{name:o}),React.createElement(l,{rom:a,onDeleteBoard:this.onDeleteBoard,onCopyBoard:this.onCopyBoard}))}}]),i}(),s=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return this.props.rom?React.createElement("div",{className:"boardEntryRomIcon",title:"Loaded from ROM"},React.createElement("img",{src:"img/boardmenu/cart.png",width:"26",height:"26"})):null}}]),t}(),c=function(e){function i(){var e,t,r;_classCallCheck(this,i);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(o)))).state={editing:!1},r.handleClick=function(){r.setState({editing:!!r.state.editing})},_possibleConstructorReturn(r,t)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){return React.createElement("div",{className:"boardName"},React.createElement(PP64.texteditor.MPEditor,{value:this.props.name,displayMode:PP64.texteditor.MPEditorDisplayMode.Display}))}}]),i}(),l=function(e){function i(){var e,t,r;_classCallCheck(this,i);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(o)))).handleClick=function(e){e.preventDefault();var t=[{title:"Copy",fn:r.props.onCopyBoard},{title:"Delete",fn:r.props.onDeleteBoard,visible:!r.props.rom}];basicContext.show(t,e.nativeEvent)},_possibleConstructorReturn(r,t)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){return React.createElement("img",{className:"boardMenuIcon",src:"img/boardmenu/options.png",onClick:this.handleClick})}}]),i}()};
"use strict";var _createClass=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.newboard=function(){var c=[{name:"Blank",id:"default"}],e=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(r)))).state={version:1,type:PP64.types.BoardType.NORMAL,theme:0},n.onVersionChange=function(e){n.setState({version:e}),3!==e&&n.setState({type:PP64.types.BoardType.NORMAL})},n.onTypeChange=function(e){n.setState({type:e})},n.onThemeChange=function(e){n.setState({theme:e})},n.submit=function(){if(n.state.type!==PP64.types.BoardType.DUEL||(PP64.app.showMessage("Duel board support is partially finished, coming soon!"),$$debug)){var e=n.props.onAccept;e&&e(n.state.version,n.state.type,c[n.props.theme])}},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var e=PP64.controls.Button;return React.createElement("div",{className:"newBoardContainer"},React.createElement(t,{onVersionChange:this.onVersionChange}),3===this.state.version?React.createElement(n,{type:this.state.type,onTypeChange:this.onTypeChange}):null,React.createElement(a,{onThemeChange:this.onThemeChange}),React.createElement(e,{onClick:this.submit,css:"nbCreate"},"Create"))}}]),s}(),t=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(r)))).state={version:1},n.onVersionChange=function(e,t){n.setState({version:e}),n.props.onVersionChange(e)},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var e=PP64.controls.ToggleButton,t=[React.createElement(e,{id:1,key:1,allowDeselect:!1,onToggled:this.onVersionChange,pressed:1===this.state.version},React.createElement("span",{className:"newBoardVersion",title:"Mario Party 1"},"MP1"))];return t.push(React.createElement(e,{id:2,key:2,allowDeselect:!1,onToggled:this.onVersionChange,pressed:2===this.state.version},React.createElement("span",{className:"newBoardVersion",title:"Mario Party 2"},"MP2"))),t.push(React.createElement(e,{id:3,key:3,allowDeselect:!1,onToggled:this.onVersionChange,pressed:3===this.state.version},React.createElement("span",{className:"newBoardVersion",title:"Mario Party 3"},"MP3"))),React.createElement("div",{className:"newBoardVersionSelect"},React.createElement("label",{className:"nbLabel"},"Game Version"),React.createElement("br",null),t)}}]),s}(),n=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(r)))).onTypeChange=function(e){n.props.onTypeChange(e)},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var e=PP64.controls.ToggleButton;return React.createElement("div",{className:"newBoardVersionSelect"},React.createElement("label",{className:"nbLabel"},"Board Type"),React.createElement("br",null),React.createElement(e,{id:PP64.types.BoardType.NORMAL,allowDeselect:!1,onToggled:this.onTypeChange,pressed:this.props.type===PP64.types.BoardType.NORMAL},React.createElement("span",{className:"newBoardVersion",title:"Normal party board"},"Normal")),React.createElement(e,{id:PP64.types.BoardType.DUEL,allowDeselect:!1,onToggled:this.onTypeChange,pressed:this.props.type===PP64.types.BoardType.DUEL},React.createElement("span",{className:"newBoardVersion",title:"Duel board"},"Duel")))}}]),s}(),a=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(r)))).state={theme:0},n.onThemeChange=function(e,t){n.setState({theme:e}),n.props.onThemeChange(e)},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var a=this,r=PP64.controls.ToggleButton,e=c.map(function(e,t){var n="img/themes/"+e.id+"/preview.png";return React.createElement(r,{id:t,key:t,allowDeselect:!1,css:"nbTheme",onToggled:a.onThemeChange,pressed:a.state.theme===t},React.createElement("img",{src:n,className:"newBoardThemePreview",width:"96",height:"72"}),React.createElement("span",{className:"newBoardTheme"},React.createElement("span",{className:"newBoardThemeInner"},e.name)))});return React.createElement("div",{className:"NewBoardThemeSelect"},React.createElement("label",{className:"nbLabel"},"Theme"),React.createElement("br",null),e)}}]),s}();return{NewBoard:e}}();
"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.screenshot=function(){var e=function(e){function c(){var e,t,n;_classCallCheck(this,c);for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];return(t=n=_possibleConstructorReturn(this,(e=c.__proto__||Object.getPrototypeOf(c)).call.apply(e,[this].concat(a)))).state={renderConnections:!0,renderCharacters:!0,renderHiddenSpaces:!0,renderBadges:!0},n.takeScreenshot=function(){var e=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=PP64.boards.getCurrentBoard(),n=PP64.utils.canvas.createContext(t.bg.width,t.bg.height),r=PP64.renderer.external.getBGImage();n.drawImage(r,0,0,t.bg.width,t.bg.height);var a=$$debug;return $$debug=!1,e.renderConnections&&PP64.renderer.external.renderConnections(n.canvas,n,t,!1),PP64.renderer.external.renderSpaces(n.canvas,n,t,!1,{skipCharacters:!e.renderCharacters,skipHiddenSpaces:!e.renderHiddenSpaces,skipBadges:!e.renderBadges}),$$debug=a,n.canvas.toDataURL()}({renderConnections:n.state.renderConnections,renderCharacters:n.state.renderCharacters,renderHiddenSpaces:n.state.renderHiddenSpaces,renderBadges:n.state.renderBadges});n.props.onAccept&&n.props.onAccept(e)},n.onCheckChanged=function(e){var t={};t[e]=!n.state[e],n.setState(t)},_possibleConstructorReturn(n,t)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var e=PP64.controls.Button;return React.createElement("div",{className:"screenshotContainer"},React.createElement("label",{className:"nbLabel"},"Screenshot Options"),React.createElement("br",null),React.createElement(t,{id:"renderConnections",text:"Render connections",checked:this.state.renderConnections,onChange:this.onCheckChanged}),React.createElement(t,{id:"renderCharacters",text:"Render characters",checked:this.state.renderCharacters,onChange:this.onCheckChanged}),React.createElement(t,{id:"renderHiddenSpaces",text:"Render hidden spaces",checked:this.state.renderHiddenSpaces,onChange:this.onCheckChanged}),React.createElement(t,{id:"renderBadges",text:"Render badges",checked:this.state.renderBadges,onChange:this.onCheckChanged}),React.createElement("br",null),React.createElement(e,{onClick:this.takeScreenshot,css:"ssCreate"},"Take Screenshot"))}}]),c}(),t=function(e){function c(){var e,t,n;_classCallCheck(this,c);for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];return(t=n=_possibleConstructorReturn(this,(e=c.__proto__||Object.getPrototypeOf(c)).call.apply(e,[this].concat(a)))).state={},n.onChange=function(){n.props.onChange(n.props.id)},_possibleConstructorReturn(n,t)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var e="ssCheck";return this.props.css&&(e+=" "+this.props.css),React.createElement("label",{className:e,title:""},React.createElement("input",{type:"checkbox",onChange:this.onChange,checked:this.props.checked}),this.props.text)}}]),c}();return{Screenshot:e}}();
"use strict";var _createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.header=function(){var r=[{name:"Load ROM",icon:"img/header/romcart.png",type:$actType.ROM_LOAD,details:"Load a ROM image and read its boards"},{name:"New board",icon:"img/header/newboard.png",type:$actType.BOARD_NEW,details:"Create a new board",dropdownFn:t},{name:"Import board",icon:"img/header/loadboard.png",type:$actType.BOARD_LOAD,details:"Import a board file into the editor"},{name:"Export board",icon:"img/header/saveboard.png",type:$actType.BOARD_SAVE,details:"Export a board file for distribution"},{name:"Screenshot",icon:"img/header/screenshot.png",type:$actType.SCREENSHOT,details:"Take a screenshot of the current board",dropdownFn:a},{name:"Events",icon:"img/header/events.png",type:$actType.EVENTS,details:"View and manage events",advanced:!0},{name:"Settings",icon:"img/header/settings.png",type:$actType.SETTINGS,details:"Editor settings"},{name:"About",icon:"img/header/about.png",type:$actType.ABOUT,details:"About PartyPlanner64"}],o=[{name:"Close ROM",icon:"img/header/romclose.png",type:$actType.ROM_UNLOAD,details:"Close the ROM file and remove its boards"},{name:"Save ROM",icon:"img/header/romsave.png",type:$actType.ROM_SAVE,details:"Save changes out to a ROM file"},{name:"New board",icon:"img/header/newboard.png",type:$actType.BOARD_NEW,details:"Create a new board",dropdownFn:t},{name:"Import board",icon:"img/header/loadboard.png",type:$actType.BOARD_LOAD,details:"Import a board file into the editor"},{name:"Export board",icon:"img/header/saveboard.png",type:$actType.BOARD_SAVE,details:"Export a board file for distribution"},{name:"Import file dump",icon:"img/header/dump.png",type:$actType.DUMP_LOAD,details:"Import and overwrite with a dump of ROM data",advanced:!0},{name:"Export file dump",icon:"img/header/dump.png",type:$actType.DUMP_SAVE,details:"Export a zip of all the ROM file data",advanced:!0},{name:"Screenshot",icon:"img/header/screenshot.png",type:$actType.SCREENSHOT,details:"Take a screenshot of the current board",dropdownFn:a},{name:"Events",icon:"img/header/events.png",type:$actType.EVENTS,details:"View and manage events",advanced:!0},{name:"Patches",icon:"img/header/rompatch.png",type:$actType.PATCHES,details:"Apply patches to the ROM",advanced:!0},{name:"Model Viewer",icon:"img/header/modelviewer.png",type:$actType.MODEL_VIEWER,details:"View 3D model data in the ROM"},{name:"Settings",icon:"img/header/settings.png",type:$actType.SETTINGS,details:"Editor settings"},{name:"About",icon:"img/header/about.png",type:$actType.ABOUT,details:"About PartyPlanner64"}],i=[{name:"Close ROM",icon:"img/header/romclose.png",type:$actType.ROM_UNLOAD,details:"Close the ROM file and remove its boards"},{name:"Save ROM",icon:"img/header/romsave.png",type:$actType.ROM_SAVE,details:"Save changes out to a ROM file"},{name:"Overwrite",icon:"img/header/romoverwrite.png",type:$actType.BOARD_WRITE,details:"Overwrite a ROM board with the current board",dropdownFn:function(a,e){var t=PP64.validation.validateCurrentBoardForOverwrite();return t?t.map(function(e,t){return React.createElement(n,{name:e.name,errors:e.errors,warnings:e.warnings,unavailable:e.unavailable,closeCallback:a,key:t,boardIndex:t})}):null}},{name:"New board",icon:"img/header/newboard.png",type:$actType.BOARD_NEW,details:"Create a new board",dropdownFn:t},{name:"Import board",icon:"img/header/loadboard.png",type:$actType.BOARD_LOAD,details:"Import a board file into the editor"},{name:"Export board",icon:"img/header/saveboard.png",type:$actType.BOARD_SAVE,details:"Export a board file for distribution"},{name:"Import file dump",icon:"img/header/dump.png",type:$actType.DUMP_LOAD,details:"Import and overwrite with a dump of ROM data",advanced:!0},{name:"Export file dump",icon:"img/header/dump.png",type:$actType.DUMP_SAVE,details:"Export a zip of all the ROM file data",advanced:!0},{name:"Screenshot",icon:"img/header/screenshot.png",type:$actType.SCREENSHOT,details:"Take a screenshot of the current board",dropdownFn:a},{name:"Events",icon:"img/header/events.png",type:$actType.EVENTS,details:"View and manage events",advanced:!0},{name:"Patches",icon:"img/header/rompatch.png",type:$actType.PATCHES,details:"Apply patches to the ROM",advanced:!0},{name:"Model Viewer",icon:"img/header/modelviewer.png",type:$actType.MODEL_VIEWER,details:"View 3D model data in the ROM"},{name:"Settings",icon:"img/header/settings.png",type:$actType.SETTINGS,details:"Editor settings"},{name:"About",icon:"img/header/about.png",type:$actType.ABOUT,details:"About PartyPlanner64"}],s=[{name:"Back to editor",icon:"img/header/back.png",type:$actType.BOARD_EDITOR,details:"Return to the board editor"}],c=s.concat([{name:"Create Event",icon:"img/header/add.png",type:$actType.CREATEEVENT,details:"Create your own event code"},{name:"Import Event",icon:"img/header/eventload.png",type:$actType.EVENT_LOAD,details:"Load event code from a file"}]),d=[{name:"Back to event list",icon:"img/header/back.png",type:$actType.BACK_TO_EVENTS,details:"Return to the event list"},{name:"Save",icon:"img/header/save.png",type:$actType.SAVE_EVENT,details:"Save the event"}],l={name:"",type:"MORE",details:"More options"};function p(e){var t=e.target.files[0];if(t){PP64.app.blockUI(!0);var a=new FileReader;a.onload=function(e){if(e.target.result){var t=PP64.romhandler.setROMBuffer(e.target.result);t&&t.then(function(e){PP64.app.romLoadedChanged(),PP64.boards.loadBoardsFromROM(),PP64.app.blockUI(!1),$$log("ROM loaded")},function(e){$$log("Error loading ROM: "+e),PP64.app.showMessage("Error loading the ROM file.")})}else PP64.app.blockUI(!1)},a.readAsArrayBuffer(t)}}function u(e){var t=e.target.files[0];if(t){var a=new FileReader;a.onload=function(e){var t=void 0;try{t=JSON.parse(e.target.result)}catch(e){return void alert("Board could not be parsed.")}var a=PP64.boards.addBoard(t);PP64.boards.setCurrentBoard(a)},a.readAsText(t)}}function m(e){var t=e.target.files[0];if(t){var a=new FileReader;a.onload=function(e){PP64.boards.setBG(a.result),PP64.renderer.render()},a.readAsDataURL(t)}}function h(e){var t=e.target&&e.target.files;if(t&&t[0])for(var a=0;a<t.length;a++){var n=new FileReader;n.onload=function(e){try{var t=e.target.result;PP64.adapters.events.createCustomEvent(t),PP64.events.refreshEventsView()}catch(e){return void PP64.app.showMessage("Event file load failed. "+e.toString())}},n.readAsText(t[a])}}function v(e){var t=e.target.files[0];if(t){var a=new FileReader;a.onload=function(e){PP64.utils.dump.load(a.result)},a.readAsArrayBuffer(t)}}function g(e){saveAs(e,"mp"+PP64.romhandler.getGameVersion()+"-files.zip"),PP64.app.blockUI(!1)}function y(e,t,a){var n=void 0;return n=e!==$viewType.EDITOR?e===$viewType.EVENTS?c:e===$viewType.CREATEEVENT?d:s:a?PP64.boards.boardIsROM(t)?o:i:r,PP64.settings.get($setting.uiAdvanced)||(n=n.filter(function(e){return!e.advanced})),n}var e=function(e){function n(e){_classCallCheck(this,n);var a=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));a.componentWillReceiveProps=function(e){var t=y(e.view,e.board,e.romLoaded);PP64.utils.arrays.equal(a.state.totalActions,t)||a.setState({actions:t,totalActions:t,overflow:[]})};var t=y(e.view,e.board,e.romLoaded);return a.state={actions:t,totalActions:t,overflow:[]},a}return _inherits(n,React.Component),_createClass(n,[{key:"refresh",value:function(){var e=y(this.props.view,this.props.board,this.props.romLoaded);this.setState({actions:e,totalActions:e,overflow:[]})}},{key:"render",value:function(){var t=this,e=this.state.actions,a=0,n=e.map(function(e){return e.dropdownFn?React.createElement(P,{key:e.type,action:e,fn:e.dropdownFn,index:a++}):React.createElement(b,{key:e.type,action:e,index:a++})}),r=void 0;return this.state.overflow.length&&(r=React.createElement(P,{key:l.type,action:l,overflow:this.state.overflow,fn:E,index:a++})),React.createElement("div",{className:"header",role:"toolbar"},React.createElement(f,null),React.createElement("div",{className:"headerActions",ref:function(e){t.actionsEl=e}},n,r))}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.refresh.bind(this),!1),setTimeout(function(){window.requestAnimationFrame(e.handleOverflow.bind(e))},0)}},{key:"componentDidUpdate",value:function(){var e=this;setTimeout(function(){window.requestAnimationFrame(e.handleOverflow.bind(e))},0)}},{key:"componentWillUnmount",value:function(){$$log("Why did Header unmount?")}},{key:"handleOverflow",value:function(){for(var e=this.state.actions.slice(),t=this.state.overflow.length,a=this.state.overflow.slice(),n=ReactDOM.findDOMNode(this),r=this.actionsEl;r.offsetWidth>n.offsetWidth-215-(t?0:80);){var o=r.children[e.length-(t?2:1)];if(!o)break;o.style.display="none",a.unshift(e.pop())}for(var i=0;i<r.children.length-(t?2:1);i++){r.children[i].style.display=""}e.length===this.state.actions.length&&a.length===this.state.overflow.length||this.setState({actions:e,overflow:a})}}]),n}(),f=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement("a",{href:"."},React.createElement("img",{className:"headerLogo",src:"img/header/logo.png",alt:"PartyPlanner64 Logo"}))}}]),t}(),b=function(e){function i(){var e,t,a;_classCallCheck(this,i);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(r)))).handleClick=function(){!function(e){switch(e){case $actType.ROM_LOAD:PP64.utils.input.openFile(".z64,.v64,.rom,.n64",p);break;case $actType.ROM_UNLOAD:PP64.romhandler.clear(),PP64.boards.clearBoardsFromROM(),PP64.app.boardsChanged(),PP64.boards.setCurrentBoard(0),PP64.app.romLoadedChanged();break;case $actType.ROM_SAVE:PP64.app.blockUI(!0),setTimeout(function(){PP64.romhandler.saveROM(),PP64.app.blockUI(!1),setTimeout(function(){PP64.app.showMessageHTML('Before trying the game, review\n              <a href="https://github.com/PartyPlanner64/PartyPlanner64/wiki/Emulator-Setup" target="_blank">emulator setup instructions</a>.')},0)},0);break;case $actType.BOARD_LOAD:PP64.utils.input.openFile(".json",u);break;case $actType.BOARD_SAVE:var t=PP64.boards.getCurrentBoard(!0),a=new Blob([JSON.stringify(t)]);saveAs(a,t.name+".json");break;case $actType.BOARD_COPY:PP64.boards.copyCurrentBoard();break;case $actType.BOARD_DETAILS:PP64.app.changeView($viewType.DETAILS);break;case $actType.BOARD_EDITOR:PP64.app.changeView($viewType.EDITOR);break;case $actType.SETTINGS:PP64.app.changeView($viewType.SETTINGS);break;case $actType.ABOUT:PP64.app.changeView($viewType.ABOUT);break;case $actType.MODEL_VIEWER:PP64.app.changeView($viewType.MODELS);break;case $actType.EVENTS:PP64.app.changeView($viewType.EVENTS);break;case $actType.BACK_TO_EVENTS:PP64.events.createEventPromptExit()&&(PP64.app.changeCurrentEvent(null),PP64.app.changeView($viewType.EVENTS));break;case $actType.EVENT_LOAD:PP64.utils.input.openFile(".s",h);break;case $actType.SAVE_EVENT:PP64.events.saveEvent();break;case $actType.CREATEEVENT:PP64.app.changeView($viewType.CREATEEVENT);break;case $actType.STRINGS_EDITOR:PP64.app.changeView($viewType.STRINGS);break;case $actType.PATCHES:PP64.app.changeView($viewType.PATCHES);break;case $actType.SET_BG:PP64.utils.input.openFile("image/*",m);break;case $actType.DUMP_LOAD:PP64.utils.input.openFile(".zip",v);break;case $actType.DUMP_SAVE:PP64.app.blockUI(!0),PP64.utils.dump.create(g)}}(a.props.action.type)},_possibleConstructorReturn(a,t)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){var e=void 0;return this.props.action.icon&&(e=React.createElement("img",{className:"headerButtonIcon",src:this.props.action.icon})),React.createElement("div",{className:"headerButton",title:this.props.action.details,role:"button",tabIndex:"0",onClick:this.handleClick,onKeyDown:PP64.utils.react.makeKeyClick(this.handleClick,this)},e,React.createElement("span",{className:"headerButtonText"},this.props.action.name))}}]),i}(),P=function(e){function i(){var e,t,a;_classCallCheck(this,i);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(r)))).state={opened:!1},a.globalClickHandler=function(e){a.elementIsWithin(e.target)||a.close()},a.onButtonClick=function(e){a.state.opened&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),a.setState({opened:!a.state.opened})},a.onDropdownClick=function(e){e.stopPropagation()},a.close=function(){a.state.opened&&a.setState({opened:!1})},_possibleConstructorReturn(a,t)}return _inherits(i,React.Component),_createClass(i,[{key:"addGlobalHandler",value:function(){document.addEventListener("click",this.globalClickHandler)}},{key:"removeGlobalHandler",value:function(){document.removeEventListener("click",this.globalClickHandler)}},{key:"elementIsWithin",value:function(e){return!this.refs||!this.refs.dropdown||this.refs.dropdown.contains(e)}},{key:"componentDidMount",value:function(){this.addGlobalHandler(),window.addEventListener("resize",this.close,!1)}},{key:"componentWillUnmount",value:function(){this.removeGlobalHandler(),window.removeEventListener("resize",this.close)}},{key:"render",value:function(){var e="headerButton",t=null;if(this.state.opened){e+=" headerButtonExpanded";var a=this.props.fn(this.close,this.props);t=React.createElement("div",{className:"headerDropdown",onClick:this.onDropdownClick},a)}var n=void 0;return this.props.action.icon&&(n=React.createElement("img",{className:"headerButtonIcon",src:this.props.action.icon})),React.createElement("div",{className:e,title:this.props.action.details,ref:"dropdown",onClick:this.onButtonClick,tabIndex:"0",role:"button","aria-haspopup":"true"},n,React.createElement("span",{className:"headerButtonText"},this.props.action.name),React.createElement("div",{className:"headerDropdownArrow"},"‚ñæ"),t)}}]),i}();var n=function(e){function i(){var e,t,n;_classCallCheck(this,i);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(r)))).boardClicked=function(e){if(e.target&&"A"===e.target.tagName.toUpperCase())e.stopPropagation();else if(!n.hasErrors()&&!n.props.unavailable){n.props.closeCallback();var t=PP64.adapters.getROMAdapter();if(!t)return;PP64.app.blockUI(!0);var a=PP64.boards.getCurrentBoard();t.overwriteBoard(n.props.boardIndex,a).then(function(e){$$log("Board overwritten"),PP64.boards.clearBoardsFromROM(),PP64.boards.loadBoardsFromROM();var t=PP64.boards.indexOf(a);t<0&&(t=0),PP64.boards.setCurrentBoard(t),PP64.utils.analytics.recordEvent("board_write",{event_category:"action",event_label:a.name}),PP64.app.blockUI(!1)},function(e){$$log("Error overriding board: "+e),PP64.app.showMessage("Error overwriting the board.")})}},_possibleConstructorReturn(n,t)}return _inherits(i,React.Component),_createClass(i,[{key:"hasErrors",value:function(){return!!this.props.errors.length}},{key:"hasWarnings",value:function(){return!!this.props.warnings.length}},{key:"render",value:function(){var e="overwriteBoardEntry",t="Overwrite "+this.props.name+" with the current board.",a=[];return this.props.unavailable?(e+=" unavailable",a.push(React.createElement("div",{className:"overwriteBoardMessage",key:"unavailable"},"Board cannot be overwritten currently."))):(this.hasErrors()&&(e+=" failed",a=a.concat(this.props.errors.map(function(e,t){return React.createElement("div",{className:"overwriteBoardMessage",key:t+"e"},React.createElement("img",{src:"img/header/boarderror.png",alt:"",className:"overwriteBoardIssueIcon"}),React.createElement("span",{dangerouslySetInnerHTML:{__html:e}}))}))),this.hasWarnings()&&(a=a.concat(this.props.warnings.map(function(e,t){return React.createElement("div",{className:"overwriteBoardMessage",key:t+"w"},React.createElement("img",{src:"img/header/boardwarning.png",alt:"",className:"overwriteBoardIssueIcon"}),React.createElement("span",{dangerouslySetInnerHTML:{__html:e}}))})))),a.length?(t="Issues with the current board.",React.createElement("div",{className:e,onClick:this.boardClicked,title:t},React.createElement("span",{className:"overwriteBoardName"},this.props.name),React.createElement("br",null),a)):React.createElement("div",{className:e,onClick:this.boardClicked,title:t},React.createElement("span",{className:"overwriteBoardName"},this.props.name))}}]),i}();function E(e,t){var a=t.overflow;return a.length?a.map(function(e){return e.dropdownFn?React.createElement(P,{key:e.type,action:e,fn:e.dropdownFn}):React.createElement(b,{key:e.type,action:e})}):null}function t(r,e){return React.createElement(PP64.newboard.NewBoard,{onAccept:function(e,t,a){r();var n=PP64.boards.addBoard(null,{game:e,type:t});PP64.boards.setCurrentBoard(n)}})}function a(n,e){return React.createElement(PP64.screenshot.Screenshot,{onAccept:function(e){var t=window.open();if(t){var a=t.document;a?(a.write(""),a.close(),a.body.appendChild(a.createElement("img")).src=e):t.eval&&t.eval("document.write(''); document.close(); document.body.appendChild(document.createElement('img')).src = \""+e+'";')}n()}})}return{Header:e}}();
"use strict";var _slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var c,a=t[Symbol.iterator]();!(n=(c=a.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_createClass=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.texteditor=function(){var t=Draft,i=t.Editor,d=t.EditorState,o=t.ContentState,m=t.SelectionState,g=t.Modifier,s=t.RichUtils,e=(t.Entity,t.CompositeDecorator),r=function(t){function o(t){_classCallCheck(this,o);var e=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));c.call(e);var r=void 0;r=t.value?E.stringToEditorState(t.value):d.createEmpty();var n=t.theme;return"number"!=typeof t.theme&&(n=t.value&&0<=t.value.indexOf("WHITE")?x.Dark:x.Light),e.state={editorState:r,theme:n},e}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var t=this.state.editorState,e=this.props.displayMode||v.Edit,r=void 0;this.props.showToolbar&&e===v.Edit&&(r=React.createElement(p,{onItemClick:this.onToolbarClick,itemBlacklist:this.props.itemBlacklist}));var n=this.props.toolbarPlacement||b.Top,o="mpEditor";return e===v.Display&&(o+=" mpDisplay"),this.state.theme===x.Light&&(o+=" mpEditorLight"),this.state.theme===x.Dark&&(o+=" mpEditorDark"),r&&(n===b.Bottom?o+=" mpEditorShowToolbarBottom":o+=" mpEditorShowToolbarTop"),React.createElement("div",{className:o},n===b.Top&&r,React.createElement("div",{className:"mpEditorWrapper"},React.createElement(i,{ref:"editor",editorState:t,stripPastedStyles:!0,readOnly:e!==v.Edit,customStyleMap:y,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,handleReturn:this.handleReturn})),n===b.Bottom&&r)}}]),o}(),c=function(){var a=this;this.componentWillReceiveProps=function(t){if(E.editorStateToString(a.state.editorState,{theme:a.state.theme})!==t.value){var e=E.stringToEditorState(t.value);a.setState({editorState:e})}},this.focus=function(){a.refs.editor.focus()},this.onChange=function(t){a.setState({editorState:t}),a.setState(function(t,e){e.onValueChange&&e.onValueChange(e.id,E.editorStateToString(t.editorState,{theme:t.theme}))})},this.handleReturn=function(t,e){if(a.props.maxlines&&e.getCurrentContent().getPlainText().split("\n").length>=a.props.maxlines)return"handled";return"not-handled"},this.onFocus=function(t){a.props.onFocus&&a.props.onFocus(t)},this.onBlur=function(t){a.props.onBlur&&a.props.onBlur(t)},this.onToolbarClick=function(t){switch(t.type){case"COLOR":a.toggleColor(t.key);break;case"IMAGE":a.addImage(t.char);break;case"ACTION":switch(t.key){case"DARKLIGHT":var e=a.state.theme===x.Light?x.Dark:x.Light;a.setState({theme:e})}}setTimeout(function(){a.focus()},0)},this.toggleColor=function(t){var e=a.state.editorState,r=e.getSelection(),n=e.getCurrentContent(),o=Object.keys(y).reduce(function(t,e){return g.removeInlineStyle(t,r,e)},n),i=d.push(e,o,"change-inline-style"),c=e.getCurrentInlineStyle();r.isCollapsed()&&(i=c.reduce(function(t,e){return s.toggleInlineStyle(t,e)},i)),c.has(t)||(i=s.toggleInlineStyle(i,t)),a.onChange(i)},this.addImage=function(t){var e=a.state.editorState,r=e.getSelection(),n=g.replaceText(e.getCurrentContent(),r,t),o=d.push(e,n,"insert-characters");a.onChange(o)}};var f=new e([{strategy:function(t,e){for(var r=t.getText(),n=0;n<r.length;n++)a[r.charAt(n)]&&e(n,n+1)},component:function(t){var e=t.children[0].props.text,r="mpImage";return r+=" mpImageKey-"+a[e],React.createElement("span",_extends({},t,{className:r}),React.createElement("span",{className:"mpImageTextWrapper"},t.children))}}]),y={DEFAULT:{color:"#200E71"},BLACK:{color:"#000000"},WHITE:{color:"#FFFFFF"},RED:{color:"#E70014"},GREEN:{color:"#00AB29"},BLUE:{color:"#003EF9"},PURPLE:{color:"#E847CD"},YELLOW:{color:"#FFEA38"}},n=[{key:"COLOR",type:"SUBMENU",icon:"img/richtext/default.png",desc:"Font color",items:[{key:"DEFAULT",type:"COLOR",icon:"img/richtext/default.png",desc:"Default"},{key:"BLACK",type:"COLOR",icon:"img/richtext/black.png",desc:"Black"},{key:"WHITE",type:"COLOR",icon:"img/richtext/white.png",desc:"White"},{key:"RED",type:"COLOR",icon:"img/richtext/red.png",desc:"Red"},{key:"GREEN",type:"COLOR",icon:"img/richtext/green.png",desc:"Green"},{key:"BLUE",type:"COLOR",icon:"img/richtext/blue.png",desc:"Blue"},{key:"PURPLE",type:"COLOR",icon:"img/richtext/purple.png",desc:"Purple"},{key:"YELLOW",type:"COLOR",icon:"img/richtext/yellow.png",desc:"Yellow"}]},{key:"IMAGE",type:"SUBMENU",icon:"img/richtext/A.png",desc:"Insert image",items:[{key:"A",type:"IMAGE",icon:"img/richtext/A.png",desc:"A button",char:"„ÄÄ"},{key:"B",type:"IMAGE",icon:"img/richtext/B.png",desc:"B button",char:"„ÄÅ"},{key:"S",type:"IMAGE",icon:"img/richtext/S.png",desc:"Start button",char:"„Äê"},{key:"CUP",type:"IMAGE",icon:"img/richtext/Cup.png",desc:"C-up button",char:"„ÄÇ"},{key:"CDOWN",type:"IMAGE",icon:"img/richtext/Cdown.png",desc:"C-down button",char:"„ÄÖ"},{key:"CLEFT",type:"IMAGE",icon:"img/richtext/Cleft.png",desc:"C-left button",char:"„ÄÑ"},{key:"CRIGHT",type:"IMAGE",icon:"img/richtext/Cright.png",desc:"C-right button",char:"„ÄÉ"},{key:"Z",type:"IMAGE",icon:"img/richtext/Z.png",desc:"Z button",char:"„ÄÜ"},{key:"R",type:"IMAGE",icon:"img/richtext/R.png",desc:"R button",char:"„Äë"},{key:"ANALOG",type:"IMAGE",icon:"img/richtext/analog.png",desc:"Analog stick",char:"„Äá"},{key:"COIN",type:"IMAGE",icon:"img/richtext/coin.png",desc:"Coin",char:"„Äà"},{key:"STAR",type:"IMAGE",icon:"img/richtext/star.png",desc:"Star",char:"„Äâ"}]},{key:"ADVANCED",type:"SUBMENU",icon:"img/richtext/pause.png",desc:"Advanced text features",items:[{key:"PAUSE",type:"IMAGE",icon:"img/richtext/pause.png",desc:"Pause to continue",char:"„Äï"},{key:"FEED",type:"IMAGE",icon:"img/richtext/feed.png",desc:"Feed new page",char:"„Äî"}]},{key:"DARKLIGHT",type:"ACTION",icon:"img/richtext/darklight.png",desc:"Toggle background color (has no effect on actual game)"}],a={},l={};function u(t,e){switch(t.type){case"SUBMENU":return React.createElement(h,{key:t.key,item:t,onItemClick:e,items:t.items});default:return React.createElement(C,{key:t.key,item:t,onItemClick:e})}}n.forEach(function t(e){e.items&&e.items.forEach(t);e.char&&(a[e.char]=e.key,l[e.key]=e.char)});var p=function(t){function c(){var t,e,r;_classCallCheck(this,c);for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=r=_possibleConstructorReturn(this,(t=c.__proto__||Object.getPrototypeOf(c)).call.apply(t,[this].concat(o)))).state={},r.onItemClick=function(t){r.props.onItemClick&&r.props.onItemClick(t)},_possibleConstructorReturn(r,e)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var e=this,r=this.props.itemBlacklist,t=n.map(function(t){return r&&-1!==r.indexOf(t.key)?null:u(t,e.onItemClick)});return React.createElement("div",{className:"mpEditorToolbar"},t)}}]),c}(),h=function(t){function c(){var t,e,r;_classCallCheck(this,c);for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=r=_possibleConstructorReturn(this,(t=c.__proto__||Object.getPrototypeOf(c)).call.apply(t,[this].concat(o)))).state={expanded:!1},r.onBlur=function(){r.setState({expanded:!1})},r.onClick=function(){r.setState({expanded:!r.state.expanded})},r.onItemClick=function(t){r.props.onItemClick&&r.props.onItemClick(t)},_possibleConstructorReturn(r,e)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var e=this,t=this.props.item,r=void 0;if(this.state.expanded){var n=this.props.items.map(function(t){return u(t,e.onItemClick)});r=React.createElement("div",{ref:function(t){e.expMenu=t},className:"mpEditorToolbarSubmenuExp",tabIndex:-1,onBlur:this.onBlur},n)}return React.createElement("div",{className:"mpEditorToolbarButton",title:t.desc,onClick:this.onClick},React.createElement("img",{src:t.icon,alt:t.desc}),React.createElement("img",{src:"img/richtext/divot.png"}),r)}},{key:"componentDidMount",value:function(){this.state.expanded&&this.expMenu.focus()}},{key:"componentDidUpdate",value:function(){this.state.expanded&&this.expMenu.focus()}}]),c}(),C=function(t){function c(){var t,e,r;_classCallCheck(this,c);for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=r=_possibleConstructorReturn(this,(t=c.__proto__||Object.getPrototypeOf(c)).call.apply(t,[this].concat(o)))).state={},r.onClick=function(){r.props.onItemClick(r.props.item)},_possibleConstructorReturn(r,e)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this.props.item;return React.createElement("div",{className:"mpEditorToolbarButton",title:t.desc,onClick:this.onClick},React.createElement("img",{src:t.icon,alt:t.desc}))}}]),c}(),E=(function(t){function c(){var t,e,r;_classCallCheck(this,c);for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=r=_possibleConstructorReturn(this,(t=c.__proto__||Object.getPrototypeOf(c)).call.apply(t,[this].concat(o)))).state={},_possibleConstructorReturn(r,e)}_inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){return React.createElement("div",{className:"mpEditorToolbarSeparator"})}}])}(),new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"editorStateToString",value:function(t,e){var r=t.getCurrentContent(),s=[],l=e.theme===x.Light?"DEFAULT":"WHITE",n=r.getBlockMap(),u=-1;return n.forEach(function(t){u++;var r=void 0,n=void 0,o={};t.findStyleRanges(function(t){var e=t.getStyle().find(function(t){return!!y[t]});return e?n=!1:(n=!0,e=l),r=e,!0},function(t,e){n&&0===t&&0===u||(o[t]="<"+r+">")});var e=0,i=t.getText();for(var c in o){var a=e+parseInt(c);i=PP64.utils.string.splice(i,a,0,o[c]),e+=o[c].length}s.push(i)}),s.join("\n")}},{key:"stringToEditorState",value:function(t){for(var i=o.createFromText(t||""),c=i.getBlocksAsArray(),a=0;a<c.length;a++)for(var s=c[a],l=s.getText(),e=k(l),r=_slicedToArray(e,3),u=r[0],p=r[1],h=r[2],n=function(){var t=s.getKey(),r=m.createEmpty(s.getKey());r=r.merge({anchorOffset:p,focusKey:t,focusOffset:h}),i=g.replaceText(i,r,""),c=i.getBlocksAsArray(),s=c[a],l=s.getText();var e=c[c.length-1];r=r.merge({focusKey:e.getKey(),focusOffset:e.getText().length}),i=Object.keys(y).reduce(function(t,e){return g.removeInlineStyle(t,r,e)},i),i=g.applyInlineStyle(i,r,u),c=i.getBlocksAsArray(),s=c[a];var n=k(l=s.getText()),o=_slicedToArray(n,3);u=o[0],p=o[1],h=o[2]};u;)n();return d.createWithContent(i,f)}}]),t}()));function k(t){for(var e=0;e<t.length;){var r=t.indexOf("<",e)+1;if(!r)return[];var n=t.indexOf(">",r);if(-1===n)return[];var o=t.substring(r,n);if(y[o])return[o,r-1,n+1];e=r}return[]}var v={Edit:0,Readonly:1,Display:2},b={Top:0,Bottom:1},x={Light:0,Dark:1};return{MPEditor:r,MPCompositeDecorator:f,MPEditorStringAdapter:E,MPEditorDisplayMode:v,MPEditorToolbarPlacement:b}}();
"use strict";var _createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.toolwindow=function(){var t=function(t){function a(){var t,e,i;_classCallCheck(this,a);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=i=_possibleConstructorReturn(this,(t=a.__proto__||Object.getPrototypeOf(a)).call.apply(t,[this].concat(o)))).state={left:-1e3,top:-1e3,manuallyPlaced:!1},i.mouseDown=function(t){u=i;var e=[t.clientX,t.clientY];r=e[0],l=e[1];var n=i.getContainerEl();n.addEventListener("mousemove",c),n.addEventListener("mouseup",f),n.addEventListener("mouseleave",f),n.classList.add("moving")},i.onWindowResize=function(){i.updatePositionState()},_possibleConstructorReturn(i,e)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){if(!this.props.visible)return null;var t={left:this.state.left,top:this.state.top};return React.createElement("div",{className:"toolWindow",style:t},React.createElement("div",{className:"toolWindowName",onMouseDown:this.mouseDown},this.props.name),this.props.children)}},{key:"componentDidMount",value:function(){this.props.visible&&this.updatePositionState(),window.addEventListener("resize",this.onWindowResize),this.attachMutationObserver()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize),this.detachMutationObserver()}},{key:"componentDidUpdate",value:function(){this.props.visible&&this.updatePositionState(),this.detachMutationObserver(),this.attachMutationObserver()}},{key:"shouldComponentUpdate",value:function(t,e,n){return!this.tryUpdatePosition(e)}},{key:"attachMutationObserver",value:function(){var t=ReactDOM.findDOMNode(this);if(t&&window.MutationObserver){var e=new MutationObserver(function(t){this.updatePositionState()}.bind(this));e.observe(t,{childList:!0,subtree:!0}),n[this.props.name]=e}}},{key:"detachMutationObserver",value:function(){n[this.props.name]&&(n[this.props.name].disconnect(),n[this.props.name]=null)}},{key:"tryUpdatePosition",value:function(t){var e=this.state.left!==t.left||this.state.top!==t.top;return e&&this.updatePosition(t),e}},{key:"updatePosition",value:function(t){t=t||this.state;var e=ReactDOM.findDOMNode(this);e&&(e.style.left=t.left+"px",e.style.top=t.top+"px")}},{key:"tryUpdatePositionState",value:function(t){var e=this.state.left!==t.left||this.state.top!==t.top;return e&&this.setState(t),e}},{key:"updatePositionState",value:function(){if(this.state.manuallyPlaced){var t=p(this,{left:this.state.left,top:this.state.top});this.tryUpdatePositionState(t)}else{var e={},n=this.props.position;-1!==n.indexOf("Left")&&(e.left=0),-1!==n.indexOf("Right")&&(e.left=this.getContainerWidth()-this.getWidth()),-1!==n.indexOf("Top")&&(e.top=0),-1!==n.indexOf("Bottom")&&(e.top=this.getContainerHeight()-this.getHeight()),this.tryUpdatePositionState(e)}}},{key:"getWidth",value:function(){var t=ReactDOM.findDOMNode(this);return t&&t.offsetWidth||0}},{key:"getHeight",value:function(){var t=ReactDOM.findDOMNode(this);return t&&t.offsetHeight||0}},{key:"getContainerWidth",value:function(){var t=this.getContainerEl();return t&&t.offsetWidth||0}},{key:"getContainerHeight",value:function(){var t=this.getContainerEl();return t&&t.offsetHeight||0}},{key:"getContainerEl",value:function(){var t=ReactDOM.findDOMNode(this);return t&&t.offsetParent||null}}]),a}(),r=null,l=null,u=null,n={};function c(t){var e=[t.clientX,t.clientY],n=e[0],i=e[1],o=n-r,s=i-l,a={left:u.state.left+o,top:u.state.top+s,manuallyPlaced:!0};a=p(u,a),u.setState(a),r=n,l=i}function f(t){var e=u.getContainerEl();"mouseleave"===t.type&&t.target!==e||(e.removeEventListener("mousemove",c),e.removeEventListener("mouseup",f),e.removeEventListener("mouseleave",f),e.classList.remove("moving"),r=l=u=null)}function p(t,e){if(e.left<0)e.left=0;else{var n=t.getContainerWidth()-t.getWidth();e.left>n&&(e.left=n)}if(e.top<0)e.top=0;else{var i=t.getContainerHeight()-t.getHeight();e.top>i&&(e.top=i)}return e}return{ToolWindow:t}}();
"use strict";var _createClass=function(){function n(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,a,t){return a&&n(e.prototype,a),t&&n(e,t),e}}();function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}PP64.toolbar=function(){var o=[{name:"Move spaces",icon:"img/toolbar/move.png",type:$actType.MOVE},{name:"Connect spaces",icon:"img/toolbar/line.png",type:$actType.LINE},{name:"Connect multiple spaces in one click",icon:"img/toolbar/stickyline.png",type:$actType.LINE_STICKY},{name:"Erase spaces and lines",icon:"img/toolbar/eraser.png",type:$actType.ERASE},{spacer:!0},{name:"Add blue space",icon:"img/toolbar/blue.png",type:$actType.ADD_BLUE,draggable:!0},{name:"Add red space",icon:"img/toolbar/red.png",type:$actType.ADD_RED,draggable:!0},{name:"Add happening space",icon:"img/toolbar/happening.png",type:$actType.ADD_HAPPENING,draggable:!0},{name:"Add chance time space",icon:"img/toolbar/chance.png",type:$actType.ADD_CHANCE,draggable:!0},{name:"Add Bowser space",icon:"img/toolbar/bowser.png",type:$actType.ADD_BOWSER,draggable:!0},{name:"Add Mini-Game space",icon:"img/toolbar/minigame.png",type:$actType.ADD_MINIGAME,draggable:!0},{name:"Add shroom space",icon:"img/toolbar/shroom.png",type:$actType.ADD_SHROOM,draggable:!0},{name:"Add invisible space",icon:"img/toolbar/other.png",type:$actType.ADD_OTHER,draggable:!0},{name:"Add star space (decoration)",icon:"img/toolbar/star.png",type:$actType.ADD_STAR,draggable:!0,advanced:!0},{name:"Add start space",icon:"img/toolbar/start.png",type:$actType.ADD_START,draggable:!0,advanced:!0},{spacer:!0},{name:"Add Toad",icon:"img/toolbar/toad.png",type:$actType.ADD_TOAD_CHARACTER,draggable:!0},{name:"Add Boo",icon:"img/toolbar/boo.png",type:$actType.ADD_BOO_CHARACTER,draggable:!0},{name:"Add Bowser",icon:"img/toolbar/bowsercharacter.png",type:$actType.ADD_BOWSER_CHARACTER,draggable:!0},{name:"Add Koopa Troopa",icon:"img/toolbar/koopa.png",type:$actType.ADD_KOOPA_CHARACTER,draggable:!0},{name:"Mark space as hosting star",icon:"img/toolbar/markstar.png",type:$actType.MARK_STAR}],r=[{name:"Move spaces",icon:"img/toolbar/move.png",type:$actType.MOVE},{name:"Connect spaces",icon:"img/toolbar/line.png",type:$actType.LINE},{name:"Connect multiple spaces in one click",icon:"img/toolbar/stickyline.png",type:$actType.LINE_STICKY},{name:"Erase spaces and lines",icon:"img/toolbar/eraser.png",type:$actType.ERASE},{spacer:!0},{name:"Add blue space",icon:"img/toolbar/blue.png",type:$actType.ADD_BLUE,draggable:!0},{name:"Add red space",icon:"img/toolbar/red.png",type:$actType.ADD_RED,draggable:!0},{name:"Add happening space",icon:"img/toolbar/happening.png",type:$actType.ADD_HAPPENING,draggable:!0},{name:"Add chance time space",icon:"img/toolbar/chance2.png",type:$actType.ADD_CHANCE,draggable:!0},{name:"Add Bowser space",icon:"img/toolbar/bowser.png",type:$actType.ADD_BOWSER,draggable:!0},{name:"Add item space",icon:"img/toolbar/item.png",type:$actType.ADD_ITEM,draggable:!0},{name:"Add battle space",icon:"img/toolbar/battle.png",type:$actType.ADD_BATTLE,draggable:!0},{name:"Add bank space",icon:"img/toolbar/bank.png",type:$actType.ADD_BANK,draggable:!0},{name:"Add invisible space",icon:"img/toolbar/other.png",type:$actType.ADD_OTHER,draggable:!0},{name:"Add star space (decoration)",icon:"img/toolbar/star.png",type:$actType.ADD_STAR,draggable:!0,advanced:!0},{name:"Add black star space (decoration)",icon:"img/toolbar/blackstar.png",type:$actType.ADD_BLACKSTAR,draggable:!0,advanced:!0},{name:"Add start space",icon:"img/toolbar/start.png",type:$actType.ADD_START,draggable:!0,advanced:!0},{name:"Add arrow space",icon:"img/toolbar/arrow.png",type:$actType.ADD_ARROW,draggable:!0,advanced:!0},{spacer:!0},{name:"Add Toad",icon:"img/toolbar/toad.png",type:$actType.ADD_TOAD_CHARACTER,draggable:!0},{name:"Add Boo",icon:"img/toolbar/boo.png",type:$actType.ADD_BOO_CHARACTER,draggable:!0},{name:"Add bank",icon:"img/toolbar/banksubtype2.png",type:$actType.ADD_BANK_SUBTYPE,draggable:!0},{name:"Add bank coin stack",icon:"img/toolbar/bankcoinsubtype.png",type:$actType.ADD_BANKCOIN_SUBTYPE,draggable:!0},{name:"Add item shop",icon:"img/toolbar/itemshopsubtype2.png",type:$actType.ADD_ITEMSHOP_SUBTYPE,draggable:!0},{name:"Mark space as hosting star",icon:"img/toolbar/markstar.png",type:$actType.MARK_STAR}],p=[{name:"Move spaces",icon:"img/toolbar/move.png",type:$actType.MOVE},{name:"Connect spaces",icon:"img/toolbar/line.png",type:$actType.LINE},{name:"Connect multiple spaces in one click",icon:"img/toolbar/stickyline.png",type:$actType.LINE_STICKY},{name:"Erase spaces and lines",icon:"img/toolbar/eraser.png",type:$actType.ERASE},{name:"Rotate arrow spaces",icon:"img/toolbar/rotate.png",type:$actType.ROTATE,advanced:!0},{spacer:!0},{name:"Add blue space",icon:"img/toolbar/blue3.png",type:$actType.ADD_BLUE,draggable:!0},{name:"Add red space",icon:"img/toolbar/red3.png",type:$actType.ADD_RED,draggable:!0},{name:"Add happening space",icon:"img/toolbar/happening3.png",type:$actType.ADD_HAPPENING,draggable:!0},{name:"Add chance time space",icon:"img/toolbar/chance3.png",type:$actType.ADD_CHANCE,draggable:!0},{name:"Add Bowser space",icon:"img/toolbar/bowser3.png",type:$actType.ADD_BOWSER,draggable:!0},{name:"Add item space",icon:"img/toolbar/item3.png",type:$actType.ADD_ITEM,draggable:!0},{name:"Add battle space",icon:"img/toolbar/battle3.png",type:$actType.ADD_BATTLE,draggable:!0},{name:"Add bank space",icon:"img/toolbar/bank3.png",type:$actType.ADD_BANK,draggable:!0},{name:"Add Game Guy space",icon:"img/toolbar/gameguy.png",type:$actType.ADD_GAMEGUY,draggable:!0},{name:"Add invisible space",icon:"img/toolbar/other.png",type:$actType.ADD_OTHER,draggable:!0},{name:"Add star space (decoration)",icon:"img/toolbar/star.png",type:$actType.ADD_STAR,draggable:!0,advanced:!0},{name:"Add start space",icon:"img/toolbar/start.png",type:$actType.ADD_START,draggable:!0,advanced:!0},{name:"Add arrow space",icon:"img/toolbar/arrow.png",type:$actType.ADD_ARROW,draggable:!0,advanced:!0},{spacer:!0},{name:"Add Millennium Star",icon:"img/toolbar/mstar.png",type:$actType.ADD_TOAD_CHARACTER,draggable:!0},{name:"Add Boo",icon:"img/toolbar/boo.png",type:$actType.ADD_BOO_CHARACTER,draggable:!0},{name:"Add bank",icon:"img/toolbar/banksubtype.png",type:$actType.ADD_BANK_SUBTYPE,draggable:!0},{name:"Add bank coin stack",icon:"img/toolbar/bankcoinsubtype.png",type:$actType.ADD_BANKCOIN_SUBTYPE,draggable:!0},{name:"Add item shop",icon:"img/toolbar/itemshopsubtype.png",type:$actType.ADD_ITEMSHOP_SUBTYPE,draggable:!0},{name:"Mark space as hosting star",icon:"img/toolbar/markstar.png",type:$actType.MARK_STAR},{name:"Mark space as Skeleton Key gate",icon:"img/toolbar/markgate.png",type:$actType.MARK_GATE}],i=[{name:"Move spaces",icon:"img/toolbar/move.png",type:$actType.MOVE},{name:"Connect spaces",icon:"img/toolbar/line.png",type:$actType.LINE},{name:"Connect multiple spaces in one click",icon:"img/toolbar/stickyline.png",type:$actType.LINE_STICKY},{name:"Erase spaces and lines",icon:"img/toolbar/eraser.png",type:$actType.ERASE},{spacer:!0},{name:"Add basic space",icon:"img/toolbar/basic3.png",type:$actType.ADD_DUEL_BASIC,draggable:!0},{name:"Add Mini-Game space",icon:"img/toolbar/minigameduel3.png",type:$actType.ADD_MINIGAME,draggable:!0},{name:"Add reverse space",icon:"img/toolbar/reverse3.png",type:$actType.ADD_DUEL_REVERSE,draggable:!0},{name:"Add happening space",icon:"img/toolbar/happeningduel3.png",type:$actType.ADD_HAPPENING,draggable:!0},{name:"Add Game Guy space",icon:"img/toolbar/gameguyduel.png",type:$actType.ADD_GAMEGUY,draggable:!0},{name:"Add power-up space",icon:"img/toolbar/powerup.png",type:$actType.ADD_DUEL_POWERUP,draggable:!0},{name:"Add invisible space",icon:"img/toolbar/other.png",type:$actType.ADD_OTHER,draggable:!0},{name:"Add blue start space",icon:"img/toolbar/startblue.png",type:$actType.ADD_DUEL_START_BLUE,draggable:!0,advanced:!0},{name:"Add red start space",icon:"img/toolbar/startred.png",type:$actType.ADD_DUEL_START_RED,draggable:!0,advanced:!0}];var e=function(e){function c(){var e,a,t;_classCallCheck(this,c);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=t=_possibleConstructorReturn(this,(e=c.__proto__||Object.getPrototypeOf(c)).call.apply(e,[this].concat(o)))).state={},_possibleConstructorReturn(t,a)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var t=this;if(PP64.boards.currentBoardIsROM())return React.createElement("div",{className:"toolbarReadonly"},"Board is readonly.");var n=0,e=function(e,a){var t=void 0;switch(e){case 1:t=o;break;case 2:t=r;break;case 3:t=a===PP64.types.BoardType.DUEL?i:p;break;default:throw"Unknown game version found by Toolbar ("+e+")"}return PP64.settings.get($setting.uiAdvanced)||(t=t.filter(function(e){return!e.advanced})),t}(this.props.gameVersion,this.props.boardType);return e=e.map(function(e){if(e.group)return React.createElement(g,{key:e.group,icon:e.icon,actions:e.actions,currentAction:t.props.currentAction});if(e.spacer)return React.createElement(l,{key:"spacer"+n});var a=t.props.currentAction===e.type;return React.createElement(s,{key:e.type,current:a,action:e,index:n++})}),React.createElement("div",{className:"toolbar",role:"toolbar"},e)}}]),c}(),g=function(e){function a(){return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t,n=this,e="toolbarGroup",a=this.props.actions.map(function(e){e.type===n.props.currentAction&&(t=e.icon);var a=n.props.currentAction===e.type;return React.createElement(s,{key:e.type,action:e,current:a})});t?e+=" selected":t=this.props.icon;var o=-50*a.length,r=50*a.length;5<=a.length&&(o/=2,r/=2);var c={left:o,maxWidth:r};return React.createElement("div",{className:e,title:this.props.group,role:"button",tabIndex:"0"},React.createElement("img",{className:"toolbarIcon",src:t}),React.createElement("div",{className:"toolbarGroupPanel",style:c},a))}}]),a}(),s=function(e){function c(){var e,a,t;_classCallCheck(this,c);for(var n=arguments.length,o=Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=t=_possibleConstructorReturn(this,(e=c.__proto__||Object.getPrototypeOf(c)).call.apply(e,[this].concat(o)))).handleClick=function(){var e;e=t.props.action.type,PP64.app.changeCurrentAction(e)},t.onDragStart=function(e){t.props.action.draggable&&e.dataTransfer.setData("text",JSON.stringify({action:t.props.action}))},_possibleConstructorReturn(t,a)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var e="toolbarButton";this.props.current&&(e+=" selected");var a=PP64.utils.react.makeKeyClick(this.handleClick,this);return React.createElement("div",{className:e,title:this.props.action.name,role:"button",tabIndex:"0",onClick:this.handleClick,onKeyDown:a,draggable:this.props.action.draggable,onDragStart:this.onDragStart},React.createElement("img",{className:"toolbarIcon",src:this.props.action.icon}))}}]),c}(),l=function(e){function a(){return _classCallCheck(this,a),_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments))}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"toolbarSpacer",role:"separator"})}}]),a}();return{Toolbar:e}}();
"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("properties"),PP64.properties.BoardProperties=function(){var e=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var e=this.props.currentBoard.game,t=PP64.boards.currentBoardIsROM(),n=void 0;2===e&&(n=React.createElement(c,{board:this.props.currentBoard}));var r=void 0;return t||(r=React.createElement(i,{board:this.props.currentBoard})),React.createElement("div",{className:"properties"},React.createElement(a,{romBoard:t}),React.createElement(o,{gameVersion:e,boardType:this.props.currentBoard.type}),r,n)}}]),s}(),o=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={},n.onChangeBg=function(){PP64.utils.input.openFile("image/*",n.bgSelected)},n.bgSelected=function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){PP64.boards.setBG(n.result),PP64.renderer.render()},n.readAsDataURL(t)}},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var e=void 0;switch(this.props.gameVersion){case 1:e="960 x 720";break;case 2:case 3:e=this.props.boardType===PP64.types.BoardType.DUEL?"896 x 672":"1152 x 864"}return React.createElement("div",{className:"propertiesActionButton",onClick:this.onChangeBg,title:e},React.createElement("img",{src:"img/header/setbg.png",className:"propertiesActionButtonImg",width:"24",height:"24"}),React.createElement("span",{className:"propertiesActionButtonSpan"},"Change main background"))}}]),s}(),a=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"onEditDetails",value:function(){PP64.app.changeView($viewType.DETAILS)}},{key:"render",value:function(){var e=this.props.romBoard?"View board details":"Edit board details";return React.createElement("div",{className:"propertiesActionButton",onClick:this.onEditDetails},React.createElement("img",{src:"img/header/editdetails.png",className:"propertiesActionButtonImg",width:"24",height:"24"}),React.createElement("span",{className:"propertiesActionButtonSpan"},e))}}]),s}(),i=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={noDeadEnds:!1},n.checkForDeadEnds=function(){var e=PP64.boards.getDeadEnds(n.props.board);$$log("Dead ends",e),e.length?PP64.renderer.highlightSpaces(e):(n.setState({noDeadEnds:!0}),n._noDeadEndsTimeout=setTimeout(function(){delete n._noDeadEndsTimeout,n.setState({noDeadEnds:!1})},1e3))},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"componentWillUnmount",value:function(){this._noDeadEndsTimeout&&(delete this._noDeadEndsTimeout,clearTimeout(this._noDeadEndsTimeout))}},{key:"render",value:function(){var e=void 0,t=void 0;return this.state.noDeadEnds?e="‚úì No dead ends":(e="Check for dead ends",t=this.checkForDeadEnds),React.createElement("div",{className:"propertiesActionButton",onClick:t},React.createElement("img",{src:"img/editor/boardproperties/deadend.png",className:"propertiesActionButtonImg",width:"24",height:"24"}),React.createElement("span",{className:"propertiesActionButtonSpan"},e))}}]),s}(),c=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={},n.onAnimBgsChanged=function(){n.forceUpdate()},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){var t=this,e=this.props.board.animbg||[],n=0,r=e.map(function(e){return n++,React.createElement(l,{bg:e,text:"Frame "+n,key:n,index:n-1,onAnimBgsChanged:t.onAnimBgsChanged})}),o=void 0;return e.length&&(o=React.createElement(u,null)),React.createElement("div",{className:"propertiesAnimationBGList"},React.createElement("span",{className:"propertySectionTitle"},"Animation Backgrounds",o),r,React.createElement(p,{onAnimBgsChanged:this.onAnimBgsChanged}))}}]),s}(),l=function(e){function s(){var e,t,n;_classCallCheck(this,s);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return(t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={},n.onMouseDown=function(){PP64.renderer.animationPlaying()||PP64.renderer.external.setBGImage(n.props.bg)},n.restoreMainBG=function(){PP64.renderer.animationPlaying()||PP64.renderer.renderBG()},n.onRemove=function(){PP64.boards.removeAnimBG(n.props.index),n.props.onAnimBgsChanged()},_possibleConstructorReturn(n,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){return React.createElement("div",{className:"propertiesActionButton",onMouseDown:this.onMouseDown,onMouseUp:this.restoreMainBG,onMouseOut:this.restoreMainBG},React.createElement("img",{src:this.props.bg,className:"propertiesActionButtonImg",width:"24",height:"24"}),React.createElement("span",{className:"propertiesActionButtonSpan"},this.props.text),React.createElement("div",{role:"button",className:"animBGEntryDelete",onClick:this.onRemove,title:"Remove this animation frame"},"‚úñ"))}}]),s}(),p=function(e){function s(){var e,t,r;_classCallCheck(this,s);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o)))).state={},r.onAddAnimBg=function(){PP64.utils.input.openFile("image/*",r.bgSelected)},r.bgSelected=function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){PP64.boards.addAnimBG(n.result),r.props.onAnimBgsChanged()},n.readAsDataURL(t)}},_possibleConstructorReturn(r,t)}return _inherits(s,React.Component),_createClass(s,[{key:"render",value:function(){return React.createElement("div",{className:"propertiesActionButton",onClick:this.onAddAnimBg},React.createElement("img",{src:"img/toolbar/animadd.png",className:"propertiesActionButtonImg",width:"24",height:"24"}),React.createElement("span",{className:"propertiesActionButtonSpan"},"Add background"))}}]),s}(),u=function(e){function n(e){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.onClick=function(){t.setState({playing:!t.state.playing}),t.state.playing?PP64.renderer.stopAnimation():PP64.renderer.playAnimation()},t.state={playing:PP64.renderer.animationPlaying()},t}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var e=this.state.playing?"‚ñÆ‚ñÆ":"‚ñ∫";return React.createElement("div",{className:"animPlayBtn",onClick:this.onClick},e)}},{key:"componentWillUnmount",value:function(){PP64.renderer.stopAnimation()}}]),n}();return e}();
"use strict";var _createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("properties"),PP64.properties.SpaceProperties=function(){var e=function(e){function o(){var e,t,i;_classCallCheck(this,o);for(var a=arguments.length,n=Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=i=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={},i.onTypeChanged=function(e,t){var a=i.props.selectedSpaces,n=!0,r=!1,o=void 0;try{for(var p,s=a[Symbol.iterator]();!(n=(p=s.next()).done);n=!0){var c=p.value;void 0!==e&&(c.type=e),void 0!==t?c.subtype=t:delete c.subtype}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}PP64.renderer.render(),i.forceUpdate()},i.onStarCheckChanged=function(e){var t=i.props.selectedSpaces,a=!0,n=!1,r=void 0;try{for(var o,p=t[Symbol.iterator]();!(a=(o=p.next()).done);a=!0){o.value.star=!!e}}catch(e){n=!0,r=e}finally{try{!a&&p.return&&p.return()}finally{if(n)throw r}}PP64.renderer.render(),i.forceUpdate()},i.onEventAdded=function(e){var t=i.props.selectedSpaces[0];PP64.boards.addEventToSpace(t,e),PP64.renderer.render(),i.forceUpdate()},i.onEventDeleted=function(e){var t=i.props.selectedSpaces[0];PP64.boards.removeEventFromSpace(t,e),PP64.renderer.render(),i.forceUpdate()},i.onEventActivationTypeToggle=function(e){e.activationType===PP64.types.EventActivationType.WALKOVER?e.activationType=PP64.types.EventActivationType.LANDON:e.activationType=PP64.types.EventActivationType.WALKOVER},i.onEventParameterSet=function(e,t,a){e.parameterValues||(e.parameterValues={}),e.parameterValues[t]=a,PP64.renderer.renderConnections(),PP64.renderer.renderSpaces()},_possibleConstructorReturn(i,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var e=this.props.selectedSpaces;if(!e||!e.length)return React.createElement("div",{className:"propertiesEmptyText"},"No space selected.");var t=1<e.length,a=e[0],n=this.props.gameVersion,r=this.props.boardType,o=r===PP64.types.BoardType.DUEL,p=function(e,t){var a=void 0;switch(e){case 1:a=C;break;case 2:a=T;break;case 3:switch(t){case PP64.types.BoardType.DUEL:a=S;break;default:a=P}}PP64.settings.get($setting.uiAdvanced)||(a=a.filter(function(e){return!e.advanced}));return a}(n,r),s=function(e,t){var a=void 0;switch(e){case 1:a=f;break;case 2:a=R;break;case 3:switch(t){case PP64.types.BoardType.DUEL:a=[];break;default:a=_}}PP64.settings.get($setting.uiAdvanced)||(a=a.filter(function(e){return!e.advanced}));return a}(n,r),c=void 0;c=React.createElement("span",{className:"propertySectionTitle"},"Events ¬†",React.createElement("img",{src:"img/editor/event.png",height:"9",width:"9"}));var i=a.type,l=a.subtype,m=a.star||!1,u=!1;if(t){var g=!0,y=!1,h=void 0;try{for(var v,d=e[Symbol.iterator]();!(g=(v=d.next()).done);g=!0){var b=v.value;b.type!==i&&(i=void 0),b.subtype!==l&&(l=void 0),b.star!==m&&(u=!0)}}catch(e){y=!0,h=e}finally{try{!g&&d.return&&d.return()}finally{if(y)throw h}}}return React.createElement("div",{className:"properties"},React.createElement("div",{className:"propertiesPadded"},t?null:React.createElement(E,{space:a}),React.createElement(k,{toggleTypes:p,type:i,subtype:l,typeChanged:this.onTypeChanged}),React.createElement(k,{toggleTypes:s,type:i,subtype:l,typeChanged:this.onTypeChanged}),o?null:React.createElement(A,{checked:m,indeterminate:u,onStarCheckChanged:this.onStarCheckChanged})),t?null:c,t?null:React.createElement("div",{className:"propertiesPadded"},React.createElement(N,{events:a.events,onEventAdded:this.onEventAdded,onEventDeleted:this.onEventDeleted,onEventActivationTypeToggle:this.onEventActivationTypeToggle,onEventParameterSet:this.onEventParameterSet})))}}]),o}(),E=function(e){function p(){var e,t,r;_classCallCheck(this,p);for(var a=arguments.length,n=Array(a),o=0;o<a;o++)n[o]=arguments[o];return(t=r=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(n)))).state={},r.onChangeX=function(e){var t=parseInt(e.target.value,10),a=""===e.target.value,n=PP64.boards.getCurrentBoard().bg.width;!a&&isNaN(t)||t<0||n<t||(r.state.oldX||r.setState({oldX:r.props.space.x}),r.props.space.x=a?"":t,r.forceUpdate())},r.onChangeY=function(e){var t=parseInt(e.target.value,10),a=""===e.target.value,n=PP64.boards.getCurrentBoard().bg.height;!a&&isNaN(t)||t<0||n<t||(r.state.oldY||r.setState({oldY:r.props.space.y}),r.props.space.y=a?"":t,r.forceUpdate())},r.onChangeRotation=function(e){var t=parseInt(e.target.value,10);!(""===e.target.value)&&isNaN(t)||t<0||360<t||(r.state.oldRot||r.setState({oldRot:r.props.space.rotation}),t?r.props.space.rotation=t:delete r.props.space.rotation,r.forceUpdate())},r.onCoordSet=function(e){r.props.space.x=r.props.space.x||0,r.props.space.y=r.props.space.y||0,PP64.renderer.render(),r.setState({oldX:void 0,oldY:void 0,oldRot:void 0}),r.forceUpdate()},r.onKeyUp=function(e){"Enter"===e.key&&r.onCoordSet()},_possibleConstructorReturn(r,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var e=this.props.space;if(!e)return null;e.type,$spaceType.ARROW;return React.createElement(React.Fragment,null,React.createElement("div",{className:"spaceCoordRow"},React.createElement("span",{className:"coordLabel"},"X:"),React.createElement("input",{className:"coordInput",type:"text",value:e.x,onChange:this.onChangeX,onBlur:this.onCoordSet,onKeyUp:this.onKeyUp}),React.createElement("span",{className:"coordLabel"},"Y:"),React.createElement("input",{className:"coordInput",type:"text",value:e.y,onChange:this.onChangeY,onBlur:this.onCoordSet,onKeyUp:this.onKeyUp})))}}]),p}(),C=[{name:"Change to blue space",icon:"img/toolbar/blue.png",type:$spaceType.BLUE},{name:"Change to red space",icon:"img/toolbar/red.png",type:$spaceType.RED},{name:"Change to happening space",icon:"img/toolbar/happening.png",type:$spaceType.HAPPENING},{name:"Change to chance time space",icon:"img/toolbar/chance.png",type:$spaceType.CHANCE},{name:"Change to Mini-Game space",icon:"img/toolbar/minigame.png",type:$spaceType.MINIGAME},{name:"Change to shroom space",icon:"img/toolbar/shroom.png",type:$spaceType.SHROOM},{name:"Change to Bowser space",icon:"img/toolbar/bowser.png",type:$spaceType.BOWSER},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to star space",icon:"img/toolbar/star.png",type:$spaceType.STAR,advanced:!0},{name:"Change to start space",icon:"img/toolbar/start.png",type:$spaceType.START,advanced:!0}],f=[{name:"Show Toad",icon:"img/toolbar/toad.png",subtype:$spaceSubType.TOAD},{name:"Show Boo",icon:"img/toolbar/boo.png",subtype:$spaceSubType.BOO},{name:"Show Bowser",icon:"img/toolbar/bowsercharacter.png",subtype:$spaceSubType.BOWSER},{name:"Show Koopa Troopa",icon:"img/toolbar/koopa.png",subtype:$spaceSubType.KOOPA}],T=[{name:"Change to blue space",icon:"img/toolbar/blue.png",type:$spaceType.BLUE},{name:"Change to red space",icon:"img/toolbar/red.png",type:$spaceType.RED},{name:"Change to happening space",icon:"img/toolbar/happening.png",type:$spaceType.HAPPENING},{name:"Change to chance time space",icon:"img/toolbar/chance2.png",type:$spaceType.CHANCE},{name:"Change to Bowser space",icon:"img/toolbar/bowser.png",type:$spaceType.BOWSER},{name:"Change to item space",icon:"img/toolbar/item.png",type:$spaceType.ITEM},{name:"Change to battle space",icon:"img/toolbar/battle.png",type:$spaceType.BATTLE},{name:"Change to bank space",icon:"img/toolbar/bank.png",type:$spaceType.BANK},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to star space",icon:"img/toolbar/star.png",type:$spaceType.STAR,advanced:!0},{name:"Change to black star space",icon:"img/toolbar/blackstar.png",type:$spaceType.BLACKSTAR,advanced:!0},{name:"Change to start space",icon:"img/toolbar/start.png",type:$spaceType.START,advanced:!0},{name:"Change to arrow space",icon:"img/toolbar/arrow.png",type:$spaceType.ARROW,advanced:!0}],R=[{name:"Show Toad",icon:"img/toolbar/toad.png",subtype:$spaceSubType.TOAD},{name:"Show Boo",icon:"img/toolbar/boo.png",subtype:$spaceSubType.BOO},{name:"Show bank",icon:"img/toolbar/banksubtype2.png",subtype:$spaceSubType.BANK},{name:"Show bank coin stack",icon:"img/toolbar/bankcoinsubtype.png",subtype:$spaceSubType.BANKCOIN},{name:"Show item shop",icon:"img/toolbar/itemshopsubtype2.png",subtype:$spaceSubType.ITEMSHOP}],P=[{name:"Change to blue space",icon:"img/toolbar/blue3.png",type:$spaceType.BLUE},{name:"Change to red space",icon:"img/toolbar/red3.png",type:$spaceType.RED},{name:"Change to happening space",icon:"img/toolbar/happening3.png",type:$spaceType.HAPPENING},{name:"Change to chance time space",icon:"img/toolbar/chance3.png",type:$spaceType.CHANCE},{name:"Change to Bowser space",icon:"img/toolbar/bowser3.png",type:$spaceType.BOWSER},{name:"Change to item space",icon:"img/toolbar/item3.png",type:$spaceType.ITEM},{name:"Change to battle space",icon:"img/toolbar/battle3.png",type:$spaceType.BATTLE},{name:"Change to bank space",icon:"img/toolbar/bank3.png",type:$spaceType.BANK},{name:"Change to Game Guy space",icon:"img/toolbar/gameguy.png",type:$spaceType.GAMEGUY},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to star space",icon:"img/toolbar/star.png",type:$spaceType.STAR,advanced:!0},{name:"Change to start space",icon:"img/toolbar/start.png",type:$spaceType.START,advanced:!0},{name:"Change to arrow space",icon:"img/toolbar/arrow.png",type:$spaceType.ARROW,advanced:!0}],_=[{name:"Show Millenium Star",icon:"img/toolbar/mstar.png",subtype:$spaceSubType.TOAD},{name:"Show Boo",icon:"img/toolbar/boo.png",subtype:$spaceSubType.BOO},{name:"Show bank",icon:"img/toolbar/banksubtype.png",subtype:$spaceSubType.BANK},{name:"Show bank coin stack",icon:"img/toolbar/bankcoinsubtype.png",subtype:$spaceSubType.BANKCOIN},{name:"Show item shop",icon:"img/toolbar/itemshopsubtype.png",subtype:$spaceSubType.ITEMSHOP}],S=[{name:"Change to basic space",icon:"img/toolbar/basic3.png",type:$spaceType.DUEL_BASIC},{name:"Change to Mini-Game space",icon:"img/toolbar/minigameduel3.png",type:$spaceType.MINIGAME},{name:"Change to reverse space",icon:"img/toolbar/reverse3.png",type:$spaceType.DUEL_REVERSE},{name:"Change to happening space",icon:"img/toolbar/happeningduel3.png",type:$spaceType.HAPPENING},{name:"Change to Game Guy space",icon:"img/toolbar/gameguyduel.png",type:$spaceType.GAMEGUY},{name:"Change to power-up space",icon:"img/toolbar/powerup.png",type:$spaceType.DUEL_POWERUP},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to blue start space",icon:"img/toolbar/startblue.png",type:$spaceType.DUEL_START_BLUE,advanced:!0},{name:"Change to red start space",icon:"img/toolbar/startred.png",type:$spaceType.DUEL_START_RED,advanced:!0}];var k=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onTypeChanged=function(e,t){a.props.typeChanged(e,t)},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var n=this.props.type;if(n===$spaceType.START&&!PP64.settings.get($setting.uiAdvanced))return null;var r=this.props.subtype,o=this.onTypeChanged,e=(this.props.toggleTypes||[]).map(function(e){var t=e.type+"-"+e.subtype,a=void 0!==e.type&&n===e.type||void 0!==e.subtype&&void 0!==r&&r===e.subtype;return React.createElement(s,{key:t,type:e.type,subtype:e.subtype,icon:e.icon,title:e.name,selected:a,typeChanged:o})});return React.createElement("div",{className:"spaceToggleContainer"},e)}}]),p}(),s=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onTypeChanged=function(){void 0!==a.props.subtype&&a.props.selected?a.props.typeChanged(a.props.type,void 0):a.props.typeChanged(a.props.type,a.props.subtype)},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var e="spaceToggleButton";this.props.selected&&(e+=" selected");var t=void 0!==this.props.subtype?25:20,a=PP64.utils.react.makeKeyClick(this.onTypeChanged,this);return React.createElement("div",{className:e,title:this.props.title,tabIndex:"0",onClick:this.onTypeChanged,onKeyDown:a},React.createElement("img",{src:this.props.icon,height:t,width:t}))}}]),p}(),A=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onChange=function(e){a.props.onStarCheckChanged(e.target.checked)},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var t=this;return React.createElement("div",{className:"starCheckbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",ref:function(e){return t.checkboxEl=e},checked:this.props.checked,value:this.props.checked,onChange:this.onChange})," Hosts star"))}},{key:"componentDidMount",value:function(){this.checkboxEl.indeterminate=this.props.indeterminate}},{key:"componentDidUpdate",value:function(e){e.indeterminate!==this.props.indeterminate&&(this.checkboxEl.indeterminate=this.props.indeterminate)}}]),p}(),N=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e,t=this,a=this.props.events||[],n=0,r=a.map(function(e){return React.createElement(o,{event:e,key:e.id+"-"+n++,onEventDeleted:t.props.onEventDeleted,onEventActivationTypeToggle:t.props.onEventActivationTypeToggle,onEventParameterSet:t.props.onEventParameterSet})});return e=React.createElement(p,{onEventAdded:this.props.onEventAdded}),React.createElement("div",{className:"eventsList"},r,e)}}]),t}(),o=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onEventDeleted=function(){a.props.onEventDeleted(a.props.event)},a.onEventActivationTypeToggle=function(){a.props.onEventActivationTypeToggle(a.props.event),a.forceUpdate()},a.onEventParameterSet=function(e,t){a.props.onEventParameterSet(a.props.event,e,t),a.forceUpdate()},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var a=this,n=this.props.event,e=PP64.adapters.events.getName(n.id)||n.id,t=void 0;return n.parameters&&(t=n.parameters.map(function(e){var t=n.parameterValues&&n.parameterValues[e.name];switch(e.type){case"Boolean":return React.createElement(i,{key:e.name,parameter:e,parameterValue:t,onEventParameterSet:a.onEventParameterSet});case"Number":case"+Number":return React.createElement(c,{key:e.name,parameter:e,parameterValue:t,positiveOnly:"+Number"===e.type,onEventParameterSet:a.onEventParameterSet});case"Space":return React.createElement(l,{key:e.name,parameter:e,parameterValue:t,onEventParameterSet:a.onEventParameterSet});default:return null}})),React.createElement("div",{className:"eventEntry"},React.createElement("div",{className:"eventEntryHeader"},React.createElement("span",{className:"eventEntryName",title:e},e),React.createElement("div",{role:"button",className:"eventEntryDelete",onClick:this.onEventDeleted,title:"Remove this event"},"‚úñ")),React.createElement("div",{className:"eventEntryOptions"},React.createElement(r,{activationType:n.activationType,onEventActivationTypeToggle:this.onEventActivationTypeToggle}),t))}}]),p}(),r=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onTypeToggle=function(){a.props.onEventActivationTypeToggle()},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var e=this.props.activationType,t=PP64.types.EventActivationType,a={};a[t.WALKOVER]="img/toolbar/eventpassing.png",a[t.LANDON]="img/toolbar/eventstanding.png";var n=a[e];if(!n)return null;var r={};r[t.WALKOVER]="Occurs when passing over the space",r[t.LANDON]="Occurs when landing on the space";var o="";switch(e){case t.WALKOVER:o="Passing event";break;case t.LANDON:o="Land-on event"}return React.createElement("div",{className:"eventEntryItem eventEntryActivationTypeItem",onClick:this.onTypeToggle},React.createElement("img",{className:"eventEntryActivationTypeToggle",alt:"Activation Type",src:n,title:r[e]}),React.createElement("span",null,o))}}]),p}(),c=function(e){function p(){var e,t,r;_classCallCheck(this,p);for(var a=arguments.length,n=Array(a),o=0;o<a;o++)n[o]=arguments[o];return(t=r=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(n)))).onParameterClicked=function(){var e=r.props.parameter.name,t=r.props.positiveOnly,a=window.prompt("Enter a"+(t?" positive ":" ")+"numeric value for the "+e+" parameter");if(a){var n=parseInt(a);isNaN(n)?PP64.app.showMessage("The value entered could not be parsed into a number"):r.props.positiveOnly&&n<=0?PP64.app.showMessage("The value entered must be a positive number"):r.props.onEventParameterSet(e,n)}},_possibleConstructorReturn(r,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var e=this.props.parameterValue,t=null!=e,a="(Number) "+this.props.parameter.name+": "+(t?e:"null");return React.createElement("div",{className:"eventEntryItem",title:a,onClick:this.onParameterClicked},React.createElement("span",{className:"eventEntryItemParameterName"},this.props.parameter.name,":"),"¬†",t?React.createElement("span",null,this.props.parameterValue):React.createElement("span",{className:"eventEntryItemParameterUnset"},"null"))}}]),p}(),i=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onParameterClicked=function(){var e=a.props.parameterValue;a.props.onEventParameterSet(a.props.parameter.name,!e)},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var e=this.props.parameterValue,t=null!=e,a="(Boolean) "+this.props.parameter.name+": "+(t?e:"null");return React.createElement("div",{className:"eventEntryItem",title:a,onClick:this.onParameterClicked},React.createElement("span",{className:"eventEntryItemParameterName"},this.props.parameter.name,":"),"¬†",t?React.createElement("span",null,this.props.parameterValue.toString()):React.createElement("span",{className:"eventEntryItemParameterUnset"},"null"))}}]),p}(),l=function(e){function p(){var e,t,a;_classCallCheck(this,p);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=a=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).onDragStart=function(e){PP64.utils.drag.setEventParamDropHandler(a.onSpaceDroppedOn),e.dataTransfer.setDragImage(PP64.images.get("targetImg"),3,0),e.dataTransfer.setData("text",JSON.stringify({isEventParamDrop:!0}))},a.onSpaceDroppedOn=function(e){PP64.utils.drag.setEventParamDropHandler(null),0<=e&&a.props.onEventParameterSet(a.props.parameter.name,e)},a.onParameterClicked=function(){PP64.app.showMessage("To associate a space with this event, click and drag from this list entry and release over the target space.")},_possibleConstructorReturn(a,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var e=this.props.parameterValue,t=null!=e,a="(Space) "+this.props.parameter.name+": "+(t?"set":"null")+"\nDrag to a space to associate it";return React.createElement("div",{className:"eventEntryItem eventEntryItemDraggable",title:a,draggable:!0,onDragStart:this.onDragStart,onClick:this.onParameterClicked},React.createElement("img",{alt:"Target",src:"img/events/target.png"}),React.createElement("span",{className:"eventEntryItemParameterName"},this.props.parameter.name,":"),"¬†",t?React.createElement("span",null,"set"):React.createElement("span",{className:"eventEntryItemParameterUnset"},"null"))}}]),p}(),p=function(e){function p(){var e,t,n;_classCallCheck(this,p);for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=p.__proto__||Object.getPrototypeOf(p)).call.apply(e,[this].concat(r)))).state={selectedValue:-1,possibleEvents:PP64.adapters.events.getAvailableEvents().sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})},n.onSelection=function(e){var t=e.target.value;if("-1"!=t){var a=PP64.utils.obj.copy(n.state.possibleEvents[t]);n.props.onEventAdded(a)}},_possibleConstructorReturn(n,t)}return _inherits(p,React.Component),_createClass(p,[{key:"render",value:function(){var a=0,e=this.state.possibleEvents.map(function(e){var t=a++;return React.createElement("option",{value:t,key:t},e.name)});return e.length?(e.unshift(React.createElement("option",{value:"-1",key:"-1"},"Add new event")),React.createElement("div",{className:"eventAddSelectEntry"},React.createElement("select",{className:"eventAddSelect",value:this.state.selectedValue,onChange:this.onSelection},e))):null}}]),p}();return e}();
"use strict";var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.details=function(){var c=[{type:"richtext",id:"detailBoardName",desc:"Board name",maxlines:1},{type:"richtext",id:"detailBoardDesc",desc:"Board description",maxlines:2},{type:"br"},{type:"image",id:"detailBoardSelectImg",desc:"Board select image",width:128,height:64},{type:"image",id:"detailBoardLogoImg",desc:"Board logo",width:250,height:100},{type:"audio",id:"detailBoardAudio",desc:"Background music"},{type:"difficulty",id:"detailBoardDifficulty",desc:"Difficulty"},{type:"br"},{type:"image",id:"detailBoardLargeSceneBg",desc:"Large scene background",width:320,height:240},{type:"image",id:"detailBoardConversationBg",desc:"Conversation background",width:320,height:240},{type:"image",id:"detailBoardSplashscreenBg",desc:"Splashscreen background",width:320,height:240}],d=[{type:"richtext",id:"detailBoardName",desc:"Board name",maxlines:1},{type:"richtext",id:"detailBoardDesc",desc:"Board description",maxlines:2},{type:"br"},{type:"image",id:"detailBoardSelectImg",desc:"Board select image",width:64,height:48},{type:"image",id:"detailBoardSelectIcon",desc:"Board select icon",width:32,height:32},{type:"image",id:"detailBoardLogoImg",desc:"Board logo",width:260,height:120},{type:"audio",id:"detailBoardAudio",desc:"Background music"},{type:"difficulty",id:"detailBoardDifficulty",desc:"Difficulty"},{type:"br"},{type:"image",id:"detailBoardLargeSceneBg",desc:"Large scene background",width:320,height:240}],s=[{type:"richtext",id:"detailBoardName",desc:"Board name",maxlines:1},{type:"richtext",id:"detailBoardDesc",desc:"Board description",maxlines:2},{type:"br"},{type:"image",id:"detailBoardSelectImg",desc:"Board select image",width:64,height:64},{type:"image",id:"detailBoardLogoImg",desc:"Board logo",width:226,height:120},{type:"image",id:"detailBoardLogoTextImg",desc:"Board logo text",width:226,height:36},{type:"audio",id:"detailBoardAudio",desc:"Background music"},{type:"difficulty",id:"detailBoardDifficulty",desc:"Difficulty"},{type:"br"},{type:"image",id:"detailBoardLargeSceneBg",desc:"Large scene background",width:320,height:240}],l=[{type:"richtext",id:"detailBoardName",desc:"Board name",maxlines:1},{type:"richtext",id:"detailBoardDesc",desc:"Board description",maxlines:2},{type:"br"},{type:"image",id:"detailBoardSelectImg",desc:"Board select image",width:64,height:64},{type:"image",id:"detailBoardLogoImg",desc:"Board logo",width:226,height:120},{type:"image",id:"detailBoardLogoTextImg",desc:"Board logo text",width:226,height:36},{type:"audio",id:"detailBoardAudio",desc:"Background music"},{type:"difficulty",id:"detailBoardDifficulty",desc:"Difficulty"}];function u(e,t,a){switch(e){case"detailBoardName":a.name=t,PP64.app.refresh();break;case"detailBoardDesc":a.description=t;break;case"detailBoardDifficulty":a.difficulty=t;break;case"detailBoardSelectImg":a.otherbg.boardselect=t;break;case"detailBoardSelectIcon":a.otherbg.boardselecticon=t;break;case"detailBoardLogoImg":a.otherbg.boardlogo=t;break;case"detailBoardLogoTextImg":a.otherbg.boardlogotext=t;break;case"detailBoardAudio":a.audioIndex=t,PP64.app.refresh();break;case"detailBoardLargeSceneBg":a.otherbg.largescene=t;break;case"detailBoardConversationBg":a.otherbg.conversation=t;break;case"detailBoardSplashscreenBg":a.otherbg.splashscreen=t}}var e=function(e){function n(){var e,t,a;_classCallCheck(this,n);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=a=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(o)))).state={},a.onTextChange=function(e,t){u(e,t.target.value,a.props.board),a.forceUpdate()},a.onRichTextChange=function(e,t){u(e,t,a.props.board),a.forceUpdate()},a.onValueChange=function(e,t){u(e,t,a.props.board),a.forceUpdate()},_possibleConstructorReturn(a,t)}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var r=this;if(!this.props.board)return null;var o=0,i=PP64.boards.boardIsROM(this.props.board),e=function(){var e=PP64.boards.getCurrentBoard(),t=e.game,a=e.type;switch(t){case 1:return c;case 2:return d;case 3:switch(a){case PP64.types.BoardType.DUEL:return l;default:return s}}}().map(function(e){var t=function(e,t){switch(e){case"detailBoardName":return t.board.name;case"detailBoardDesc":return t.board.description;case"detailBoardDifficulty":return t.board.difficulty;case"detailBoardSelectImg":return t.board.otherbg.boardselect;case"detailBoardSelectIcon":return t.board.otherbg.boardselecticon;case"detailBoardLogoImg":return t.board.otherbg.boardlogo;case"detailBoardLogoTextImg":return t.board.otherbg.boardlogotext;case"detailBoardAudio":return t.board.audioIndex;case"detailBoardLargeSceneBg":return t.board.otherbg.largescene;case"detailBoardConversationBg":return t.board.otherbg.conversation;case"detailBoardSplashscreenBg":return t.board.otherbg.splashscreen}return""}(e.id,r.props);switch(e.type){case"text":return React.createElement(p,{id:e.id,desc:e.desc,readonly:i,value:t,onTextChange:r.onTextChange,key:e.id,type:e.type});case"richtext":var a=i?PP64.texteditor.MPEditorDisplayMode.Readonly:PP64.texteditor.MPEditorDisplayMode.Edit;return React.createElement("div",{className:"detailRichTextContainer",key:e.id},React.createElement("label",{htmlFor:e.id},e.desc),React.createElement(PP64.texteditor.MPEditor,{id:e.id,value:t,showToolbar:!i,displayMode:a,maxlines:e.maxlines||0,itemBlacklist:["COLOR","ADVANCED","DARKLIGHT"],onValueChange:r.onRichTextChange}));case"image":return React.createElement(h,{id:e.id,desc:e.desc,readonly:i,value:t,key:e.id,onImageSelected:r.onValueChange,width:e.width,height:e.height});case"audio":return React.createElement(g,{id:e.id,desc:e.desc,readonly:i,value:t,key:e.id,onAudioSelected:r.onValueChange});case"difficulty":return React.createElement(f,{id:e.id,desc:e.desc,readonly:i,value:t,key:e.id,onDifficultySelected:r.onValueChange});case"br":return React.createElement("br",{key:"br"+o++})}});return React.createElement("div",{id:"detailsForm"},e)}}]),n}(),p=function(e){function n(){var e,t,a;_classCallCheck(this,n);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=a=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(o)))).onTextChange=function(e){a.props.onTextChange(a.props.id,e)},_possibleConstructorReturn(a,t)}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var e=this.props.id,t=this.props.desc,a=this.props.readonly;return React.createElement("div",{className:"detailTextContainer"},React.createElement("label",{htmlFor:e},t),React.createElement("input",{id:e,type:"text",placeholder:t,value:this.props.value,readOnly:a,defaultValue:"",onChange:this.onTextChange}))}}]),n}(),h=function(e){function n(){var e,t,a;_classCallCheck(this,n);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=a=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(o)))).handleClick=function(){PP64.boards.currentBoardIsROM()||PP64.utils.input.openFile("image/*",a.imageSelected.bind(a))},_possibleConstructorReturn(a,t)}return _inherits(n,React.Component),_createClass(n,[{key:"imageSelected",value:function(e){var t=this,a=e.target.files[0];if(a){var r=new FileReader;r.onload=function(e){var i=t.props.onImageSelected,n=t.props.id,c=document.getElementById(n),d=new Image;d.onload=function(){var e=this.props.width,t=this.props.height,a=PP64.utils.canvas.createContext(e,t);a.drawImage(d,0,0,e,t);var r=a.getImageData(0,0,e,t).data.buffer;r=function(e,t){if("detailBoardSelectImg"===e&&1===PP64.boards.getCurrentBoard().game){for(var a=new Uint32Array(t),r=0;r<128;r++)a[r]=0,a[r+128]=0,a[r+7936]=0,a[r+8064]=0;for(var o=0;o<6;o++)a[o+256]=0,a[o+256+122]=0,a[o+7808]=0,a[o+7808+122]=0;for(var i=0;i<4;i++)a[i+384]=0,a[i+384+124]=0,a[i+7680]=0,a[i+7680+124]=0;for(var n=0;n<3;n++)a[n+512]=0,a[n+512+125]=0,a[n+7552]=0,a[n+7552+125]=0;for(var c=0;c<2;c++)a[c+640]=0,a[c+640+126]=0,a[c+7424]=0,a[c+7424+126]=0,a[c+768]=0,a[c+768+126]=0,a[c+7296]=0,a[c+7296+126]=0;a[896]=0,a[1023]=0,a[7168]=0,a[7295]=0,a[1024]=0,a[1151]=0,a[7040]=0;for(var d={},s=a[7167]=0;s<32;s++)for(var l=0;l<64;l++)d[a[128*s+l]]=!0;for(var u={},p=0;p<32;p++)for(var h=64;h<128;h++)u[a[128*p+64+h]]=!0;for(var g={},f=32;f<64;f++)for(var y=0;y<64;y++)g[a[128*f+y]]=!0;for(var m={},b=32;b<64;b++)for(var v=64;v<128;v++)m[a[128*b+64+v]]=!0;(256<Object.keys(d).length||256<Object.keys(u).length||256<Object.keys(g).length||256<Object.keys(m).length)&&(PP64.app.showMessage("Sorry, but the palette limit for this image is 256 unique colors. For now, the image has been reduced to 8-bit, but most image editors should be able to reduce the palette for you with higher quality."),PP64.utils.img.RGBA32.make8Bit(a,128,64))}return t}(n,r);var o=PP64.utils.arrays.arrayBufferToDataURL(r,e,t);c.src=o,i(n,o)}.bind(t),d.src=r.result},r.readAsDataURL(a)}}},{key:"render",value:function(){var e=this.props.id,t=this.props.desc,a=this.props.width,r=this.props.height,o=null;if(!this.props.readonly){var i=a+" √ó "+r;if(100<a&50<r){o=React.createElement("div",{className:"detailImgHoverCover"},React.createElement("span",null,"Choose a new image"),React.createElement("br",null),React.createElement("span",{className:"detailImgHoverCoverSize"},i))}else o=React.createElement("div",{className:"detailImgHoverCover",title:i})}var n={width:a,height:r,minWidth:a,minHeight:r};return React.createElement("div",{className:"detailImgContainer"},React.createElement("label",null,t),React.createElement("div",{className:"detailImgSelect",style:n,onClick:this.handleClick},React.createElement("img",{id:e,className:"detailImg",height:r,width:a,style:n,src:this.props.value,alt:t}),o))}}]),n}(),g=function(e){function n(){var e,t,a;_classCallCheck(this,n);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=a=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(o)))).state={},a.onSelection=function(e){a.props.onAudioSelected(a.props.id,parseInt(e.target.value))},_possibleConstructorReturn(a,t)}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var a=0,e=PP64.adapters.getAdapter(PP64.boards.getCurrentBoard().game).getAudioMap().map(function(e){var t=a++;return e?React.createElement("option",{value:t,key:t},e):null});return React.createElement("div",{className:"audioDetailsContainer"},React.createElement("label",null,this.props.desc),React.createElement("select",{className:"audioSelect",value:this.props.value,disabled:this.props.readonly,onChange:this.onSelection},e))}}]),n}(),f=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.onSelection=function(e){t.props.readonly||t.props.onDifficultySelected(t.props.id,e)},t.onDifficultyFocused=function(e){t.props.readonly||t.setState({focusedLevel:e})},t.state={focusedLevel:0},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){for(var e=[],t=1;t<=5;t++)e.push(React.createElement(r,{level:t.toString(),key:t.toString(),readonly:this.props.readonly,currentLevel:this.props.value,focusedLevel:this.state.focusedLevel,onDifficultyLevelSelected:this.onSelection,onDifficultyFocused:this.onDifficultyFocused}));return React.createElement("div",{className:"difficultyDetailsContainer"},React.createElement("label",null,this.props.desc),React.createElement("div",{className:"difficultyDetailsLevels"},e))}}]),a}(),r=function(e){function n(){var e,t,a;_classCallCheck(this,n);for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=a=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(o)))).state={},a.onClick=function(){a.props.readonly||a.props.onDifficultyLevelSelected(a.props.level)},a.onMouseEnter=function(){a.props.readonly||a.props.onDifficultyFocused(a.props.level)},a.onMouseLeave=function(){a.props.readonly||a.props.onDifficultyFocused(0)},_possibleConstructorReturn(a,t)}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var e="difficultyDetailsLevel";return this.props.readonly||(this.props.level<=this.props.currentLevel&&(e+=" difficultyLevelCurrent"),0<this.props.focusedLevel&&this.props.level<=this.props.focusedLevel&&(e+=" difficultyLevelFocused")),React.createElement("div",{className:e,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave})}}]),n}();return{Details:e}}();
"use strict";var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.about={About:function(e){function c(){var e,t,a;_classCallCheck(this,c);for(var r=arguments.length,n=Array(r),l=0;l<r;l++)n[l]=arguments[l];return(t=a=_possibleConstructorReturn(this,(e=c.__proto__||Object.getPrototypeOf(c)).call.apply(e,[this].concat(n)))).state={},_possibleConstructorReturn(a,t)}return _inherits(c,React.Component),_createClass(c,[{key:"render",value:function(){var e="v0.4.1 (+58 <a href='https://github.com/PartyPlanner64/PartyPlanner64/commit/ca90a14'>ca90a14</a>)";e==="####VERS ION####".replace(" ","")&&(e="unknown");var t=void 0;return t=0<=document.location.href.indexOf("mariopartylegacy")?"Hosted by":"Visit",React.createElement("div",{id:"aboutForm"},React.createElement("div",{className:"aboutHeader"},React.createElement("img",{src:"img/logoloading.png",alt:"PartyPlanner64"}),React.createElement("br",null),React.createElement("span",{className:"aboutVersion selectable"},"Version ",React.createElement("span",{dangerouslySetInnerHTML:{__html:e}}))),React.createElement("br",null),React.createElement("div",{className:"aboutText"},React.createElement("span",{className:"aboutTextLabel"},"Want more PartyPlanner64?"),React.createElement("ul",null,React.createElement("li",null,"Follow ",React.createElement("a",{href:"https://twitter.com/PartyPlanner64",target:"_blank"},"@PartyPlanner64")," on Twitter."),React.createElement("li",null,React.createElement("a",{href:"https://github.com/PartyPlanner64/PartyPlanner64",target:"_blank"},"Contribute")," to development on Github."),React.createElement("li",null,"Write or view ",React.createElement("a",{href:"https://github.com/PartyPlanner64/PartyPlanner64/issues",target:"_blank"},"bugs and enhancement requests"),"."),React.createElement("li",null,"Read the ",React.createElement("a",{href:"https://github.com/PartyPlanner64/PartyPlanner64/wiki/Creating-a-Board"},"usage tutorial")," or ",React.createElement("a",{href:"https://github.com/PartyPlanner64/PartyPlanner64/wiki"},"documentation"),"."))),React.createElement("br",null),React.createElement("br",null),React.createElement("div",{className:"aboutHeader"},React.createElement("span",null,t),React.createElement("br",null),React.createElement("a",{href:"http://mariopartylegacy.com/",target:"_blank"},React.createElement("img",{src:"img/mpllogo.png",alt:"Mario Party Legacy"}))),React.createElement("div",{className:"aboutText"},React.createElement("ul",null,React.createElement("li",null,"Check out discussion in the ",React.createElement("a",{href:"http://www.mariopartylegacy.com/forum/index.php?topic=15883.0",target:"_blank"},"forum thread"),"."),React.createElement("li",null,"Post your creations to the ",React.createElement("a",{href:"http://www.mariopartylegacy.com/forum/index.php?action=downloads",target:"_blank"},"downloads page"),"."))),React.createElement("br",null),React.createElement("br",null),React.createElement("span",{className:"aboutDisclaimer"},"PartyPlanner64 is not affiliated with Nintendo or Hudson."),React.createElement("br",null),React.createElement("span",{className:"aboutDisclaimer"},"Mario Party is a registered trademark of Nintendo."))}}]),c}()};
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,s=!1,n=void 0;try{for(var a,l=e[Symbol.iterator]();!(o=(a=l.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw n}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.models=function(){var e=function(e){function i(e){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));n.onModelSelected=function(e){var t=e.match(/^(\d+)\/(\d+)/);if(!t)throw"Could not parse selected model string "+n.props.selectedModel;var r=_slicedToArray(t,3),o=r[1],s=r[2];n.setState({selectedModel:e,selectedModelDir:o,selectedModelFile:s,selectedAnim:"",selectedAnimDir:null,selectedAnimFile:null})},n.onAnimSelected=function(e){if(e){var t=e.match(/^(\d+)\/(\d+)/);if(!t)throw"Error parsing anim string "+e;var r=_slicedToArray(t,3),o=r[1],s=r[2];n.setState({selectedAnim:e,selectedAnimDir:o,selectedAnimFile:s})}else n.setState({selectedAnim:"",selectedAnimDir:null,selectedAnimFile:null})},n.onBgColorChange=function(e){n.setState({bgColor:e})},n.onFeatureChange=function(e){n.setState(e)},n.onKeyDown=function(e){if(e.key&&n.modelToolbar){var t=e.key.toLowerCase();"m"===t?n.modelToolbar.focusModelSelect():"a"===t&&n.modelToolbar.focusAnimSelect()}},n.state={selectedModel:"",selectedModelDir:null,selectedModelFile:null,selectedAnim:"",selectedAnimDir:null,selectedAnimFile:null,bgColor:0,showTextures:!0,showWireframe:!1,showVertexNormals:!1,useCamera:!1};for(var t=PP64.fs.mainfs.getDirectoryCount(),r=2;r<t;r++)for(var o=PP64.fs.mainfs.getFileCount(r),s=0;s<o;s++){var a=PP64.fs.mainfs.get(r,s);if(PP64.utils.FORM.isForm(a)){var l=r+"/"+s;return n.state.selectedModel=l,n.state.selectedModelDir=r,n.state.selectedModelFile=s,_possibleConstructorReturn(n)}}return n}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){var t=this;return React.createElement("div",{className:"modelViewerContainer",tabIndex:"-1",onKeyDownCapture:this.onKeyDown},React.createElement(s,{ref:function(e){t.modelToolbar=e},selectedModel:this.state.selectedModel,onModelSelected:this.onModelSelected,selectedModelDir:this.state.selectedModelDir,selectedModelFile:this.state.selectedModelFile,selectedAnim:this.state.selectedAnim,onAnimSelected:this.onAnimSelected,selectedAnimDir:this.state.selectedAnimDir,selectedAnimFile:this.state.selectedAnimFile,bgColor:this.state.bgColor,onBgColorChange:this.onBgColorChange,showTextures:this.state.showTextures,showWireframe:this.state.showWireframe,showVertexNormals:this.state.showVertexNormals,useCamera:this.state.useCamera,onFeatureChange:this.onFeatureChange}),React.createElement(o,{selectedModelDir:this.state.selectedModelDir,selectedModelFile:this.state.selectedModelFile,selectedAnimDir:this.state.selectedAnimDir,selectedAnimFile:this.state.selectedAnimFile,bgColor:this.state.bgColor,showTextures:this.state.showTextures,showWireframe:this.state.showWireframe,showVertexNormals:this.state.showVertexNormals,useCamera:this.state.useCamera}))}}]),i}(),t=void 0,r=null,C=void 0,g=void 0,v=void 0,y=void 0,M=void 0,w=void 0,o=function(e){function a(){var e,t,o;_classCallCheck(this,a);for(var r=arguments.length,s=Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=o=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(s)))).state={hasError:!1},o.onWindowResize=function(){if(v&&C){var e=ReactDOM.findDOMNode(o),t=e.offsetHeight,r=e.offsetWidth;C.aspect=r/t,C.updateProjectionMatrix(),v.setSize(r,t)}},_possibleConstructorReturn(o,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){return this.state.hasError?React.createElement("p",null,"An error occurred during rendering, see the browser console."):React.createElement("div",{className:"modelRenderContainer"})}},{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0}),console.error(e,t)}},{key:"componentDidMount",value:function(){try{window.addEventListener("resize",this.onWindowResize),(t=this).initModel()}catch(e){console.error(e)}}},{key:"componentWillUnmount",value:function(){try{window.removeEventListener("resize",this.onWindowResize),t=null,this.clearViewer()}catch(e){console.error(e)}}},{key:"componentDidUpdate",value:function(){try{this.clearViewer(),this.initModel()}catch(e){console.error(e)}}},{key:"clearViewer",value:function(){this.disposeTHREERenderer(),this.disposeTHREEObj(g),g=null,w&&(w.stopAllAction(),w=null),M&&(M.stop(),M=null),null!==r&&(clearTimeout(r),r=null)}},{key:"disposeTHREERenderer",value:function(){if(v){v.dispose(),v.forceContextLoss();var e=ReactDOM.findDOMNode(this);v.domElement.offsetParent&&e.removeChild(v.domElement),v.context=void 0,v.domElement=void 0,v=null}}},{key:"disposeTHREEObj",value:function(e){if(e){for(var t=0;t<e.children.length;t++)this.disposeTHREEObj(e.children[t]);if(e.geometry&&(e.geometry.dispose(),e.geometry=void 0),e.material){var r=void 0;e.material instanceof THREE.MeshFaceMaterial||e.material instanceof THREE.MultiMaterial?r=e.material.materials:e.material instanceof Array&&(r=e.material),r?r.forEach(function(e,t){e.map&&e.map.dispose(),e.lightMap&&e.lightMap.dispose(),e.bumpMap&&e.bumpMap.dispose(),e.normalMap&&e.normalMap.dispose(),e.specularMap&&e.specularMap.dispose(),e.envMap&&e.envMap.dispose(),e.dispose()}):(e.material.map&&e.material.map.dispose(),e.material.lightMap&&e.material.lightMap.dispose(),e.material.bumpMap&&e.material.bumpMap.dispose(),e.material.normalMap&&e.material.normalMap.dispose(),e.material.specularMap&&e.material.specularMap.dispose(),e.material.envMap&&e.material.envMap.dispose(),e.material.dispose())}}}},{key:"initModel",value:function(){if(null!==this.props.selectedModelDir){var e=[this.props.selectedModelDir,this.props.selectedModelFile],t=e[0],r=e[1],o=ReactDOM.findDOMNode(this),s=o.offsetHeight,n=o.offsetWidth;(g=new THREE.Scene).background=new THREE.Color(this.props.bgColor),$$log("Rendering model "+t+"/"+r);var a=PP64.utils.FORM.unpack(PP64.fs.mainfs.get(t,r));$$log("form",a);var l=new PP64.utils.FormToThreeJs;l.bgColor=this.props.bgColor,l.showTextures=this.props.showTextures,l.showWireframe=this.props.showWireframe,l.showVertexNormals=this.props.showVertexNormals,l.useFormCamera=this.props.useCamera;var i=l.createModel(a);if(g.add(i),this.props.showVertexNormals){var c=new THREE.VertexNormalsHelper(i,8,65280,1);g.add(c)}if($$log("Scene",g),null!==this.props.selectedAnimDir){var u=[this.props.selectedAnimDir,this.props.selectedAnimFile],d=u[0],h=u[1],p=PP64.utils.MTNX.unpack(PP64.fs.mainfs.get(d,h));$$log("mtnx",p);var m=new PP64.utils.MtnxToThreeJs;m.form=a;var f=m.createClip(p);$$log("mtnxClip",f),(w=new THREE.AnimationMixer(g)).clipAction(f).play(),M=new THREE.Clock}(v=new THREE.WebGLRenderer({antialias:!0})).setSize(n,s),o.appendChild(v.domElement),C=l.createCamera(a,n,s),y=new THREE.OrbitControls(C,v.domElement),this.animate()}}},{key:"renderModel",value:function(){v.render(g,C)}},{key:"animate",value:function(){if(t&&v){if(y.update(),M){var e=M.getDelta();w&&w.update(e)}t.renderModel(),PP64.settings.get($setting.limitModelFPS)?r=setTimeout(function(){t&&requestAnimationFrame(t.animate)},1e3/30):requestAnimationFrame(t.animate)}}}]),a}(),s=function(e){function a(){var e,t,r;_classCallCheck(this,a);for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];return(t=r=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(s)))).state={},r.focusModelSelect=function(){r.modelSelect&&r.modelSelect.focus()},r.focusAnimSelect=function(){r.animSelect&&r.animSelect.focus()},_possibleConstructorReturn(r,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t=this;return React.createElement("div",{className:"modelViewerToolbar"},React.createElement(n,{ref:function(e){t.modelSelect=e},selectedModel:this.props.selectedModel,onModelSelected:this.props.onModelSelected}),React.createElement(l,{ref:function(e){t.animSelect=e},selectedAnim:this.props.selectedAnim,selectedModelDir:this.props.selectedModelDir,onAnimSelected:this.props.onAnimSelected}),React.createElement(i,{selectedColor:this.props.bgColor,onColorChange:this.props.onBgColorChange}),React.createElement(c,{showTextures:this.props.showTextures,showWireframe:this.props.showWireframe,showVertexNormals:this.props.showVertexNormals,useCamera:this.props.useCamera,onFeatureChange:this.props.onFeatureChange}),React.createElement("div",{className:"modelViewerToolbarSpacer"}),React.createElement(u,{selectedModelDir:this.props.selectedModelDir,selectedModelFile:this.props.selectedModelFile}))}}]),a}(),n=function(e){function a(){var e,t,r;_classCallCheck(this,a);for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];return(t=r=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(s)))).state={},r.focus=function(){r.selectEl&&r.selectEl.focus()},r.modelSelected=function(e){r.props.onModelSelected&&r.props.onModelSelected(e.target.value)},_possibleConstructorReturn(r,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t=this,e=this.getModelEntries().map(function(e){return React.createElement("option",{value:e,key:e},e)});return React.createElement("div",{className:"modelSelectContainer"},"Model:",React.createElement("select",{ref:function(e){t.selectEl=e},value:this.props.selectedModel,onChange:this.modelSelected},e))}},{key:"getModelEntries",value:function(){for(var e=[],t=PP64.fs.mainfs.getDirectoryCount(),r=0;r<t;r++)for(var o=PP64.fs.mainfs.getFileCount(r),s=0;s<o;s++){var n=PP64.fs.mainfs.get(r,s);if(PP64.utils.FORM.isForm(n)){var a=r+"/"+s;try{e.push(a)}catch(e){console.error("Could not parse FORM "+r+"/"+s,e)}}}return e}}]),a}(),l=function(e){function a(){var e,t,r;_classCallCheck(this,a);for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];return(t=r=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(s)))).state={},r.focus=function(){r.selectEl&&r.selectEl.focus()},r.animSelected=function(e){r.props.onAnimSelected&&r.props.onAnimSelected(e.target.value)},_possibleConstructorReturn(r,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t=this,e=this.getAnimEntries().map(function(e){return React.createElement("option",{value:e,key:e},e)});return e.unshift(React.createElement("option",{value:"",key:""})),React.createElement("div",{className:"modelSelectContainer"},"Animation:",React.createElement("select",{ref:function(e){t.selectEl=e},value:this.props.selectedAnim,onChange:this.animSelected},e))}},{key:"getAnimEntries",value:function(){var e=[];if(null===this.props.selectedModelDir)return e;if(PP64.settings.get($setting.limitModelAnimations))return this.getAnimationsInDir(this.props.selectedModelDir);for(var t=PP64.fs.mainfs.getDirectoryCount(),r=0;r<t;r++)e=e.concat(this.getAnimationsInDir(r));return e}},{key:"getAnimationsInDir",value:function(t){for(var e=[],r=PP64.fs.mainfs.getFileCount(t),o=0;o<r;o++){var s=PP64.fs.mainfs.get(t,o);if(PP64.utils.MTNX.isMtnx(s)){var n=t+"/"+o;try{e.push(n)}catch(e){console.error("Could not parse MTNX "+t+"/"+o,e)}}}return e}}]),a}(),i=function(e){function a(){var e,t,r;_classCallCheck(this,a);for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];return(t=r=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(s)))).state={},r.onColorChange=function(e,t){r.setState({color:e}),r.props.onColorChange(e)},_possibleConstructorReturn(r,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var e=PP64.controls.ToggleButton,t=void 0;return $$debug&&(t=React.createElement(e,{id:13035519,key:2,allowDeselect:!1,onToggled:this.onColorChange,pressed:13035519===this.props.selectedColor},React.createElement("span",{className:"colorSwatch",title:"Change background to MP3 motion test (0xC6E7FF)",style:{backgroundColor:"#C6E7FF"}}))),React.createElement("div",{className:"modelViewerColorPicker"},React.createElement(e,{id:0,key:0,allowDeselect:!1,onToggled:this.onColorChange,pressed:0===this.props.selectedColor},React.createElement("span",{className:"colorSwatch",title:"Change background to black",style:{backgroundColor:"#000000"}})),React.createElement(e,{id:16777215,key:1,allowDeselect:!1,onToggled:this.onColorChange,pressed:16777215===this.props.selectedColor},React.createElement("span",{className:"colorSwatch",title:"Change background to white",style:{backgroundColor:"#FFFFFF"}})),t)}}]),a}(),c=function(e){function a(){var e,t,r;_classCallCheck(this,a);for(var o=arguments.length,s=Array(o),n=0;n<o;n++)s[n]=arguments[n];return(t=r=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(s)))).state={},r.onShowTextureChange=function(e){var t=e.target.checked;t||r.props.showWireframe?r.props.onFeatureChange({showTextures:t}):r.props.onFeatureChange({showTextures:t,showWireframe:!0})},r.onShowWireframeChange=function(e){var t=e.target.checked;t||r.props.showTextures?r.props.onFeatureChange({showWireframe:t}):r.props.onFeatureChange({showTextures:!0,showWireframe:t})},r.onShowNormalsChange=function(e){var t=e.target.checked;r.props.onFeatureChange({showVertexNormals:t})},r.onUseCameraChange=function(e){var t=e.target.checked;r.props.onFeatureChange({useCamera:t})},_possibleConstructorReturn(r,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var e=void 0;return PP64.settings.get($setting.uiAdvanced)&&(e=[React.createElement("label",{key:"modelFeatureSelectShowVertexNormals"},React.createElement("input",{type:"checkbox",checked:this.props.showVertexNormals,onChange:this.onShowNormalsChange}),"Vertex Normals")]),React.createElement("div",{className:"modelFeatureSelectContainer"},React.createElement("label",{key:"modelFeatureSelectShowTextures"},React.createElement("input",{type:"checkbox",checked:this.props.showTextures,onChange:this.onShowTextureChange}),"Textures"),React.createElement("label",{key:"modelFeatureSelectShowWireframe"},React.createElement("input",{type:"checkbox",checked:this.props.showWireframe,onChange:this.onShowWireframeChange}),"Wireframe"),React.createElement("label",{key:"modelFeatureSelectUseCamera",title:"Use the camera defined by the model"},React.createElement("input",{type:"checkbox",checked:this.props.useCamera,onChange:this.onUseCameraChange}),"Camera"),e)}}]),a}(),u=function(e){function a(){var e,t,n;_classCallCheck(this,a);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return(t=n=_possibleConstructorReturn(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(o)))).state={},n.export=function(){var e=[n.props.selectedModelDir,n.props.selectedModelFile],t=e[0],r=e[1],o=PP64.utils.FORM.unpack(PP64.fs.mainfs.get(t,r)),s=(new PP64.utils.FormToThreeJs).createModel(o);GLTFUtils.exportGLTF(GLTFUtils.glTFAssetFromTHREE(s),{jsZip:JSZip}).then(function(e){saveAs(e,"model-"+t+"-"+r+".zip")})},_possibleConstructorReturn(n,t)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var e=PP64.controls.Button;return React.createElement(e,{onClick:this.export,css:"btnModelExport"},React.createElement("img",{src:"img/model/export.png",height:"16",width:"16"}),"glTF")}}]),a}();return{ModelViewer:e}}();
"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("events"),Object.assign(PP64.events,function(){var t=void 0,e=function(e){function n(e){_classCallCheck(this,n);var t=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.onDeleteEvent=function(e){window.confirm("Are you sure you want to delete "+e.name+"?")&&(PP64.adapters.events.removeEvent(e.id),t.forceUpdate())},t.state={hasError:!1},t}return _inherits(n,React.Component),_createClass(n,[{key:"render",value:function(){var t=this;if(this.state.hasError)return React.createElement("p",null,"An error was encountered.");var e=null,n=PP64.adapters.events.getCustomEvents();e=n.length?n.map(function(e){return React.createElement(r,{key:e.id,event:e,onDeleteEvent:t.onDeleteEvent})}):React.createElement("tr",null,React.createElement("td",null,"No custom events present ‚Äî load or create your own!"));PP64.controls.Button;return React.createElement("div",{className:"eventsViewContainer"},React.createElement("h3",null,"Events"),React.createElement("table",{className:"eventsViewTable"},Array.isArray(e)?React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"eventsViewTableIconColumn"}),React.createElement("th",{className:"eventsViewTableIconColumn"}),React.createElement("th",null))):null,React.createElement("tbody",null,e)))}},{key:"componentDidMount",value:function(){t=this}},{key:"componentWillUnmount",value:function(){t=null}},{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0}),console.error(e)}}]),n}(),r=function(e){function l(){var e,t,n;_classCallCheck(this,l);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=n=_possibleConstructorReturn(this,(e=l.__proto__||Object.getPrototypeOf(l)).call.apply(e,[this].concat(a)))).onEditEvent=function(){PP64.app.changeCurrentEvent(n.props.event),PP64.app.changeView($viewType.CREATEEVENT)},n.onExportEvent=function(){var e=n.props.event,t=new Blob([e.asm]);saveAs(t,e.name+".s")},_possibleConstructorReturn(n,t)}return _inherits(l,React.Component),_createClass(l,[{key:"render",value:function(){var e=this;return React.createElement("tr",{className:"eventTableRow"},React.createElement("td",null,React.createElement("img",{src:"img/events/delete.png",alt:"Delete event",title:"Delete event",onClick:function(){e.props.onDeleteEvent(e.props.event)}})),React.createElement("td",null,React.createElement("img",{src:"img/events/export.png",alt:"Download event code",title:"Download event code",onClick:this.onExportEvent})),React.createElement("td",{className:"eventNameTableCell",onClick:this.onEditEvent},React.createElement("span",{className:"eventNameText"},this.props.event.name),React.createElement("img",{src:"img/events/edit.png",className:"eventEditCellIcon",alt:"Edit event",title:"Edit event"})))}}]),l}();return{EventsView:e,refreshEventsView:function(){t&&t.forceUpdate()}}}());
"use strict";var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},_createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("events"),Object.assign(PP64.events,function(){var r=void 0,e=function(e){function a(e){_classCallCheck(this,a);var s=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));s.onEventNameChange=function(e){var t=_extends({},s.state,{eventName:e});s.setState({eventName:e}),s.syncTextToStateVars(t,s.state.asm)},s.onAsmChange=function(e){s.setState({asm:e}),s.syncStateVarsToText(e)},s.onGameToggleClicked=function(e,t){var a=s.state.supportedGames,n=a.indexOf(e),r=void 0;-1===n&&t?(s.setState({supportedGames:[].concat(_toConsumableArray(a),[e])}),(r=_extends({},s.state)).supportedGames=[].concat(_toConsumableArray(a),[e])):0<=n&&!t&&(a.splice(n,1),s.setState({supportedGames:a}),(r=_extends({},s.state)).supportedGames=a),r&&s.syncTextToStateVars(r,s.state.asm)},s.onExecTypeToggleClicked=function(e,t){var a=_extends({},s.state);a.executionType=e,s.setState({executionType:e}),s.syncTextToStateVars(a,s.state.asm)},s.onAddEventParameter=function(e){var t=_extends({},s.state);t.parameters=[].concat(_toConsumableArray(s.state.parameters),[e]),s.setState(t),s.syncTextToStateVars(t,s.state.asm)},s.onRemoveEventParameter=function(t){var e=_extends({},s.state);e.parameters=s.state.parameters.filter(function(e){return e.name!==t.name}),s.setState(e),s.syncTextToStateVars(e,s.state.asm)},s.getEventName=function(){return s.state.eventName},s.getSupportedGames=function(){return s.state.supportedGames},s.getExecutionType=function(){return s.state.executionType},s.getEventAsm=function(){return s.state.asm},s.syncTextToStateVars=function(e,t){var a=s.__clearDiscreteProperties(t,["NAME","GAMES","EXECUTION","PARAM"]);a="\n"+a,a=s.__writeDiscretePropertyArray(a,"PARAM",e.parameters.map(function(e){return e.type+"|"+e.name})),a=s.__writeDiscreteProperty(a,"EXECUTION",PP64.types.getExecutionTypeName(e.executionType)),a=s.__writeDiscreteProperty(a,"GAMES",e.supportedGames.map(PP64.types.getGameName).join(",")),(a=s.__writeDiscreteProperty(a,"NAME",e.eventName.trim()))!==t&&s.setState({asm:a})},s.syncStateVarsToText=function(e){var t=s.__readDiscreteProperty(e,"NAME");null!==t&&s.setState({eventName:(t||"").trim()}),null!==(t=PP64.adapters.events.CustomAsmHelper.readSupportedGames(e))&&s.setState({supportedGames:t}),(t=PP64.adapters.events.CustomAsmHelper.readExecutionType(e))&&s.setState({executionType:t}),(t=PP64.adapters.events.CustomAsmHelper.readParameters(e))&&s.setState({parameters:t})},s.promptExit=function(){var e=s.state.asm,t=PP64.adapters.events.getEvent(s.state.eventName.toUpperCase());return!(!t||t.asm&&t.asm!==e)||!!window.confirm("Are you sure you want to exit without saving the event?")};var t=PP64.app.getCurrentEvent();return s.state=t?{eventName:t.name,supportedGames:t.supportedGames,executionType:t.executionType,asm:t.asm,parameters:t.parameters}:{eventName:"",supportedGames:[],executionType:$executionType.DIRECT,asm:"; NAME:\n; GAMES:\n; EXECUTION: Direct\n\nADDIU SP SP -4\nSW RA 0(SP)\n\n; Your code here\n\nLW RA 0(SP)\nJR RA\nADDIU SP SP 4",parameters:[]},s}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var t=this;if(this.state.hasError)return React.createElement("p",null,"An error was encountered.");var e=PP64.components.CodeMirrorWrapper;return React.createElement("div",{className:"createEventViewContainer"},React.createElement(e,{ref:function(e){t._codemirror=e},className:"eventcodemirror",value:this.state.asm,onChange:this.onAsmChange}),React.createElement(n,{name:this.state.eventName,onEventNameChange:this.onEventNameChange,supportedGames:this.state.supportedGames,onGameToggleClicked:this.onGameToggleClicked,executionType:this.state.executionType,onExecTypeToggleClicked:this.onExecTypeToggleClicked,parameters:this.state.parameters,onAddEventParameter:this.onAddEventParameter,onRemoveEventParameter:this.onRemoveEventParameter}))}},{key:"componentDidMount",value:function(){r=this}},{key:"componentWillUnmount",value:function(){r=null}},{key:"__clearDiscreteProperties",value:function(a,e){return e.forEach(function(e){var t=new RegExp("^\\s*[;\\/]+\\s*"+e+":.*[\r\n]*","gim");a=a.replace(t,"")}),a}},{key:"__writeDiscreteProperty",value:function(e,t,a){return"; "+t+": "+a+"\n"+e}},{key:"__writeDiscretePropertyArray",value:function(e,t,a){for(var n=a.length-1;0<=n;n--)e="; "+t+": "+a[n]+"\n"+e;return e}},{key:"__readDiscreteProperty",value:function(e,t){return PP64.adapters.events.CustomAsmHelper.readDiscreteProperty(e,t)}}]),a}(),n=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.onEventNameChange=function(e){t.props.onEventNameChange(e.target.value)},t._gameSupported=function(e){return 0<=t.props.supportedGames.indexOf(e)},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var e=[{id:$gameType.MP1_USA,text:"MP1 USA",selected:this._gameSupported($gameType.MP1_USA)},{id:$gameType.MP2_USA,text:"MP2 USA",selected:this._gameSupported($gameType.MP2_USA)},{id:$gameType.MP3_USA,text:"MP3 USA",selected:this._gameSupported($gameType.MP3_USA)},{id:$gameType.MP1_JPN,text:"MP1 JPN",selected:this._gameSupported($gameType.MP1_JPN)},{id:$gameType.MP2_JPN,text:"MP2 JPN",selected:this._gameSupported($gameType.MP2_JPN)},{id:$gameType.MP3_JPN,text:"MP3 JPN",selected:this._gameSupported($gameType.MP3_JPN)},{id:$gameType.MP1_PAL,text:"MP1 PAL",selected:this._gameSupported($gameType.MP1_PAL)},{id:$gameType.MP2_PAL,text:"MP2 PAL",selected:this._gameSupported($gameType.MP2_PAL)},{id:$gameType.MP3_PAL,text:"MP3 PAL",selected:this._gameSupported($gameType.MP3_PAL)}],t=[{id:1,text:"Direct",title:"The game will execute the event function directly",selected:this.props.executionType===$executionType.DIRECT},{id:2,text:"Process",title:"The game will use its process system when executing the event function",selected:this.props.executionType===$executionType.PROCESS}],a=PP64.controls.ToggleGroup;return React.createElement("div",{className:"createEventForm"},React.createElement("label",null,"Name:"),React.createElement("input",{value:this.props.name,onChange:this.onEventNameChange}),React.createElement("br",null),React.createElement("br",null),React.createElement("label",null,"Supported Games:"),React.createElement(a,{items:e,groupCssClass:"createEventGameToggles",onToggleClick:this.props.onGameToggleClicked}),React.createElement("br",null),React.createElement("label",null,"Execution Type:"),React.createElement(a,{items:t,allowDeselect:!1,onToggleClick:this.props.onExecTypeToggleClicked}),React.createElement("br",null),React.createElement("label",null,"Parameters:"),React.createElement(s,{parameters:this.props.parameters,onAddEventParameter:this.props.onAddEventParameter,onRemoveEventParameter:this.props.onRemoveEventParameter}))}}]),a}(),s=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this,e=this.props.parameters.map(function(e){return React.createElement(a,{entry:e,key:e.name,onRemoveEntry:t.props.onRemoveEventParameter})});return React.createElement("div",{className:"eventParametersList"},React.createElement("table",null,React.createElement("tbody",null,e)),React.createElement(o,{onAddEntry:this.props.onAddEventParameter}))}}]),t}(),a=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.onDeleteClick=function(){t.props.onRemoveEntry(t.props.entry)},t}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var e=this.props.entry,t=e.type,a=e.name;return React.createElement("tr",{className:"eventParameterEntry"},React.createElement("td",{className:"eventParameterEntryType"},t),React.createElement("td",{className:"eventParameterEntryName",title:a},a),React.createElement("td",{className:"eventParameterEntryDelete"},React.createElement("img",{src:"img/events/delete.png",alt:"Delete",onClick:this.onDeleteClick})))}}]),a}(),o=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(r)))).state={selectedType:"",name:""},a.onNameChange=function(e){var t=e.target.value;t.match(PP64.adapters.events.CustomAsmHelper.validParameterNameRegex)&&a.setState({name:t})},a.onTypeChange=function(e){a.setState({selectedType:e.target.value})},a.onAddClick=function(){a.state.name&&a.state.selectedType&&(a.props.onAddEntry({name:a.state.name,type:a.state.selectedType}),a.setState({name:"",selectedType:""}))},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var e=PP64.controls.Button;return React.createElement("div",{className:"eventParameterAddNewEntry"},React.createElement("select",{value:this.state.selectedType,onChange:this.onTypeChange},React.createElement("option",null),React.createElement("option",{value:"Boolean"},"Boolean"),React.createElement("option",{value:"Number"},"Number"),React.createElement("option",{value:"+Number"},"Positive Number"),React.createElement("option",{value:"Space"},"Space")),React.createElement("input",{type:"text",placeholder:"Name",value:this.state.name,onChange:this.onNameChange}),React.createElement(e,{onClick:this.onAddClick},"Add"))}}]),o}();return{CreateEventView:e,saveEvent:function(){var e=r.getEventName(),t=r.getSupportedGames(),a=(r.getExecutionType(),r.getEventAsm());if(e){var n=PP64.adapters.events.getEvent(e);if(!n||n.custom)if(t.length)if(a)try{PP64.adapters.events.createCustomEvent(a)}catch(e){PP64.app.showMessage(e.toString())}else PP64.app.showMessage("No assembly code was provided.");else PP64.app.showMessage("At least one game must be supported.");else PP64.app.showMessage("The event name collides with a reserved event name from the original boards.")}else PP64.app.showMessage("An event name must be specified.")},createEventPromptExit:function(){if(r)return r.promptExit()},getActiveEditorSupportedGames:function(){return r?r.getSupportedGames():[]}}}());
"use strict";var _createClass=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("fs"),PP64.fs.strings=function(){var t={};function e(){var t=PP64.romhandler.getDataView(),e=f();if(!e)return null;var r=e[0];if(!r)return null;var n=t.getUint16(r.upper)<<16,i=t.getUint16(r.lower),a=n|i;if(32768&i&&(a-=65536),$$log("Strings.getROMOffset -> "+$$hex(a)),$$debug)for(var u=1;u<e.length;u++){var o=t.getUint16(e[u].upper)<<16,s=t.getUint16(e[u].lower);if(o!==n||s!==i)throw"Strings.getROMOffset patch offset "+u+" seems wrong"}return a}function f(){return t[PP64.romhandler.getROMGame()]}t[$gameType.MP1_USA]=[{upper:110190,lower:110198}],t[$gameType.MP1_JPN]=[{upper:109982,lower:109990}],t[$gameType.MP2_USA]=[{upper:119338,lower:119346},{upper:562006,lower:562014},{upper:562026,lower:562034}];var r=function(){function e(t){_classCallCheck(this,e),this.strs=this._extract(t)}return _createClass(e,[{key:"_extract",value:function(t){for(var e=this._getStringCountFromView(t),r=new Array(e),n=0;n<e;n++)r[n]=this._readFromView(t,n);return r}},{key:"_getStringCountFromView",value:function(t){return t.getUint32(0)}},{key:"_readFromView",value:function(t,e){var r=this._getStringOffsetFromView(t,e),n=new DataView(t.buffer,t.byteOffset+r).getUint16(0);return t.buffer.slice(t.byteOffset+r+2,t.byteOffset+r+2+n)}},{key:"_getStringOffsetFromView",value:function(t,e){return t.getUint32(4*(1+e))}},{key:"read",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(t>=this.getStringCount())throw"Requesting non-existent string entry";var r=this.strs[t];if(e)return r;for(var n=new DataView(r),i="",a=0;a<r.byteLength;a++)i+=this._byteToStr(n.getUint8(a));return i}},{key:"_byteToStr",value:function(t){var e=PP64.adapters.getROMAdapter().getCharacterMap();return e.hasOwnProperty(t)?e[t]:String.fromCharCode(t)}},{key:"write",value:function(t,e){this.strs[t]=e.slice(0)}},{key:"getStringCount",value:function(){return this.strs.length}},{key:"getByteLength",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=0,r=this.strs.length;e+=4,e+=4*r;for(var n=0;n<r;n++)e+=2,e+=this.strs[n].byteLength,e=$$number.makeDivisibleBy(e,2);return t&&(e+=e/8+16),e}},{key:"pack",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(t,e),n=this.getStringCount();r.setUint32(0,n);for(var i=4,a=4+4*n,u=0;u<n;u++)r.setUint32(i,a),i+=4,a=this._packStr(u,r,a),a=$$number.makeDivisibleBy(a,2);return a}},{key:"_packStr",value:function(t,e,r){var n=this.strs[t];return e.setUint16(r,n.byteLength),PP64.utils.arrays.copyRange(e,n,r+2,0,n.byteLength),r+2+n.byteLength}}]),e}();var n=void 0;function i(){var t=PP64.romhandler.getDataView(e());return n=new r(t)}return{extract:i,extractAsync:function(){return new Promise(function(t,e){i(),t()})},pack:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return n.pack(t,e)},read:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return n.read(t,e)},write:function(t,e){n.write(t,e)},clear:function(){n=null},getByteLength:function(){return n.getByteLength()},getStringCount:function(){return n.getStringCount()},getROMOffset:e,setROMOffset:function(t,e){var r=new DataView(e),n=f(),i=(4294901760&t)>>>16,a=65535&t;32768&a&&(i+=1);for(var u=0;u<n.length;u++)r.setUint16(n[u].upper,i),r.setUint16(n[u].lower,a);$$log("Strings.setROMOffset -> "+$$hex(i<<16|a))},getPatchOffsets:f,_strToBytes:function(t){for(var e=PP64.adapters.getROMAdapter().getCharacterMap(),r=[],n=[0,t.length],i=n[0],a=n[1];i<a;){var u=0,o=void 0;for(var s in e)if(e.hasOwnProperty(s)){var f=e[s];t.substr(i,f.length)===f&&f.length>u&&(u=f.length,o=s)}0===u&&(u=1,o=t.charCodeAt(i)),"string"==typeof o&&(o=parseInt(o)),r.push(o),i+=u}return r},StringTable:r}}();
"use strict";var _createClass=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.ns("strings"),PP64.strings=Object.assign(function(){var t=function(t){function r(t){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return e.state={hasError:!1},e}return _inherits(r,React.Component),_createClass(r,[{key:"render",value:function(){if(this.state.hasError)return React.createElement("p",null,"An error was encountered.");var t=[],e=void 0;e=3===PP64.romhandler.getGameVersion()?PP64.fs.strings3.getStringCount("en",0):PP64.fs.strings.getStringCount();for(var r=0;r<e;r++)t.push(React.createElement(n,{strIndex:r}));return React.createElement("div",{className:"stringViewerContainer"},React.createElement("p",null,"This is an experimental strings editor, probably doesn't work yet."),t)}},{key:"componentDidCatch",value:function(t,e){this.setState({hasError:!0}),console.error(t)}}]),r}(),n=function(t){function a(){var t,e,n;_classCallCheck(this,a);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return(e=n=_possibleConstructorReturn(this,(t=a.__proto__||Object.getPrototypeOf(a)).call.apply(t,[this].concat(o)))).state={hasFocus:!1},n.onValueChanged=function(t,e){if(3!==PP64.romhandler.getGameVersion()){var r=PP64.utils.arrays.arrayToArrayBuffer(PP64.fs.strings._strToBytes(e));PP64.fs.strings.write(n.props.strIndex,r)}},n.onFocus=function(t){n.setState({hasFocus:!0})},n.onBlur=function(t){n.setState({hasFocus:!1})},_possibleConstructorReturn(n,e)}return _inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){var e=this,t=void 0;return t=3===PP64.romhandler.getGameVersion()?PP64.fs.strings3.read("en",0,this.props.strIndex):PP64.fs.strings.read(this.props.strIndex),React.createElement(PP64.texteditor.MPEditor,{ref:function(t){e.editor=t},value:t,displayMode:PP64.texteditor.MPEditorDisplayMode.Edit,showToolbar:!0,toolbarPlacement:PP64.texteditor.MPEditorToolbarPlacement.Top,onValueChange:this.onValueChanged,onFocus:this.onFocus,onBlur:this.onBlur})}},{key:"componentDidMount",value:function(){this.state.hasFocus&&this.editor.focus()}},{key:"componentDidUpdate",value:function(){this.state.hasFocus&&this.editor.focus()}}]),a}();!function(t){function a(){var t,e,r;_classCallCheck(this,a);for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=r=_possibleConstructorReturn(this,(t=a.__proto__||Object.getPrototypeOf(a)).call.apply(t,[this].concat(o)))).state={},_possibleConstructorReturn(r,e)}_inherits(a,React.Component),_createClass(a,[{key:"render",value:function(){return React.createElement("div",{className:"stringEditorToolbar"})}}])}();return{StringsViewer:t}}());
"use strict";var _createClass=function(){function l(e,a){for(var t=0;t<a.length;t++){var l=a[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(e,a,t){return a&&l(e.prototype,a),t&&l(e,t),e}}();function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}PP64.spaces=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"drawUnknown",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.fillStyle="orange",e.lineWidth=2,e.stroke(),e.fill(),e.restore()}},{key:"drawOther",value:function(e,a,t){PP64.spaces._drawOther(e,a,t,8)}},{key:"drawOther3",value:function(e,a,t){PP64.spaces._drawOther(e,a,t,12)}},{key:"_drawOther",value:function(e,a,t,l){e.save(),e.beginPath(),e.arc(a,t,l,0,2*Math.PI),e.lineWidth=l/6,e.strokeStyle="rgba(255, 255, 255, 0.4)",e.stroke(),e.lineWidth=l/4,e.fillStyle="rgba(255, 255, 255, 0.2)",e.strokeStyle="black",e.setLineDash([l/2,3]),e.stroke(),e.fill(),e.restore()}},{key:"drawBlue",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#0039ff",e.strokeStyle="#001281",e.stroke(),e.fill(),e.restore()}},{key:"drawBlue3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceBlue3"),a-14,t-14),e.restore()}},{key:"drawRed",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#ff3131",e.strokeStyle="#611515",e.stroke(),e.fill(),e.restore()}},{key:"drawRed3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceRed3"),a-14,t-14),e.restore()}},{key:"drawMiniGame",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#0039ff",e.strokeStyle="#001281",e.stroke(),e.fill(),e.fillStyle="#A4FFFF",PP64.spaces._drawStar(e,a,t,8,5,.45),e.restore()}},{key:"drawMiniGameDuel3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceMiniGameDuel3"),a-14,t-14),e.restore()}},{key:"drawHappening",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#099f0a",e.strokeStyle="#2e681e",e.stroke(),e.fill(),e.fillStyle="white",e.font="bold 19px monospace",e.fillText("?",a-6,t+6),e.restore()}},{key:"drawHappening3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceHappening3"),a-14,t-14),e.restore()}},{key:"drawHappeningDuel3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceHappeningDuel3"),a-14,t-14),e.restore()}},{key:"drawStar",value:function(e,a,t){PP64.spaces._drawStarSpace(e,a,t,8)}},{key:"drawStar3",value:function(e,a,t){PP64.spaces._drawStarSpace(e,a,t,12)}},{key:"_drawStarSpace",value:function(e,a,t,l){e.save(),e.beginPath(),e.arc(a,t,l,0,2*Math.PI),e.lineWidth=l/8,e.fillStyle="rgba(0, 0, 0, 0.2)",e.strokeStyle="rgba(0, 0, 0, 0.3)",e.stroke(),e.fill(),e.fillStyle="yellow",PP64.spaces._drawStar(e,a,t,l+1,5,.45),e.restore()}},{key:"drawChance",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#0039ff",e.strokeStyle="#001281",e.stroke(),e.fill(),e.fillStyle="#ff3131",e.font="bold 19px monospace",e.fillText("!",a-6,t+6),e.restore()}},{key:"drawChance2",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#099f0a",e.strokeStyle="#2e681e",e.stroke(),e.fill(),e.fillStyle="white",e.font="bold 19px monospace",e.fillText("!",a-6,t+6),e.restore()}},{key:"drawChance3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceChance3"),a-14,t-14),e.restore()}},{key:"drawStart",value:function(e,a,t){PP64.spaces._drawStart(e,a,t,8,"black")}},{key:"drawStart3",value:function(e,a,t){PP64.spaces._drawStart(e,a,t,12,"black")}},{key:"drawStartDuelRed",value:function(e,a,t){PP64.spaces._drawStart(e,a,t,12,"red")}},{key:"drawStartDuelBlue",value:function(e,a,t){PP64.spaces._drawStart(e,a,t,12,"blue")}},{key:"_drawStart",value:function(e,a,t,l,r){e.save(),e.beginPath(),e.arc(a,t,l,0,2*Math.PI),e.lineWidth=1,e.fillStyle=r,e.strokeStyle="rgba(255, 255, 255, 0.5)",e.stroke(),e.fill(),e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2,e.font="bold 12px monospace",e.textAlign="center",e.strokeText("START",a,t+12),e.fillText("START",a,t+12),e.restore()}},{key:"drawShroom",value:function(e,a,t){e.save(),e.beginPath(),e.ellipse?e.ellipse(a,t,8,6,0,0,2*Math.PI):e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#0039ff",e.strokeStyle="#001281",e.stroke(),e.fill(),e.beginPath(),e.fillStyle="#D3FDFC",e.arc(a,t+5,4,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(a-5,t,2,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(a+5,t,2,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(a,t-2,3,0,2*Math.PI),e.fill(),e.restore()}},{key:"drawBowser",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceBowser"),a-9,t-9),e.restore()}},{key:"drawBowser3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceBowser3"),a-14,t-14),e.restore()}},{key:"drawItem2",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceItem2"),a-9,t-9),e.restore()}},{key:"drawItem3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceItem3"),a-14,t-14),e.restore()}},{key:"drawBattle2",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#099f0a",e.strokeStyle="#2e681e",e.stroke(),e.fill(),e.beginPath(),e.fillStyle="white",e.translate(a-10,t-10),e.moveTo(14,3),e.lineTo(4,11),e.lineTo(9,11),e.lineTo(7,18),e.lineTo(16,9),e.lineTo(12,9),e.lineTo(14,3),e.fill(),e.restore()}},{key:"drawBattle3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceBattle3"),a-14,t-14),e.restore()}},{key:"drawBank2",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=2,e.fillStyle="#099f0a",e.strokeStyle="#2e681e",e.stroke(),e.fill(),e.fillStyle="#EEF700",e.translate(a-10,t-10),e.beginPath(),e.arc(10,12,5,0,2*Math.PI),e.fill(),e.beginPath(),e.moveTo(8,7),e.lineTo(7,5),e.lineTo(8,4),e.lineTo(12,4),e.lineTo(13,5),e.lineTo(12,7),e.fill(),e.fillStyle="#099f0a",PP64.spaces._drawStar(e,10,12,4,5,.45),e.restore()}},{key:"drawBank3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceBank3"),a-14,t-14),e.restore()}},{key:"drawArrow",value:function(e,a,t,l){e.save(),e.beginPath(),e.fillStyle="#F647A0",e.strokeStyle="#94305B",3===l?(e.translate(a-12,t-12),e.scale(1.25,1.25)):e.translate(a-10,t-10),e.moveTo(10,1),e.lineTo(1,10),e.lineTo(5,10),e.lineTo(5,18),e.lineTo(15,18),e.lineTo(15,10),e.lineTo(19,10),e.lineTo(10,1),e.stroke(),e.fill(),e.restore()}},{key:"drawBlackStar2",value:function(e,a,t){e.save(),e.beginPath(),e.arc(a,t,8,0,2*Math.PI),e.lineWidth=1,e.fillStyle="rgba(0, 0, 0, 0.2)",e.strokeStyle="rgba(0, 0, 0, 0.3)",e.stroke(),e.fill(),e.fillStyle="black",PP64.spaces._drawStar(e,a,t,9,5,.45),e.restore()}},{key:"drawGameGuy3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceGameGuy3"),a-14,t-14),e.restore()}},{key:"drawGameGuyDuel3",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceGameGuyDuel3"),a-14,t-14),e.restore()}},{key:"drawDuelBasic",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceDuelBasic3"),a-14,t-14),e.restore()}},{key:"drawDuelPowerup",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceDuelPowerup3"),a-14,t-14),e.restore()}},{key:"drawDuelReverse",value:function(e,a,t){e.save(),e.drawImage(PP64.images.get("spaceDuelReverse3"),a-14,t-14),e.restore()}},{key:"_drawStar",value:function(e,a,t,l,r,i){e.save(),e.beginPath(),e.translate(a,t),e.moveTo(0,0-l);for(var n=0;n<r;n++)e.rotate(Math.PI/r),e.lineTo(0,0-l*i),e.rotate(Math.PI/r),e.lineTo(0,0-l);e.fill(),e.restore()}}]),e}();
"use strict";var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.renderer=function(){PP64.types.isKnownSpaceType;function n(e,t){var a=Math.floor((t.offsetWidth-e.bg.width)/2);a=Math.max(0,a);var r=Math.floor((t.offsetHeight-e.bg.height)/2);return"translateX("+a+"px) translateY("+(r=Math.max(0,r))+"px)"}function s(e,t,a){(!(3<arguments.length&&void 0!==arguments[3])||arguments[3])&&t.clearRect(0,0,e.width,e.height);var r=a.links=a.links||{};for(var n in r)for(var s=a.spaces[n].x,o=a.spaces[n].y,i=PP64.boards.getConnections(n,a),c=void 0,l=void 0,p=!1,u=0;u<i.length;u++)c=a.spaces[i[u]].x,l=a.spaces[i[u]].y,(p=k(r,i[u],n))&&n>i[u]||C(t,s,o,c,l,p);var d=a.spaces;if(d&&d.length)for(var h=0;h<d.length;h++){var g=d[h];if(g.events&&g.events.length)for(var f=0;f<g.events.length;f++){var P=g.events[f];if(P.parameters&&P.parameters.length)for(var m=0;m<P.parameters.length;m++){var v=P.parameters[m];if("Space"===v.type){var b=P.parameterValues&&P.parameterValues[v.name];if("number"==typeof b){var y=d[b];if(!y)continue;w(t,g.x,g.y,y.x,y.y)}}}}}}function k(e,t,a){var r=e[t];return Array.isArray(r)?0<=r.indexOf(parseInt(a)):r==a}function i(e,t,a){var r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};r&&t.clearRect(0,0,e.width,e.height);for(var s=a.game||1,o=a.type||PP64.types.BoardType.NORMAL,i=0;i<a.spaces.length;i++){var c=a.spaces[i];null!==c&&(c.z=c.z||0,l(t,c,s,o,n))}}function l(e,t,a,r){var n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},s=t.x,o=t.y,i=t.rotation,c=t.type,l=t.subtype;if("number"==typeof i){e.save(),e.translate(s,o);var p=-i;e.rotate(PP64.utils.number.degreesToRadians(p)),e.translate(-s,-o)}switch(c){case $spaceType.OTHER:if(n.skipHiddenSpaces)break;3===a?PP64.spaces.drawOther3(e,s,o):PP64.spaces.drawOther(e,s,o);break;case $spaceType.BLUE:3===a?PP64.spaces.drawBlue3(e,s,o):PP64.spaces.drawBlue(e,s,o);break;case $spaceType.RED:3===a?PP64.spaces.drawRed3(e,s,o):PP64.spaces.drawRed(e,s,o);break;case $spaceType.MINIGAME:r===PP64.types.BoardType.DUEL?PP64.spaces.drawMiniGameDuel3(e,s,o):PP64.spaces.drawMiniGame(e,s,o);break;case $spaceType.HAPPENING:3===a?r===PP64.types.BoardType.DUEL?PP64.spaces.drawHappeningDuel3(e,s,o):PP64.spaces.drawHappening3(e,s,o):PP64.spaces.drawHappening(e,s,o);break;case $spaceType.STAR:3===a?PP64.spaces.drawStar3(e,s,o):PP64.spaces.drawStar(e,s,o);break;case $spaceType.CHANCE:3===a?PP64.spaces.drawChance3(e,s,o):2===a?PP64.spaces.drawChance2(e,s,o):PP64.spaces.drawChance(e,s,o);break;case $spaceType.START:if(n.skipHiddenSpaces)break;3===a?PP64.spaces.drawStart3(e,s,o):PP64.spaces.drawStart(e,s,o);break;case $spaceType.SHROOM:PP64.spaces.drawShroom(e,s,o);break;case $spaceType.BOWSER:3===a?PP64.spaces.drawBowser3(e,s,o):PP64.spaces.drawBowser(e,s,o);break;case $spaceType.ITEM:3===a?PP64.spaces.drawItem3(e,s,o):PP64.spaces.drawItem2(e,s,o);break;case $spaceType.BATTLE:3===a?PP64.spaces.drawBattle3(e,s,o):PP64.spaces.drawBattle2(e,s,o);break;case $spaceType.BANK:3===a?PP64.spaces.drawBank3(e,s,o):PP64.spaces.drawBank2(e,s,o);break;case $spaceType.ARROW:PP64.spaces.drawArrow(e,s,o,a);break;case $spaceType.BLACKSTAR:PP64.spaces.drawBlackStar2(e,s,o);break;case $spaceType.GAMEGUY:r===PP64.types.BoardType.DUEL?PP64.spaces.drawGameGuyDuel3(e,s,o):PP64.spaces.drawGameGuy3(e,s,o);break;case $spaceType.DUEL_BASIC:PP64.spaces.drawDuelBasic(e,s,o);break;case $spaceType.DUEL_START_BLUE:if(n.skipHiddenSpaces)break;PP64.spaces.drawStartDuelBlue(e,s,o);break;case $spaceType.DUEL_START_RED:if(n.skipHiddenSpaces)break;PP64.spaces.drawStartDuelRed(e,s,o);break;case $spaceType.DUEL_POWERUP:PP64.spaces.drawDuelPowerup(e,s,o);break;case $spaceType.DUEL_REVERSE:PP64.spaces.drawDuelReverse(e,s,o);break;default:PP64.spaces.drawUnknown(e,s,o)}if("number"==typeof i&&e.restore(),n.skipCharacters||function(e,t,a,r,n){r===$spaceSubType.TOAD&&(3===n?e.drawImage(PP64.images.get("mstarImg"),t-15,a-22):e.drawImage(PP64.images.get("toadImg"),t-9,a-22));r===$spaceSubType.BOWSER&&e.drawImage(PP64.images.get("bowserImg"),t-27,a-45);r===$spaceSubType.KOOPA&&e.drawImage(PP64.images.get("koopaImg"),t-12,a-22);r===$spaceSubType.BOO&&e.drawImage(PP64.images.get("booImg"),t-13,a-17);r===$spaceSubType.GOOMBA&&e.drawImage(PP64.images.get("goombaImg"),t-8,a-12);r===$spaceSubType.BANK&&(2===n?e.drawImage(PP64.images.get("bank2Img"),t-9,a-10):e.drawImage(PP64.images.get("bank3Img"),t-17,a-20));r===$spaceSubType.BANKCOIN&&e.drawImage(PP64.images.get("bankcoinImg"),t-10,a-9);r===$spaceSubType.ITEMSHOP&&(2===n?e.drawImage(PP64.images.get("itemShop2Img"),t-9,a-10):e.drawImage(PP64.images.get("itemShop3Img"),t-16,a-20))}(e,s,o,l,a),!n.skipBadges){var u=3===a?5:2,d=3===a?16:12;if(t.events&&t.events.length){var h=o+u;c===$spaceType.START&&(h-=d),e.drawImage(function(e){if(e.events&&e.events.length)for(var t=0;t<e.events.length;t++){var a=e.events[t];if(a.parameters)for(var r=0;r<a.parameters.length;r++){var n=a.parameters[r];if(!a.parameterValues||!a.parameterValues.hasOwnProperty(n.name))return PP64.images.get("eventErrorImg")}}return PP64.images.get("eventImg")}(t),s+u,h)}if(t.star){var g=o+u;c===$spaceType.START&&(g-=d),e.drawImage(PP64.images.get("starImg"),s-u-9,g)}if(t.subtype===$spaceSubType.GATE){var f=s-u-9,P=o+u-5;e.drawImage(PP64.images.get("gateImg"),f,P)}}if($$debug){e.save();var m=PP64.boards.getSpaceIndex(t);e.fillStyle="white",e.strokeStyle="black",e.lineWidth=2,e.font="bold 6pt Courier New",e.textAlign="center";var v=m.toString();e.strokeText(v,s,o-2),e.fillText(v,s,o-2),v=$$hex(m),e.strokeText(v,s,o+8),e.fillText(v,s,o+8),e.restore()}}var p=Math.PI/1;function C(e,t,a,r,n,s){e.save(),e.beginPath(),e.strokeStyle="rgba(255, 185, 105, 0.75)",e.lineCap="round",e.lineWidth=8,e.moveTo(t,a),e.lineTo(r,n),e.stroke();var o=(t+r)/2,i=(a+n)/2;e.translate(o,i),e.rotate(-Math.atan2(t-o,a-i)+p),e.fillStyle="#A15000";var c=s?3:0;e.moveTo(-4,-2+c),e.lineTo(0,2+c),e.lineTo(4,-2+c),e.fill(),s&&(e.moveTo(-4,2-c),e.lineTo(0,-2-c),e.lineTo(4,2-c),e.fill()),e.restore()}function w(e,t,a,r,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0, 0, 0, 0.5)",e.setLineDash([1,8]),e.lineCap="round",e.lineWidth=6,e.moveTo(t,a),e.lineTo(r,n),e.stroke(),e.restore(),e.save(),e.beginPath(),e.strokeStyle="rgba(240, 240, 240, 0.5)",e.setLineDash([1,8]),e.lineCap="round",e.lineWidth=4,e.moveTo(t,a),e.lineTo(r,n),e.stroke(),e.restore()}var a=void 0,t=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){this.renderContent(),a=this}},{key:"componentWillUnmount",value:function(){a=null}},{key:"componentDidUpdate",value:function(){this.renderContent()}},{key:"renderContent",value:function(){var e=this.props.board,t=this.getImage(),a=n(e,t.parentElement);t.style.transform=a,t._src===e.bg.src&&t.width===e.bg.width&&t.height===e.bg.height||(t.width=e.bg.width,t.height=e.bg.height,this.setSource(e.bg.src,t))}},{key:"getImage",value:function(){return ReactDOM.findDOMNode(this)}},{key:"setSource",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getImage();t.src=e,t._src=e}},{key:"render",value:function(){return React.createElement("img",{className:"editor_bg"})}}]),o}(),e=void 0,r=-1;function o(){e&&clearInterval(e),e=null,r=-1,PP64.renderer.renderBG()}function c(){var e=PP64.boards.getCurrentBoard(),t=e.animbg;a&&t&&t.length?(0<=r&&r<t.length?(a.setSource(t[r]),r++):r=-1,-1===r&&(a.setSource(e.bg.src),r++)):o()}var u=void 0,d=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){this.renderContent(),u=this}},{key:"componentWillUnmount",value:function(){u=null}},{key:"componentDidUpdate",value:function(){this.renderContent()}},{key:"renderContent",value:function(){var e=ReactDOM.findDOMNode(this),t=e.parentElement,a=this.props.board,r=n(a,t);e.style.transform=r,e.width===a.bg.width&&e.height===a.bg.height||(e.width=a.bg.width,e.height=a.bg.height),s(e,e.getContext("2d"),a)}},{key:"render",value:function(){return React.createElement("canvas",{className:"editor_line_canvas"})}}]),o}(),h=void 0,g=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){this.renderContent(),h=this}},{key:"componentWillUnmount",value:function(){h=null}},{key:"componentDidUpdate",value:function(){this.renderContent()}},{key:"renderContent",value:function(){var e=ReactDOM.findDOMNode(this),t=e.parentElement,a=this.props.board,r=n(a,t);e.style.transform=r,e.width===a.bg.width&&e.height===a.bg.height||(e.width=a.bg.width,e.height=a.bg.height),function(e,t,a){if(t.clearRect(0,0,e.width,e.height),a&&a.length)for(var r=0;r<a.length;r++){var n=a[r];if(n){t.save(),t.beginPath();var s=3===PP64.boards.getCurrentBoard().game?18:12;t.arc(n.x,n.y,s,0,2*Math.PI),t.setLineDash([2,2]),t.lineWidth=2,t.fillStyle="rgba(47, 70, 95, 0.35)",t.strokeStyle="rgba(47, 70, 95, 1)",t.fill(),t.stroke(),t.restore()}}}(e,e.getContext("2d"),this.props.selectedSpaces)}},{key:"highlightSpaces",value:function(e){var t=ReactDOM.findDOMNode(this);!function(e,t,a){for(var r=PP64.boards.getCurrentBoard(),n=3===r.game?18:12,s=0;s<a.length;s++){var o=r.spaces[a[s]];o&&(t.save(),t.beginPath(),t.arc(o.x,o.y,n,0,2*Math.PI),t.shadowColor="rgba(225, 225, 225, 1)",t.shadowBlur=2,t.fillStyle="rgba(255, 0, 0, 0.85)",t.fill(),t.restore())}}(0,t.getContext("2d"),e)}},{key:"render",value:function(){return React.createElement("canvas",{className:"editor_current_space_canvas"})}}]),o}(),f=void 0,P=function(e){function o(){var e,t,s;_classCallCheck(this,o);for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];return(t=s=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(r)))).state={},s.drawSelectionBox=function(e,t,a,r){var n=ReactDOM.findDOMNode(s).getContext("2d");n.save(),n.beginPath(),n.fillStyle="rgba(47, 70, 95, 0.5)",n.strokeStyle="rgba(47, 70, 95, 1)",n.fillRect(Math.min(e,a),Math.min(t,r),Math.abs(e-a),Math.abs(t-r)),n.strokeRect(Math.min(e,a),Math.min(t,r),Math.abs(e-a),Math.abs(t-r)),n.restore()},_possibleConstructorReturn(s,t)}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){var e=ReactDOM.findDOMNode(this);PP64.interaction.attachToCanvas(e),this.renderContent(),f=this}},{key:"componentWillUnmount",value:function(){var e=ReactDOM.findDOMNode(this);PP64.interaction.detachFromCanvas(e),f=null}},{key:"componentDidUpdate",value:function(){this.renderContent()}},{key:"renderContent",value:function(){var e=ReactDOM.findDOMNode(this),t=e.parentElement,a=this.props.board,r=n(a,t);e.style.transform=r,e.width===a.bg.width&&e.height===a.bg.height||(e.width=a.bg.width,e.height=a.bg.height),i(e,e.getContext("2d"),a)}},{key:"render",value:function(){return React.createElement("canvas",{className:"editor_space_canvas",tabIndex:"-1",onDragOver:this.preventDefault})}}]),o}(),m=void 0,v=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={rightClickSpace:null},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){this.renderContent(),m=this}},{key:"componentWillUnmount",value:function(){m=null}},{key:"componentDidUpdate",value:function(){this.renderContent()}},{key:"renderContent",value:function(){var e=ReactDOM.findDOMNode(this),t=e.parentElement,a=n(this.props.board,t);e.style.transform=a}},{key:"setRightClickMenu",value:function(e){this.setState({rightClickSpace:e})}},{key:"rightClickOpen",value:function(){return!!this.state.rightClickSpace}},{key:"render",value:function(){var e=void 0;return this.rightClickOpen()&&(e=React.createElement(PP64.rightclick.RightClickMenu,{space:this.state.rightClickSpace})),React.createElement("div",{className:"editor_menu_overlay"},e)}}]),o}();return{render:function(){a&&a.renderContent(),u&&u.renderContent(),h&&h.renderContent(),f&&f.renderContent()},renderBG:function(){a&&a.renderContent()},renderConnections:function(){u&&u.renderContent()},renderSelectedSpaces:function(){h&&h.renderContent()},renderSpaces:function(){f&&f.renderContent()},updateRightClickMenu:function(e){m&&m.setRightClickMenu(e)},rightClickOpen:function(){return!!m&&m.rightClickOpen()},drawConnection:function(e,t,a,r){u&&C(ReactDOM.findDOMNode(u).getContext("2d"),e,t,a,r)},highlightSpaces:function(e){h&&h.highlightSpaces(e)},drawSelectionBox:function(e,t,a,r){f&&f.drawSelectionBox(e,t,a,r)},playAnimation:function(){e||(e=setInterval(c,800))},stopAnimation:o,animationPlaying:function(){return!!e},external:{getBGImage:function(){return a.getImage()},setBGImage:function(e){a.setSource(e)},renderConnections:s,renderSpaces:i},Editor:function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){window.addEventListener("resize",PP64.renderer.render,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",PP64.renderer.render)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){return React.createElement("div",{className:"editor"},React.createElement(t,{board:this.props.board}),React.createElement(d,{board:this.props.board}),React.createElement(g,{board:this.props.board,selectedSpaces:this.props.selectedSpaces}),React.createElement(P,{board:this.props.board}),React.createElement(v,{board:this.props.board}))}}]),o}()}}();
"use strict";var _createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.rightclick=function(){var t=void 0,e=function(e){function r(){var e,t,o;_classCallCheck(this,r);for(var a=arguments.length,n=Array(a),p=0;p<a;p++)n[p]=arguments[p];return(t=o=_possibleConstructorReturn(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(n)))).state={},o.globalClickHandler=function(e){o.elementIsWithin(e.target)||"CANVAS"===e.target.tagName.toUpperCase()||PP64.renderer.updateRightClickMenu(null)},o.handleClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},o.onContextMenu=function(e){e.preventDefault()},o.onTypeChanged=function(e,t){void 0!==e&&(o.props.space.type=e),void 0!==t?o.props.space.subtype=t:delete o.props.space.subtype,PP64.renderer.render(),o.forceUpdate()},o.onChangeX=function(e){var t=parseInt(e.target.value,10),a=""===e.target.value,n=PP64.boards.getCurrentBoard().bg.width;!a&&isNaN(t)||t<0||n<t||(o.state.oldX||o.setState({oldX:o.props.space.x}),o.props.space.x=a?"":t,o.forceUpdate())},o.onChangeY=function(e){var t=parseInt(e.target.value,10),a=""===e.target.value,n=PP64.boards.getCurrentBoard().bg.height;!a&&isNaN(t)||t<0||n<t||(o.state.oldY||o.setState({oldY:o.props.space.y}),o.props.space.y=a?"":t,o.forceUpdate())},o.onCoordSet=function(e){o.props.space.x=o.props.space.x||0,o.props.space.y=o.props.space.y||0,PP64.renderer.render(),o.setState({oldX:void 0,oldY:void 0}),o.forceUpdate()},o.onKeyUp=function(e){"Enter"===e.key&&o.onCoordSet()},_possibleConstructorReturn(o,t)}return _inherits(r,React.Component),_createClass(r,[{key:"componentDidMount",value:function(){t=this.globalClickHandler.bind(this),document.addEventListener("click",t)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",t),t=null}},{key:"getPlacement",value:function(e){return"translateX("+((isNaN(this.state.oldX)?e.x:this.state.oldX)-8)+"px) translateY("+((isNaN(this.state.oldY)?e.y:this.state.oldY)+15)+"px)"}},{key:"elementIsWithin",value:function(e){return!(e&&this.refs&&this.refs.rcMenu)||this.refs.rcMenu.contains(e)}},{key:"render",value:function(){var e=this.props.space;if(!e)return null;var t={transform:this.getPlacement(e)};return React.createElement("div",{ref:"rcMenu",className:"rcMenu",style:t,onClick:this.handleClick,onContextMenu:this.onContextMenu},"¬†¬†",React.createElement("span",null,"X:"),React.createElement("input",{type:"text",value:e.x,onChange:this.onChangeX,onBlur:this.onCoordSet,onKeyUp:this.onKeyUp}),React.createElement("span",null,"Y:"),React.createElement("input",{type:"text",value:e.y,onChange:this.onChangeY,onBlur:this.onCoordSet,onKeyUp:this.onKeyUp}),React.createElement(a,{type:e.type,subtype:e.subtype,typeChanged:this.onTypeChanged}))}}]),r}(),s=[{name:"Change to blue space",icon:"img/toolbar/blue.png",type:$spaceType.BLUE},{name:"Change to red space",icon:"img/toolbar/red.png",type:$spaceType.RED},{name:"Change to happening space",icon:"img/toolbar/happening.png",type:$spaceType.HAPPENING},{name:"Change to chance time space",icon:"img/toolbar/chance.png",type:$spaceType.CHANCE},{name:"Change to minigame space",icon:"img/toolbar/minigame.png",type:$spaceType.MINIGAME},{name:"Change to shroom space",icon:"img/toolbar/shroom.png",type:$spaceType.SHROOM},{name:"Change to Bowser space",icon:"img/toolbar/bowser.png",type:$spaceType.BOWSER},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to star space",icon:"img/toolbar/star.png",type:$spaceType.STAR,advanced:!0},{name:"Change to start space",icon:"img/toolbar/start.png",type:$spaceType.START,advanced:!0}],c=[{name:"Show Toad",icon:"img/toolbar/toad.png",subtype:$spaceSubType.TOAD},{name:"Show Boo",icon:"img/toolbar/boo.png",subtype:$spaceSubType.BOO},{name:"Show Bowser",icon:"img/toolbar/bowsercharacter.png",subtype:$spaceSubType.BOWSER},{name:"Show Koopa Troopa",icon:"img/toolbar/koopa.png",subtype:$spaceSubType.KOOPA}],i=[{name:"Change to blue space",icon:"img/toolbar/blue.png",type:$spaceType.BLUE},{name:"Change to red space",icon:"img/toolbar/red.png",type:$spaceType.RED},{name:"Change to happening space",icon:"img/toolbar/happening.png",type:$spaceType.HAPPENING},{name:"Change to chance time space",icon:"img/toolbar/chance2.png",type:$spaceType.CHANCE},{name:"Change to Bowser space",icon:"img/toolbar/bowser.png",type:$spaceType.BOWSER},{name:"Change to item space",icon:"img/toolbar/item.png",type:$spaceType.ITEM},{name:"Change to battle space",icon:"img/toolbar/battle.png",type:$spaceType.BATTLE},{name:"Change to bank space",icon:"img/toolbar/bank.png",type:$spaceType.BANK},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to star space",icon:"img/toolbar/star.png",type:$spaceType.STAR,advanced:!0},{name:"Change to black star space",icon:"img/toolbar/blackstar.png",type:$spaceType.BLACKSTAR,advanced:!0},{name:"Change to start space",icon:"img/toolbar/start.png",type:$spaceType.START,advanced:!0},{name:"Change to arrow space",icon:"img/toolbar/arrow.png",type:$spaceType.ARROW,advanced:!0}],g=[{name:"Show Toad",icon:"img/toolbar/toad.png",subtype:$spaceSubType.TOAD},{name:"Show Boo",icon:"img/toolbar/boo.png",subtype:$spaceSubType.BOO},{name:"Show bank",icon:"img/toolbar/banksubtype2.png",subtype:$spaceSubType.BANK},{name:"Show bank coin stack",icon:"img/toolbar/bankcoinsubtype.png",subtype:$spaceSubType.BANKCOIN},{name:"Show item shop",icon:"img/toolbar/itemshopsubtype2.png",subtype:$spaceSubType.ITEMSHOP}],l=[{name:"Change to blue space",icon:"img/toolbar/blue3.png",type:$spaceType.BLUE},{name:"Change to red space",icon:"img/toolbar/red3.png",type:$spaceType.RED},{name:"Change to happening space",icon:"img/toolbar/happening3.png",type:$spaceType.HAPPENING},{name:"Change to chance time space",icon:"img/toolbar/chance3.png",type:$spaceType.CHANCE},{name:"Change to Bowser space",icon:"img/toolbar/bowser3.png",type:$spaceType.BOWSER},{name:"Change to item space",icon:"img/toolbar/item3.png",type:$spaceType.ITEM},{name:"Change to battle space",icon:"img/toolbar/battle3.png",type:$spaceType.BATTLE},{name:"Change to bank space",icon:"img/toolbar/bank3.png",type:$spaceType.BANK},{name:"Change to Game Guy space",icon:"img/toolbar/gameguy.png",type:$spaceType.GAMEGUY},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to star space",icon:"img/toolbar/star.png",type:$spaceType.STAR,advanced:!0},{name:"Change to start space",icon:"img/toolbar/start.png",type:$spaceType.START,advanced:!0},{name:"Change to arrow space",icon:"img/toolbar/arrow.png",type:$spaceType.ARROW,advanced:!0}],y=[{name:"Show Millenium Star",icon:"img/toolbar/mstar.png",subtype:$spaceSubType.TOAD},{name:"Show Boo",icon:"img/toolbar/boo.png",subtype:$spaceSubType.BOO},{name:"Show bank",icon:"img/toolbar/banksubtype.png",subtype:$spaceSubType.BANK},{name:"Show bank coin stack",icon:"img/toolbar/bankcoinsubtype.png",subtype:$spaceSubType.BANKCOIN},{name:"Show item shop",icon:"img/toolbar/itemshopsubtype.png",subtype:$spaceSubType.ITEMSHOP}],u=[{name:"Change to basic space",icon:"img/toolbar/basic3.png",type:$spaceType.DUEL_BASIC},{name:"Change to Mini-Game space",icon:"img/toolbar/minigameduel3.png",type:$spaceType.MINIGAME},{name:"Change to reverse space",icon:"img/toolbar/reverse3.png",type:$spaceType.DUEL_REVERSE},{name:"Change to happening space",icon:"img/toolbar/happeningduel3.png",type:$spaceType.HAPPENING},{name:"Change to Game Guy space",icon:"img/toolbar/gameguyduel.png",type:$spaceType.GAMEGUY},{name:"Change to power-up space",icon:"img/toolbar/powerup.png",type:$spaceType.DUEL_POWERUP},{name:"Change to invisible space",icon:"img/toolbar/other.png",type:$spaceType.OTHER},{name:"Change to blue start space",icon:"img/toolbar/startblue.png",type:$spaceType.DUEL_START_BLUE,advanced:!0},{name:"Change to red start space",icon:"img/toolbar/startred.png",type:$spaceType.DUEL_START_RED,advanced:!0}];var a=function(e){function r(){var e,t,a;_classCallCheck(this,r);for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return(t=a=_possibleConstructorReturn(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(o)))).onTypeChanged=function(e,t){a.props.typeChanged(e,t)},_possibleConstructorReturn(a,t)}return _inherits(r,React.Component),_createClass(r,[{key:"render",value:function(){var n=this.props.type;if(n===$spaceType.START&&!PP64.settings.get($setting.uiAdvanced))return null;var o=this.props.subtype,p=this.onTypeChanged,e=function(e){var t=e.type+"-"+e.subtype,a=n===e.type||n===$spaceType.OTHER&&void 0!==o&&o===e.subtype;return React.createElement(b,{key:t,type:e.type,subtype:e.subtype,icon:e.icon,title:e.name,selected:a,typeChanged:p})},t=function(){var e=PP64.boards.getCurrentBoard(),t=void 0;switch(e.game){case 1:t=s;break;case 2:t=i;break;case 3:switch(e.type){case PP64.types.BoardType.DUEL:t=u;break;case PP64.types.BoardType.NORMAL:default:t=l}}return PP64.settings.get($setting.uiAdvanced)||(t=t.filter(function(e){return!e.advanced})),t}().map(e),a=function(){var e=PP64.boards.getCurrentBoard(),t=void 0;switch(e.game){case 1:t=c;break;case 2:t=g;break;case 3:switch(e.type){case PP64.types.BoardType.DUEL:t=[];break;default:t=y}}return PP64.settings.get($setting.uiAdvanced)||(t=t.filter(function(e){return!e.advanced})),t}().map(e);return React.createElement("div",{className:"rcSpaceToggleContainer"},t,React.createElement("br",null),a)}}]),r}(),b=function(e){function r(){var e,t,a;_classCallCheck(this,r);for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return(t=a=_possibleConstructorReturn(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(o)))).onTypeChanged=function(){void 0!==a.props.subtype&&a.props.selected?a.props.typeChanged(a.props.type,void 0):a.props.typeChanged(a.props.type,a.props.subtype)},_possibleConstructorReturn(a,t)}return _inherits(r,React.Component),_createClass(r,[{key:"render",value:function(){var e="rcSpaceToggleButton";this.props.selected&&(e+=" selected");var t=void 0!==this.props.subtype?25:20;return React.createElement("div",{className:e,title:this.props.title,onClick:this.onTypeChanged},React.createElement("img",{src:this.props.icon,height:t,width:t}))}}]),r}();return{RightClickMenu:e}}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}PP64.interaction=function(){var r={},$=!1,u=-1,R=-1,S=-1,l=-1,i=null;function a(e){c(e.currentTarget,e.clientX,e.clientY,e.ctrlKey)}function t(e){if(1===e.touches.length){var a=e.touches[0];c(e.currentTarget,a.clientX,a.clientY,e.ctrlKey)}}function c(e,a,t,c){var r=a-(i=e.getBoundingClientRect()).left,n=t-i.top;u=S=r,R=l=n;var p=I(S,l);$$log("Clicked space: "+$$hex(p)+" ("+p+")",PP64.boards.getCurrentBoard().spaces[p]);var s=-1!==p;PP64.boards.currentBoardIsROM()&&s&&(PP64.app.changeCurrentAction($actType.MOVE),PP64.boards.copyCurrentBoard(),PP64.boards.setCurrentBoard(PP64.boards.getCurrentBoardIndex()+1));var T=PP64.app.getCurrentAction();switch(T){case $actType.MOVE:s?c?L(p):b(p)||M(p):B();break;case $actType.ADD_OTHER:case $actType.ADD_BLUE:case $actType.ADD_RED:case $actType.ADD_MINIGAME:case $actType.ADD_HAPPENING:case $actType.ADD_STAR:case $actType.ADD_BLACKSTAR:case $actType.ADD_START:case $actType.ADD_CHANCE:case $actType.ADD_SHROOM:case $actType.ADD_BOWSER:case $actType.ADD_ITEM:case $actType.ADD_BATTLE:case $actType.ADD_BANK:case $actType.ADD_GAMEGUY:case $actType.ADD_ARROW:case $actType.MARK_STAR:case $actType.MARK_GATE:case $actType.ADD_TOAD_CHARACTER:case $actType.ADD_BOWSER_CHARACTER:case $actType.ADD_KOOPA_CHARACTER:case $actType.ADD_BOO_CHARACTER:case $actType.ADD_BANK_SUBTYPE:case $actType.ADD_BANKCOIN_SUBTYPE:case $actType.ADD_ITEMSHOP_SUBTYPE:case $actType.ADD_DUEL_BASIC:case $actType.ADD_DUEL_REVERSE:case $actType.ADD_DUEL_POWERUP:case $actType.ADD_DUEL_START_BLUE:case $actType.ADD_DUEL_START_RED:s?c?L(p):b(p)||M(p):c||B();break;case $actType.LINE:case $actType.LINE_STICKY:case $actType.ROTATE:s?M(p):B();break;case $actType.ERASE:B()}var D=h(),A=PP64.boards.getCurrentBoard(),o=A.spaces[p];switch(T){case $actType.LINE:if(1===D.length){var y=D[0];PP64.renderer.renderConnections(),PP64.renderer.drawConnection(y.x,y.y,r,n),PP64.renderer.rightClickOpen()&&PP64.renderer.updateRightClickMenu(null)}break;case $actType.LINE_STICKY:if(1===D.length){var P=D[0];if(o&&o!==P){var E=PP64.boards.getSpaceIndex(P,A);PP64.boards.addConnection(E,p),M(p),PP64.renderer.renderConnections()}else PP64.renderer.renderConnections(),PP64.renderer.drawConnection(P.x,P.y,r,n)}break;case $actType.ROTATE:break;case $actType.ERASE:-1!==p&&U(A,p)?(PP64.boards.removeSpace(p),PP64.app.changeSelectedSpaces([]),PP64.renderer.render()):m(r,n);break;case $actType.ADD_OTHER:case $actType.ADD_BLUE:case $actType.ADD_RED:case $actType.ADD_MINIGAME:case $actType.ADD_HAPPENING:case $actType.ADD_STAR:case $actType.ADD_BLACKSTAR:case $actType.ADD_START:case $actType.ADD_CHANCE:case $actType.ADD_SHROOM:case $actType.ADD_BOWSER:case $actType.ADD_ITEM:case $actType.ADD_BATTLE:case $actType.ADD_BANK:case $actType.ADD_GAMEGUY:case $actType.ADD_ARROW:case $actType.MARK_STAR:case $actType.MARK_GATE:case $actType.ADD_TOAD_CHARACTER:case $actType.ADD_BOWSER_CHARACTER:case $actType.ADD_KOOPA_CHARACTER:case $actType.ADD_BOO_CHARACTER:case $actType.ADD_BANK_SUBTYPE:case $actType.ADD_BANKCOIN_SUBTYPE:case $actType.ADD_ITEMSHOP_SUBTYPE:case $actType.ADD_DUEL_BASIC:case $actType.ADD_DUEL_REVERSE:case $actType.ADD_DUEL_POWERUP:case $actType.ADD_DUEL_START_BLUE:case $actType.ADD_DUEL_START_RED:N(T,r,n,o,!1,c)&&L(-1!==p?p:A.spaces.length-1);break;case $actType.MOVE:default:$=s,PP64.renderer.rightClickOpen()&&PP64.renderer.updateRightClickMenu(D[0])}}function n(e){if(1===e.touches.length&&d()){e.preventDefault();var a=e.touches[0];s(a.clientX-i.left,a.clientY-i.top)}}function p(e){i&&1===e.buttons&&s(e.clientX-i.left,e.clientY-i.top)}function s(e,a){if(!PP64.boards.currentBoardIsROM()){var t=PP64.app.getCurrentAction(),c=h(),r=PP64.boards.getCurrentBoard(),n=I(e,a);switch(t){case $actType.LINE:if(1===c.length){var p=c[0];PP64.renderer.renderConnections(),PP64.renderer.drawConnection(p.x,p.y,e,a),PP64.renderer.rightClickOpen()&&PP64.renderer.updateRightClickMenu(null)}break;case $actType.LINE_STICKY:if(1===c.length){var s=c[0],T=r.spaces[n];if(T&&T!==s){var D=PP64.boards.getSpaceIndex(s,r);PP64.boards.addConnection(D,n),M(n),PP64.renderer.renderConnections()}else PP64.renderer.renderConnections(),PP64.renderer.drawConnection(s.x,s.y,e,a)}break;case $actType.ROTATE:if(1===c.length){var A=c[0];if(A.type===$spaceType.ARROW){var o=PP64.utils.number.determineAngle(A.x,A.y,e,a),y=(1.5*Math.PI+o)%(2*Math.PI),P=PP64.utils.number.radiansToDegrees(y),E=PP64.boards.getSpaceIndex(A,r);PP64.boards.setSpaceRotation(E,P),PP64.renderer.renderSpaces()}}break;case $actType.ERASE:-1!==n&&U(r,n)?(PP64.boards.removeSpace(n),PP64.app.changeSelectedSpaces([]),PP64.renderer.render()):m(e,a);break;case $actType.MOVE:case $actType.ADD_OTHER:case $actType.ADD_BLUE:case $actType.ADD_RED:case $actType.ADD_MINIGAME:case $actType.ADD_HAPPENING:case $actType.ADD_STAR:case $actType.ADD_BLACKSTAR:case $actType.ADD_START:case $actType.ADD_CHANCE:case $actType.ADD_SHROOM:case $actType.ADD_BOWSER:case $actType.ADD_ITEM:case $actType.ADD_BATTLE:case $actType.ADD_BANK:case $actType.ADD_GAMEGUY:case $actType.ADD_ARROW:case $actType.MARK_STAR:case $actType.MARK_GATE:case $actType.ADD_TOAD_CHARACTER:case $actType.ADD_BOWSER_CHARACTER:case $actType.ADD_KOOPA_CHARACTER:case $actType.ADD_BOO_CHARACTER:case $actType.ADD_BANK_SUBTYPE:case $actType.ADD_BANKCOIN_SUBTYPE:case $actType.ADD_ITEMSHOP_SUBTYPE:case $actType.ADD_DUEL_BASIC:case $actType.ADD_DUEL_REVERSE:case $actType.ADD_DUEL_POWERUP:case $actType.ADD_DUEL_START_BLUE:case $actType.ADD_DUEL_START_RED:default:var i=!$&&t===$actType.MOVE;if(!i&&c.length){var _=e-S,d=a-l;c.forEach(function(e){var a=e.x+_;e.x=Math.max(0,Math.min(a,r.bg.width));var t=e.y+d;e.y=Math.max(0,Math.min(t,r.bg.height))}),C||(C=setTimeout(f,10)),v||(v=setTimeout(O,10)),PP64.renderer.rightClickOpen()&&PP64.renderer.updateRightClickMenu(c[0])}i&&function(e,a){if(-1===u||-1===R)return;B();for(var t=PP64.boards.getCurrentBoard().spaces,c=0;c<t.length;c++){var r=t[c];$$number.pointFallsWithin(r.x,r.y,u,R,e,a)&&L(c,!0)}g(),PP64.renderer.drawSelectionBox(u,R,e,a)}(e,a)}S=e,l=a}}function T(e){0===e.button&&A()}function D(e){1===e.touches.length&&A()}function A(){if(!PP64.boards.currentBoardIsROM()){var e=PP64.app.getCurrentAction();if($||e!==$actType.MOVE||PP64.renderer.renderSpaces(),$=!1,d()){var a=h();if(e===$actType.LINE){var t=I(S,l);if(-1!==t&&-1===a.indexOf(t))for(var c in r)PP64.boards.addConnection(parseInt(c),t);PP64.renderer.renderConnections()}}}}function o(e){if(!PP64.boards.currentBoardIsROM()){var a=5<Math.abs(u-S)||5<Math.abs(R-l),t=0<Math.abs(u-S)||0<Math.abs(R-l),c=h();u=S=-1,R=l=-1;var r=e.ctrlKey,n=I(e.clientX-i.left,e.clientY-i.top),p=PP64.boards.getCurrentBoard(),s=-1===n?null:p.spaces[n];if(0===e.button)switch(PP64.app.getCurrentAction()){case $actType.MOVE:case $actType.ADD_OTHER:case $actType.ADD_BLUE:case $actType.ADD_RED:case $actType.ADD_MINIGAME:case $actType.ADD_HAPPENING:case $actType.ADD_STAR:case $actType.ADD_BLACKSTAR:case $actType.ADD_START:case $actType.ADD_CHANCE:case $actType.ADD_SHROOM:case $actType.ADD_BOWSER:case $actType.ADD_ITEM:case $actType.ADD_BATTLE:case $actType.ADD_BANK:case $actType.ADD_GAMEGUY:case $actType.ADD_ARROW:case $actType.MARK_GATE:case $actType.ADD_TOAD_CHARACTER:case $actType.ADD_BOWSER_CHARACTER:case $actType.ADD_KOOPA_CHARACTER:case $actType.ADD_BOO_CHARACTER:case $actType.ADD_BANK_SUBTYPE:case $actType.ADD_BANKCOIN_SUBTYPE:case $actType.ADD_ITEMSHOP_SUBTYPE:case $actType.ADD_DUEL_BASIC:case $actType.ADD_DUEL_REVERSE:case $actType.ADD_DUEL_POWERUP:case $actType.ADD_DUEL_START_BLUE:case $actType.ADD_DUEL_START_RED:t||r||(s?M(n):B());break;case $actType.MARK_STAR:a||function(e){if(!e||!e.length)return;e.forEach(function(e){e.star=!e.star}),PP64.renderer.renderSpaces(),PP64.app.changeSelectedSpaces(e)}(c);break;case $actType.LINE:case $actType.LINE_STICKY:PP64.renderer.renderConnections();break;case $actType.ERASE:case $actType.ROTATE:}}}function y(e){e.preventDefault(),e.stopPropagation();var a=h(),t=1!==a.length?null:a[0];PP64.renderer.updateRightClickMenu(t)}function P(e){if(e.preventDefault(),!PP64.boards.currentBoardIsROM()){PP64.renderer.rightClickOpen()&&PP64.renderer.updateRightClickMenu(null);var a=void 0;try{a=JSON.parse(e.dataTransfer.getData("text"))}catch(e){return}if("object"===(void 0===a?"undefined":_typeof(a)))if(a.action){B();var t=e.currentTarget;i=t.getBoundingClientRect();var c=e.clientX-i.left,r=e.clientY-i.top,n=I(c,r),p=PP64.boards.getCurrentBoard(),s=-1===n?null:p.spaces[n];N(a.action.type,c,r,s,!1,!1)}else if(a.isEventParamDrop){var T=PP64.utils.drag.getEventParamDropHandler();if(T){var D=e.currentTarget;i=D.getBoundingClientRect(),T(I(e.clientX-i.left,e.clientY-i.top))}}}}function E(e){var a=PP64.app.getSelectedSpaces();if(a&&a.length){var t=PP64.boards.getCurrentBoard();if(38===e.keyCode)a.forEach(function(e){e.y=Math.max(e.y-1,0)}),PP64.app.changeSelectedSpaces(a);else if(40===e.keyCode)a.forEach(function(e){e.y=Math.min(e.y+1,t.bg.height)}),PP64.app.changeSelectedSpaces(a);else if(37===e.keyCode)a.forEach(function(e){e.x=Math.max(e.x-1,0)}),PP64.app.changeSelectedSpaces(a);else if(39===e.keyCode)a.forEach(function(e){e.x=Math.min(e.x+1,t.bg.width)}),PP64.app.changeSelectedSpaces(a);else if(46===e.keyCode){var c=!1;a.forEach(function(e){void 0!==e.subtype&&(c=!0)}),a.forEach(function(e){if(c)void 0!==e.subtype&&delete e.subtype;else{var a=PP64.boards.getSpaceIndex(e,t);U(t,a)&&PP64.boards.removeSpace(a,t)}}),c?PP64.app.changeSelectedSpaces(a):PP64.app.changeSelectedSpaces([])}}}function _(e){if($=!1,0===e.button&&!PP64.boards.currentBoardIsROM()){var a=PP64.app.getCurrentAction();!$&&a===$actType.MOVE&&(PP64.renderer.renderSpaces(),u=S=-1,R=l=-1)}}var C=void 0;function f(){PP64.renderer.renderConnections(),C=null}var v=void 0;function O(){PP64.renderer.renderSpaces(),PP64.renderer.renderSelectedSpaces(),v=null}function B(){r={},PP64.app.changeSelectedSpaces([])}function g(){PP64.app.changeSelectedSpaces(h())}function h(){var e=PP64.boards.getCurrentBoard(),a=[];for(var t in r){var c=e.spaces[t];a.push(c)}return a}function d(){for(var e in r)return!0;return!1}function b(e){return!!r[e]}function L(e,a){r||(r={}),r[e]=!0,a||g()}function M(e){r=_defineProperty({},e,!0),g()}function I(e,a){for(var t=PP64.boards.getCurrentBoard(),c=3===PP64.boards.getCurrentBoard().game?14:8,r=-1,n=0;n<t.spaces.length;n++){var p=t.spaces[n];p&&(Math.abs(p.x-e)<=c&&Math.abs(p.y-a)<=c&&(r=n))}return r}function U(e,a){var t=e.spaces[a];return!!t&&(t.type!==$spaceType.START||1<PP64.boards.getSpacesOfType($spaceType.START,e).length)}function N(e,a,t,c,r,n){var p=function(e){var a=$spaceType.OTHER;e===$actType.ADD_BLUE?a=$spaceType.BLUE:e===$actType.ADD_RED?a=$spaceType.RED:e===$actType.ADD_HAPPENING?a=$spaceType.HAPPENING:e===$actType.ADD_STAR?a=$spaceType.STAR:e===$actType.ADD_BLACKSTAR?a=$spaceType.BLACKSTAR:e===$actType.ADD_MINIGAME?a=$spaceType.MINIGAME:e===$actType.ADD_CHANCE?a=$spaceType.CHANCE:e===$actType.ADD_START?a=$spaceType.START:e===$actType.ADD_SHROOM?a=$spaceType.SHROOM:e===$actType.ADD_BOWSER?a=$spaceType.BOWSER:e===$actType.ADD_ITEM?a=$spaceType.ITEM:e===$actType.ADD_BATTLE?a=$spaceType.BATTLE:e===$actType.ADD_BANK?a=$spaceType.BANK:e===$actType.ADD_ARROW?a=$spaceType.ARROW:e===$actType.ADD_GAMEGUY?a=$spaceType.GAMEGUY:e===$actType.ADD_DUEL_BASIC?a=$spaceType.DUEL_BASIC:e===$actType.ADD_DUEL_REVERSE?a=$spaceType.DUEL_REVERSE:e===$actType.ADD_DUEL_POWERUP?a=$spaceType.DUEL_POWERUP:e===$actType.ADD_DUEL_START_BLUE?a=$spaceType.DUEL_START_BLUE:e===$actType.ADD_DUEL_START_RED&&(a=$spaceType.DUEL_START_RED);return a}(e),s=function(e){var a=void 0;e===$actType.ADD_TOAD_CHARACTER?a=$spaceSubType.TOAD:e===$actType.ADD_BOWSER_CHARACTER?a=$spaceSubType.BOWSER:e===$actType.ADD_KOOPA_CHARACTER?a=$spaceSubType.KOOPA:e===$actType.ADD_BOO_CHARACTER?a=$spaceSubType.BOO:e===$actType.ADD_BANK_SUBTYPE?a=$spaceSubType.BANK:e===$actType.ADD_BANKCOIN_SUBTYPE?a=$spaceSubType.BANKCOIN:e===$actType.ADD_ITEMSHOP_SUBTYPE?a=$spaceSubType.ITEMSHOP:e===$actType.MARK_GATE&&(a=$spaceSubType.GATE);return a}(e),T=!1;if(c)void 0===s||r||(c.type!==$spaceType.OTHER&&s===$spaceSubType.GATE||(c.subtype===s?delete c.subtype:c.subtype=s),PP64.app.changeSelectedSpaces([c]),T=!0);else{var D=PP64.boards.getCurrentBoard(),A=PP64.boards.addSpace(a,t,p,s),o=D.spaces[A];if(n){var y=PP64.app.getSelectedSpaces()||[];y.push(o),PP64.app.changeSelectedSpaces(y)}else PP64.app.changeSelectedSpaces([o]);T=!0}return PP64.renderer.renderSpaces(),T}function m(e,a){var t=PP64.boards.getCurrentBoard(),c=t.spaces,r=t.links,n=!1;for(var p in r){var s=c[p],T=r[p];if(Array.isArray(T)){for(var D=0;D<T.length;)H(s,c[T[D]],e,a)?(T.splice(D,1),n=!0):D++;1===T.length?T=T[0]:T.length||delete r[p]}else H(s,c[T],e,a)&&(delete r[p],n=!0)}n&&PP64.renderer.renderConnections()}function H(e,a,t,c){return!(t>e.x&&t>a.x)&&(!(t<e.x&&t<a.x)&&(!(c>e.y&&c>a.y)&&(!(c<e.y&&c<a.y)&&$$number.lineDistance(t,c,e.x,e.y,a.x,a.y)<=4)))}function K(e){e.preventDefault()}return{attachToCanvas:function(e){e.addEventListener("contextmenu",y,!1),e.addEventListener("click",o,!1),e.addEventListener("mousedown",a,!1),e.addEventListener("mousemove",p,!1),e.addEventListener("mouseup",T,!1),e.addEventListener("mouseout",_,!1),e.addEventListener("touchstart",t,!1),e.addEventListener("touchmove",n,!1),e.addEventListener("touchend",D,!1),e.addEventListener("drop",P,!1),e.addEventListener("dragover",K,!1),e.addEventListener("keydown",E,!1)},detachFromCanvas:function(e){e.removeEventListener("contextmenu",y),e.removeEventListener("click",o),e.removeEventListener("mousedown",a),e.removeEventListener("mousemove",p),e.removeEventListener("mouseup",T),e.removeEventListener("mouseout",_),e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",n),e.removeEventListener("touchend",D),e.removeEventListener("drop",P),e.removeEventListener("dragover",K),e.removeEventListener("keydown",E)}}}();
"use strict";var _createClass=function(){function a(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,s){return t&&a(e.prototype,t),s&&a(e,s),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.romhandler=new(function(){function e(){_classCallCheck(this,e),this._rom=null,this._u8array=null,this._gameId=null,this._gameVersion=null}return _createClass(e,[{key:"getROMGame",value:function(){return this._rom?this._gameId?this._gameId:this._rom.byteLength<64?null:(this._gameId=String.fromCharCode(this._u8array[59],this._u8array[60],this._u8array[61],this._u8array[62]),this._gameId):null}},{key:"getROMBuffer",value:function(){return this._rom}},{key:"clear",value:function(){this._rom=null,this._u8array=null,this._gameId=null,this._gameVersion=null,PP64.fs.scenes.clearCache(),PP64.fs.mainfs.clearCache(),PP64.fs.strings.clear(),PP64.fs.strings3.clear(),PP64.fs.hvqfs.clearCache(),PP64.fs.audio.clearCache(),PP64.fs.animationfs.clearCache()}},{key:"setROMBuffer",value:function(e){if(!e)return this.clear(),!1;if(this._rom=e,this._u8array=new Uint8Array(this._rom),this.byteSwapIfNeeded(),!this.romRecognized())return PP64.app.showMessage("File is not recognized as any valid ROM."),this.clear(),!1;if(!this.romSupported())return PP64.app.showMessage("This ROM is not supported right now."),this.clear(),!1;PP64.patches.gameshark.reset();var t=this.getGameVersion(),s=[];return s.push(PP64.fs.scenes.extractAsync()),s.push(PP64.fs.mainfs.extractAsync()),3===t?s.push(PP64.fs.strings3.extractAsync()):s.push(PP64.fs.strings.extractAsync()),s.push(PP64.fs.hvqfs.extractAsync()),s.push(PP64.fs.audio.extractAsync()),2===t&&s.push(PP64.fs.animationfs.extractAsync()),Promise.all(s)}},{key:"saveROM",value:function(){var e=this.getGameVersion(),t=PP64.fs.mainfs.getROMOffset(),s=$$number.makeDivisibleBy(PP64.fs.mainfs.getByteLength(),16),a=void 0;a=3===e?$$number.makeDivisibleBy(PP64.fs.strings3.getByteLength(),16):$$number.makeDivisibleBy(PP64.fs.strings.getByteLength(),16);var r=$$number.makeDivisibleBy(PP64.fs.hvqfs.getByteLength(),16),i=$$number.makeDivisibleBy(PP64.fs.audio.getByteLength(),16),n=0;for(2===e&&(n=$$number.makeDivisibleBy(PP64.fs.animationfs.getByteLength(),16));t+s+a&32768;)a+=4096;var u=new ArrayBuffer(t+s+a+r+n+i);PP64.utils.arrays.copyRange(u,this._rom,0,0,t),PP64.patches.gameshark.hook.apply(u),PP64.fs.mainfs.pack(u,t),PP64.fs.mainfs.setROMOffset(t,u),3===e?(PP64.fs.strings3.pack(u,t+s),PP64.fs.strings3.setROMOffset(t+s,u)):(PP64.fs.strings.pack(u,t+s),PP64.fs.strings.setROMOffset(t+s,u)),PP64.fs.hvqfs.pack(u,t+s+a),PP64.fs.hvqfs.setROMOffset(t+s+a,u),2===e&&(PP64.fs.animationfs.pack(u,t+s+a+r),PP64.fs.animationfs.setROMOffset(t+s+a+r,u)),PP64.fs.audio.pack(u,t+s+a+r+n),PP64.fs.audio.setROMOffset(t+s+a+r+n,u);var h=PP64.adapters.getROMAdapter();h.onAfterSave&&h.onAfterSave(new DataView(u)),PP64.utils.CIC.fixChecksum(u),this._rom=u,this._u8array=new Uint8Array(this._rom);var f=new Blob([u]);saveAs(f,"MyMarioParty"+e+".z64")}},{key:"romIsLoaded",value:function(){return!!this._rom}},{key:"getByteArray",value:function(){return this._u8array}},{key:"getDataView",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!this._rom)throw"ROM not loaded, cannot get DataView.";return t?new DataView(this._rom,e,t-e):new DataView(this._rom,e)}},{key:"getGameVersion",value:function(){if(null!==this._gameVersion)return this._gameVersion;var e=this.getROMGame();if(!e)return null;switch(e){case $gameType.MP1_USA:case $gameType.MP1_JPN:return this._gameVersion=1;case $gameType.MP2_USA:return this._gameVersion=2;case $gameType.MP3_USA:return this._gameVersion=3}return null}},{key:"romRecognized",value:function(){return null!==this.getGameVersion()}},{key:"romSupported",value:function(){var e=!1;switch(this.getROMGame()){case $gameType.MP1_USA:case $gameType.MP2_USA:case $gameType.MP3_USA:e=!0}return e||PP64.settings.get($setting.uiAllowAllRoms)}},{key:"byteSwapIfNeeded",value:function(){if(this._rom&&!(this._rom.byteLength<4)){var e=this.getDataView(),t=e.getUint32(0);if(2151092800!==t){$$log("Byteswapping ROM...");var s=this._rom.byteLength-this._rom.byteLength%2,a=this._rom.byteLength-this._rom.byteLength%4;if(931151890===t)for(var r=0;r<s;r+=2){var i=[this._u8array[r+1],this._u8array[r]];this._u8array[r]=i[0],this._u8array[r+1]=i[1]}else if(1074935680===t)for(var n=0;n<a;n+=4){var u=[this._u8array[n+3],this._u8array[n+2],this._u8array[n+1],this._u8array[n]];this._u8array[n]=u[0],this._u8array[n+1]=u[1],this._u8array[n+2]=u[2],this._u8array[n+3]=u[3]}else if(306217015===t)for(var h=0;h<a;h+=4){var f=e.getUint16(h+2);e.setUint16(h+2,e.getUint16(h)),e.setUint16(h,f)}}}}}]),e}());
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function r(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("components"),Object.assign(PP64.components,{CodeMirrorWrapper:function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onInternalValueChanged=function(e,t){r.props.onChange&&"setValue"!==t.origin&&r.props.onChange(e.getValue(),t)},r.setOptionIfChanged=function(e,t){var o=r.codemirror.getOption(e);isEqual(o,t)||r.codemirror.setOption(e,t)},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var t=this;return React.createElement("div",{ref:function(e){t.el=e},className:this.props.className})}},{key:"componentDidMount",value:function(){var t=this.el;this.codemirror=CodeMirror(function(e){t.appendChild(e)},{value:this.props.value||this.props.defaultValue||"",extraKeys:{"Ctrl-Space":"autocomplete"}}),this.codemirror.on("change",this.onInternalValueChanged)}},{key:"componentWillUnmount",value:function(){this.codemirror=null}},{key:"componentWillReceiveProps",value:function(e){if(this.codemirror&&void 0!==e.value&&e.value!==this.props.value&&PP64.utils.string.normalizeLineEndings(this.codemirror.getValue())!==PP64.utils.string.normalizeLineEndings(e.value))if(this.props.preserveScrollPosition){var t=this.codemirror.getScrollInfo();this.codemirror.setValue(e.value),this.codemirror.scrollTo(t.left,t.top)}else this.codemirror.setValue(e.value);if("object"===_typeof(e.options))for(var o in e.options)e.options.hasOwnProperty(o)&&this.setOptionIfChanged(o,e.options[o])}}]),t}()});
"use strict";var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("patches"),PP64.patches.PatchView=function(){var e=function(e){function o(){var e,t,a;_classCallCheck(this,o);for(var r=arguments.length,n=Array(r),c=0;c<r;c++)n[c]=arguments[c];return(t=a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={},_possibleConstructorReturn(a,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var e=PP64.patches.getPatches(PP64.romhandler.getROMGame()).map(function(e){return React.createElement(t,{key:e.id,patch:e})});return e.length||(e=React.createElement("p",null,"Sorry, no patches are available for this ROM.")),React.createElement("div",{id:"patchesView"},React.createElement("h3",null,"Patches"),e)}}]),o}(),t=function(e){function o(){var e,t,r;_classCallCheck(this,o);for(var a=arguments.length,n=Array(a),c=0;c<a;c++)n[c]=arguments[c];return(t=r=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={applied:!1},r.applyPatch=function(){var e=PP64.romhandler.getDataView(),t=PP64.romhandler.getROMGame(),a=r.props.patch;a.apply(e,t),r.setState({applied:!0}),$$log("Applied patch "+a.id+".")},_possibleConstructorReturn(r,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var e=this.state.applied?"‚úì":"Apply";return React.createElement("div",{className:"patchEntry"},React.createElement("button",{className:"patchBtn",onClick:this.applyPatch},e),React.createElement("div",{className:"patchText"},React.createElement("span",{className:"patchName"},this.props.patch.name),React.createElement("br",null),React.createElement("span",{className:"patchDesc"},this.props.patch.desc)))}}]),o}();return e}();
"use strict";var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("patches.gameshark"),PP64.patches.gameshark.reset=function(){PP64.patches.gameshark.currentCheats=[]},PP64.patches.gameshark.reset(),PP64.patches.gameshark.getCheatBuffer=function(){return PP64.patches.gameshark.currentCheats.reduce(PP64.utils.arrays.join)},PP64.patches.gameshark.getCheatRoutineBuffer=function(e){var t=(e=e||{}).endInsts,a=PP64.patches.gameshark.getCheatBuffer(),r=a.byteLength+(t?4*t.length:0),n=new ArrayBuffer(r),s=new DataView(n),o=0;if(PP64.utils.arrays.copyRange(n,a,o,0,a.byteLength),o+=a.byteLength,t)for(var c=0;c<t.length;c++)s.setUint32(o,t[c]),o+=4;return n},PP64.patches.gameshark.GamesharkView=function(e){function o(){var e,t,r;_classCallCheck(this,o);for(var a=arguments.length,n=Array(a),s=0;s<a;s++)n[s]=arguments[s];return(t=r=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(n)))).state={showApplied:!1},r.applyCheat=function(){var e=r.inputEl.value,t=PP64.patches.gameshark.Parser.parse(e);if(t){var a=(new PP64.patches.gameshark.Compiler).compile(t);a?(PP64.patches.gameshark.currentCheats.push(a),r.inputEl.value="",r.setState({showApplied:!0}),setTimeout(function(){r.setState({showApplied:!1})},3e3)):PP64.app.showMessage("There was an error compiling the entered cheats")}else PP64.app.showMessage("There was an error parsing the entered cheats")},_possibleConstructorReturn(r,t)}return _inherits(o,React.Component),_createClass(o,[{key:"render",value:function(){var t=this,e=void 0;return this.state.showApplied&&(e=React.createElement("span",{className:"gsApplied"},"Applied!")),React.createElement("div",{id:"gamesharkView"},React.createElement("h3",null,"Cheats"),React.createElement("textarea",{ref:function(e){t.inputEl=e}}),React.createElement("button",{className:"patchBtn",onClick:this.applyCheat},"Apply"),e)}}]),o}();
"use strict";var _createClass=function(){function n(e,r){for(var a=0;a<r.length;a++){var n=r[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,r,a){return r&&n(e.prototype,r),a&&n(e,a),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}PP64.ns("patches.gameshark"),PP64.patches.gameshark.Opcodes={WRITE8:128,WRITE16:129,IF8:208,IF16:209,IFNOT8:210,IFNOT16:211},PP64.patches.gameshark.Parser=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"parse",value:function(e){var r=PP64.patches.gameshark.Parser.splitInput(e);if(!r.length)return $$log("Gameshark code string was empty"),null;if(r.length%2)return $$log("Gameshark code string was malformed"),null;for(var a=[],n=0;n<r.length;n+=2){var t=parseInt(r[n],16),s=parseInt(r[n+1],16);if(!t)return $$log("Invalid code instruction: "+r[n]),null;var l=PP64.patches.gameshark.Parser.getCode(t,s);if(!l)return $$log("Could not parse code: "+$$hex(t)+" "+$$hex(s)),null;a.push(l)}return a}},{key:"getCode",value:function(e,r){var a=PP64.patches.gameshark.Parser.getOpcode(e);if(null===a)return null;var n=16777215&e;return PP64.patches.gameshark.Parser.opcodeHas8BitValue(a)&&(r&=255),{opcode:a,addr:n,value:r}}},{key:"getOpcode",value:function(e){var r=(4278190080&e)>>>24;if(!r)return null;var a=PP64.patches.gameshark.Opcodes;for(var n in a)if(a.hasOwnProperty(n)&&a[n]===r)return n;return null}},{key:"opcodeHas8BitValue",value:function(e){var r=PP64.patches.gameshark.Opcodes;return e===r.WRITE8||e===r.IF8||e===r.IFNOT8}},{key:"splitInput",value:function(e){return e&&e.match(/\S+/g)||[]}},{key:"printCodes",value:function(e){for(var r=0;r<e.length;r++)console.log(e[r].opcode+" "+$$hex(e[r].addr)+" "+$$hex(e[r].value))}}]),e}();
"use strict";var _createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("patches.gameshark"),PP64.patches.gameshark.Compiler=function(){function t(){_classCallCheck(this,t),this.REG1="A3",this.REG2="AT"}return _createClass(t,[{key:"compile",value:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=void 0,s="compile"+r.opcode;if("function"==typeof this[s]&&(i=this[s](r)),!i)return $$log("Error compiling code",r),null;e=e.concat(i)}for(var h=new ArrayBuffer(4*e.length),a=new DataView(h),R=0;R<e.length;R++)a.setUint32(4*R,e[R]);return h}},{key:"compileWRITE8",value:function(t){return MIPSInst.parse("\n      LUI "+this.REG1+" "+this.getAddrUpper(t.addr)+"\n      ORI "+this.REG1+" "+this.REG1+" "+this.getAddrLower(t.addr)+"\n      ADDIU "+this.REG2+" R0 "+t.value+"\n      SB "+this.REG2+" 0("+this.REG1+")\n    ")}},{key:"compileWRITE16",value:function(t){return MIPSInst.parse("\n      LUI "+this.REG1+" "+this.getAddrUpper(t.addr)+"\n      ORI "+this.REG1+" "+this.REG1+" "+this.getAddrLower(t.addr)+"\n      ADDIU "+this.REG2+" R0 "+t.value+"\n      SH "+this.REG2+" 0("+this.REG1+")\n    ")}},{key:"compileIF8",value:function(t){return MIPSInst.parse("\n      LUI "+this.REG1+" "+this.getAddrUpper(t.addr)+"\n      ORI "+this.REG1+" "+this.REG1+" "+this.getAddrLower(t.addr)+"\n      LB "+this.REG1+" 0("+this.REG1+")\n      ADDIU "+this.REG2+" R0 "+t.value+"\n      BNE "+this.REG1+" "+this.REG2+" 4\n    ")}},{key:"compileIF16",value:function(t){return MIPSInst.parse("\n      LUI "+this.REG1+" "+this.getAddrUpper(t.addr)+"\n      ORI "+this.REG1+" "+this.REG1+" "+this.getAddrLower(t.addr)+"\n      LH "+this.REG1+" 0("+this.REG1+")\n      ADDIU "+this.REG2+" R0 "+t.value+"\n      BNE "+this.REG1+" "+this.REG2+" 4\n    ")}},{key:"compileIFNOT8",value:function(t){return MIPSInst.parse("\n      LUI "+this.REG1+" "+this.getAddrUpper(t.addr)+"\n      ORI "+this.REG1+" "+this.REG1+" "+this.getAddrLower(t.addr)+"\n      LB "+this.REG1+" 0("+this.REG1+")\n      ADDIU "+this.REG2+" R0 "+t.value+"\n      BEQ "+this.REG1+" "+this.REG2+" 4\n    ")}},{key:"compileIFNOT16",value:function(t){return MIPSInst.parse("\n      LUI "+this.REG1+" "+this.getAddrUpper(t.addr)+"\n      ORI "+this.REG1+" "+this.REG1+" "+this.getAddrLower(t.addr)+"\n      LH "+this.REG1+" 0("+this.REG1+")\n      ADDIU "+this.REG2+" R0 "+t.value+"\n      BEQ "+this.REG1+" "+this.REG2+" 4\n    ")}},{key:"getAddrUpper",value:function(t){return(4294901760&t)>>>16}},{key:"getAddrLower",value:function(t){return 65535&t}}]),t}();
"use strict";var _createClass=function(){function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("patches.gameshark.hook"),PP64.patches.gameshark.hook.apply=function(e){var t=PP64.patches.gameshark.currentCheats.length;if(t){switch(PP64.romhandler.getROMGame()){case $gameType.MP1_USA:PP64.patches.gameshark.hook.MP1U.apply(e);break;case $gameType.MP2_USA:PP64.patches.gameshark.hook.MP2U.apply(e);break;case $gameType.MP3_USA:PP64.patches.gameshark.hook.MP3U.apply(e);break;case $gameType.MP1_JPN:default:return void console.warn("Cannot write cheats for this game")}$$log("Applied "+t+" Gameshark cheats")}},PP64.patches.gameshark.romSupportsCheats=function(){switch(PP64.romhandler.getROMGame()){case $gameType.MP1_USA:case $gameType.MP2_USA:case $gameType.MP3_USA:return!0;case $gameType.MP1_JPN:default:return!1}},PP64.patches.gameshark.HookBase=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"apply",value:function(e){throw new Error("apply not implemented, is that OK?")}},{key:"writeHookCode",value:function(e){var t=PP64.adapters.getROMAdapter(),a=t&&t.MAINFS_READ_ADDR;if(!a)throw new Error("Cheats were being applied, but the ROM adapter had no MAINFS_READ_ADDR");var s=this.HOOK_ROM_START_OFFSET+4,n=$MIPS.getRegSetUpperAndLower(this.HOOK_RAM_START_OFFSET);e.setUint32(s,MIPSInst.parse("LUI A1 "+(32768|n[0]))),e.setUint32(s+=4,MIPSInst.parse("ADDIU A1 A1 "+n[1])),e.setUint32(s+=4,MIPSInst.parse("LW A1 0(A1)")),e.setUint32(s+=4,MIPSInst.parse("LUI A2 "+(this.HOOK_CACHE_DEFAULT_VALUE>>>16))),e.setUint32(s+=4,MIPSInst.parse("ADDIU A2 A2 "+(65535&this.HOOK_CACHE_DEFAULT_VALUE))),e.setUint32(s+=4,MIPSInst.parse("BNE A1 A2 11")),e.setUint32(s+=4,MIPSInst.parse("ADDU T9 V0 R0")),e.setUint32(s+=4,MIPSInst.parse("ADDU S7 RA R0")),e.setUint32(s+=4,MIPSInst.parse("LUI A0 "+this.MAINFS_CHEAT_FILE[0])),e.setUint32(s+=4,MIPSInst.parse("JAL "+a)),e.setUint32(s+=4,MIPSInst.parse("ADDIU A0 A0 "+this.MAINFS_CHEAT_FILE[1])),e.setUint32(s+=4,MIPSInst.parse("LUI A1 "+(32768|n[0]))),e.setUint32(s+=4,MIPSInst.parse("ADDIU A1 A1 "+n[1])),e.setUint32(s+=4,MIPSInst.parse("SW V0 0(A1)")),e.setUint32(s+=4,MIPSInst.parse("ADDU A1 V0 R0")),e.setUint32(s+=4,MIPSInst.parse("ADDU V0 T9 R0")),e.setUint32(s+=4,MIPSInst.parse("ADDU RA S7 R0")),e.setUint32(s+=4,MIPSInst.parse("JR A1")),e.setUint32(s+=4,0)}}]),e}();
"use strict";var _createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.ns("patches.gameshark.hook"),PP64.patches.gameshark.hook.MP1U=new(function(t){function e(){_classCallCheck(this,e);var t=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.MAINFS_CHEAT_FILE=[0,137],t.HOOK_ROM_START_OFFSET=832768,t.HOOK_RAM_START_OFFSET=829696,t.HOOK_JUMP_ROM_OFFSET=84596,t.HOOK_CACHE_DEFAULT_VALUE=1986359841,t}return _inherits(e,PP64.patches.gameshark.HookBase),_createClass(e,[{key:"apply",value:function(t){var e=new DataView(t);this.applyHook(e),this.writeHookCode(e)}},{key:"applyHook",value:function(t){var e=MIPSInst.parse("J "+(this.HOOK_RAM_START_OFFSET+4)),n=[t.getUint32(this.HOOK_JUMP_ROM_OFFSET),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+4),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+8),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+12)];t.setUint32(this.HOOK_JUMP_ROM_OFFSET,e),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+4,0),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+8,0),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+12,0);var r=PP64.patches.gameshark.getCheatRoutineBuffer({endInsts:n});PP64.fs.mainfs.write(this.MAINFS_CHEAT_FILE[0],this.MAINFS_CHEAT_FILE[1],r)}}]),e}());
"use strict";var _createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.ns("patches.gameshark.hook"),PP64.patches.gameshark.hook.MP2U=new(function(t){function e(){_classCallCheck(this,e);var t=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.MAINFS_CHEAT_FILE=[0,140],t.HOOK_ROM_START_OFFSET=863168,t.HOOK_RAM_START_OFFSET=860096,t.HOOK_JUMP_ROM_OFFSET=666680,t.HOOK_CACHE_DEFAULT_VALUE=1180792172,t}return _inherits(e,PP64.patches.gameshark.HookBase),_createClass(e,[{key:"apply",value:function(t){var e=new DataView(t);this.applyHook(e),this.writeHookCode(e)}},{key:"applyHook",value:function(t){var e=MIPSInst.parse("J "+(this.HOOK_RAM_START_OFFSET+4)),n=[t.getUint32(this.HOOK_JUMP_ROM_OFFSET),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+4),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+8)];t.setUint32(this.HOOK_JUMP_ROM_OFFSET,e),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+4,0),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+8,0);var r=PP64.patches.gameshark.getCheatRoutineBuffer({endInsts:n});PP64.fs.mainfs.write(this.MAINFS_CHEAT_FILE[0],this.MAINFS_CHEAT_FILE[1],r)}}]),e}());
"use strict";var _createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}PP64.ns("patches.gameshark.hook"),PP64.patches.gameshark.hook.MP3U=new(function(t){function e(){_classCallCheck(this,e);var t=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.MAINFS_CHEAT_FILE=[0,149],t.HOOK_ROM_START_OFFSET=686128,t.HOOK_RAM_START_OFFSET=683056,t.HOOK_JUMP_ROM_OFFSET=498328,t.HOOK_CACHE_DEFAULT_VALUE=1986359841,t}return _inherits(e,PP64.patches.gameshark.HookBase),_createClass(e,[{key:"apply",value:function(t){var e=new DataView(t);this.applyHook(e),this.writeHookCode(e)}},{key:"applyHook",value:function(t){var e=MIPSInst.parse("J "+(this.HOOK_RAM_START_OFFSET+4)),n=[t.getUint32(this.HOOK_JUMP_ROM_OFFSET),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+4),t.getUint32(this.HOOK_JUMP_ROM_OFFSET+8)];t.setUint32(this.HOOK_JUMP_ROM_OFFSET,e),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+4,0),t.setUint32(this.HOOK_JUMP_ROM_OFFSET+8,0);var r=PP64.patches.gameshark.getCheatRoutineBuffer({endInsts:n});PP64.fs.mainfs.write(this.MAINFS_CHEAT_FILE[0],this.MAINFS_CHEAT_FILE[1],r)}}]),e}());
"use strict";PP64.ns("patches"),PP64.patches.__patches=Object.create(null),PP64.patches.addPatch=function(t){PP64.patches.__patches[t.id]=t},PP64.patches.getPatches=function(t){var e=[];for(var a in PP64.patches.__patches){var c=PP64.patches.__patches[a];0<=c.supports.indexOf(t)&&e.push(c)}return e};
"use strict";PP64.ns("patches"),PP64.patches.addPatch({id:"ANTIALIAS",name:"Remove antialiasing",desc:"Removes some blurring seen on N64 hardware",supports:[$gameType.MP1_USA],apply:function(e,t){e.setUint8(602219,0),e.setUint8(602221,0),e.setUint8(602260,0),e.setUint8(602261,0),e.setUint8(602263,0)}});
"use strict";PP64.ns("patches"),PP64.patches.addPatch({id:"INTROSKIP",name:"Skip Intro",desc:"Booting the game skips intro sequences",supports:[$gameType.MP1_USA,$gameType.MP2_USA,$gameType.MP3_USA],apply:function(e,s){switch(s){case $gameType.MP1_USA:e.setUint16(2862978,105);break;case $gameType.MP2_USA:e.setUint16(119574,91);break;case $gameType.MP3_USA:e.setUint16(4621646,121)}}});
"use strict";PP64.ns("patches"),PP64.patches.addPatch({id:"DEBUGMENU",name:"Debug Menu",desc:"Boot into the debug menu",supports:[$gameType.MP1_USA,$gameType.MP2_USA,$gameType.MP3_USA],apply:function(e,a){switch(a){case $gameType.MP1_USA:e.setUint16(2862978,131);break;case $gameType.MP2_USA:e.setUint16(119574,0);break;case $gameType.MP3_USA:e.setUint16(4621646,0)}}});
"use strict";PP64.ns("patches"),PP64.patches.addPatch({id:"NOGAME",name:"Happening spaces trigger NO GAME",desc:"Happening spaces will prevent Mini-Games for the current turn",supports:[$gameType.MP1_USA],apply:function(e,p){e.setUint8(318295,3)}});
"use strict";PP64.ns("symbols"),Object.assign(PP64.symbols,function(){function o(r){switch(r){case $gameType.MP1_USA:return"MarioParty1U";case $gameType.MP1_JPN:return"MarioParty1J";case $gameType.MP1_PAL:return"MarioParty1E";case $gameType.MP2_USA:return"MarioParty2U";case $gameType.MP2_JPN:return"MarioParty2J";case $gameType.MP2_PAL:return"MarioParty2E";case $gameType.MP3_USA:return"MarioParty3U";case $gameType.MP3_JPN:return"MarioParty3J";case $gameType.MP3_PAL:return"MarioParty3E"}throw"Unrecognized game type "+r}return{getSymbols:function(r,e){var a=o(r),t=PP64.symbols[a];return t?(e&&(t=t.filter(function(r){return r.type===e})),t=t.filter(function(r){return"_"!==r.name[0]})):[]},getSymbol:function(r,e){var a=o(r),t=PP64.symbols[a];if(!t)throw new Error("Symbols aren't available for "+a+".");for(var n=0;n<t.length;n++)if(t[n].name===e)return t[n].addr;throw new Error("Symbol "+e+" wasn't found for "+a+".")}}}());
"use strict";PP64.ns("symbols"),PP64.symbols.MarioParty1U=[{addr:2147484416,type:"u32",name:"osTvType",desc:"0=PAL"},{addr:2147484420,type:"u32",name:"osRomType",desc:"0=cart"},{addr:2147484424,type:"data",name:"osRomBase",desc:"B0000000=cart"},{addr:2147484428,type:"data",name:"osResetType",desc:"0=cold reset"},{addr:2147484440,type:"data",name:"osMemSize",desc:"Size of RDRAM"},{addr:2147567024,type:"code",name:"ReadMainFS",desc:"Reads file from MainFS"},{addr:2147567408,type:"code",name:"FreeMainFS",desc:"Free's an allocated MainFS file pointer"},{addr:2147578972,type:"code",name:"DMA",desc:"A0=rom_addr"},{addr:2147579176,type:"code",name:"LoadFormFile",desc:"A0=main_fs_DDDDFFFF"},{addr:2147579276,type:"code",name:"GetRandomByte"},{addr:2147579328,type:"code",name:"LoadOverlay",desc:"A0=overlay_index"},{addr:2147594896,type:"code",name:"ParseObjType10",desc:"Parse OBJ1 type 0x10"},{addr:2147599080,type:"code",name:"FindFormEntry",desc:'Finds a FORM entry. A0=entry type (like "OBJ1")'},{addr:2147604788,type:"code",name:"Convert3DTo2D",desc:"A0=3 point vector"},{addr:2147630100,type:"code",name:"LoadFormBinary",desc:"A0=form_addr"},{addr:2147726976,type:"code",name:"MakePermHeap",desc:"A0=heap_addr"},{addr:2147727012,type:"code",name:"MallocPerm",desc:"A0=size"},{addr:2147727048,type:"code",name:"FreePerm",desc:"A0=addr"},{addr:2147727184,type:"code",name:"MakeTempHeap",desc:"A0=heap_addr"},{addr:2147727220,type:"code",name:"MallocTemp",desc:"A0=size"},{addr:2147727256,type:"code",name:"FreeTemp",desc:"A0=addr"},{addr:2147729740,type:"code",name:"DirectionPrompt",desc:"Prompts player to choose path at branch"},{addr:2147768184,type:"code",name:"ShowPlayerCoinChange",desc:"A0=player_index"},{addr:2147787668,type:"code",name:"HVQDecode",desc:"HVQ image decoder"},{addr:2147795436,type:"code",name:"GetSpaceData",desc:"A0=space_index"},{addr:2147795460,type:"code",name:"GetAbsSpaceIndexFromChainSpaceIndex",desc:"A0=chain_index"},{addr:2147795504,type:"code",name:"GetChainLength",desc:"A0=chain_index"},{addr:2147795532,type:"code",name:"GetChainSpaceIndexFromAbsSpaceIndex",desc:"A0=abs_space_index"},{addr:2147796108,type:"code",name:"SetSpaceType",desc:"A0=space_index"},{addr:2147797248,type:"code",name:"EventTableHydrate",desc:"Moves event table data into the space data"},{addr:2147798640,type:"code",name:"SwapPlayerLocationData",desc:"A0=player_index_1"},{addr:2147798848,type:"code",name:"SetPlayerBlue",desc:"Sets the player's turn state blue"},{addr:2147798856,type:"code",name:"SetPlayerRed",desc:"Sets the player's turn state red"},{addr:2147798864,type:"code",name:"SetPlayerGreen",desc:"Sets the player's turn state green"},{addr:2147798896,type:"code",name:"GetSumOfPlayerStars",desc:"sums the star count of all players"},{addr:2147799048,type:"code",name:"GetTurnsElapsed",desc:"Subtracts remaining turns from total turns"},{addr:2147801048,type:"code",name:"SetPlayerOntoChain",desc:"A0=player_index"},{addr:2147801156,type:"code",name:"SetNextChainAndSpace",desc:"A0=player_index"},{addr:2147801392,type:"code",name:"CreateTextWindow",desc:"creates a text window based on upper left x and y coordinate"},{addr:2147801560,type:"code",name:"ShowTextWindow"},{addr:2147801808,type:"code",name:"HideTextWindow"},{addr:2147802724,type:"code",name:"WaitForTextConfirmation"},{addr:2147822208,type:"code",name:"GetCurrentPlayerIndex"},{addr:2147822220,type:"code",name:"GetPlayerStruct",desc:"A0=player_index pass -1 to get current player's struct"},{addr:2147822284,type:"code",name:"PlayerIsCurrent",desc:"A0=player_index tests if A0 is the current player"},{addr:2147822368,type:"code",name:"PlayerIsCPU",desc:"A0=player_index"},{addr:2147822408,type:"code",name:"AdjustPlayerCoins",desc:"A0=player_index"},{addr:2147822520,type:"code",name:"PlayerHasCoins",desc:"A0=player_index"},{addr:2147823648,type:"code",name:"ClearPlayer0x20",desc:"clears all 0x20 entries in player structs"},{addr:2147834208,type:"code",name:"AdjustPlayerCoinsGradual",desc:"A0=player_index"},{addr:2147845968,type:"code",name:"ExecBoardScene",desc:"A0=board_fns"},{addr:2147850136,type:"code",name:"IsBoardFeatureDisabled",desc:"A0=0xD:bowser"},{addr:2147850204,type:"code",name:"SetBoardFeatureEnabled",desc:"A0=feature"},{addr:2147850284,type:"code",name:"SetBoardFeatureDisabled",desc:"A0=feature"},{addr:2147850368,type:"code",name:"MakeHeap",desc:"A0=addr"},{addr:2147850400,type:"code",name:"Malloc",desc:"A0=heap pointer (main or temp)"},{addr:2147850540,type:"code",name:"Free",desc:"A0=allocated heap pointer"},{addr:2147851008,type:"code",name:"Ensure16",desc:"A0=num"},{addr:2147858488,type:"code",name:"FreeString",desc:"A0=*str"},{addr:2147867688,type:"code",name:"InitProcess"},{addr:2147868048,type:"code",name:"EndProcess"},{addr:2147877548,type:"code",name:"PlaySound",desc:"A0=index"},{addr:2147885756,type:"code",name:"DrawDebugText",desc:"A0=x_pos"},{addr:2147890512,type:"code",name:"SleepProcess"},{addr:2147890612,type:"code",name:"SleepVProcess"},{addr:2147932120,type:"code",name:"LoadStringIntoWindow",desc:"A0=window_id"},{addr:2147934320,type:"code",name:"SetTextCharsPerFrame",desc:"A0=window_id"},{addr:2148005196,type:"code",name:"HVQDecodeInner",desc:"HVQ image decoder"},{addr:2148007236,type:"code",name:"__leoCommand"},{addr:2148010448,type:"code",name:"__leoAnalize_asic_status"},{addr:2148011632,type:"code",name:"__leoSend_asic_cmd_w"},{addr:2148011688,type:"code",name:"__leoSend_asic_cmd_w_nochkDiskChange"},{addr:2148012004,type:"code",name:"__leoRecal_w"},{addr:2148012144,type:"code",name:"__leoSeek_w"},{addr:2148012288,type:"code",name:"__leoChk_err_retry"},{addr:2148012560,type:"code",name:"__leoChk_cur_drvmode"},{addr:2148012832,type:"code",name:"__LEOrw_flags"},{addr:2148012834,type:"code",name:"__LEOdma_que"},{addr:2148012858,type:"code",name:"__LEOPiDmaParam"},{addr:2148012882,type:"code",name:"__LEOtgt_param"},{addr:2148012894,type:"code",name:"__LEOPiInfo"},{addr:2148012898,type:"code",name:"__LEOasic_seq_ctl_shadow"},{addr:2148012902,type:"code",name:"__leoSet_mseq"},{addr:2148013268,type:"code",name:"__leoClr_reset"},{addr:2148013380,type:"code",name:"__LEOcommand_que"},{addr:2148013404,type:"code",name:"__leoClr_queue"},{addr:2148013552,type:"code",name:"__leoLba_to_phys"},{addr:2148014484,type:"code",name:"LeoReadDiskID"},{addr:2148014580,type:"code",name:"LeoReadWrite"},{addr:2148017600,type:"code",name:"osLeoDiskInit"},{addr:2148017756,type:"code",name:"__osDiskHandle"},{addr:2148017760,type:"code",name:"__LeoDiskHandle"},{addr:2148018112,type:"code",name:"LeoDriveExist"},{addr:2148029872,type:"code",name:"sqrtf",desc:"of F0 and F12"},{addr:2148029888,type:"code",name:"cosf"},{addr:2148030224,type:"code",name:"guLookAt",desc:"Calculate a 'lookat' view matrix."},{addr:2148031124,type:"code",name:"guLookAtF",desc:"Calculate a 'lookat' view matrix (floating point)"},{addr:2148032032,type:"code",name:"guLookAtReflect"},{addr:2148032140,type:"code",name:"guLookAtReflectF"},{addr:2148033552,type:"code",name:"guLookAtHilite"},{addr:2148033764,type:"code",name:"guLookAtHiliteF"},{addr:2148036208,type:"code",name:"guMtxF2L"},{addr:2148036360,type:"code",name:"guMtxL2F"},{addr:2148036448,type:"code",name:"guMtxIdentF"},{addr:2148036528,type:"code",name:"guMtxIdentF"},{addr:2148036696,type:"code",name:"guMtxF2L"},{addr:2148036848,type:"code",name:"guMtxXFMF"},{addr:2148037020,type:"code",name:"guMtxCatF"},{addr:2148037068,type:"code",name:"guMtxXFMF"},{addr:2148037248,type:"code",name:"guMtxXFML"},{addr:2148037388,type:"code",name:"guMtxCatL"},{addr:2148037504,type:"code",name:"guOrtho",desc:"Calculate a positive projection matrix."},{addr:2148037836,type:"code",name:"guOrthoF",desc:"Calculate a positive projection matrix (floating point)"},{addr:2148038144,type:"code",name:"guPerspective",desc:"Calculate a perspective drawing projection matrix."},{addr:2148038600,type:"code",name:"guPerspectiveF",desc:"Calculate a perspective drawing projection matrix (floating point)"},{addr:2148039040,type:"code",name:"guRotate"},{addr:2148039416,type:"code",name:"guRotateF"},{addr:2148039776,type:"code",name:"guRotateRPY"},{addr:2148040172,type:"code",name:"guRotateRPYF"},{addr:2148040576,type:"code",name:"guScale"},{addr:2148040700,type:"code",name:"guScaleF"},{addr:2148040800,type:"code",name:"sinf"},{addr:2148041216,type:"code",name:"guTranslate"},{addr:2148041328,type:"code",name:"guTranslateF"},{addr:2148041424,type:"code",name:"guRandom",desc:"Generates a pseudo-random number"},{addr:2148041472,type:"code",name:"osInvalDCache"},{addr:2148041872,type:"code",name:"osSetIntMask"},{addr:2148042096,type:"code",name:"osWritebackDCache"},{addr:2148042272,type:"code",name:"osCreateMesgQueue"},{addr:2148042320,type:"code",name:"osCreateThread"},{addr:2148042736,type:"code",name:"osGetThreadPri"},{addr:2148042768,type:"code",name:"osGetTime"},{addr:2148042912,type:"code",name:"osJamMesg"},{addr:2148043232,type:"code",name:"osRecvMesg"},{addr:2148043536,type:"code",name:"osSendMesg"},{addr:2148043840,type:"code",name:"osSetThreadPri"},{addr:2148044048,type:"code",name:"osStartThread"},{addr:2148044336,type:"code",name:"osStopThread"},{addr:2148044528,type:"code",name:"__osDequeueThread"},{addr:2148044580,type:"code",name:"__osFaultedThread"},{addr:2148044584,type:"code",name:"__osRunningThread"},{addr:2148044588,type:"code",name:"__osActiveQueue"},{addr:2148044592,type:"code",name:"__osRunQueue"},{addr:2148044596,type:"code",name:"__osThreadTail"},{addr:2148044992,type:"code",name:"__osSetTimerIntr"},{addr:2148045088,type:"code",name:"__osInsertTimer"},{addr:2148045360,type:"code",name:"osVirtualToPhysical",desc:"Translates between CPU virtual address/physical memory address"},{addr:2148045472,type:"code",name:"alBnkfNew",desc:"Initializes a bank file"},{addr:2148045620,type:"code",name:"alSeqFileNew"},{addr:2148045684,type:"code",name:"__bnkf_o_0098"},{addr:2148045856,type:"code",name:"__bnkf_o_0118"},{addr:2148046004,type:"code",name:"__bnkf_o_01D8"},{addr:2148046092,type:"code",name:"__bnkf_o_0258"},{addr:2148046192,type:"code",name:"alEvtqFlushType"},{addr:2148046316,type:"code",name:"alEvtqNextEvent"},{addr:2148046368,type:"code",name:"alEvtqFlushstring_num",desc:"returns pointer"},{addr:2148046468,type:"code",name:"alEvtqPostEvent"},{addr:2148046488,type:"code",name:"alEvtqPostEvent"},{addr:2148046756,type:"code",name:"alEvtqNextEvent"},{addr:2148046856,type:"code",name:"alEvtqFlushType"},{addr:2148046908,type:"code",name:"alEvtqNew"},{addr:2148047132,type:"code",name:"alLink"},{addr:2148047164,type:"code",name:"alUnlink"},{addr:2148047216,type:"code",name:"alHeapInit"},{addr:2148047280,type:"code",name:"alHeapDBAlloc"},{addr:2148047360,type:"code",name:"alCopy"},{addr:2148047424,type:"code",name:"alCSeqGetLoc"},{addr:2148047540,type:"code",name:"alCSeqSetLoc"},{addr:2148047656,type:"code",name:"alCSeqNewMarker"},{addr:2148047692,type:"code",name:"alCSeqNextEvent"},{addr:2148047936,type:"code",name:"__alCSeqNextDelta"},{addr:2148048064,type:"code",name:"__cseq_o_0194"},{addr:2148048320,type:"code",name:"alCSeqGetTicks"},{addr:2148048328,type:"code",name:"alCSeqSecToTicks"},{addr:2148048488,type:"code",name:"alCSeqTicksToSec"},{addr:2148048612,type:"code",name:"__alCSeqNextDelta"},{addr:2148048740,type:"code",name:"alCSeqNextEvent"},{addr:2148048984,type:"code",name:"alCSeqNew"},{addr:2148049876,type:"code",name:"__cseq_o_02A4"},{addr:2148050060,type:"code",name:"__cseq_o_0088"},{addr:2148050176,type:"code",name:"alSeqpDelete"},{addr:2148050208,type:"code",name:"alSeqpGetChlFXMix"},{addr:2148050240,type:"code",name:"alSeqpGetChlPan"},{addr:2148050272,type:"code",name:"alSeqpGetChlVol"},{addr:2148050304,type:"code",name:"alSeqpGetChlProgram"},{addr:2148050432,type:"code",name:"alCSPGetTempo"},{addr:2148050480,type:"code",name:"alSeqpGetState"},{addr:2148050496,type:"code",name:"alSeqpPlay"},{addr:2148050544,type:"code",name:"alSeqpSetBank"},{addr:2148050592,type:"code",name:"alSeqpSetChlFXMix"},{addr:2148050672,type:"code",name:"alSeqpSetSeq"},{addr:2148050720,type:"code",name:"alSeqpSetTempo"},{addr:2148050800,type:"code",name:"alSeqpSetVol"},{addr:2148050848,type:"code",name:"alSeqpStop"},{addr:2148050896,type:"code",name:"alSndpDelete"},{addr:2148050944,type:"code",name:"alSndpAllocate"},{addr:2148051136,type:"code",name:"alSndpDeallocate"},{addr:2148051216,type:"code",name:"alSndpSetSound"},{addr:2148051232,type:"code",name:"alSndpPlay"},{addr:2148051328,type:"code",name:"alSndpGetSound"},{addr:2148051344,type:"code",name:"alSndpStop"},{addr:2148051424,type:"code",name:"alSndpGetState"},{addr:2148051456,type:"code",name:"alSndpSetPitch"},{addr:2148051536,type:"code",name:"alSndpSetPriority"},{addr:2148051584,type:"code",name:"alSndpSetVol"},{addr:2148051664,type:"code",name:"alSndpSetPan"},{addr:2148051744,type:"code",name:"alSndpSetFXMix"},{addr:2148051824,type:"code",name:"alSynDelete"},{addr:2148051840,type:"code",name:"alSynAddPlayer"},{addr:2148051920,type:"code",name:"alSynRemovePlayer"},{addr:2148052080,type:"code",name:"alSynFreeVoice"},{addr:2148052240,type:"code",name:"_allocatePVoice"},{addr:2148052424,type:"code",name:"alSynAllocVoice"},{addr:2148052536,type:"code",name:"__synallocvoice_o_0048"},{addr:2148052720,type:"code",name:"alSynStopVoice"},{addr:2148052848,type:"code",name:"alSynStartVoice"},{addr:2148053008,type:"code",name:"alSynSetPitch"},{addr:2148053152,type:"code",name:"alSynSetVol"},{addr:2148053344,type:"code",name:"alCents2Ratio"},{addr:2148053440,type:"code",name:"osAiGetLength"},{addr:2148053616,type:"code",name:"osSpTaskStartGo"},{addr:2148053660,type:"code",name:"osSpTaskLoad"},{addr:2148054192,type:"code",name:"osSpTaskYield"},{addr:2148054224,type:"code",name:"osSpTaskYielded"},{addr:2148054304,type:"code",name:"osViGetCurrentFramebuffer"},{addr:2148054432,type:"code",name:"osViSetEvent"},{addr:2148054528,type:"code",name:"osViSetMode"},{addr:2148054608,type:"code",name:"osViSwapBuffer"},{addr:2148054688,type:"code",name:"osViBlack"},{addr:2148055664,type:"code",name:"__osPfsGetInitData"},{addr:2148055844,type:"code",name:"__osPfsRequestData"},{addr:2148056008,type:"code",name:"__osPfsPifRam"},{addr:2148056044,type:"code",name:"__pfsisplug_o_004C"},{addr:2148056072,type:"code",name:"osPfsIsPlug"},{addr:2148056208,type:"code",name:"__pfsisplug_o_0094"},{addr:2148056400,type:"code",name:"osEepromLongWrite"},{addr:2148056640,type:"code",name:"osEepromLongRead"},{addr:2148056752,type:"code",name:"osEPiStartDma"},{addr:2148056912,type:"code",name:"__osPiCreateAccessQueue"},{addr:2148056952,type:"code",name:"__osPiGetAccess"},{addr:2148056996,type:"code",name:"__osPiGetAccess"},{addr:2148057060,type:"code",name:"__osPiAccessQueue"},{addr:2148057084,type:"code",name:"__osPiCreateAccessQueue"},{addr:2148057104,type:"code",name:"__osPiRelAccess"},{addr:2148057152,type:"code",name:"bcopy"},{addr:2148057952,type:"code",name:"bzero",desc:"Writes all zeroes"},{addr:2148058112,type:"code",name:"strchr"},{addr:2148058204,type:"code",name:"memcpy"},{addr:2148058168,type:"code",name:"strlen"},{addr:2148058256,type:"code",name:"sprintf",desc:"A0=out_addr"},{addr:2148058400,type:"code",name:"rmonPrintf",desc:"no-op in release"},{addr:2148058420,type:"code",name:"osSyncPrintf",desc:"no-op in release"},{addr:2148058564,type:"code",name:"alCSPNew"},{addr:2148065316,type:"code",name:"alSeqpNew"},{addr:2148065496,type:"code",name:"__seqplayer_o_03EC"},{addr:2148067584,type:"code",name:"__seqplayer_o_0400"},{addr:2148067692,type:"code",name:"__seqplayer_o_0A54"},{addr:2148067772,type:"code",name:"__seqplayer_o_0244"},{addr:2148067872,type:"code",name:"__seqplayer_o_0D18"},{addr:2148067956,type:"code",name:"__seqplayer_o_0A1C"},{addr:2148068168,type:"code",name:"__seqplayer_o_0284"},{addr:2148068280,type:"code",name:"__seqplayer_o_0320"},{addr:2148068308,type:"code",name:"__seqplayer_o_0C7C"},{addr:2148068376,type:"code",name:"__seqplayer_o_04F8"},{addr:2148068668,type:"code",name:"__seqplayer_o_04E0"},{addr:2148068844,type:"code",name:"__seqplayer_o_0600"},{addr:2148069016,type:"code",name:"__seqplayer_o_107C"},{addr:2148069100,type:"code",name:"__seqplayer_o_167C"},{addr:2148069228,type:"code",name:"__seqplayer_o_00BC"},{addr:2148069408,type:"code",name:"__seqplayer_o_0238"},{addr:2148069648,type:"code",name:"__seqplayer_o_05D8"},{addr:2148069712,type:"code",name:"alSynSetFXMix"},{addr:2148070164,type:"code",name:"alAudioFrame"},{addr:2148070596,type:"code",name:"alSynNew"},{addr:2148071472,type:"code",name:"osAiSetFrequency"},{addr:2148071760,type:"code",name:"__CartRomHandle"},{addr:2148071876,type:"code",name:"osCartRomInit"},{addr:2148072144,type:"code",name:"osEepromProbe"},{addr:2148072272,type:"code",name:"osEepromRead"},{addr:2148072680,type:"code",name:"__conteepread_o_00A8"},{addr:2148072816,type:"code",name:"osEepromWrite"},{addr:2148073176,type:"code",name:"__conteepwrite_o_00AC"},{addr:2148073344,type:"code",name:"__osEepStatus"},{addr:2148073760,type:"code",name:"osContGetReadData"},{addr:2148073916,type:"code",name:"osContStartReadData"},{addr:2148074052,type:"code",name:"__contreaddata_o_0028"},{addr:2148074736,type:"code",name:"osEPiReadIo"},{addr:2148074832,type:"code",name:"osEPiWriteIo"},{addr:2148074928,type:"code",name:"osMotorInit"},{addr:2148075512,type:"code",name:"__osMotorAccess"},{addr:2148075840,type:"code",name:"__osPfsDeclearPage"},{addr:2148076120,type:"code",name:"osPfsAllocateFile"},{addr:2148076620,type:"code",name:"__pfsallocatefile_o_0178"},{addr:2148076912,type:"code",name:"__osPfsReleasePages"},{addr:2148077016,type:"code",name:"osPfsDeleteFile"},{addr:2148077340,type:"code",name:"__pfsdeletefile_o_00EC"},{addr:2148077436,type:"code",name:"alHeapCheck"},{addr:2148077856,type:"code",name:"osPfsFreeBlocks"},{addr:2148078128,type:"code",name:"osPfsInitPak"},{addr:2148078632,type:"code",name:"__pfsinitpak_o_0050"},{addr:2148080192,type:"code",name:"osPfsRepairId"},{addr:2148080288,type:"code",name:"osPfsFindFile"},{addr:2148080704,type:"code",name:"__osPfsSelectBank"},{addr:2148080816,type:"code",name:"osCreatePiManager"},{addr:2148081216,type:"code",name:"__osPiRawStartDma"},{addr:2148081224,type:"code",name:"__osPiTable"},{addr:2148081228,type:"code",name:"__osPiDevMgr"},{addr:2148081332,type:"code",name:"__Dom1SpeedParam"},{addr:2148081424,type:"code",name:"__osSiRawStartDma"},{addr:2148081448,type:"code",name:"__osCurrentHandle"},{addr:2148081456,type:"code",name:"__osPiTable"},{addr:2148081460,type:"code",name:"__osPiDevMgr"},{addr:2148081600,type:"code",name:"__osSpRawStartDma"},{addr:2148082576,type:"code",name:"osViSetSpecialFeatures"},{addr:2148082944,type:"code",name:"__osViSwapContext"},{addr:2148083728,type:"code",name:"osAfterPreNMI"},{addr:2148085420,type:"code",name:"__osEnqueueAndYield"},{addr:2148085756,type:"code",name:"__osPopThread"},{addr:2148086176,type:"code",name:"osGetMemSize"},{addr:2148087072,type:"code",name:"__osDisableInt"},{addr:2148087184,type:"code",name:"__osRestoreInt"},{addr:2148087216,type:"code",name:"osSetEventMesg"},{addr:2148087392,type:"code",name:"__osSetHWIntrRoutine"},{addr:2148087680,type:"code",name:"osGetCount"},{addr:2148087712,type:"code",name:"__osProbeTLB"},{addr:2148088096,type:"code",name:"osSetTimer"},{addr:2148088256,type:"code",name:"alLoadParam"},{addr:2148088684,type:"code",name:"alRaw16Pull"},{addr:2148089608,type:"code",name:"alAdpcmPull"},{addr:2148090272,type:"code",name:"alLoadParam"},{addr:2148090700,type:"code",name:"__load_o_0108"},{addr:2148091088,type:"code",name:"alAuxBusParam"},{addr:2148091136,type:"code",name:"alAuxBusPull"},{addr:2148091308,type:"code",name:"alAuxBusParam"},{addr:2148091360,type:"code",name:"alMainBusParam"},{addr:2148091408,type:"code",name:"alMainBusPull"},{addr:2148091680,type:"code",name:"alMainBusParam"},{addr:2148091728,type:"code",name:"alResampleParam"},{addr:2148091920,type:"code",name:"alResamplePull"},{addr:2148092220,type:"code",name:"alResampleParam"},{addr:2148092416,type:"code",name:"alSeqGetLoc"},{addr:2148092480,type:"code",name:"alSeqNewMarker"},{addr:2148092648,type:"code",name:"__seq_o_044C"},{addr:2148092756,type:"code",name:"alSeqSecToTicks"},{addr:2148092900,type:"code",name:"alSeqTicksToSec"},{addr:2148093008,type:"code",name:"__alSeqNextDelta"},{addr:2148093108,type:"code",name:"alSeqNextEvent"},{addr:2148093468,type:"code",name:"alSeqNew"},{addr:2148093644,type:"code",name:"alSeqSetLoc"},{addr:2148093700,type:"code",name:"__seq_o_011C"},{addr:2148093720,type:"code",name:"__seq_o_0040"},{addr:2148093768,type:"code",name:"__seq_o_0020"},{addr:2148093848,type:"code",name:"__seq_o_0104"},{addr:2148093936,type:"code",name:"alSynSetPriority"},{addr:2148093952,type:"code",name:"alSynAllocFX"},{addr:2148094112,type:"code",name:"__osAiDeviceBusy"},{addr:2148094144,type:"code",name:"__osSpDeviceBusy"},{addr:2148094176,type:"code",name:"__osSpGetStatus"},{addr:2148094192,type:"code",name:"__osSpSetStatus"},{addr:2148094208,type:"code",name:"__osSpSetPc"},{addr:2148094628,type:"code",name:"__osSiGetAccess"},{addr:2148094736,type:"code",name:"__osSiRelAccess"},{addr:2148094784,type:"code",name:"osPiGetCmdQueue"},{addr:2148097860,type:"code",name:"alFxNew"},{addr:2148099036,type:"code",name:"alEnvmixerNew"},{addr:2148099220,type:"code",name:"alLoadNew"},{addr:2148099396,type:"code",name:"alResampleNew"},{addr:2148099536,type:"code",name:"alAuxBusNew"},{addr:2148099628,type:"code",name:"alMainBusNew"},{addr:2148099720,type:"code",name:"alSaveNew"},{addr:2148099792,type:"code",name:"_ldexpf",desc:"multiply floating-point number by integral power of 2"},{addr:2148099828,type:"code",name:"_frexpf",desc:"convert floating-point number to fractional and integral components"},{addr:2148100052,type:"code",name:"alEnvmixerParam"},{addr:2148100264,type:"code",name:"alEnvmixerPull"},{addr:2148101072,type:"code",name:"alEnvmixerParam"},{addr:2148101284,type:"code",name:"__env_o_01E0"},{addr:2148102268,type:"code",name:"__env_o_0718"},{addr:2148102908,type:"code",name:"__env_o_027C"},{addr:2148103040,type:"code",name:"_doModFunc"},{addr:2148103180,type:"code",name:"alFxParamHdl"},{addr:2148103676,type:"code",name:"alFxParam"},{addr:2148103696,type:"code",name:"_filterBuffer"},{addr:2148103852,type:"code",name:"_loadOutputBuffer"},{addr:2148103924,type:"code",name:"alFxParam"},{addr:2148104388,type:"code",name:"_loadBuffer"},{addr:2148104440,type:"code",name:"__reverb_o_0178"},{addr:2148104756,type:"code",name:"_saveBuffer"},{addr:2148104976,type:"code",name:"__reverb_o_0154"},{addr:2148105124,type:"code",name:"alFxPull"},{addr:2148105344,type:"code",name:"__reverb_o_00C4"},{addr:2148105712,type:"code",name:"__reverb_o_024C"},{addr:2148105868,type:"code",name:"__reverb_o_05D0"},{addr:2148106016,type:"code",name:"alSaveParam"},{addr:2148106056,type:"code",name:"alSavePull"},{addr:2148106184,type:"code",name:"alSaveParam"},{addr:2148106224,type:"code",name:"__osPfsInodeCache"},{addr:2148106276,type:"code",name:"__osIdCheckSum"},{addr:2148106344,type:"code",name:"__osRepairPackId"},{addr:2148106480,type:"code",name:"__osPfsRWInode"},{addr:2148107092,type:"code",name:"__osCheckPackId"},{addr:2148107304,type:"code",name:"__osCheckId"},{addr:2148107448,type:"code",name:"__osGetId"},{addr:2148107488,type:"code",name:"__osGetId"},{addr:2148107908,type:"code",name:"__osCheckId"},{addr:2148107948,type:"code",name:"__osCheckPackId"},{addr:2148108092,type:"code",name:"__osPfsRWInode"},{addr:2148108304,type:"code",name:"__osRepairPackId"},{addr:2148108928,type:"code",name:"__osContRamRead"},{addr:2148109052,type:"code",name:"__osIdCheckSum"},{addr:2148109120,type:"code",name:"__osSumcalc"},{addr:2148109172,type:"code",name:"__osPfsInodeCacheBank"},{addr:2148109173,type:"code",name:"__osPfsInodeCacheChannel"},{addr:2148109440,type:"code",name:"__osContRamWrite"},{addr:2148109984,type:"code",name:"__osContDataCrc"},{addr:2148110108,type:"code",name:"__osContAddressCrc"},{addr:2148110224,type:"code",name:"__osDevMgrMain"},{addr:2148111184,type:"code",name:"__osEPiRawReadIo"},{addr:2148111552,type:"code",name:"__osEPiRawWriteIo"},{addr:2148111920,type:"code",name:"osPfsChecker"},{addr:2148113744,type:"code",name:"__osPfsGetStatus"},{addr:2148113872,type:"code",name:"__osPfsRequestOneChannel"},{addr:2148113984,type:"code",name:"__pfsgetstatus_o_0030"},{addr:2148114020,type:"code",name:"__osPfsGetStatus"},{addr:2148114132,type:"code",name:"__pfsgetstatus_o_0084"},{addr:2148114272,type:"code",name:"__osSpRawReadIo"},{addr:2148114352,type:"code",name:"__osSpRawWriteIo"},{addr:2148114432,type:"code",name:"__osResetGlobalIntMask"},{addr:2148114512,type:"code",name:"__osSetGlobalIntMask"},{addr:2148114576,type:"code",name:"osYieldThread"},{addr:2148114656,type:"code",name:"alFilterNew"},{addr:2148114688,type:"code",name:"__osSpDeviceBusy"},{addr:2148277364,type:"data",name:"dma_table"},{addr:2148282356,type:"data",name:"rng_seed"},{addr:2148287312,type:"data",name:"model_info"},{addr:2148292986,type:"u16",name:"cur_board_scene_state",desc:"Determines how the board scene starts up when (re)loaded"},{addr:2148313792,type:"data",name:"jt_ai_logic",desc:"Jump table for 8003E9B0"},{addr:2148315232,type:"data",name:"jt_spacetype_to_turneffect",desc:"Jump table for space type to turn effect"},{addr:2148340464,type:"data",name:"main_fs_rom_location"},{addr:2148340468,type:"data",name:"main_fs_dir_count",desc:"Number of directories in main filesystem"},{addr:2148340480,type:"data",name:"main_fs_cur_dir_file_count",desc:"Count of files in directory being accessed"},{addr:2148360240,type:"data",name:"perm_heap_addr",desc:"Address of permanent heap"},{addr:2148360256,type:"data",name:"temp_heap_addr",desc:"Address of temporary heap"},{addr:2148368648,type:"data",name:"space_data",desc:"pointer to space data parsed from board def file"},{addr:2148368656,type:"data",name:"chain_data_addr",desc:"pointer to array of chain lengths and indices"},{addr:2148453156,type:"data",name:"debug_font_color",desc:"16 color values"},{addr:2148454722,type:"u16",name:"bank_coins",desc:"Coins in bank"},{addr:2148454724,type:"u16",name:"bank_stars",desc:"Stars in bank"},{addr:2148454728,type:"u16",name:"enabled_feature_flags"},{addr:2148455878,type:"u16",name:"total_turns",desc:"Total game turns"},{addr:2148455880,type:"u16",name:"remaining_turns",desc:"Remaining turns"},{addr:2148455900,type:"u16",name:"current_player_index",desc:"Player who's turn is active"},{addr:2148469236,type:"u32",name:"scene",desc:"Current scene"},{addr:2148478172,type:"u16",name:"hidden_block_space_index",desc:"Space index of hidden block"},{addr:2148479665,type:"u8",name:"p1_cpu_difficulty_1",desc:"Player 1 CPU difficulty"},{addr:2148479666,type:"u8",name:"p1_cpu_difficulty_2",desc:"Player 1 CPU difficulty"},{addr:2148479668,type:"u8",name:"p1_char",desc:"Player 1 character"},{addr:2148479672,type:"u16",name:"p1_coins",desc:"Player 1 coin count"},{addr:2148479674,type:"s16",name:"p1_minigame_coins",desc:"Player 1 coins in current Mini-Game"},{addr:2148479676,type:"u16",name:"p1_stars",desc:"Player 1 star count"},{addr:2148479678,type:"u16",name:"p1_cur_chain_index",desc:"Player 1 current chain index"},{addr:2148479680,type:"u16",name:"p1_cur_space_index",desc:"Player 1 current space index"},{addr:2148479682,type:"u16",name:"p1_next_chain_index",desc:"Player 1 next chain index"},{addr:2148479684,type:"u16",name:"p1_next_space_index",desc:"Player 1 next space index"},{addr:2148479686,type:"u8",name:"p1_poisoned",desc:"Player 1 poisoned boolean"},{addr:2148479687,type:"u8",name:"p1_turn_status",desc:"Color based on type of space landed on"},{addr:2148479700,type:"u16",name:"p1_total_minigame_coins",desc:"Player 1 total Mini-Game coins collected"},{addr:2148479702,type:"u16",name:"p1_total_coins",desc:"Player 1 total coins collected"},{addr:2148479704,type:"u8",name:"p1_total_happening_spaces",desc:"Player 1 total number of Happening Spaces landed on"},{addr:2148479705,type:"u8",name:"p1_total_red_spaces",desc:"Player 1 total number of red spaces landed on"},{addr:2148479706,type:"u8",name:"p1_total_blue_spaces",desc:"Player 1 total number of blue spaces landed on"},{addr:2148479707,type:"u8",name:"p1_total_minigame_spaces",desc:"Player 1 total number of Mini-Game spaces landed on"},{addr:2148479708,type:"u8",name:"p1_total_chance_spaces",desc:"Player 1 total number of Chance Time spaces landed on"},{addr:2148479709,type:"u8",name:"p1_total_mushroom_spaces",desc:"Player 1 total number of Mushroom spaces landed on"},{addr:2148479710,type:"u8",name:"p1_total_bowser_spaces",desc:"Player 1 total number of Bowser spaces landed on"},{addr:2148479713,type:"u8",name:"p2_cpu_difficulty_1",desc:"Player 2 CPU difficulty"},{addr:2148479714,type:"u8",name:"p2_cpu_difficulty_2",desc:"Player 2 CPU difficulty"},{addr:2148479716,type:"u8",name:"p2_char",desc:"Player 2 character"},{addr:2148479720,type:"u16",name:"p2_coins",desc:"Player 2 coin count"},{addr:2148479722,type:"s16",name:"p2_minigame_coins",desc:"Player 2 coins in current Mini-Game"},{addr:2148479724,type:"u16",name:"p2_stars",desc:"Player 2 star count"},{addr:2148479726,type:"u16",name:"p2_cur_chain_index",desc:"Player 2 current chain index"},{addr:2148479728,type:"u16",name:"p2_cur_space_index",desc:"Player 2 current space index"},{addr:2148479730,type:"u16",name:"p2_next_chain_index",desc:"Player 2 next chain index"},{addr:2148479732,type:"u16",name:"p2_next_space_index",desc:"Player 2 next space index"},{addr:2148479734,type:"u8",name:"p2_poisoned",desc:"Player 2 poisoned boolean"},{addr:2148479735,type:"u8",name:"p2_turn_status",desc:"Color based on type of spaced landed on"},{addr:2148479748,type:"u16",name:"p2_total_minigame_coins",desc:"Player 2 total Mini-Game coins collected"},{addr:2148479750,type:"u16",name:"p2_total_coins",desc:"Player 2 total coins collected"},{addr:2148479752,type:"u8",name:"p2_total_happening_spaces",desc:"Player 2 total number of Happening spaces landed on"},{addr:2148479753,type:"u8",name:"p2_total_red_spaces",desc:"Player 2 total number of red spaces landed on"},{addr:2148479754,type:"u8",name:"p2_total_blue_spaces",desc:"Player 2 total number of blue spaces landed on"},{addr:2148479755,type:"u8",name:"p2_total_minigame_spaces",desc:"Player 2 total number of Mini-Game spaces landed on"},{addr:2148479756,type:"u8",name:"p2_total_chance_spaces",desc:"Player 2 total number of Chance Time spaces landed on"},{addr:2148479757,type:"u8",name:"p2_total_mushroom_spaces",desc:"Player 2 total number of Mushroom spaces landed on"},{addr:2148479758,type:"u8",name:"p2_total_bowser_spaces",desc:"Player 2 total number of Bowser spaces landed on"},{addr:2148479761,type:"u8",name:"p3_cpu_difficulty_1",desc:"Player 3 CPU difficulty"},{addr:2148479762,type:"u8",name:"p3_cpu_difficulty_2",desc:"Player 3 CPU difficulty"},{addr:2148479764,type:"u8",name:"p3_char",desc:"Player 3 character"},{addr:2148479768,type:"u16",name:"p3_coins",desc:"Player 3 coin count"},{addr:2148479770,type:"s16",name:"p3_minigame_coins",desc:"Player 3 coins in current Mini-Game"},{addr:2148479772,type:"u16",name:"p3_stars",desc:"Player 3 star count"},{addr:2148479774,type:"u16",name:"p3_cur_chain_index",desc:"Player 3 current chain index"},{addr:2148479776,type:"u16",name:"p3_cur_space_index",desc:"Player 3 current space index"},{addr:2148479778,type:"u16",name:"p3_next_chain_index",desc:"Player 3 next chain index"},{addr:2148479780,type:"u16",name:"p3_next_space_index",desc:"Player 3 next space index"},{addr:2148479782,type:"u8",name:"p3_poisoned",desc:"Player 3 poisoned boolean"},{addr:2148479783,type:"u8",name:"p3_turn_status",desc:"Color based on type of space landed on"},{addr:2148479796,type:"u16",name:"p3_total_minigame_coins",desc:"Player 3 total Mini-Game coins collected"},{addr:2148479798,type:"u16",name:"p3_total_coins",desc:"Player 3 total coins collected"},{addr:2148479800,type:"u8",name:"p3_total_happening_spaces",desc:"Player 3 total number of Happening spaces landed on"},{addr:2148479801,type:"u8",name:"p3_total_red_spaces",desc:"Player 3 total number of red spaces landed on"},{addr:2148479802,type:"u8",name:"p3_total_blue_spaces",desc:"Player 3 total number of blue spaces landed on"},{addr:2148479803,type:"u8",name:"p3_total_minigame_spaces",desc:"Player 3 total number of Mini-Game spaces landed on"},{addr:2148479804,type:"u8",name:"p3_total_chance_spaces",desc:"Player 3 total number of Chance Time spaces landed on"},{addr:2148479805,type:"u8",name:"p3_total_mushroom_spaces",desc:"Player 3 total number of Mushroom spaces landed on"},{addr:2148479806,type:"u8",name:"p3_total_bowser_spaces",desc:"Player 3 total number of Bowser spaces landed on"},{addr:2148479809,type:"u8",name:"p3_cpu_difficulty_1",desc:"Player 3 CPU difficulty"},{addr:2148479810,type:"u8",name:"p3_cpu_difficulty_2",desc:"Player 3 CPU difficulty"},{addr:2148479812,type:"u8",name:"p4_char",desc:"Player 4 character"},{addr:2148479816,type:"u16",name:"p4_coins",desc:"Player 4 coin count"},{addr:2148479818,type:"s16",name:"p4_minigame_coins",desc:"Player 4 coins in current Mini-Game"},{addr:2148479820,type:"u16",name:"p4_stars",desc:"Player 4 star count"},{addr:2148479822,type:"u16",name:"p4_cur_chain_index",desc:"Player 4 current chain index"},{addr:2148479824,type:"u16",name:"p4_cur_space_index",desc:"Player 4 current space index"},{addr:2148479826,type:"u16",name:"p4_next_chain_index",desc:"Player 4 next chain index"},{addr:2148479828,type:"u16",name:"p4_next_space_index",desc:"Player 4 next space index"},{addr:2148479830,type:"u8",name:"p4_poisoned",desc:"Player 4 poisoned boolean"},{addr:2148479831,type:"u8",name:"p4_turn_status",desc:"Color based on type of space landed on"},{addr:2148479844,type:"u16",name:"p4_total_minigame_coins",desc:"Player 4 total Mini-Game coins collected"},{addr:2148479846,type:"u16",name:"p4_total_coins",desc:"Player 4 total coins collected"},{addr:2148479848,type:"u8",name:"p4_total_happening_spaces",desc:"Player 4 total number of Happening spaces landed on"},{addr:2148479849,type:"u8",name:"p4_total_red_spaces",desc:"Player 4 total number of red spaces landed on"},{addr:2148479850,type:"u8",name:"p4_total_blue_spaces",desc:"Player 4 total number of blue spaces landed on"},{addr:2148479851,type:"u8",name:"p4_total_minigame_spaces",desc:"Player 4 total number of Mini-Game spaces landed on"},{addr:2148479852,type:"u8",name:"p4_total_chance_spaces",desc:"Player 4 total number of Chance Time spaces landed on"},{addr:2148479853,type:"u8",name:"p4_total_mushroom_spaces",desc:"Player 4 total number of Mushroom spaces landed on"},{addr:2148479854,type:"u8",name:"p4_total_bowser_spaces",desc:"Player 4 total number of Bowser spaces landed on"}];
"use strict";PP64.ns("symbols"),PP64.symbols.MarioParty2U=[{addr:2147484416,type:"u32",name:"osTvType",desc:"0=PAL"},{addr:2147484420,type:"u32",name:"osRomType",desc:"0=cart"},{addr:2147484424,type:"data",name:"osRomBase",desc:"B0000000=cart"},{addr:2147484428,type:"data",name:"osResetType",desc:"0=cold reset"},{addr:2147484440,type:"data",name:"osMemSize",desc:"Size of RDRAM"},{addr:2147579520,type:"code",name:"ReadMainFS",desc:"Reads file from MainFS"},{addr:2147579904,type:"code",name:"FreeMainFS",desc:"Free's an allocated MainFS file pointer"},{addr:2147584764,type:"code",name:"GetRandomByte"},{addr:2147797556,type:"code",name:"ShowPlayerCoinChange",desc:"A0=player_index"},{addr:2147828328,type:"code",name:"AddArrowAngle",desc:"F0=degree_rot_of_arrow"},{addr:2147830668,type:"code",name:"GetSpaceData",desc:"A0=space_index"},{addr:2147833484,type:"code",name:"EventTableHydrate",desc:"Moves event table data into the space data"},{addr:2147867696,type:"code",name:"GetCurrentPlayerIndex"},{addr:2147867708,type:"code",name:"GetPlayerStruct",desc:"A0=player_index pass -1 to get current player's struct"},{addr:2147867780,type:"code",name:"PlayerIsCurrent",desc:"A0=player_index tests if A0 is the current player"},{addr:2147867808,type:"code",name:"PlayerIsCPU",desc:"A0=player_index"},{addr:2147867848,type:"code",name:"AdjustPlayerCoins",desc:"A0=player_index"},{addr:2147867960,type:"code",name:"PlayerHasCoins",desc:"A0=player_index"},{addr:2147882164,type:"code",name:"AdjustPlayerCoinsGradual",desc:"A0=player_index"},{addr:2147998176,type:"code",name:"SleepProcess"},{addr:2147998276,type:"code",name:"SleepVProcess"},{addr:2148397008,type:"data",name:"perm_heap_addr",desc:"Permanent heap pointer"},{addr:2148397024,type:"data",name:"temp_heap_addr",desc:"Temporary heap address"},{addr:2148084464,type:"code",name:"alSynStartVoiceParams"},{addr:2148084880,type:"code",name:"alSynSetPan"},{addr:2148101828,type:"code",name:"__leoCommand"},{addr:2148105040,type:"code",name:"__leoAnalize_asic_status"},{addr:2148106224,type:"code",name:"__leoSend_asic_cmd_w"},{addr:2148106280,type:"code",name:"__leoSend_asic_cmd_w_nochkDiskChange"},{addr:2148106596,type:"code",name:"__leoRecal_w"},{addr:2148106736,type:"code",name:"__leoSeek_w"},{addr:2148106880,type:"code",name:"__leoChk_err_retry"},{addr:2148107152,type:"code",name:"__leoChk_cur_drvmode"},{addr:2148107424,type:"code",name:"__LEOrw_flags"},{addr:2148107426,type:"code",name:"__LEOdma_que"},{addr:2148107450,type:"code",name:"__LEOPiDmaParam"},{addr:2148107474,type:"code",name:"__LEOtgt_param"},{addr:2148107490,type:"code",name:"__LEOasic_seq_ctl_shadow"},{addr:2148107494,type:"code",name:"__leoSet_mseq"},{addr:2148107860,type:"code",name:"__leoClr_reset"},{addr:2148107972,type:"code",name:"__LEOcommand_que"},{addr:2148107996,type:"code",name:"__leoClr_queue"},{addr:2148108144,type:"code",name:"__leoLba_to_phys"},{addr:2148108736,type:"code",name:"LeoDriveExist"},{addr:2148109280,type:"code",name:"__leoActive"},{addr:2148109284,type:"code",name:"LeoReadDiskID"},{addr:2148109376,type:"code",name:"__leoActive"},{addr:2148109380,type:"code",name:"LeoReadWrite"},{addr:2148109524,type:"code",name:"__LEO_country_code"},{addr:2148109528,type:"code",name:"__osShutdown"},{addr:2148109836,type:"code",name:"__LeoBootGame2"},{addr:2148110360,type:"code",name:"LeoBootGame"},{addr:2148110672,type:"code",name:"__LeoBootGame3"},{addr:2148117912,type:"code",name:"__leoInquiry"},{addr:2148118084,type:"code",name:"__leoMode_sel"},{addr:2148118260,type:"code",name:"__leoStart_stop"},{addr:2148118496,type:"code",name:"__LEORAM_BYTE"},{addr:2148118524,type:"code",name:"__LEOdisk_type"},{addr:2148118525,type:"code",name:"__LEORAM_START_LBA"},{addr:2148118543,type:"code",name:"__leoRd_capacity"},{addr:2148119508,type:"code",name:"__LEOtgt_param"},{addr:2148119520,type:"code",name:"leoRezero"},{addr:2148119668,type:"code",name:"leoSeek"},{addr:2148119860,type:"code",name:"__leoTest_unit_rdy"},{addr:2148123936,type:"code",name:"__osPiTable"},{addr:2148123940,type:"code",name:"osLeoDiskInit"},{addr:2148124092,type:"code",name:"__osDiskHandle"},{addr:2148124096,type:"code",name:"__LeoDiskHandle"},{addr:2148124448,type:"code",name:"osEepromWrite"},{addr:2148124808,type:"code",name:"__conteepwrite_o_00AC"},{addr:2148124976,type:"code",name:"__osEepStatus"},{addr:2148125392,type:"code",name:"osEepromProbe"},{addr:2148125520,type:"code",name:"osEepromLongWrite"},{addr:2148125760,type:"code",name:"osEepromLongRead"},{addr:2148127548,type:"code",name:"__osEnqueueAndYield"},{addr:2148127884,type:"code",name:"__osPopThread"},{addr:2148128304,type:"code",name:"__osDisableInt"},{addr:2148128416,type:"code",name:"__osRestoreInt"},{addr:2148128448,type:"code",name:"osSetIntMask"},{addr:2148128608,type:"code",name:"__osSetHWIntrRoutine"},{addr:2148128704,type:"code",name:"osCreatePiManager"},{addr:2148129104,type:"code",name:"__Dom2SpeedParam"},{addr:2148129112,type:"code",name:"__osPiTable"},{addr:2148129116,type:"code",name:"__osPiDevMgr"},{addr:2148129220,type:"code",name:"__Dom1SpeedParam"},{addr:2148129336,type:"code",name:"__osCurrentHandle"},{addr:2148129344,type:"code",name:"__osPiTable"},{addr:2148129348,type:"code",name:"__osPiDevMgr"},{addr:2148129600,type:"code",name:"osEPiWriteIo"},{addr:2148129696,type:"code",name:"osEPiReadIo"},{addr:2148129792,type:"code",name:"osEPiStartDma"},{addr:2148129952,type:"code",name:"__CartRomHandle"},{addr:2148130068,type:"code",name:"osCartRomInit"},{addr:2148130336,type:"code",name:"__osDevMgrMain"},{addr:2148131296,type:"code",name:"__osPiCreateAccessQueue"},{addr:2148131336,type:"code",name:"__osPiGetAccess"},{addr:2148131380,type:"code",name:"__osPiGetAccess"},{addr:2148131444,type:"code",name:"__osPiAccessQueue"},{addr:2148131468,type:"code",name:"__osPiCreateAccessQueue"},{addr:2148131488,type:"code",name:"__osPiRelAccess"},{addr:2148131536,type:"code",name:"osAiGetLength"},{addr:2148131552,type:"code",name:"__osPiAccessQueueEnabled"},{addr:2148132e3,type:"code",name:"alBnkfNew"},{addr:2148132148,type:"code",name:"alSeqFileNew"},{addr:2148132212,type:"code",name:"__bnkf_o_0098"},{addr:2148132384,type:"code",name:"__bnkf_o_0118"},{addr:2148132532,type:"code",name:"__bnkf_o_01D8"},{addr:2148132620,type:"code",name:"__bnkf_o_0258"},{addr:2148132720,type:"code",name:"alEvtqFlushType"},{addr:2148132844,type:"code",name:"alEvtqNextEvent"},{addr:2148132896,type:"code",name:"alEvtqFlush"},{addr:2148132996,type:"code",name:"alEvtqPostEvent"},{addr:2148133016,type:"code",name:"alEvtqPostEvent"},{addr:2148133284,type:"code",name:"alEvtqNextEvent"},{addr:2148133384,type:"code",name:"alEvtqFlushType"},{addr:2148133436,type:"code",name:"alEvtqNew"},{addr:2148133660,type:"code",name:"alLink"},{addr:2148133692,type:"code",name:"alUnlink"},{addr:2148133744,type:"code",name:"alHeapInit"},{addr:2148133808,type:"code",name:"alHeapDBAlloc"},{addr:2148133888,type:"code",name:"alCopy"},{addr:2148133952,type:"code",name:"alCSeqGetLoc"},{addr:2148134068,type:"code",name:"alCSeqSetLoc"},{addr:2148134184,type:"code",name:"alCSeqNewMarker"},{addr:2148134220,type:"code",name:"alCSeqNextEvent"},{addr:2148134464,type:"code",name:"__alCSeqNextDelta"},{addr:2148134592,type:"code",name:"__cseq_o_0194"},{addr:2148135140,type:"code",name:"__alCSeqNextDelta"},{addr:2148135512,type:"code",name:"alCSeqNew"},{addr:2148136404,type:"code",name:"__cseq_o_02A4"},{addr:2148136588,type:"code",name:"__cseq_o_0088"},{addr:2148136704,type:"code",name:"alSeqpDelete"},{addr:2148136736,type:"code",name:"alSeqpGetChlFXMix"},{addr:2148136768,type:"code",name:"alSeqpGetChlPan"},{addr:2148136800,type:"code",name:"alSeqpGetChlVol"},{addr:2148136832,type:"code",name:"alSeqpGetChlProgram"},{addr:2148136960,type:"code",name:"alCSPGetTempo"},{addr:2148137008,type:"code",name:"alSeqpGetState"},{addr:2148137024,type:"code",name:"alSeqpPlay"},{addr:2148137072,type:"code",name:"alSeqpSetBank"},{addr:2148137120,type:"code",name:"alSeqpSetSeq"},{addr:2148137168,type:"code",name:"alSeqpSetTempo"},{addr:2148137248,type:"code",name:"alSeqpSetVol"},{addr:2148137296,type:"code",name:"alSeqpStop"},{addr:2148137344,type:"code",name:"__CSPPostNextSeqEvent"},{addr:2148137460,type:"code",name:"alCSPNew"},{addr:2148138936,type:"code",name:"__csplayer_o_046C"},{addr:2148139052,type:"code",name:"__csplayer_o_01D0"},{addr:2148139308,type:"code",name:"__csplayer_o_03E0"},{addr:2148141448,type:"code",name:"__csplayer_o_03F4"},{addr:2148141848,type:"code",name:"__csplayer_o_115C"},{addr:2148141992,type:"code",name:"__csplayer_o_05B4"},{addr:2148142048,type:"code",name:"alSndpDelete"},{addr:2148142096,type:"code",name:"alSndpAllocate"},{addr:2148142288,type:"code",name:"alSndpDeallocate"},{addr:2148142368,type:"code",name:"alSndpSetSound"},{addr:2148142384,type:"code",name:"alSndpPlay"},{addr:2148142480,type:"code",name:"alSndpStop"},{addr:2148142560,type:"code",name:"alSndpGetState"},{addr:2148142592,type:"code",name:"alSndpSetPitch"},{addr:2148142672,type:"code",name:"alSndpSetPriority"},{addr:2148142720,type:"code",name:"alSndpSetVol"},{addr:2148142800,type:"code",name:"alSndpSetPan"},{addr:2148142880,type:"code",name:"alSndpSetFXMix"},{addr:2148143252,type:"code",name:"alAudioFrame"},{addr:2148143684,type:"code",name:"alSynNew"},{addr:2148144176,type:"code",name:"__synthesizer_o_0440"},{addr:2148144324,type:"code",name:"__synthesizer_o_0370"},{addr:2148144472,type:"code",name:"__synthesizer_o_032C"},{addr:2148144560,type:"code",name:"alSynDelete"},{addr:2148144576,type:"code",name:"alSynAddPlayer"},{addr:2148144656,type:"code",name:"alSynRemovePlayer"},{addr:2148144816,type:"code",name:"alSynFreeVoice"},{addr:2148144976,type:"code",name:"alSynAllocVoice"},{addr:2148145160,type:"code",name:"alSynAllocVoice"},{addr:2148145272,type:"code",name:"__synallocvoice_o_0048"},{addr:2148145456,type:"code",name:"alSynStopVoice"},{addr:2148145584,type:"code",name:"alSynStartVoice"},{addr:2148145744,type:"code",name:"alSynSetPitch"},{addr:2148145888,type:"code",name:"alSynSetVol"},{addr:2148146080,type:"code",name:"alSynSetFXMix"},{addr:2148146240,type:"code",name:"alSynAllocFX"},{addr:2148146400,type:"code",name:"alCents2Ratio"},{addr:2148146496,type:"code",name:"osInvalDCache"},{addr:2148146672,type:"code",name:"osInvalICache"},{addr:2148146800,type:"code",name:"osWritebackDCache"},{addr:2148146928,type:"code",name:"osWritebackDCacheAll"},{addr:2148146976,type:"code",name:"osContGetReadData"},{addr:2148147132,type:"code",name:"osContStartReadData"},{addr:2148147268,type:"code",name:"__contreaddata_o_0028"},{addr:2148148336,type:"code",name:"osVirtualToPhysical"},{addr:2148148432,type:"code",name:"cosf"},{addr:2148148768,type:"code",name:"guLookAt"},{addr:2148149668,type:"code",name:"guLookAtF"},{addr:2148150576,type:"code",name:"guLookAtHilite"},{addr:2148150788,type:"code",name:"guLookAtHiliteF"},{addr:2148153232,type:"code",name:"guLookAtReflect"},{addr:2148153340,type:"code",name:"guLookAtReflectF"},{addr:2148154924,type:"code",name:"guMtxCatF"},{addr:2148155152,type:"code",name:"guMtxXFML"},{addr:2148155292,type:"code",name:"guMtxCatL"},{addr:2148155408,type:"code",name:"guMtxF2L"},{addr:2148155560,type:"code",name:"guMtxL2F"},{addr:2148155648,type:"code",name:"guMtxIdentF"},{addr:2148155728,type:"code",name:"guMtxIdentF"},{addr:2148156048,type:"code",name:"guOrtho"},{addr:2148156380,type:"code",name:"guOrthoF"},{addr:2148156688,type:"code",name:"guPerspective"},{addr:2148157144,type:"code",name:"guPerspectiveF"},{addr:2148157584,type:"code",name:"guRandom",desc:"Generates a pseudo-random number"},{addr:2148157632,type:"code",name:"guRotate"},{addr:2148158008,type:"code",name:"guRotateF"},{addr:2148158368,type:"code",name:"guRotateRPY"},{addr:2148158764,type:"code",name:"guRotateRPYF"},{addr:2148159168,type:"code",name:"guScale"},{addr:2148159292,type:"code",name:"guScaleF"},{addr:2148159392,type:"code",name:"sinf"},{addr:2148159808,type:"code",name:"guTranslate"},{addr:2148159920,type:"code",name:"guTranslateF"},{addr:2148160016,type:"code",name:"bcopy"},{addr:2148160816,type:"code",name:"bzero"},{addr:2148160976,type:"code",name:"memcpy"},{addr:2148161016,type:"code",name:"strlen"},{addr:2148161040,type:"code",name:"strlen"},{addr:2148161052,type:"code",name:"strchr"},{addr:2148161076,type:"code",name:"memcpy"},{addr:2148161120,type:"code",name:"sprintf"},{addr:2148161264,type:"code",name:"rmonPrintf",desc:"no-op in released ROM"},{addr:2148161284,type:"code",name:"osSyncPrintf",desc:"no-op in released ROM"},{addr:2148161312,type:"code",name:"osCreateMesgQueue"},{addr:2148161360,type:"code",name:"osJamMesg"},{addr:2148161680,type:"code",name:"osRecvMesg"},{addr:2148161984,type:"code",name:"osSendMesg"},{addr:2148162288,type:"code",name:"osSetEventMesg"},{addr:2148162464,type:"code",name:"__osSetCause"},{addr:2148162480,type:"code",name:"__osSetCompare"},{addr:2148162496,type:"code",name:"__osSetCount"},{addr:2148162512,type:"code",name:"__osSetSR"},{addr:2148162528,type:"code",name:"osSpTaskStartGo"},{addr:2148162572,type:"code",name:"osSpTaskLoad"},{addr:2148163104,type:"code",name:"osSpTaskYield"},{addr:2148163136,type:"code",name:"osSpTaskYielded"},{addr:2148163216,type:"code",name:"__osSiRawStartDma"},{addr:2148163476,type:"code",name:"__osSiGetAccess"},{addr:2148163584,type:"code",name:"__osSiRelAccess"},{addr:2148163632,type:"code",name:"osCreateThread"},{addr:2148164064,type:"code",name:"osGetThreadPri"},{addr:2148164096,type:"code",name:"osSetThreadPri"},{addr:2148164304,type:"code",name:"osStartThread"},{addr:2148164592,type:"code",name:"osStopThread"},{addr:2148164784,type:"code",name:"__osDequeueThread"},{addr:2148164836,type:"code",name:"__osFaultedThread"},{addr:2148164840,type:"code",name:"__osRunningThread"},{addr:2148164844,type:"code",name:"__osActiveQueue"},{addr:2148164848,type:"code",name:"osYieldThread"},{addr:2148164852,type:"code",name:"__osThreadTail"},{addr:2148164928,type:"code",name:"osGetTime"},{addr:2148165072,type:"code",name:"osSetTimer"},{addr:2148165632,type:"code",name:"__osSetTimerIntr"},{addr:2148165728,type:"code",name:"__osInsertTimer"},{addr:2148166e3,type:"code",name:"__osProbeTLB"},{addr:2148166192,type:"code",name:"osViGetCurrentFramebuffer"},{addr:2148167152,type:"code",name:"osViSetEvent"},{addr:2148167248,type:"code",name:"osViSetMode"},{addr:2148167328,type:"code",name:"osViSetSpecialFeatures"},{addr:2148167696,type:"code",name:"osViSetYScale"},{addr:2148167776,type:"code",name:"osViSwapBuffer"},{addr:2148167856,type:"code",name:"__osViSwapContext"},{addr:2148168640,type:"code",name:"osViBlack"},{addr:2148168736,type:"code",name:"osMotorInit"},{addr:2148169320,type:"code",name:"__osMotorAccess"},{addr:2148169648,type:"code",name:"__osPfsSelectBank"},{addr:2148169760,type:"code",name:"__osContRamRead"},{addr:2148170248,type:"code",name:"__osPfsLastChannel"},{addr:2148170256,type:"code",name:"__osContRamWrite"},{addr:2148170880,type:"code",name:"osAfterPreNMI"},{addr:2148170912,type:"code",name:"osGetMemSize"},{addr:2148171824,type:"code",name:"osEepromRead"},{addr:2148172232,type:"code",name:"__conteepread_o_00A8"},{addr:2148172368,type:"code",name:"__osSetGlobalIntMask"},{addr:2148172432,type:"code",name:"__osResetGlobalIntMask"},{addr:2148172512,type:"code",name:"__osPiRawStartDma"},{addr:2148172720,type:"code",name:"osPiGetCmdQueue"},{addr:2148172752,type:"code",name:"__osEPiRawReadIo"},{addr:2148173104,type:"code",name:"alHeapCheck"},{addr:2148173120,type:"code",name:"__osEPiRawWriteIo"},{addr:2148173488,type:"code",name:"__osAiDeviceBusy"},{addr:2148173520,type:"code",name:"_init_lpfilter"},{addr:2148173684,type:"code",name:"alFxNew"},{addr:2148174860,type:"code",name:"alEnvmixerNew"},{addr:2148175044,type:"code",name:"alLoadNew"},{addr:2148175220,type:"code",name:"alResampleNew"},{addr:2148175360,type:"code",name:"alAuxBusNew"},{addr:2148175452,type:"code",name:"alMainBusNew"},{addr:2148175544,type:"code",name:"alSaveNew"},{addr:2148175616,type:"code",name:"alLoadParam"},{addr:2148176044,type:"code",name:"alRaw16Pull"},{addr:2148176968,type:"code",name:"alAdpcmPull"},{addr:2148177632,type:"code",name:"alLoadParam"},{addr:2148178060,type:"code",name:"__load_o_0108"},{addr:2148178448,type:"code",name:"alAuxBusParam"},{addr:2148178496,type:"code",name:"alAuxBusPull"},{addr:2148178668,type:"code",name:"alAuxBusParam"},{addr:2148178720,type:"code",name:"_ldexpf"},{addr:2148178756,type:"code",name:"_frexpf"},{addr:2148178980,type:"code",name:"alEnvmixerParam"},{addr:2148179192,type:"code",name:"alEnvmixerPull"},{addr:214818e4,type:"code",name:"alEnvmixerParam"},{addr:2148180212,type:"code",name:"__env_o_01E0"},{addr:2148181196,type:"code",name:"__env_o_0718"},{addr:2148181836,type:"code",name:"__env_o_027C"},{addr:2148181968,type:"code",name:"alFilterNew"},{addr:2148182e3,type:"code",name:"alMainBusParam"},{addr:2148182048,type:"code",name:"alMainBusPull"},{addr:2148182320,type:"code",name:"alMainBusParam"},{addr:2148182368,type:"code",name:"alResampleParam"},{addr:2148182560,type:"code",name:"alResamplePull"},{addr:2148182860,type:"code",name:"alResampleParam"},{addr:2148183056,type:"code",name:"_doModFunc"},{addr:2148183196,type:"code",name:"alFxParamHdl"},{addr:2148183692,type:"code",name:"alFxParam"},{addr:2148183712,type:"code",name:"_filterBuffer"},{addr:2148183868,type:"code",name:"_loadOutputBuffer"},{addr:2148183940,type:"code",name:"alFxParam"},{addr:2148184404,type:"code",name:"_loadBuffer"},{addr:2148184456,type:"code",name:"__reverb_o_0178"},{addr:2148184772,type:"code",name:"_saveBuffer"},{addr:2148184992,type:"code",name:"__reverb_o_0154"},{addr:2148185140,type:"code",name:"alFxPull"},{addr:2148185360,type:"code",name:"__reverb_o_00C4"},{addr:2148185728,type:"code",name:"__reverb_o_024C"},{addr:2148185884,type:"code",name:"__reverb_o_05D0"},{addr:2148186032,type:"code",name:"alSaveParam"},{addr:2148186072,type:"code",name:"alSavePull"},{addr:2148186200,type:"code",name:"alSaveParam"},{addr:2148186240,type:"code",name:"__resetPerfChanState"},{addr:2148186368,type:"code",name:"__setInstChanState"},{addr:2148186452,type:"code",name:"__lookupVoice"},{addr:2148186536,type:"code",name:"__vsPan"},{addr:2148186604,type:"code",name:"__mapVoice"},{addr:2148186684,type:"code",name:"__lookupSoundQuick"},{addr:2148186896,type:"code",name:"__initFromBank"},{addr:2148187068,type:"code",name:"__seqpReleaseVoice"},{addr:2148187360,type:"code",name:"__voiceNeedsNoteKill"},{addr:2148187536,type:"code",name:"__postNextSeqEvent"},{addr:2148187744,type:"code",name:"__vsDelta"},{addr:2148187772,type:"code",name:"__vsVol"},{addr:2148187864,type:"code",name:"__seqplayer_o_0420"},{addr:2148187884,type:"code",name:"__unmapVoice"},{addr:2148187984,type:"code",name:"__seqpStopOsc"},{addr:2148188072,type:"code",name:"__seqplayer_o_01DC"},{addr:2148188224,type:"code",name:"__initChanState"},{addr:2148188404,type:"code",name:"alSeqpNew"},{addr:2148188584,type:"code",name:"__seqplayer_o_03EC"},{addr:2148190672,type:"code",name:"__seqplayer_o_0400"},{addr:2148190780,type:"code",name:"__seqplayer_o_0A54"},{addr:2148190860,type:"code",name:"__seqplayer_o_0244"},{addr:2148190960,type:"code",name:"__seqplayer_o_0D18"},{addr:2148191044,type:"code",name:"__seqplayer_o_0A1C"},{addr:2148191256,type:"code",name:"__seqplayer_o_0284"},{addr:2148191368,type:"code",name:"__seqplayer_o_0320"},{addr:2148191396,type:"code",name:"__seqplayer_o_0C7C"},{addr:2148191464,type:"code",name:"__seqplayer_o_04F8"},{addr:2148191756,type:"code",name:"__seqplayer_o_04E0"},{addr:2148191932,type:"code",name:"__seqplayer_o_0600"},{addr:2148192104,type:"code",name:"__seqplayer_o_107C"},{addr:2148192188,type:"code",name:"__seqplayer_o_167C"},{addr:2148192316,type:"code",name:"__seqplayer_o_00BC"},{addr:2148192496,type:"code",name:"__seqplayer_o_0238"},{addr:2148192736,type:"code",name:"__seqplayer_o_05D8"},{addr:2148192800,type:"code",name:"alSynSetPriority"},{addr:2148192816,type:"code",name:"sqrtf",desc:"SQRT.S F0"},{addr:2148195664,type:"code",name:"osGetCount"},{addr:2148195728,type:"code",name:"__osSpDeviceBusy"},{addr:2148195760,type:"code",name:"__osSpGetStatus"},{addr:2148195776,type:"code",name:"__osSpSetStatus"},{addr:2148195792,type:"code",name:"__osSpSetPc"},{addr:2148195840,type:"code",name:"__osSpRawStartDma"},{addr:2148195984,type:"code",name:"__osSpRawReadIo"},{addr:2148196064,type:"code",name:"__osSpRawWriteIo"},{addr:2148196144,type:"code",name:"__osContDataCrc"},{addr:2148196252,type:"code",name:"__osContDataCrc"},{addr:2148196268,type:"code",name:"__osContAddressCrc"},{addr:2148196848,type:"code",name:"__osPfsGetInitData"},{addr:2148197028,type:"code",name:"__osPfsRequestData"},{addr:2148197192,type:"code",name:"__osPfsPifRam"},{addr:2148197228,type:"code",name:"__pfsisplug_o_004C"},{addr:2148197256,type:"code",name:"osPfsIsPlug"},{addr:2148197392,type:"code",name:"__pfsisplug_o_0094"},{addr:2148197584,type:"code",name:"__osPfsGetOneChannelData"},{addr:2148197712,type:"code",name:"__osPfsRequestOneChannel"},{addr:2148197824,type:"code",name:"__pfsgetstatus_o_0030"},{addr:2148197860,type:"code",name:"__osPfsGetStatus"},{addr:2148197972,type:"code",name:"__pfsgetstatus_o_0084"},{addr:2148198112,type:"code",name:"__osPfsInodeCache"},{addr:2148198232,type:"code",name:"__contpfs_o_0598"},{addr:2148198368,type:"code",name:"__osPfsRWInode"},{addr:2148198980,type:"code",name:"__contpfs_o_0578"},{addr:2148199192,type:"code",name:"__osCheckId"},{addr:2148199376,type:"code",name:"__osGetId"},{addr:2148199836,type:"code",name:"__osCheckPackId"},{addr:2148200192,type:"code",name:"__osRepairPackId"},{addr:2148202608,type:"code",name:"_Litob"},{addr:2148203200,type:"code",name:"_Ldtob"},{addr:2148204300,type:"code",name:"__xldtob_o_0080"},{addr:2148204452,type:"code",name:"__xldtob_o_0414"},{addr:2148205904,type:"code",name:"__osSpDeviceBusy"},{addr:2148209696,type:"code",name:"__divdi3"},{addr:2148210064,type:"code",name:"__udivdi3"},{addr:2148210096,type:"code",name:"__umoddi3"},{addr:2148509246,type:"u16",name:"scene",desc:"Current scene number"},{addr:2148520648,type:"u16",name:"p1_coins",desc:"Player 1 coin count"},{addr:2148520654,type:"u16",name:"p1_stars",desc:"Player 1 star count"},{addr:2148520656,type:"u16",name:"p1_cur_chain_index",desc:"Player 1 current chain index"},{addr:2148520658,type:"u16",name:"p1_cur_space_index",desc:"Player 1 current space index"},{addr:2148520660,type:"u16",name:"p1_next_chain_index",desc:"Player 1 next chain index"},{addr:2148520662,type:"u16",name:"p1_next_space_index",desc:"Player 1 next space index"},{addr:2148520665,type:"u8",name:"p1_item",desc:"Player 1 item"},{addr:2148520666,type:"u16",name:"p1_turn_status",desc:"Player 1 turn status"},{addr:2148520700,type:"u16",name:"p2_coins",desc:"Player 2 coin count"},{addr:2148520706,type:"u16",name:"p2_stars",desc:"Player 2 star count"},{addr:2148520708,type:"u16",name:"p2_cur_chain_index",desc:"Player 2 current chain index"},{addr:2148520710,type:"u16",name:"p2_cur_space_index",desc:"Player 2 current space index"},{addr:2148520712,type:"u16",name:"p2_next_chain_index",desc:"Player 2 next chain index"},{addr:2148520714,type:"u16",name:"p2_next_space_index",desc:"Player 2 next space index"},{addr:2148520717,type:"u8",name:"p2_item",desc:"Player 2 item"},{addr:2148520718,type:"u16",name:"p2_turn_status",desc:"Player 2 turn status"},{addr:2148520752,type:"u16",name:"p3_coins",desc:"Player 3 coin count"},{addr:2148520758,type:"u16",name:"p3_stars",desc:"Player 3 star count"},{addr:2148520769,type:"u8",name:"p3_item",desc:"Player 3 item"},{addr:2148520770,type:"u16",name:"p3_turn_statu",desc:"Player 3 turn status"},{addr:2148520804,type:"u16",name:"p4_coins",desc:"Player 4 coin count"},{addr:2148520810,type:"u16",name:"p4_stars",desc:"Player 4 star count"},{addr:2148520821,type:"u8",name:"p4_item",desc:"Player 4 item"},{addr:2148520822,type:"u16",name:"p4_turn_status",desc:"Player 4 turn status"},{addr:2148407504,type:"u16",name:"num_board_spaces"},{addr:2148407506,type:"u16",name:"num_chains"},{addr:2148407508,type:"u32",name:"hydrated_space_data"},{addr:2148407512,type:"u32",name:"hydrated_chains"},{addr:2148407616,type:"data",name:"arrow_angles",desc:"f32[8]"},{addr:2148407648,type:"u32",name:"num_arrow_angles"}];
"use strict";PP64.ns("symbols"),PP64.symbols.MarioParty3U=[{addr:2147484416,type:"u32",name:"osTvType",desc:"0=PAL"},{addr:2147484420,type:"u32",name:"osRomType",desc:"0=cart"},{addr:2147484424,type:"data",name:"osRomBase",desc:"B0000000=cart"},{addr:2147484428,type:"data",name:"osResetType",desc:"0=cold reset"},{addr:2147484440,type:"data",name:"osMemSize",desc:"Size of RDRAM"},{addr:2147523600,type:"code",name:"ReadMainFS",desc:"Reads file from MainFS"},{addr:2147524204,type:"code",name:"FreeMainFS",desc:"Free's an allocated MainFS file pointer"},{addr:2147529068,type:"code",name:"GetRandomByte"},{addr:2147530808,type:"code",name:"LoadGraphics"},{addr:2147532780,type:"code",name:"InitEspriteSlot"},{addr:2147533188,type:"code",name:"CloseEsprite"},{addr:2147557920,type:"code",name:"InitCameras",desc:"A0=num_cameras"},{addr:2147614240,type:"code",name:"InitAnimations",desc:"A0=1"},{addr:2147702884,type:"code",name:"MallocPerm",desc:"A0=size"},{addr:2147774816,type:"code",name:"InitObjSys"},{addr:2147778208,type:"code",name:"InitProcess"},{addr:2147778568,type:"code",name:"EndProcess"},{addr:2147778856,type:"code",name:"LoadOverlay",desc:"A0=num"},{addr:2147789448,type:"code",name:"PlaySound",desc:"A0=index"},{addr:2147802492,type:"code",name:"DrawDebugText",desc:"A0=x_pos"},{addr:2147807248,type:"code",name:"SleepProcess"},{addr:2147807348,type:"code",name:"SleepVProcess",desc:"Sleep 1 frame"},{addr:2147833872,type:"code",name:"ImgPackParse"},{addr:2147885032,type:"code",name:"InitFadeIn",desc:"A0=fade_type"},{addr:2147885136,type:"code",name:"InitFadeOut",desc:"A0=fade_type"},{addr:2147885244,type:"code",name:"GetFadeStatus",desc:"returns 0 when fade action is finished"},{addr:2147902720,type:"code",name:"setjmp"},{addr:2147902820,type:"code",name:"longjmp"},{addr:2147930096,type:"code",name:"alSeqpGetChlVol"},{addr:2147930128,type:"code",name:"alSeqpGetChlFXMix"},{addr:2147930160,type:"code",name:"alSeqpGetChlPan"},{addr:2147930192,type:"code",name:"alSeqpGetChlProgram"},{addr:2147930320,type:"code",name:"alSeqpGetState"},{addr:2147930336,type:"code",name:"alCSPGetTempo"},{addr:2147930384,type:"code",name:"alSeqpPlay"},{addr:2147930432,type:"code",name:"alSeqpSetBank"},{addr:2147930480,type:"code",name:"alSeqpSetSeq"},{addr:2147930528,type:"code",name:"alSeqpSetTempo"},{addr:2147930608,type:"code",name:"alSeqpSetVol"},{addr:2147930656,type:"code",name:"alSeqpStop"},{addr:2147933812,type:"code",name:"alEvtqPostEvent"},{addr:2147950624,type:"code",name:"osEepromWrite"},{addr:2147951228,type:"code",name:"__osEepStatus"},{addr:2147951776,type:"code",name:"osEepromLongWrite"},{addr:2147952016,type:"code",name:"osEepromLongRead"},{addr:2147952128,type:"code",name:"osSetIntMask"},{addr:2147952288,type:"code",name:"osCreatePiManager"},{addr:2147952748,type:"code",name:"__Dom2SpeedParam"},{addr:2147952756,type:"code",name:"__osPiTable"},{addr:2147952760,type:"code",name:"__osPiDevMgr"},{addr:2147952864,type:"code",name:"__Dom1SpeedParam"},{addr:2147952976,type:"code",name:"__osEPiRawStartDma"},{addr:2147952980,type:"code",name:"__osCurrentHandle"},{addr:2147952988,type:"code",name:"__osPiTable"},{addr:2147952992,type:"code",name:"__osPiDevMgr"},{addr:2147953472,type:"code",name:"osEPiStartDma"},{addr:2147953632,type:"code",name:"__CartRomHandle"},{addr:2147953748,type:"code",name:"osCartRomInit"},{addr:2147954016,type:"code",name:"__osDevMgrMain"},{addr:2147954976,type:"code",name:"__osPiRelAccess"},{addr:2147955016,type:"code",name:"__osPiGetAccess"},{addr:2147955060,type:"code",name:"__osPiGetAccess"},{addr:2147955124,type:"code",name:"__osPiAccessQueue"},{addr:2147955148,type:"code",name:"__osPiCreateAccessQueue"},{addr:2147955168,type:"code",name:"__osPiRelAccess"},{addr:2147955216,type:"code",name:"osAiGetLength"},{addr:2147955232,type:"code",name:"__osPiAccessQueueEnabled"},{addr:2147955680,type:"code",name:"_init_lpfilter"},{addr:2147955844,type:"code",name:"alFxNew"},{addr:2147957020,type:"code",name:"alEnvmixerNew"},{addr:2147957204,type:"code",name:"alLoadNew"},{addr:2147957380,type:"code",name:"alResampleNew"},{addr:2147957520,type:"code",name:"alAuxBusNew"},{addr:2147957612,type:"code",name:"alMainBusNew"},{addr:2147957704,type:"code",name:"alSaveNew"},{addr:2147957776,type:"code",name:"alLoadParam"},{addr:2147958204,type:"code",name:"alRaw16Pull"},{addr:2147959128,type:"code",name:"alAdpcmPull"},{addr:2147959792,type:"code",name:"alLoadParam"},{addr:2147960220,type:"code",name:"__load_o_0108"},{addr:2147960608,type:"code",name:"alAuxBusParam"},{addr:2147960656,type:"code",name:"alAuxBusPull"},{addr:2147960828,type:"code",name:"alAuxBusParam"},{addr:2147960880,type:"code",name:"alBnkfNew"},{addr:2147961028,type:"code",name:"alSeqFileNew"},{addr:2147961092,type:"code",name:"__bnkf_o_0098"},{addr:2147961264,type:"code",name:"__bnkf_o_0118"},{addr:2147961412,type:"code",name:"__bnkf_o_01D8"},{addr:2147961500,type:"code",name:"__bnkf_o_0258"},{addr:2147961600,type:"code",name:"_ldexpf"},{addr:2147961636,type:"code",name:"_frexpf"},{addr:2147961860,type:"code",name:"alEnvmixerParam"},{addr:2147962072,type:"code",name:"alEnvmixerPull"},{addr:2147962880,type:"code",name:"alEnvmixerParam"},{addr:2147963092,type:"code",name:"__env_o_01E0"},{addr:2147964076,type:"code",name:"__env_o_0718"},{addr:2147964716,type:"code",name:"__env_o_027C"},{addr:2147964848,type:"code",name:"alEvtqFlushType"},{addr:2147965024,type:"code",name:"alEvtqFlush"},{addr:2147965144,type:"code",name:"alEvtqPostEvent"},{addr:2147965412,type:"code",name:"alEvtqNextEvent"},{addr:2147965564,type:"code",name:"alEvtqNew"},{addr:2147965696,type:"code",name:"alFilterNew"},{addr:2147965728,type:"code",name:"alMainBusParam"},{addr:2147965776,type:"code",name:"alMainBusPull"},{addr:2147966048,type:"code",name:"alMainBusParam"},{addr:2147966096,type:"code",name:"alResampleParam"},{addr:2147966288,type:"code",name:"alResamplePull"},{addr:2147966588,type:"code",name:"alResampleParam"},{addr:2147971580,type:"code",name:"alLink"},{addr:2147971612,type:"code",name:"alUnlink"},{addr:2147971664,type:"code",name:"alHeapInit"},{addr:2147971728,type:"code",name:"alHeapDBAlloc"},{addr:2147971808,type:"code",name:"alCopy"},{addr:2147971872,type:"code",name:"alCSeqGetLoc"},{addr:2147971988,type:"code",name:"alCSeqSetLoc"},{addr:2147972104,type:"code",name:"alCSeqNewMarker"},{addr:2147972384,type:"code",name:"__alCSeqNextDelta"},{addr:2147972512,type:"code",name:"__cseq_o_0194"},{addr:2147972768,type:"code",name:"alCSeqGetTicks"},{addr:2147972776,type:"code",name:"alCSeqSecToTicks"},{addr:2147972936,type:"code",name:"alCSeqTicksToSec"},{addr:2147973060,type:"code",name:"__alCSeqNextDelta"},{addr:2147973188,type:"code",name:"alCSeqNextEvent"},{addr:2147973432,type:"code",name:"alCSeqNew"},{addr:2147974324,type:"code",name:"__cseq_o_02A4"},{addr:2147974508,type:"code",name:"__cseq_o_0088"},{addr:2147974916,type:"code",name:"alAudioFrame"},{addr:2147975348,type:"code",name:"alSynNew"},{addr:2147975840,type:"code",name:"__synthesizer_o_0440"},{addr:2147975988,type:"code",name:"__synthesizer_o_0370"},{addr:2147976136,type:"code",name:"__synthesizer_o_032C"},{addr:2147976224,type:"code",name:"alSynDelete"},{addr:2147976240,type:"code",name:"alSynAddPlayer"},{addr:2147976320,type:"code",name:"alSynFreeVoice"},{addr:2147976664,type:"code",name:"alSynAllocVoice"},{addr:2147976776,type:"code",name:"__synallocvoice_o_0048"},{addr:2147976960,type:"code",name:"alSynStopVoice"},{addr:2147977088,type:"code",name:"alSynStartVoice"},{addr:2147977248,type:"code",name:"alSynSetPitch"},{addr:2147977392,type:"code",name:"alSynSetVol"},{addr:2147977584,type:"code",name:"alSynSetFXMix"},{addr:2147977744,type:"code",name:"alSynSetPan"},{addr:2147977888,type:"code",name:"alSynAllocFX"},{addr:2147978048,type:"code",name:"alCents2Ratio"},{addr:2147978144,type:"code",name:"osInvalDCache"},{addr:2147978320,type:"code",name:"osInvalICache"},{addr:2147978448,type:"code",name:"osWritebackDCache"},{addr:2147978624,type:"code",name:"osContGetReadData"},{addr:2147978780,type:"code",name:"osContStartReadData"},{addr:2147978916,type:"code",name:"__contreaddata_o_0028"},{addr:2147979984,type:"code",name:"osVirtualToPhysical"},{addr:2147980080,type:"code",name:"cosf"},{addr:2147980416,type:"code",name:"guLookAt"},{addr:2147981316,type:"code",name:"guLookAtF"},{addr:2147982224,type:"code",name:"guLookAtHilite"},{addr:2147982436,type:"code",name:"guLookAtHiliteF"},{addr:2147984880,type:"code",name:"guLookAtReflect"},{addr:2147984988,type:"code",name:"guLookAtReflectF"},{addr:2147986400,type:"code",name:"guOrtho"},{addr:2147986732,type:"code",name:"guOrthoF"},{addr:2147987040,type:"code",name:"guPerspective"},{addr:2147987496,type:"code",name:"guPerspectiveF"},{addr:2147987936,type:"code",name:"guRandom"},{addr:2147987984,type:"code",name:"guRotateRPY"},{addr:2147988380,type:"code",name:"guRotateRPYF"},{addr:2147988784,type:"code",name:"sinf"},{addr:2147989200,type:"code",name:"__osRdbSend"},{addr:2147989736,type:"code",name:"__osRdb_IP6_Empty"},{addr:2147989744,type:"code",name:"__osRdb_IP6_CurSend"},{addr:2147989748,type:"code",name:"__osRdb_IP6_CurWrite"},{addr:2147989752,type:"code",name:"__osRdb_IP6_Ct"},{addr:2147989756,type:"code",name:"__osRdb_IP6_Size"},{addr:2147989760,type:"code",name:"__osRdb_IP6_Data"},{addr:2147989764,type:"code",name:"osInitRdb"},{addr:2147989872,type:"code",name:"bcopy"},{addr:2147990672,type:"code",name:"bzero"},{addr:2147990832,type:"code",name:"memcpy"},{addr:2147990896,type:"code",name:"strlen"},{addr:2147990976,type:"code",name:"sprintf"},{addr:2147991120,type:"code",name:"rmonPrintf",desc:"disabled behind flag"},{addr:2147991168,type:"code",name:"osSyncPrintf",desc:"disabled behind flag"},{addr:2147991296,type:"code",name:"osCreateMesgQueue"},{addr:2147991344,type:"code",name:"osJamMesg"},{addr:2147991664,type:"code",name:"osRecvMesg"},{addr:2147991968,type:"code",name:"osSendMesg"},{addr:2147992272,type:"code",name:"__osEventStateTab"},{addr:2147992392,type:"code",name:"osSetEventMesg"},{addr:2147992456,type:"code",name:"osSetEventMesg"},{addr:2147992512,type:"code",name:"osSpTaskStartGo"},{addr:2147992556,type:"code",name:"osSpTaskLoad"},{addr:2147993088,type:"code",name:"osSpTaskYield"},{addr:2147993120,type:"code",name:"osSpTaskYielded"},{addr:2147993200,type:"code",name:"__osSiRawStartDma"},{addr:2147993460,type:"code",name:"__osSiGetAccess"},{addr:2147993568,type:"code",name:"__osSiRelAccess"},{addr:2147993616,type:"code",name:"osCreateThread"},{addr:2147994096,type:"code",name:"osGetThreadPri"},{addr:2147994128,type:"code",name:"osSetThreadPri"},{addr:2147994336,type:"code",name:"osStartThread"},{addr:2147994624,type:"code",name:"__osDequeueThread"},{addr:2147994676,type:"code",name:"__osFaultedThread"},{addr:2147994680,type:"code",name:"__osRunningThread"},{addr:2147994684,type:"code",name:"__osActiveQueue"},{addr:2147994688,type:"code",name:"osYieldThread"},{addr:2147994692,type:"code",name:"__osThreadTail"},{addr:2147994768,type:"code",name:"osGetTime"},{addr:2147994912,type:"code",name:"osSetTimer"},{addr:2147995784,type:"code",name:"__osSetTimerIntr"},{addr:2147995912,type:"code",name:"__osInsertTimer"},{addr:2147996176,type:"code",name:"__osProbeTLB"},{addr:2147996368,type:"code",name:"osViGetCurrentFramebuffer"},{addr:2147997328,type:"code",name:"osViSetEvent"},{addr:2147997424,type:"code",name:"osViSetMode"},{addr:2147997504,type:"code",name:"osViSetSpecialFeatures"},{addr:2147997872,type:"code",name:"osViSetYScale"},{addr:2147997952,type:"code",name:"osViSwapBuffer"},{addr:2147998032,type:"code",name:"__osViSwapContext"},{addr:2147998816,type:"code",name:"osViBlack"},{addr:2147998912,type:"code",name:"guMtxIdentF"},{addr:2147999008,type:"code",name:"guMtxF2L"},{addr:2147999136,type:"code",name:"guMtxL2F"},{addr:2147999264,type:"code",name:"guMtxCatF"},{addr:2147999808,type:"code",name:"guMtxCatL"},{addr:2147999936,type:"code",name:"guRotate"},{addr:2148000312,type:"code",name:"guRotateF"},{addr:2148000672,type:"code",name:"osMotorInit"},{addr:2148001256,type:"code",name:"__osMotorAccess"},{addr:2148001584,type:"code",name:"__osPfsSelectBank"},{addr:2148001696,type:"code",name:"__osContRamRead"},{addr:2148002184,type:"code",name:"__osPfsLastChannel"},{addr:2148002192,type:"code",name:"__osContRamWrite"},{addr:2148002816,type:"code",name:"osAfterPreNMI"},{addr:2148002848,type:"code",name:"osGetMemSize"},{addr:2148004048,type:"code",name:"__checkHardware_kmc"},{addr:2148004108,type:"code",name:"__osInitialize_kmc"},{addr:2148005024,type:"code",name:"__checkHardware_msp"},{addr:2148005072,type:"code",name:"__osInitialize_msp"},{addr:2148005984,type:"code",name:"__osInitialize_emu"},{addr:2148006112,type:"code",name:"__osEepromRead16K"},{addr:2148006116,type:"code",name:"__osEepPifRam"},{addr:2148006180,type:"code",name:"osEepromRead"},{addr:2148006536,type:"code",name:"__conteepread_o_00B8"},{addr:2148009500,type:"code",name:"__osEnqueueAndYield"},{addr:2148009844,type:"code",name:"__osPopThread"},{addr:2148010304,type:"code",name:"__osDisableInt"},{addr:2148010416,type:"code",name:"__osRestoreInt"},{addr:2148010448,type:"code",name:"__osSetGlobalIntMask"},{addr:2148010512,type:"code",name:"__osResetGlobalIntMask"},{addr:2148010592,type:"code",name:"__osPiRawStartDma"},{addr:2148010800,type:"code",name:"osPiGetCmdQueue"},{addr:2148010832,type:"code",name:"__osEPiRawReadIo"},{addr:2148011184,type:"code",name:"alHeapCheck"},{addr:2148011200,type:"code",name:"__osEPiRawWriteIo"},{addr:2148011568,type:"code",name:"osPiWriteIo"},{addr:2148011648,type:"code",name:"osPiReadIo"},{addr:2148011728,type:"code",name:"__osAiDeviceBusy"},{addr:2148011760,type:"code",name:"__osThreadSave"},{addr:2148012464,type:"code",name:"__osThprofStack"},{addr:2148012468,type:"code",name:"__osThprofHeap"},{addr:2148012608,type:"code",name:"sqrtf"},{addr:2148012624,type:"code",name:"__osRdb_Read_Data_Ct"},{addr:2148012628,type:"code",name:"__osRdb_Read_Data_Buf"},{addr:2148012632,type:"code",name:"osReadHost"},{addr:2148014272,type:"code",name:"MonitorInitBreak"},{addr:2148014304,type:"code",name:"__isExp"},{addr:2148014628,type:"code",name:"__isExpJP"},{addr:2148015540,type:"code",name:"__osThprofCount"},{addr:2148015544,type:"code",name:"__osThprofLastTimer"},{addr:2148015548,type:"code",name:"osThreadProfileCallback"},{addr:2148015680,type:"code",name:"__osThprofFunc"},{addr:2148015684,type:"code",name:"__osThprofFlag"},{addr:2148017296,type:"code",name:"__osGetCause"},{addr:2148017312,type:"code",name:"osGetCount"},{addr:2148017376,type:"code",name:"__rmonSendFault"},{addr:2148017380,type:"code",name:"rmonRdbReadBuf"},{addr:2148017808,type:"code",name:"__osSpDeviceBusy"},{addr:2148017840,type:"code",name:"__osSpGetStatus"},{addr:2148017856,type:"code",name:"__osSpSetStatus"},{addr:2148017872,type:"code",name:"__osSpSetPc"},{addr:2148017920,type:"code",name:"__osSpRawStartDma"},{addr:2148018064,type:"code",name:"__osSpRawReadIo"},{addr:2148018144,type:"code",name:"__osSpRawWriteIo"},{addr:2148018224,type:"code",name:"__osContDataCrc"},{addr:2148018332,type:"code",name:"__osContDataCrc"},{addr:2148018348,type:"code",name:"__osContAddressCrc"},{addr:2148019040,type:"code",name:"__osPfsGetInitData"},{addr:2148019220,type:"code",name:"__osPfsRequestData"},{addr:2148019384,type:"code",name:"__osPfsPifRam"},{addr:2148019420,type:"code",name:"__pfsisplug_o_004C"},{addr:2148019428,type:"code",name:"__rmonIOhandler"},{addr:2148019448,type:"code",name:"osPfsIsPlug"},{addr:2148019584,type:"code",name:"__pfsisplug_o_0094"},{addr:2148019604,type:"code",name:"__rmonIOputw"},{addr:2148019696,type:"code",name:"__rmonIOflush"},{addr:2148019756,type:"code",name:"__rmonSendFault"},{addr:2148019776,type:"code",name:"__osPfsGetOneChannelData"},{addr:2148019904,type:"code",name:"__osPfsRequestOneChannel"},{addr:2148020016,type:"code",name:"__pfsgetstatus_o_0030"},{addr:2148020052,type:"code",name:"__osPfsGetStatus"},{addr:2148020164,type:"code",name:"__pfsgetstatus_o_0084"},{addr:2148020304,type:"code",name:"__osPfsInodeCache"},{addr:2148020424,type:"code",name:"__contpfs_o_0598"},{addr:2148020560,type:"code",name:"__osPfsRWInode"},{addr:2148021172,type:"code",name:"__contpfs_o_0578"},{addr:2148021384,type:"code",name:"__osCheckId"},{addr:2148021568,type:"code",name:"__osGetId"},{addr:2148022028,type:"code",name:"__osCheckPackId"},{addr:2148022384,type:"code",name:"__osRepairPackId"},{addr:2148023008,type:"code",name:"__osPiRawReadIo"},{addr:2148023088,type:"code",name:"__osPiRawWriteIo"},{addr:2148023132,type:"code",name:"__osIdCheckSum"},{addr:2148023168,type:"code",name:"osEPiWriteIo"},{addr:2148023200,type:"code",name:"__osSumcalc"},{addr:2148023252,type:"code",name:"__osPfsInodeCacheBank"},{addr:2148023253,type:"code",name:"__osPfsInodeCacheChannel"},{addr:2148023632,type:"code",name:"_Litob"},{addr:2148024224,type:"code",name:"_Ldtob"},{addr:2148025324,type:"code",name:"__xldtob_o_0080"},{addr:2148025476,type:"code",name:"__xldtob_o_0414"},{addr:2148026928,type:"code",name:"__rmonExecute"},{addr:2148027072,type:"code",name:"__rmonWriteWordTo"},{addr:2148027136,type:"code",name:"__rmonReadWordAt"},{addr:2148027248,type:"code",name:"__rmonCopyWords"},{addr:2148027464,type:"code",name:"__rmonGetRegionCount"},{addr:2148027548,type:"code",name:"__rmonGetExeName"},{addr:2148027736,type:"code",name:"__rmonLoadProgram"},{addr:2148027744,type:"code",name:"__rmonListProcesses"},{addr:2148027832,type:"code",name:"__rmonWriteMem"},{addr:2148028380,type:"code",name:"__rmonUtilityBuffer"},{addr:2148028636,type:"code",name:"__rmonReadMem"},{addr:2148028976,type:"code",name:"__rmonSetComm"},{addr:2148029004,type:"code",name:"__rmonCopyWords"},{addr:2148029032,type:"code",name:"__rmonPanic"},{addr:2148029040,type:"code",name:"__rmonMQ"},{addr:2148029052,type:"code",name:"__rmonMemcpy"},{addr:2148029064,type:"code",name:"__rmonInit"},{addr:2148029100,type:"code",name:"__rmonReadWordAt"},{addr:2148029164,type:"code",name:"__rmonWriteWordTo"},{addr:2148029272,type:"code",name:"__rmonSetFault"},{addr:2148029312,type:"code",name:"__rmonGetRegisterContents"},{addr:2148029432,type:"code",name:"__rmonSetVRegs"},{addr:2148029868,type:"code",name:"__rmonGetVRegs"},{addr:2148030048,type:"code",name:"__rmonregs_o_0AA4"},{addr:2148030340,type:"code",name:"__rmonSetSRegs"},{addr:2148030704,type:"code",name:"__rmonGetSRegs"},{addr:2148031112,type:"code",name:"__rmonSetFRegisters"},{addr:2148031252,type:"code",name:"__rmonGetFRegisters"},{addr:2148031392,type:"code",name:"__rmonSetGRegisters"},{addr:2148031632,type:"code",name:"__rmonGetGRegisters"},{addr:2148031940,type:"code",name:"__rmonGetRegisterContents"},{addr:2148032064,type:"code",name:"__rmonMaskIdleThreadInts"},{addr:2148032168,type:"code",name:"__rmonGetTCB"},{addr:2148032268,type:"code",name:"__rmonStopUserThreads"},{addr:2148032752,type:"code",name:"__rmonGetThreadStatus"},{addr:2148034320,type:"code",name:"__rmonSendHeader"},{addr:2148034424,type:"code",name:"__rmonSendReply"},{addr:2148034608,type:"code",name:"__rmonSendData"},{addr:2148035248,type:"code",name:"__osSpRawReadIo"},{addr:2148035328,type:"code",name:"__osSpRawWriteIo"},{addr:2148035408,type:"code",name:"__osSpDeviceBusy"},{addr:2148035440,type:"code",name:"osStopThread"},{addr:2148035632,type:"code",name:"__osGetActiveQueue"},{addr:2148036096,type:"code",name:"__rmonRCPrunning"},{addr:2148036200,type:"code",name:"__rmonStepRCP"},{addr:2148036256,type:"code",name:"__rmonHitCpuFault"},{addr:2148036300,type:"code",name:"__rmonRcpAtBreak"},{addr:2148036301,type:"code",name:"__rmonHitSpBreak"},{addr:2148036441,type:"code",name:"__rmonHitBreak"},{addr:2148036661,type:"code",name:"__rmonGetExceptionStatus"},{addr:2148036721,type:"code",name:"__rmonSetSingleStep"},{addr:2148037149,type:"code",name:"__rmonGetBranchTarget"},{addr:2148037533,type:"code",name:"__rmonClearBreak"},{addr:2148037817,type:"code",name:"__rmonListBreak"},{addr:2148037825,type:"code",name:"__rmonSetBreak"},{addr:2148040448,type:"code",name:"__divdi3"},{addr:2148040816,type:"code",name:"__udivdi3"},{addr:2148040848,type:"code",name:"__umoddi3"},{addr:2148047536,type:"code",name:"midpoint",desc:"A0=output_xyz"},{addr:2148317348,type:"u32",name:"debug_font_color",desc:"Used with DrawDebugText"},{addr:2148323418,type:"u8",name:"total_turns"},{addr:2148323419,type:"u8",name:"current_turn"},{addr:2148327938,type:"u16",name:"current_scene"},{addr:2148339986,type:"u16",name:"p1_coins",desc:"Player 1 coin count"},{addr:2148339990,type:"u8",name:"p1_stars",desc:"Player 1 star count"},{addr:2148339991,type:"u8",name:"p1_cur_chain_index",desc:"Player 1 current chain index"},{addr:2148339992,type:"u8",name:"p1_cur_space_index",desc:"Player 1 current space index"},{addr:2148339993,type:"u8",name:"p1_next_chain_index",desc:"Player 1 next chain index"},{addr:2148339994,type:"u8",name:"p1_next_space_index",desc:"Player 1 next space index"},{addr:214834e4,type:"u8",name:"p1_item1",desc:"Player 1 first item"},{addr:2148340001,type:"u8",name:"p1_item2",desc:"Player 1 second item"},{addr:2148340002,type:"u8",name:"p1_item3",desc:"Player 1 third item"},{addr:2148340042,type:"u16",name:"p2_coins",desc:"Player 2 coin count"},{addr:2148340046,type:"u8",name:"p2_stars",desc:"Player 2 star count"},{addr:2148340047,type:"u8",name:"p2_cur_chain_index",desc:"Player 2 current chain index"},{addr:2148340048,type:"u8",name:"p2_cur_space_index",desc:"Player 2 current space index"},{addr:2148340049,type:"u8",name:"p2_next_chain_index",desc:"Player 2 next chain index"},{addr:2148340050,type:"u8",name:"p2_next_space_index",desc:"Player 2 next space index"},{addr:2148340056,type:"u8",name:"p2_item1",desc:"Player 2 first item"},{addr:2148340057,type:"u8",name:"p2_item2",desc:"Player 2 second item"},{addr:2148340058,type:"u8",name:"p2_item3",desc:"Player 2 third item"},{addr:2148340098,type:"u16",name:"p3_coins",desc:"Player 3 coin count"},{addr:2148340102,type:"u8",name:"p3_stars",desc:"Player 3 star count"},{addr:2148340103,type:"u8",name:"p3_cur_chain_index",desc:"Player 3 current chain index"},{addr:2148340104,type:"u8",name:"p3_cur_space_index",desc:"Player 3 current space index"},{addr:2148340105,type:"u8",name:"p3_next_chain_index",desc:"Player 3 next chain index"},{addr:2148340106,type:"u8",name:"p3_next_space_index",desc:"Player 3 next space index"},{addr:2148340112,type:"u8",name:"p3_item1",desc:"Player 3 first item"},{addr:2148340113,type:"u8",name:"p3_item2",desc:"Player 3 second item"},{addr:2148340114,type:"u8",name:"p3_item3",desc:"Player 3 third item"},{addr:2148340154,type:"u16",name:"p4_coins",desc:"Player 4 coin count"},{addr:2148340158,type:"u8",name:"p4_stars",desc:"Player 4 star count"},{addr:2148340159,type:"u8",name:"p4_cur_chain_index",desc:"Player 4 current chain index"},{addr:2148340160,type:"u8",name:"p4_cur_space_index",desc:"Player 4 current space index"},{addr:2148340161,type:"u8",name:"p4_next_chain_index",desc:"Player 4 next chain index"},{addr:2148340162,type:"u8",name:"p4_next_space_index",desc:"Player 4 next space index"},{addr:2148340168,type:"u8",name:"p4_item1",desc:"Player 4 first item"},{addr:2148340169,type:"u8",name:"p4_item2",desc:"Player 4 second item"},{addr:2148340170,type:"u8",name:"p4_item3",desc:"Player 4 third item"},{addr:2148352448,type:"u32",name:"cur_player_spaces_remaining"},{addr:2148409160,type:"code",name:"ShowPlayerCoinChange",desc:"A0=player_index"},{addr:2148443744,type:"code",name:"AddArrowAngle",desc:"F0=degree_rot_of_arrow"},{addr:2148446560,type:"code",name:"GetSpaceData",desc:"A0=space_index"},{addr:2148446596,type:"code",name:"GetAbsSpaceIndexFromChainSpaceIndex",desc:"A0=chain_index"},{addr:2148446640,type:"code",name:"GetChainLength",desc:"A0=chain_index"},{addr:2148446668,type:"code",name:"GetChainSpaceIndexFromAbsSpaceIndex",desc:"A0=abs_space_index"},{addr:2148448864,type:"code",name:"EventTableHydrate",desc:"Moves event table data into the space data"},{addr:2148449480,type:"code",name:"GetCurrentSpaceIndex"},{addr:2148456732,type:"code",name:"SetPlayerOntoChain",desc:"A0=player_index"},{addr:2148456856,type:"code",name:"SetNextChainAndSpace",desc:"A0=player_index"},{addr:2148475184,type:"code",name:"GetCurrentPlayerIndex"},{addr:2148475196,type:"code",name:"GetPlayerStruct",desc:"A0=player_index pass -1 to get current player's struct"},{addr:2148475260,type:"code",name:"PlayerIsCurrent",desc:"A0=player_index tests if A0 is the current player"},{addr:2148475288,type:"code",name:"PlayerIsCPU",desc:"A0=player_index"},{addr:2148475328,type:"code",name:"AdjustPlayerCoins",desc:"A0=player_index"},{addr:2148475440,type:"code",name:"PlayerHasCoins",desc:"A0=player_index"},{addr:2148490564,type:"code",name:"AdjustPlayerCoinsGradual",desc:"A0=player_index"},{addr:2148553232,type:"u16",name:"num_board_spaces"},{addr:2148553234,type:"u16",name:"num_chains"},{addr:2148553236,type:"u32",name:"hydrated_space_data"},{addr:2148553240,type:"u32",name:"hydrated_chains"},{addr:2148553360,type:"data",name:"arrow_angles",desc:"f32[8]"},{addr:2148553392,type:"u32",name:"num_arrow_angles"}];
"use strict";var _slicedToArray=function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,a){var t=[],n=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(t.push(s.value),!a||t.length!==a);n=!0);}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return t}(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")};PP64.validation=function(){var r=Object.create(null),i={fails:function(e,a){throw"fails not implemented"}};function e(e,a,t){var n=Object.create(i);return n.id=e,n.name=a,n.level=t,r[e]=n}e("HASSTART","Has start space",$validationLevel.ERROR).fails=function(e,a){return PP64.boards.getStartSpaceIndex(e)<0&&"No start space found on board."},e("GAMEVERSION","Game version mismatch",$validationLevel.ERROR).fails=function(e,a){var t=PP64.romhandler.getGameVersion();return t!==e.game&&"Board is for MP"+e.game+", but ROM is MP"+t},e("DEADEND","No dead ends",$validationLevel.WARNING).fails=function(e,a){var t=PP64.boards.getDeadEnds(e),n=PP64.boards.getStartSpaceIndex(e);return!(n<0)&&(0<=t.indexOf(n)?"Start space does not lead anywhere.":!!t.length&&"There is a dead end on the board.")},e("TOOMANYSPACES","Too many spaces",$validationLevel.ERROR).fails=function(e,a){return 65535<e.spaces.length&&"There is a hard limit of 65535 spaces."},e("OVERRECOMMENDEDSPACES","Over recommended spaces",$validationLevel.WARNING).fails=function(e,a){var t=e.spaces.length;return t>a.max&&t+" spaces present, more than "+a.max+" spaces can be unstable."};var a=function(n,r){e("TOOMANY"+r.toUpperCase().replace(/\s+/g,""),"Too many "+r,$validationLevel.ERROR).fails=function(e){var a=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).limit||0,t=e.spaces.filter(function(e){return e&&e.subtype===n}).length;return a<t&&"There are "+t+" "+r+", but the limit is "+a+" for this board."}};a($spaceSubType.BOO,"Boos"),a($spaceSubType.BOWSER,"Bowsers"),a($spaceSubType.KOOPA,"Koopas"),a($spaceSubType.BANK,"Banks"),a($spaceSubType.ITEMSHOP,"Item Shops"),a($spaceSubType.GATE,"Gates");e("BADSTARCOUNT","Bad star count",$validationLevel.ERROR).fails=function(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=a.low||1,n=a.high||1,r=e.spaces.filter(function(e){return e&&e.star}).length;return(r<t||n<r)&&(t!==n?"There are "+r+" stars, but the range is "+t+"-"+n+" for this board.":"There are "+r+" stars, but the count must be "+t+" for this board.")};var t=function(n,r){e("TOOFEW"+r.toUpperCase().replace(/\s+/g,"")+"SPACES","Too few "+r+" spaces",$validationLevel.ERROR).fails=function(e){var a=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).low||0,t=e.spaces.filter(function(e){return e&&e.type===n}).length;return t<a&&"There are "+t+" "+r+" spaces, need at least "+a+" spaces of this type."}};return t($spaceType.BLUE,"Blue"),t($spaceType.RED,"Red"),e("TOOMANYOFEVENT","Too many of event",$validationLevel.ERROR).fails=function(e,a){var t=0;e.spaces.forEach(function(e){e&&e.events&&e.events.forEach(function(e){e.id===a.event.id&&t++})});var n=a.low||0,r=a.high||0;if(t<n||r<t){if(n&&r)return"There are "+t+" of event "+a.event.name+", but the range is "+n+"-"+r+" for this board.";if(n)return"There are "+t+" of event "+a.event.name+", but there must be at least "+n+" for this board.";if(r)return"There are "+t+" of event "+a.event.name+", but there can be at most "+r+" for this board."}return!1},e("UNRECOGNIZEDEVENTS","Unrecognized events",$validationLevel.ERROR).fails=function(e,a){var t=Object.create(null);e.spaces.forEach(function(e){e&&e.events&&e.events.forEach(function(e){PP64.adapters.events.getEvent(e.id)||t[e.id]||(t[e.id]=!0)})});var n=[];for(var r in t)n.push(r);if(!n.length)return!1;var i="The following events were unrecognized:\n";return n.forEach(function(e){i+="\t"+e+"\n"}),i},e("UNSUPPORTEDEVENTS","Unsupported events",$validationLevel.ERROR).fails=function(e,a){var t=Object.create(null),n=PP64.romhandler.getROMGame();e.spaces.forEach(function(e){e&&e.events&&e.events.forEach(function(e){PP64.adapters.events.getEvent(e.id)&&PP64.adapters.events.isUnsupported(e.id,n)&&!t[e.id]&&(t[e.id]=!0)})});var r=[];for(var i in t)r.push(i);if(!r.length)return!1;var s="The following events cannot be written to this ROM:\n";return r.forEach(function(e){s+="\t"+e+"\n"}),s},e("CUSTOMEVENTFAIL","Custom event errors",$validationLevel.ERROR).fails=function(e,a){var t=Object.create(null),n=PP64.romhandler.getROMGame();e.spaces.forEach(function(e){e&&e.events&&e.events.forEach(function(a){if(a&&a.custom)try{PP64.adapters.events.CustomAsmHelper.testAssemble(a.asm,a.parameters,{game:n})}catch(e){console.error(e.toString()),t[a.id]||(t[a.id]=!0)}})});var r=[];for(var i in t)r.push(i);if(!r.length)return!1;var s="The following custom events fail to assemble:\n";return r.forEach(function(e){s+="\t"+e+"\n"}),s},e("CUSTOMEVENTBADPARAMS","Custom event parameter issues",$validationLevel.ERROR).fails=function(e,a){var t=Object.create(null);e.spaces.forEach(function(e){e&&e.events&&e.events.forEach(function(a){if(a&&a.custom){var e=a.parameters;e&&e.length&&e.forEach(function(e){a.parameterValues&&a.parameterValues.hasOwnProperty(e.name)||(t[e.name]||(t[e.name]=0),t[e.name]++)})}})});var n=[];for(var r in t){var i=t[r];i&&n.push("\t"+i+" "+r+" event parameter"+(1<i?"s are ":" is ")+"not set")}return!!n.length&&"Some event parameters need to be set:\n"+n.join("\n")},e("TOOMANYPATHOPTIONS","Too many path options",$validationLevel.ERROR).fails=function(e){var a=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).limit||2;for(var t in e.links){var n=e.links[t];if(Array.isArray(n)&&n.length>a)return"A space branches in "+n.length+" directions, but the maximum is "+a+"."}return!1},e("CHARACTERSONPATH","Characters are on path",$validationLevel.WARNING).fails=function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];for(var a in e.links){var t=e.spaces[a];if(t.hasOwnProperty("subtype")&&t.subtype!==$spaceSubType.GATE)return"Characters and objects <a href='https://github.com/PartyPlanner64/PartyPlanner64/wiki/Creating-a-Board#special-charactersobjects' target='_blank'>should not be on the player path</a>."}return!1},e("SPLITATNONINVISIBLESPACE","Split at non-invisible space",$validationLevel.WARNING).fails=function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];var a=[$spaceType.OTHER,$spaceType.STAR,$spaceType.START,$spaceType.BLACKSTAR,$spaceType.ARROW];for(var t in e.links){if(1<PP64.boards.getConnections(t,e).length){var n=e.spaces[t];if(-1===a.indexOf(n.type))return"There is a <a href='https://github.com/PartyPlanner64/PartyPlanner64/wiki/Creating-a-Board#board-flow' target='_blank'>non-conventional path split</a>."}}return!1},e("TOOMANYARROWROTATIONS","Too many arrow rotations",$validationLevel.WARNING).fails=function(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=0;return e.spaces.forEach(function(e){e&&"number"==typeof e.rotation&&t++}),t>a.limit&&"Only "+a.limit+" arrows will be rotated in-game."},e("GATESETUP","Incorrect gate setup",$validationLevel.ERROR).fails=function(r){1<arguments.length&&void 0!==arguments[1]&&arguments[1];for(var e=PP64.boards.getSpacesOfSubType($spaceSubType.GATE,r),a=0;a<e.length;a++){var t=e[a];if(r.spaces[t].type!==$spaceType.OTHER)return"Only invisible spaces can have gates.";var n=PP64.boards.getConnections(t,r);if(1!==n.length)return"A single path should leave a gate space.";var i=n[0],s=r.spaces[i];if(!s||s.type!==$spaceType.OTHER)return"Space after a gate space must be invisible.";if(s.subtype===$spaceSubType.GATE)return"Gate spaces must be 2 or more spaces apart.";if(1!==f(i).length)return"A single path should connect to the space after a gate space.";var o=PP64.boards.getConnections(i,r);if(1!==o.length)return"A single path should leave the space after a gate space";var l=o[0];if(r.spaces[l].subtype===$spaceSubType.GATE)return"Gate spaces must be 2 or more spaces apart.";var c=f(t);if(1!==c.length)return"A single path should connect to a gate space.";var u=c[0],p=r.spaces[u];if(!p||p.type!==$spaceType.OTHER)return"Space before a gate space must be invisible.";if(p.subtype===$spaceSubType.GATE)return"Gate spaces must be 2 or more spaces apart.";var v=f(u);if(1!==v.length)return"A single path should connect to the space before a gate space.";if(v[0].subtype===$spaceSubType.GATE)return"Gate spaces must be 2 or more spaces apart."}function f(t){var n=[],e=function(a){PP64.boards.getConnections(a,r).forEach(function(e){e===t&&n.push(Number(a))})};for(var a in r.links)e(a);return n}return!1},{createRule:e,getRule:function(e,a){var t=r[e];return{id:t.id,name:t.name,level:t.level,fails:function(e){return t.fails(e,a)}}},validateCurrentBoardForOverwrite:function(){var o=PP64.romhandler.getROMGame();if(!o)return null;var l=[],e=PP64.boards.getROMBoards(),c=PP64.boards.getCurrentBoard();return e.forEach(function(e,a){if(t=e,"string"!=typeof(n=c.type)?t.type!==PP64.types.BoardType.DUEL:t.type===n){var t,n,r=!(0===a||PP64.settings.get($setting.uiSkipValidation)),i=[],s=[];r||PP64.settings.get($setting.uiSkipValidation)||function(e,a){var t=[PP64.validation.getRule("HASSTART"),PP64.validation.getRule("GAMEVERSION"),PP64.validation.getRule("DEADEND"),PP64.validation.getRule("TOOMANYSPACES"),PP64.validation.getRule("UNRECOGNIZEDEVENTS"),PP64.validation.getRule("UNSUPPORTEDEVENTS"),PP64.validation.getRule("CUSTOMEVENTFAIL"),PP64.validation.getRule("CUSTOMEVENTBADPARAMS"),PP64.validation.getRule("TOOMANYPATHOPTIONS"),PP64.validation.getRule("CHARACTERSONPATH"),PP64.validation.getRule("SPLITATNONINVISIBLESPACE")];switch(e){case $gameType.MP1_USA:case $gameType.MP1_JPN:t=t.concat(PP64.validation.MP1.getValidationRulesForBoard(e,a));break;case $gameType.MP2_USA:case $gameType.MP2_JPN:t=t.concat(PP64.validation.MP2.getValidationRulesForBoard(e,a));break;case $gameType.MP3_USA:case $gameType.MP3_JPN:t=t.concat(PP64.validation.MP3.getValidationRulesForBoard(e,a))}return t}(o,a).forEach(function(e){var a=void 0;if(Array.isArray(e)){var t=_slicedToArray(e,2);e=t[0],a=t[1]}var n=e.fails(c,a);n&&(e.level===$validationLevel.ERROR?i.push(n):e.level===$validationLevel.WARNING&&s.push(n))}),l.push({name:e.name,unavailable:r,errors:i,warnings:s})}}),l}}}();
"use strict";PP64.ns("validation"),PP64.validation.MP1=function(){var a=[PP64.validation.getRule("TOOMANYGATES",{limit:0})];return{getValidationRulesForBoard:function(i,t){var l=a.slice(0);return 0===t&&(l.push(PP64.validation.getRule("TOOMANYBOOS",{limit:2})),l.push(PP64.validation.getRule("TOOMANYBOWSERS",{limit:1})),l.push(PP64.validation.getRule("TOOMANYKOOPAS",{limit:1})),l.push(PP64.validation.getRule("BADSTARCOUNT",{low:7,high:7}))),l}}}();
"use strict";PP64.ns("validation"),PP64.validation.MP2=function(){var P=[PP64.validation.getRule("TOOMANYBOWSERS",{limit:0}),PP64.validation.getRule("TOOMANYKOOPAS",{limit:0}),PP64.validation.getRule("TOOMANYGATES",{limit:0})];return{getValidationRulesForBoard:function(i,t){var a=P.slice(0),l=PP64.adapters.boardinfo.getBoardInfoByIndex(i,t),e=PP64.adapters.boardinfo.getArrowRotationLimit(l);return a.push(PP64.validation.getRule("TOOMANYARROWROTATIONS",{limit:e})),0===t&&(a.push(PP64.validation.getRule("TOOMANYBANKS",{limit:2})),a.push(PP64.validation.getRule("TOOMANYITEMSHOPS",{limit:1})),a.push(PP64.validation.getRule("TOOMANYBOOS",{limit:2})),a.push(PP64.validation.getRule("BADSTARCOUNT",{low:7,high:7}))),a}}}();
"use strict";PP64.ns("validation"),PP64.validation.MP3=function(){var l=[PP64.validation.getRule("TOOMANYBOWSERS",{limit:0}),PP64.validation.getRule("TOOMANYKOOPAS",{limit:0}),PP64.validation.getRule("GATESETUP"),PP64.validation.getRule("OVERRECOMMENDEDSPACES",{max:128})];return{getValidationRulesForBoard:function(t,i){var e=l.slice(0),a=PP64.adapters.boardinfo.getBoardInfoByIndex(t,i),P=PP64.adapters.boardinfo.getArrowRotationLimit(a);return e.push(PP64.validation.getRule("TOOMANYARROWROTATIONS",{limit:P})),0===i&&(e.push(PP64.validation.getRule("TOOMANYOFEVENT",{event:PP64.adapters.events.getEvent("BANK"),high:2})),e.push(PP64.validation.getRule("TOOMANYBANKS",{limit:2})),e.push(PP64.validation.getRule("TOOMANYOFEVENT",{event:PP64.adapters.events.getEvent("ITEMSHOP"),high:2})),e.push(PP64.validation.getRule("TOOMANYITEMSHOPS",{limit:2})),e.push(PP64.validation.getRule("TOOMANYOFEVENT",{event:PP64.adapters.events.getEvent("BOO"),high:1})),e.push(PP64.validation.getRule("TOOMANYBOOS",{limit:1})),e.push(PP64.validation.getRule("TOOMANYGATES",{limit:2})),e.push(PP64.validation.getRule("BADSTARCOUNT",{low:8,high:8}))),e}}}();
"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("fs"),PP64.fs.scenes=new(function(){function e(){_classCallCheck(this,e),this._sceneInfo=[]}return _createClass(e,[{key:"clearCache",value:function(){this._sceneInfo=null}},{key:"count",value:function(){return this._sceneInfo.length}},{key:"getInfo",value:function(e){return this._sceneInfo[e]||null}},{key:"getDataView",value:function(e){var t=this._sceneInfo[e];return PP64.romhandler.getDataView(t.rom_start,t.rom_end)}},{key:"getCodeDataView",value:function(e){var t=this._sceneInfo[e],n=2147483647&t.code_start,r=2147483647&t.code_end;return PP64.romhandler.getDataView(t.rom_start,t.rom_start+(r-n))}},{key:"getRoDataView",value:function(e){var t=this._sceneInfo[e],n=2147483647&t.rodata_start,r=2147483647&t.rodata_end,a=2147483647&t.ram_start;return PP64.romhandler.getDataView(t.rom_start+(n-a),t.rom_start+(r-a))}},{key:"extractAsync",value:function(){var t=this;return new Promise(function(e){t.extract(),e()})}},{key:"extract",value:function(){var e=PP64.adapters.getROMAdapter(),t=e&&e.SCENE_TABLE_ROM;if(!t)throw new Error("SCENE_TABLE_ROM undefined in current ROM adapter");this._sceneInfo=[];for(var n=PP64.romhandler.getDataView(),r=t;1142947840!==n.getUint32(r);)this._sceneInfo.push({rom_start:n.getUint32(r),rom_end:n.getUint32(r+4),ram_start:n.getUint32(r+8),code_start:n.getUint32(r+12),code_end:n.getUint32(r+16),rodata_start:n.getUint32(r+20),rodata_end:n.getUint32(r+24),bss_start:n.getUint32(r+28),bss_end:n.getUint32(r+32)}),r+=36}},{key:"replace",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(t){var n=this._sceneInfo[e],r=PP64.romhandler.getROMBuffer();PP64.utils.arrays.copyRange(r,t,n.rom_start,0,t.byteLength)}else this._promptReplace(e)}},{key:"_promptReplace",value:function(r){var a=this;PP64.utils.input.openFile("",function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){a.replace(r,n.result)},n.readAsArrayBuffer(t)}})}}]),e}());
"use strict";PP64.ns("fs"),PP64.fs.mainfs=function(){var e={};function m(){var e=PP64.romhandler.getDataView(),r=u();if(!r)return null;var t=r[0],n=e.getUint16(t.upper)<<16,s=e.getUint16(t.lower),i=n|s;if(32768&s&&(i-=65536),$$log("MainFS.getROMOffset -> "+$$hex(i)),$$debug)for(var o=1;o<r.length;o++){var a=e.getUint16(r[o].upper)<<16,c=e.getUint16(r[o].lower);if(a!==n||c!==s)throw"MainFS.getROMOffset patch offset "+o+" seems wrong"}return i}function u(){return e[PP64.romhandler.getROMGame()]}function o(e,r,t){var n=PP64.romhandler.getROMBuffer(),s=m(),i=s+new DataView(n,s).getUint32(4*(1+e)),o=i+new DataView(n,i).getUint32(4*(1+r)),a=new DataView(n,o),c=a.getUint32(0),u=a.getUint32(4),d=o+l(u),p=new DataView(n,d),f={compressionType:u,decompressedSize:c,decompressed:PP64.utils.compression.decompress(u,p,c)};if($$debug&&c!==f.decompressed.byteLength)throw"MainFS Dir: "+e+", File: "+r+" decompressed size mismatch";if(t){var g=f.decompressed.compressedSize;f.compressed=n.slice(d,d+g)}return f}function l(e){switch(e){case 0:case 1:case 5:return 8;case 2:case 3:case 4:return 12}throw"_getFileHeaderSize("+e+") not handled"}e[$gameType.MP1_USA]=[{upper:87974,lower:87978},{upper:245782,lower:245790}],e[$gameType.MP1_JPN]=[{upper:87766,lower:87770},{upper:245554,lower:245562}],e[$gameType.MP2_USA]=[{upper:268006,lower:268014}],e[$gameType.MP3_USA]=[{upper:221598,lower:221606}];var d=void 0;function t(){var e=void 0,r=void 0;$$debug&&window.performance&&(e=performance.now());var t=p();d=new Array(t);for(var n=0;n<t;n++){var s=f(n);d[n]=new Array(s);for(var i=0;i<s;i++)d[n][i]=o(n,i,!0)}return $$debug&&e&&(r=performance.now(),$$log("MainFS.extract() -> "+(r-e)+"ms")),d}function a(e,r,t){var n=f(e);r.setUint32(t,n);for(var s=t+4,i=t+4+4*n,o=0;o<n;o++)r.setUint32(s,i-t),s+=4,i=c(e,o,r,i),i=$$number.makeDivisibleBy(i,2);return i}function c(e,r,t,n){var s=d[e][r],i=PP64.settings.get($setting.writeDecompressed);t.setUint32(n,s.decompressedSize||s.decompressed.byteLength);var o=i?0:s.compressionType;t.setUint32(n+4,o);var a=n+8;12===l(o)&&(t.setUint32(n+8,s.decompressedSize||s.decompressed.byteLength),a+=4);var c=void 0;return c=i?s.decompressed:s.compressed||s.decompressed,PP64.utils.arrays.copyRange(t,c,a,0,c.byteLength),a+c.byteLength}function p(){if(d)return d.length;var e=PP64.romhandler.getROMBuffer();return new DataView(e,m()).getUint32(0)}function f(e){if(d&&d[e])return d[e].length;var r=PP64.romhandler.getROMBuffer(),t=m(),n=t+new DataView(r,t).getUint32(4*(1+e));return new DataView(r,n).getUint32(0)}return{read:o,write:function(e,r,t){var n=d[e][r];if(n){if(t!==n.decompressed&&PP64.utils.arrays.arrayBuffersEqual(t,n.decompressed))return}else $$log("Adding new file to MainFS: "+e+"/"+r),d[e][r]=n={compressionType:0};n.compressed&&(delete n.decompressedSize,delete n.compressed,n.compressionType=0),n.decompressed=t.slice(0)},get:function(e,r){return d[e][r].decompressed},has:function(e,r){return!!d[e][r]},extract:t,extractAsync:function(){return new Promise(function(e,r){t(),e()})},pack:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=new DataView(e,r),n=p();t.setUint32(0,n);for(var s=4,i=4+4*n,o=0;o<n;o++)t.setUint32(s,i),s+=4,i=a(o,t,i),i=$$number.makeDivisibleBy(i,2);return i},clearCache:function(){d=null},getByteLength:function(){var e=0,r=d.length,t=PP64.settings.get($setting.writeDecompressed);e+=4,e+=4*r;for(var n=0;n<r;n++){var s=d[n].length;e+=4,e+=4*s;for(var i=0;i<s;i++)e+=l(t?0:d[n][i].compressionType),d[n][i].compressed&&!t?e+=d[n][i].compressed.byteLength:e+=d[n][i].decompressed.byteLength,e=$$number.makeDivisibleBy(e,2)}return e},getDirectoryCount:p,getFileCount:f,getROMOffset:m,setROMOffset:function(e,r){var t=new DataView(r),n=u(),s=(4294901760&e)>>>16,i=65535&e;32768&i&&(s+=1);for(var o=0;o<n.length;o++)t.setUint16(n[o].upper,s),t.setUint16(n[o].lower,i);$$log("MainFS.setROMOffset -> "+$$hex(s<<16|i))},getPatchOffsets:u}}();
"use strict";var _createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("fs"),PP64.fs.strings3=function(){var t={};function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en",t=PP64.romhandler.getDataView(),r=c(e)[0];if(!r)return null;var n=t.getUint16(r.upper)<<16,i=t.getUint16(r.lower),a=n|i;return 32768&i&&(a-=65536),$$log("Strings3.getROMOffset["+e+"] -> "+$$hex(a)),a}function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en";return t[PP64.romhandler.getROMGame()][e]}t[$gameType.MP3_USA]={jp:[{upper:61762,lower:61770},{upper:373706,lower:373714}],en:[{upper:373778,lower:373786}],de:[{upper:373802,lower:373810}],es:[{upper:373814,lower:373822}],it:[{upper:373826,lower:373830}],fr:[{upper:373790,lower:373798}]};var l,a=function(){function t(e){_classCallCheck(this,t),this.dirs=this._extract(e)}return _createClass(t,[{key:"_extract",value:function(e){for(var t=this._getDirectoryCountFromView(e),r=new Array(t),n=0;n<t;n++)r[n]=this._readDirFromView(e,n);return r}},{key:"_getDirectoryCountFromView",value:function(e){return e.getUint32(0)}},{key:"_readDirFromView",value:function(e,t){var r=this._getDirOffsetFromView(e,t),n=new DataView(e.buffer,e.byteOffset+r),i=this._decompressDir(n);return new PP64.fs.strings.StringTable(new DataView(i))}},{key:"_decompressDir",value:function(e){var t=e.getUint32(0),r=e.getUint32(4),n=new DataView(e.buffer,e.byteOffset+8);return PP64.utils.compression.decompress(r,n,t)}},{key:"_getDirOffsetFromView",value:function(e,t){return e.getUint32(4*(1+t))}},{key:"read",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(e<0||e>=this.getDirectoryCount())throw"Requesting non-existent string directory";return this.dirs[e].read(t,r)}},{key:"write",value:function(e,t,r){this.dirs[e].write(t,r)}},{key:"getDirectoryCount",value:function(){return this.dirs.length}},{key:"getStringCount",value:function(e){return this.dirs[e].getStringCount()}},{key:"getByteLength",value:function(){var e=0,t=this.dirs.length;e+=4,e+=4*t;for(var r=0;r<t;r++)e+=4,e+=4,e+=this.dirs[r].getByteLength(!0),e=$$number.makeDivisibleBy(e,2);return e}},{key:"pack",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(e,t),n=this.getDirectoryCount();r.setUint32(0,n);for(var i=4,a=4+4*n,o=0;o<n;o++)r.setUint32(i,a),i+=4,r.setUint32(a,this.dirs[o].getByteLength()),a+=4,r.setUint32(a,1),a+=4,a=this._packDir(o,r,a),a=$$number.makeDivisibleBy(a,2);return a}},{key:"_packDir",value:function(e,t,r){var n=new ArrayBuffer(this.dirs[e].getByteLength());this.dirs[e].pack(n,0);var i=PP64.utils.compression.compress(1,new DataView(n));PP64.utils.arrays.copyRange(t,i,r,0,i.byteLength);var a=this.dirs[e].getByteLength(!0);if($$debug&&i.byteLength>a)throw"Upper bound guess is wrong _packDir";return r+a}}]),t}();function r(){l={};for(var e=h(PP64.romhandler.getROMGame()),t=0;t<e.length;t++){var r=e[t],n=PP64.romhandler.getDataView(i(r));l[r]=new a(n)}return l}function h(e){return Object.keys(t[e])}return{read:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return l[e].read(t,r,n)},write:function(e,t,r,n){l[e].write(t,r,n)},extract:r,extractAsync:function(){return new Promise(function(e,t){r(),e()})},pack:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=h(PP64.romhandler.getROMGame()),n=0;n<r.length;n++){var i=r[n];t+=l[i].pack(e,t),t=$$number.makeDivisibleBy(t,16)}return t},clear:function(){l=null},getByteLength:function(){for(var e=0,t=h(PP64.romhandler.getROMGame()),r=0;r<t.length;r++){var n=t[r];e+=$$number.makeDivisibleBy(l[n].getByteLength(),16)}return e},getStringCount:function(e,t){return l[e].getStringCount(t)},getDirectoryCount:function(e){return l[e].getDirectoryCount()},getROMOffset:i,setROMOffset:function(e,t){for(var r=new DataView(t),n=e,i=h(PP64.romhandler.getROMGame()),a=0;a<i.length;a++){var o=i[a],u=c(o),s=(4294901760&n)>>>16,g=65535&n;32768&g&&(s+=1);for(var f=0;f<u.length;f++)r.setUint16(u[f].upper,s),r.setUint16(u[f].lower,g);$$log("Strings3.setROMOffset["+o+"] -> "+$$hex(s<<16|g)),n+=$$number.makeDivisibleBy(l[o].getByteLength(),16)}},getPatchOffsets:c}}();
"use strict";var _slicedToArray=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var p=[],o=!0,u=!1,t=void 0;try{for(var l,n=e[Symbol.iterator]();!(o=(l=n.next()).done)&&(p.push(l.value),!r||p.length!==r);o=!0);}catch(e){u=!0,t=e}finally{try{!o&&n.return&&n.return()}finally{if(u)throw t}}return p}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")};PP64.ns("fs"),PP64.fs.hvqfs=function(){var e={};function w(){var e=PP64.romhandler.getDataView(),r=a();if(!r)return null;var p=r[0];if(!p)return null;var o=e.getUint16(p.upper)<<16,u=e.getUint16(p.lower),t=o|u;if(32768&u&&(t-=65536),$$debug)for(var l=1;l<r.length;l++){var n=e.getUint16(r[l].upper)<<16,w=e.getUint16(r[l].lower);if(n!==o||w!==u)throw"HVQFS.getROMOffset patch offset "+l+" seems wrong"}return t}function a(){return e[PP64.romhandler.getROMGame()].map(function(e){return{upper:e.upper,lower:e.upper+2+e.lower}})}function l(e,r){var p=PP64.romhandler.getROMBuffer(),o=w(),u=o+new DataView(p,o).getUint32(4*(1+e)),t=new DataView(p,u),l=u+t.getUint32(4*(1+r)),n=u+t.getUint32(4*(1+r+1));return p.slice(l,n)}e[$gameType.MP1_USA]=[{upper:357926,lower:2},{upper:380946,lower:2},{upper:873494,lower:6},{upper:2465142,lower:6},{upper:2488494,lower:6},{upper:2491282,lower:6},{upper:2606954,lower:6},{upper:2623890,lower:6},{upper:2628246,lower:6},{upper:2631114,lower:6},{upper:2642102,lower:6},{upper:2644710,lower:6},{upper:2647562,lower:6},{upper:2650538,lower:6},{upper:2656066,lower:6},{upper:2660910,lower:6},{upper:2665054,lower:6},{upper:2669458,lower:6},{upper:2674294,lower:6},{upper:2678494,lower:6},{upper:2680102,lower:6},{upper:2681858,lower:6},{upper:2688742,lower:6},{upper:2691634,lower:6},{upper:2694850,lower:6},{upper:2699550,lower:6},{upper:2701802,lower:6},{upper:2708230,lower:6},{upper:2710778,lower:6},{upper:2714110,lower:6},{upper:2718418,lower:6},{upper:2719554,lower:6},{upper:2722274,lower:6},{upper:2728570,lower:6},{upper:2730530,lower:6},{upper:2732382,lower:6},{upper:2754826,lower:6},{upper:2773410,lower:6},{upper:2846934,lower:6},{upper:2859374,lower:6},{upper:3135386,lower:6},{upper:3146422,lower:6},{upper:3150766,lower:6},{upper:3171106,lower:2},{upper:3186574,lower:6},{upper:3201066,lower:6},{upper:3229418,lower:6},{upper:3241826,lower:6}],e[$gameType.MP1_JPN]=[{upper:357526,lower:2},{upper:379858,lower:2},{upper:870598,lower:6},{upper:2462374,lower:6},{upper:2485734,lower:6},{upper:2488530,lower:6},{upper:2604202,lower:6},{upper:2621122,lower:6},{upper:2625478,lower:6},{upper:2628346,lower:6},{upper:2639334,lower:6},{upper:2641942,lower:6},{upper:2644794,lower:6},{upper:2647770,lower:6},{upper:2653298,lower:6},{upper:2658142,lower:6},{upper:2662286,lower:6},{upper:2666690,lower:6},{upper:2671526,lower:6},{upper:2675726,lower:6},{upper:2677334,lower:6},{upper:2679090,lower:6},{upper:2685974,lower:6},{upper:2688866,lower:6},{upper:2692082,lower:6},{upper:2696782,lower:6},{upper:2699034,lower:6},{upper:2705462,lower:6},{upper:2708010,lower:6},{upper:2711338,lower:6},{upper:2715646,lower:6},{upper:2716770,lower:6},{upper:2719490,lower:6},{upper:2725790,lower:6},{upper:2727746,lower:6},{upper:2729598,lower:6},{upper:2752006,lower:6},{upper:2770646,lower:6},{upper:2844246,lower:6},{upper:2856686,lower:6},{upper:3132114,lower:6},{upper:3143158,lower:6},{upper:3147502,lower:6},{upper:3167842,lower:2},{upper:3183310,lower:6},{upper:3197802,lower:6},{upper:3226138,lower:6},{upper:3238402,lower:6}],e[$gameType.MP2_USA]=[{upper:347090,lower:6},{upper:408118,lower:6},{upper:478570,lower:2},{upper:2787898,lower:6},{upper:2813510,lower:6},{upper:2885658,lower:6},{upper:2992458,lower:6},{upper:3086286,lower:6},{upper:3173442,lower:6},{upper:3272410,lower:6},{upper:3315778,lower:6},{upper:3318382,lower:6},{upper:3364070,lower:6},{upper:3420422,lower:6},{upper:3507722,lower:6},{upper:3523054,lower:6},{upper:3527082,lower:6},{upper:3544542,lower:6},{upper:3544974,lower:6},{upper:4017646,lower:6},{upper:4235298,lower:6},{upper:4241638,lower:6},{upper:4261818,lower:6},{upper:4282286,lower:6}],e[$gameType.MP3_USA]=[{upper:853926,lower:6},{upper:933974,lower:6},{upper:1038298,lower:6},{upper:1099286,lower:6},{upper:3930522,lower:6},{upper:3956998,lower:6},{upper:3964274,lower:6},{upper:3988338,lower:6},{upper:3996310,lower:6},{upper:4564630,lower:6},{upper:4603802,lower:6},{upper:4616874,lower:6},{upper:5033866,lower:2},{upper:5145586,lower:6},{upper:5178138,lower:6},{upper:5192926,lower:6},{upper:5400346,lower:6},{upper:5544602,lower:2},{upper:5567998,lower:6},{upper:5572038,lower:6}];var y=void 0;function p(){var e=void 0,r=void 0;$$debug&&window.performance&&(e=performance.now());var p=g();y=new Array(p);for(var o=0;o<p;o++){var u=s(o);y[o]=new Array(u);for(var t=0;t<u;t++)y[o][t]=l(o,t)}return $$debug&&e&&(r=performance.now(),$$log("HVQFS.extract() -> "+(r-e)+"ms")),y}function n(e,r,p){var o=s(e);r.setUint32(p,o+1);for(var u=p+4,t=p+4+4*(o+1),l=0;l<o;l++)r.setUint32(u,t-p),u+=4,t=i(e,l,r,t),t=$$number.makeDivisibleBy(t,4);return r.setUint32(u,t-p),t}function i(e,r,p,o){var u=y[e][r];return PP64.utils.arrays.copyRange(p,u,o,0,u.byteLength),o+u.byteLength}function f(e){var r=y[e].length-1,p=new DataView(y[e][0],0),o=p.getUint32(0),u=p.getUint32(4),t=p.getUint32(8),l=p.getUint32(12),n=o*t,w=u*l;if($$log("HVQFS.readBackground, dir: "+e+", tiles: "+r+", board is "+n+"x"+w),39===e){var a=new DataView(y[39][211]);PP64.utils.img.HVQ._black=a}for(var i=[],f=1===PP64.romhandler.getGameVersion()?1:2;f<y[e].length;f++)i.push(new DataView(y[e][f]));for(var g=i.map(PP64.utils.img.HVQ.decode).map(function(e){return new DataView(e)}),s=[],c=l-1;0<=c;c--)for(var v=0;v<t;v++)s.push(g[c*t+v]);for(var m=PP64.utils.img.tiler.fromTiles(s,t,l,2*o,u),P=PP64.utils.img.RGBA5551.toRGBA32(m,n,w),d=new Uint8Array(P),h=PP64.utils.canvas.createContext(n,w).createImageData(n,w),U=0;U<d.byteLength;U++)h.data[U]=d[U];return h}function g(){if(y)return y.length;var e=PP64.romhandler.getROMBuffer(),r=w();return null===r?0:new DataView(e,r).getUint32(0)-1}function s(e){if(y&&y[e])return y[e].length;var r=PP64.romhandler.getROMBuffer(),p=w();if(null===p)return 0;var o=p+new DataView(r,p).getUint32(4*(1+e));return new DataView(r,o).getUint32(0)-1}return{read:l,write:function(e,r,p){y[e][r]=p.slice(0)},get:function(e,r){return y[e][r]},extract:p,extractAsync:function(){return new Promise(function(e,r){p(),e()})},pack:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,p=new DataView(e,r),o=g();p.setUint32(0,o+1);for(var u=4,t=4+4*(o+1),l=0;l<o;l++)p.setUint32(u,t),u+=4,t=n(l,p,t),t=$$number.makeDivisibleBy(t,4);return p.setUint32(u,t),t},clearCache:function(){y=null},readBackground:function(e){var r,p,o,u=(r=new DataView(y[e][0],0),p=r.getUint32(0),o=r.getUint32(4),[p*r.getUint32(8),o*r.getUint32(12)]),t=_slicedToArray(u,2),l=t[0],n=t[1],w=PP64.utils.canvas.createContext(l,n),a=f(e);return w.putImageData(a,0,0),{width:l,height:n,src:w.canvas.toDataURL()}},readBackgroundImgData:f,writeBackground:function(e,r,p,o){var u=p/64,t=o/48,l=u*t;$$log("HVQFS.writeBackground, dir: "+e+", img is "+p+"x"+o);for(var n=PP64.utils.img.tiler.toTiles(r.data,u,t,256,48).map(function(e){return PP64.utils.img.RGBA5551.fromRGBA32(e,64,48)}).map(function(e){return PP64.utils.img.HVQ.encode(e,64,48)}),w=[],a=t-1;0<=a;a--)for(var i=0;i<u;i++)w.push(n[a*u+i]);if(1===PP64.romhandler.getGameVersion())for(var f=1;f<=l;f++)y[e][f]=w[f-1];else for(var g=2;g<=l+1;g++)y[e][g]=w[g-2]},getByteLength:function(){var e=0,r=y.length;e+=4,e+=4*(r+1);for(var p=0;p<r;p++){var o=y[p].length;e+=4,e+=4*(o+1);for(var u=0;u<o;u++)e+=y[p][u].byteLength,e=$$number.makeDivisibleBy(e,4)}return e},getDirectoryCount:g,getHVQFileCount:s,getROMOffset:w,setROMOffset:function(e,r){$$log("HVQFS.setROMOffset(0x"+Number(e).toString(16)+")");var p=new DataView(r),o=a(),u=(4294901760&e)>>>16,t=65535&e;32768&t&&(u+=1);for(var l=0;l<o.length;l++)p.setUint16(o[l].upper,u),p.setUint16(o[l].lower,t);$$log("HVQFS.setROMOffset -> "+$$hex(u<<16|t))},getPatchOffsets:a}}();
"use strict";var _createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("fs"),PP64.fs.audio=function(){var t={};function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=PP64.romhandler.getDataView(),i=c()[t];if(!i)return null;var n=i.offsets[0],r=e.getUint16(n.upper)<<16|e.getUint16(n.lower);return 32768&r&&(r-=65536),$$log("Audio.getROMOffset -> "+$$hex(r)),r}function c(){return t[PP64.romhandler.getROMGame()]}t[$gameType.MP1_USA]=[{relative:0,offsets:[{upper:399174,lower:399178},{upper:2991058,lower:2991062}]},{relative:2356512,offsets:[{upper:110378,lower:110382},{upper:399182,lower:399186},{upper:399230,lower:399234},{upper:2991066,lower:2991070},{upper:2991106,lower:2991110}]},{relative:3118144,offsets:[{upper:110386,lower:110390},{upper:399150,lower:399154},{upper:399238,lower:399242},{upper:2991038,lower:2991042},{upper:2991114,lower:2991118}]},{relative:6811072,offsets:[{upper:110350,lower:110354},{upper:399202,lower:399206},{upper:2991082,lower:2991086}]},{relative:8074688,offsets:[{upper:110426,lower:110430}]},{relative:8076784,offsets:[{upper:110438,lower:110442}]}],t[$gameType.MP1_JPN]=[],t[$gameType.MP2_USA]=[{relative:0,offsets:[{upper:119618,lower:119622},{upper:502254,lower:502258},{upper:502290,lower:502294}]},{relative:1809472,offsets:[{upper:502266,lower:502270}]},{relative:5697472,offsets:[{upper:119630,lower:119634},{upper:502302,lower:502306}]},{relative:7184656,offsets:[{upper:119682,lower:119686}]}],t[$gameType.MP3_USA]=[{relative:0,offsets:[{upper:62058,lower:62062},{upper:311026,lower:311030}]},{relative:1920048,offsets:[{upper:62070,lower:62074},{upper:311038,lower:311042}]},{relative:6796288,offsets:[{upper:62110,lower:62114}]}];var r=void 0;function i(){var t=PP64.romhandler.getROMBuffer(),e=n();if(null!==e){var i=s();r=t.slice(e,e+i)}}function s(){var t=PP64.romhandler.getROMGame();switch(t){case $gameType.MP1_USA:return 8076784;case $gameType.MP1_JPN:return 16;case $gameType.MP2_USA:return 7187280;case $gameType.MP3_USA:return 6798912}throw"Figure out the audio section length for "+t}!function(){function e(t){if(_classCallCheck(this,e),this.__type="S2",21298!==t.getUint16(0))throw"S2 constructor encountered non-S2 structure";this._extract(t)}_createClass(e,[{key:"_extract",value:function(t){var e=t.getUint16(2),i=4+8*e;this.midis=[];for(var n=0;n<e;n++){var r=t.getUint32(4+4*n*2),s=t.getUint32(8+4*n*2),a=t.byteOffset+r;this.midis.push({buffer:t.buffer.slice(a,a+s),soundbankIndex:t.getUint8(i+16*n)})}var o=t.getUint32(i+12),u=t.getUint32(4);this.tbl=t.buffer.slice(t.byteOffset+o,t.byteOffset+u);var l=t.getUint32(i+4),c=new DataView(t.buffer,t.byteOffset+l);this.soundbanks=new f(c)}}])}();var f=function(){function e(t){if(_classCallCheck(this,e),this.__type="B1",16945!==t.getUint16(0))throw"B1 constructor encountered non-B1 structure";this._extract(t)}return _createClass(e,[{key:"_extract",value:function(t){var e=t.getUint16(2);this.banks=[];for(var i=0;i<e;i++){var n=t.getUint32(4+4*i);this.banks.push(new a(t,n))}}}]),e}(),a=function(){function i(t,e){_classCallCheck(this,i),this.__type="ALBank",this._extract(t,e)}return _createClass(i,[{key:"_extract",value:function(t,e){if(this.flags=t.getUint16(e+2),this.pad=t.getUint16(e+4),this.sampleRate=t.getUint16(e+6),t.getUint32(e+8))throw"Need to parse percussion at bank offset "+$$hex(t.byteOffset+e);var i=t.getUint16(e);this.instruments=[];for(var n=0;n<i;n++){var r=t.getUint32(e+12+4*n);this.instruments.push(new o(t,r))}}}]),i}(),o=function(){function i(t,e){_classCallCheck(this,i),this.__type="ALInst",this._extract(t,e)}return _createClass(i,[{key:"_extract",value:function(t,e){this.volume=t.getUint8(e),this.pan=t.getUint8(e+1),this.priority=t.getUint8(e+2),this.flags=t.getUint8(e+3),this.tremType=t.getUint8(e+4),this.tremRate=t.getUint8(e+5),this.tremDepth=t.getUint8(e+6),this.tremDelay=t.getUint8(e+7),this.vibType=t.getUint8(e+8),this.vibRate=t.getUint8(e+9),this.vibDepth=t.getUint8(e+10),this.vibDelay=t.getUint8(e+11),this.bendRange=t.getUint16(e+12);var i=t.getUint16(e+14);this.sounds=[];for(var n=0;n<i;n++){var r=t.getUint32(e+16+4*n);this.sounds.push(new u(t,r))}}}]),i}(),u=function(){function i(t,e){_classCallCheck(this,i),this.__type="ALSound",this._extract(t,e)}return _createClass(i,[{key:"_extract",value:function(t,e){var i=t.getUint32(e);this.env=new l(t,i);var n=t.getUint32(e+4);this.keymap=new h(t,n);var r=t.getUint32(e+8);this.wave=new p(t,r),this.samplePan=t.getUint8(e+12),this.sampleVolume=t.getUint8(e+13),this.flags=t.getUint8(e+14)}}]),i}(),l=function(){function i(t,e){_classCallCheck(this,i),this.__type="ALEnv",this._extract(t,e)}return _createClass(i,[{key:"_extract",value:function(t,e){this.attackTime=t.getUint32(e),this.decayTime=t.getUint32(e+4),this.releaseTime=t.getUint32(e+8),this.attackVolume=t.getUint8(e+12),this.decayVolume=t.getUint8(e+13),this.zeroPad=t.getUint16(e+14)}}]),i}(),h=function(){function i(t,e){_classCallCheck(this,i),this.__type="ALKey",this._extract(t,e)}return _createClass(i,[{key:"_extract",value:function(t,e){this.velocityMin=t.getUint8(e),this.velocityMax=t.getUint8(e+1),this.keyMin=t.getUint8(e+2),this.keyMax=t.getUint8(e+3),this.keyBase=t.getUint8(e+4),this.detune=t.getUint8(e+5)}}]),i}(),p=function(){function i(t,e){_classCallCheck(this,i),this.__type="ALWave",this._extract(t,e)}return _createClass(i,[{key:"_extract",value:function(t,e){this.waveBase=t.getUint32(e),this.waveLen=t.getUint32(e+4),this.type=t.getUint8(e+8),this.flags=t.getUint8(e+9),this.zeroes=t.getUint16(e+10),this.loopOffset=t.getUint32(e+12),this.predictorOffset=t.getUint32(e+16)}}]),i}();(function(){function i(t,e){_classCallCheck(this,i),this.__type="ALADPCMLoop",this._extract(t,e)}_createClass(i,[{key:"_extract",value:function(t,e){}}])})(),function(){function i(t,e){_classCallCheck(this,i),this.__type="ALADPCMBook",this._extract(t,e)}_createClass(i,[{key:"_extract",value:function(t,e){}}])}();return{read:function(t){throw"audio.read not implemented"},write:function(t,e){throw"audio.write not implemented"},extract:i,extractAsync:function(){return new Promise(function(t,e){i(),t()})},pack:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return PP64.utils.arrays.copyRange(t,r,e,0,r.byteLength),r.byteLength},clearCache:function(){r=null},getByteLength:s,getROMOffset:n,setROMOffset:function(t,e){$$log("Audio.setROMOffset("+$$hex(t)+")");for(var i=new DataView(e),n=c(),r=0;r<n.length;r++){var s=n[r],a=t+s.relative,o=(4294901760&a)>>>16,u=65535&a;32768&u&&(o+=1);for(var l=0;l<s.offsets.length;l++)i.setUint16(s.offsets[l].upper,o),i.setUint16(s.offsets[l].lower,u)}},getPatchInfo:c}}();
"use strict";PP64.ns("fs"),PP64.fs.animationfs=function(){var e={};function r(){var e=PP64.romhandler.getDataView(),t=o();if(!t)return null;var r=t[0],n=e.getUint16(r.upper)<<16,i=e.getUint16(r.lower),s=n|i;return 32768&i&&(s-=65536),$$log("AnimationFS.getROMOffset -> "+$$hex(s)),s}function o(){return e[PP64.romhandler.getROMGame()]}function f(e,t,r,n){var i=PP64.utils.compression.compress(3,new DataView(r));l[e]||(l[e]=[]),l[e][t]||(l[e][t]={}),l[e][t][n]={compressionType:3,decompressed:r,compressed:i}}function m(e,t,r){for(var n=t/64,i=r/48,s=PP64.utils.img.tiler.toTiles(e.data,n,i,256,48).map(function(e){return PP64.utils.img.RGBA5551.fromRGBA32(e,64,48)}),a=[],o=i-1;0<=o;o--)for(var u=0;u<n;u++)a.push(s[o*n+u]);return a}function u(e,t,r,n,i){for(var s=[],a=0;a<r.length;a++)l[e][t].hasOwnProperty(a+1)?s.push(new DataView(l[e][t][a+1].decompressed)):s.push(new DataView(r[a]));var o=n/64,u=i/48;s=function(e,t,r){for(var n=[],i=r-1;0<=i;i--)for(var s=0;s<t;s++)n.push(e[i*t+s]);return n}(s,o,u);for(var c=PP64.utils.img.tiler.fromTiles(s,o,u,128,48),f=PP64.utils.img.RGBA5551.toRGBA32(c,n,i),m=new Uint8Array(f),p=PP64.utils.canvas.createContext(n,i),g=p.createImageData(n,i),v=0;v<m.byteLength;v++)g.data[v]=m[v];return p.putImageData(g,0,0),p.canvas.toDataURL()}e[$gameType.MP2_USA]=[{upper:345798,lower:345802}];var l=void 0;function n(){var e=r(),t=PP64.romhandler.getDataView();return l=function(e,t){for(var r=[],n=e.getUint32(t)-1,i=0;i<n;i++){var s=e.getUint32(t+4+4*i);r.push(a(e,t+s))}return r}(t,e)}function a(e,t){for(var r=[],n=e.getUint32(t),i=0;i<n;i++){var s=e.getUint32(t+4+4*i);r.push(c(e,t+s))}return r}function c(e,t){for(var r,n,i,s,a,o,u,c,f,m={},p=e.getUint32(t)-1,g=0;g<p;g++){var v=e.getUint32(t+4+4*g),l=(n=t+v,o=void 0,i=(r=e).getUint32(n),s=r.getUint32(n+4),a=r.getUint32(n+8),o=r.buffer,u=n+12,c=new DataView(o,u),f=PP64.utils.compression.getCompressedSize(s,c,a),{index:i,compressionType:s,compressed:o.slice(u,u+f),decompressed:PP64.utils.compression.decompress(s,c,a)});m[l.index]={compressionType:l.compressionType,compressed:l.compressed,decompressed:l.decompressed}}return m}function p(e,t,r){var n=P(e);t.setUint32(r,n);for(var i=r+4,s=r+4+4*n,a=0;a<n;a++)t.setUint32(i,s-r),i+=4,s=g(e,a,t,s),s=$$number.makeDivisibleBy(s,4);return s}function g(e,t,r,n){var i=h(e,t);r.setUint32(n,i+1);var s=n+4,a=n+4+4*(i+1);for(var o in l[e][t])l[e][t].hasOwnProperty(o)&&(r.setUint32(s,a-n),s+=4,a=v(e,t,o,r,a),a=$$number.makeDivisibleBy(a,4));return r.setUint32(s,a-n),a}function v(e,t,r,n,i){var s=l[e][t][r];return n.setUint32(i,parseInt(r)),n.setUint32(i+4,3),n.setUint32(i+8,s.decompressed.byteLength),PP64.utils.arrays.copyRange(n,s.compressed,i+12,0,s.compressed.byteLength),i+12+s.compressed.byteLength}function d(){return l.length}function P(e){return l[e].length}function h(e,t){return Object.keys(l[e][t]).length}return{write:f,writeAnimationBackground:function(e,t,r,n,i,s){$$log("AnimationFS.writeAnimationBackground, set: "+e+", entry: "+t+", img is "+i+"x"+s);var a,o=m(r,i,s),u=m(n,i,s);a=t,l[e][a]={};for(var c=0;c<u.length;c++)PP64.utils.arrays.arrayBuffersEqual(o[c],u[c])||f(e,t,u[c],c+1)},readAnimationBackgrounds:function(e,t,r,n){for(var i=P(e),s=m(t,r,n),a=[],o=0;o<i;o++)a.push(u(e,o,s,r,n));return a},get:function(e,t,r){return l[e][t][r].decompressed},extract:n,extractAsync:function(){return new Promise(function(e,t){n(),e()})},pack:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(e,t),n=d();r.setUint32(0,n+1);for(var i=4,s=4+4*(n+1),a=0;a<n;a++)r.setUint32(i,s),i+=4,s=p(a,r,s),s=$$number.makeDivisibleBy(s,4);return r.setUint32(i,s),s},clearCache:function(){l=null},getByteLength:function(){var e=0,t=d();e+=4,e+=4*(t+1);for(var r=0;r<t;r++){var n=P(r);e+=4,e+=4*n;for(var i=0;i<n;i++){var s=h(r,i);for(var a in e+=4,e+=4*(s+1),l[r][i])l[r][i].hasOwnProperty(a)&&(e+=4,e+=4,e+=4,e+=l[r][i][a].compressed.byteLength,e=$$number.makeDivisibleBy(e,4))}}return e},getROMOffset:r,setROMOffset:function(e,t){var r=new DataView(t),n=o();if(n){var i=(4294901760&e)>>>16,s=65535&e;32768&s&&(i+=1);for(var a=0;a<n.length;a++)r.setUint16(n[a].upper,i),r.setUint16(n[a].lower,s);$$log("AnimationFS.setROMOffset -> "+$$hex(i<<16|s))}},getPatchOffsets:o,getSetCount:d,setSetEntryCount:function(e,t){return l[e].length=t}}}();
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],r=!0,n=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){n=!0,s=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.adapters={AdapterBase:function(){function e(){_classCallCheck(this,e),this.EVENT_MEM_SIZE=327680,this.EVENT_RAM_LOC=(2147483648|8388608-this.EVENT_MEM_SIZE)>>>0,this.EVENT_HEADER_SIZE=16}return _createClass(e,[{key:"loadBoards",value:function(){for(var e=[],t=PP64.adapters.boardinfo.getBoardInfos(PP64.romhandler.getROMGame()),a=0;a<t.length;a++){$$debug&&console.group("Board "+a);var r=t[a],n=r.bgDir,s=PP64.fs.hvqfs.readBackground(n),o={game:this.gameVersion,type:r.type||PP64.types.BoardType.NORMAL,bg:s,otherbg:{}},i=PP64.fs.mainfs.get(this.boardDefDirectory,r.boardDefFile);PP64.adapters.boarddef.parse(i,o);var d=o._chains;delete o._chains,$$log("Board "+a+" chains: ",d),this.onChangeBoardSpaceTypesFromGameSpaceTypes(o,d),this._applyPerspective(o,a),this._cleanLoadedBoard(o),this.onParseStrings(o,r),o.name||(o.name=r.name||""),this.onParseBoardSelectImg(o,r),this.onParseBoardLogoImg(o,r),this._parseAudio(o,r),this._findEventTableLocations(r),this._extractEvents(r,o,a,d),this._extractStarGuardians(o,r),this._extractBoos(o,r),r.onLoad&&r.onLoad(o),this.onLoad&&this.onLoad(o,r),e.push(o),$$debug&&console.groupEnd()}if($$debug)for(var f=PP64.fs.audio.getPatchInfo().length,c=0;c<f;c++)PP64.fs.audio.getROMOffset(c);return e}},{key:"overwriteBoard",value:function(e,t){var a=PP64.utils.obj.copy(t),r=PP64.adapters.boardinfo.getBoardInfoByIndex(PP64.romhandler.getROMGame(),e),n=PP64.adapters.boarddef.determineChains(a);PP64.adapters.boarddef.padChains(a,n);var s=PP64.boards.addSpace(a.bg.width+150,a.bg.height+100,$spaceType.OTHER,void 0,a);a._deadSpace=s,this.onChangeGameSpaceTypesFromBoardSpaceTypes(a),this._reversePerspective(a,e);var o=PP64.adapters.boarddef.create(a,n);PP64.fs.mainfs.write(this.boardDefDirectory,r.boardDefFile,o);var i=PP64.romhandler.getDataView(),d=r.eventASMStart;if(d)for(var f=r.eventASMEnd,c=d;c<f;c+=4)i.setUint32(c,0);return this.onWriteStrings(a,r),this.onWriteAudio(a,r,e),this.onCreateChainEvents(a,n),this._createStarEvents(a),this._createGateEvents(a,r,n),r.onWriteEvents&&r.onWriteEvents(a),this._writeEvents(a,r,e,n),this._writeStarInfo(a,r),this._writeBoos(a,r),this._clearOtherBoardNames(e),r.onAfterOverwrite&&r.onAfterOverwrite(i,a),this.onAfterOverwrite&&this.onAfterOverwrite(i,a,r),this.onOverwritePromises(t,r)}},{key:"onOverwritePromises",value:function(e,t){$$log("Adapter does not implement onOverwritePromises")}},{key:"hydrateSpace",value:function(e){throw"hydrateSpace not implemented"}},{key:"onParseStrings",value:function(e,t){$$log("Adapter does not implement onParseStrings")}},{key:"onWriteStrings",value:function(e,t){$$log("Adapter does not implement onWriteStrings")}},{key:"_applyPerspective",value:function(e,t){for(var a=e.bg.width,r=e.bg.height,n=0;n<e.spaces.length;n++){var s=e.spaces[n],o=this.onGetBoardCoordsFromGameCoords(s.x,s.y,s.z,a,r,t),i=_slicedToArray(o,3);s.x=i[0],s.y=i[1],s.z=i[2]}}},{key:"onGetBoardCoordsFromGameCoords",value:function(e,t,a,r,n,s){$$log("Adapter does not implement onGetBoardCoordsFromGameCoords");var o=r/2+e,i=n/2+t;return[Math.round(o),Math.round(i),Math.round(0)]}},{key:"_reversePerspective",value:function(e,t){for(var a=e.bg.width,r=e.bg.height,n=0;n<e.spaces.length;n++){var s=e.spaces[n],o=this.onGetGameCoordsFromBoardCoords(s.x,s.y,s.z,a,r,t),i=_slicedToArray(o,3);s.x=i[0],s.y=i[1],s.z=i[2]}}},{key:"onGetGameCoordsFromBoardCoords",value:function(e,t,a,r,n,s){return $$log("Adapter does not implement onGetGameCoordsFromBoardCoords"),[e-r/2,t-n/2,.048]}},{key:"onChangeBoardSpaceTypesFromGameSpaceTypes",value:function(e){$$log("Adapter does not implement onChangeBoardSpaceTypesFromGameSpaceTypes")}},{key:"onChangeGameSpaceTypesFromBoardSpaceTypes",value:function(e){$$log("Adapter does not implement onChangeGameSpaceTypesFromBoardSpaceTypes")}},{key:"_offsetToAddr",value:function(e,t){if("number"==typeof t.sceneIndex&&0<=t.sceneIndex){var a=PP64.fs.scenes.getInfo(t.sceneIndex);return(2147483647&a.ram_start)-(a.rom_start-e)}return t.spaceEventsStartAddr-(t.spaceEventsStartOffset-e)}},{key:"_offsetToAddrBase",value:function(e,t){return t+e>>>0}},{key:"_addrToOffset",value:function(e,t){if("number"==typeof t.sceneIndex&&0<=t.sceneIndex){var a=PP64.fs.scenes.getInfo(t.sceneIndex);return a.rom_start-((2147483647&a.ram_start)-(2147483647&e))}return t.spaceEventsStartOffset-(t.spaceEventsStartAddr-e)}},{key:"_addrToOffsetBase",value:function(e,t){return(2147483647&e)-(2147483647&t)>>>0}},{key:"_cleanLoadedBoard",value:function(e){var t=e.spaces.length-1,a=e.spaces[e.spaces.length-1];a&&a.x>e.bg.width+50&&a.y>e.bg.height+50&&($$log("Pruning dead space",a),e.spaces.splice(t,1))}},{key:"_findEventTableLocations",value:function(e){if(!("number"!=typeof e.sceneIndex||e.sceneIndex<0)){var t=PP64.romhandler.getROMGame(),a=PP64.symbols.getSymbol(t,"EventTableHydrate"),r=PP64.fs.scenes.getCodeDataView(e.sceneIndex),n=$MIPS.findCalls(r,a),s=[];e.spaceEventTables||(e.spaceEventTables=s);for(var o=0;o<n.length;o++){var i=n[o],d=r.getUint32(i-4),f=r.getUint32(i+4),c=$MIPS.getRegSetAddress(d,f),p=this._addrToOffset(c,e);$$log("Found event table "+$$hex(c)+" (ROM "+$$hex(p)+")"),s.push({tableOffset:p})}}}},{key:"_extractEvents",value:function(e,t,a,r){if(e.spaceEventTables)this._extractEventsNew(e,t,a,r);else if(e.spaceEventsStartAddr)for(var n=PP64.romhandler.getROMBuffer(),s=new DataView(n),o=e.spaceEventsStartOffset;o<e.spaceEventsEndOffset;)if(-1!==s.getInt16(o)){var i=2147483647&s.getUint32(o+4),d=this._addrToOffset(i,e),f=s.getUint16(d);if(!i&&!s.getInt16(o))break;for(;f;){var c=s.getUint16(d+2),p=2147483647&s.getUint32(d+4),v=e.spaceEventsStartOffset-(e.spaceEventsStartAddr-p),u=s.getInt16(o),l=PP64.adapters.events.parse(s,{addr:p,offset:v,board:t,boardIndex:a,curSpace:u,chains:r,game:PP64.romhandler.getROMGame(),gameVersion:this.gameVersion});l&&!0!==l&&(l.activationType=f,l.executionType=c,PP64.boards.addEventByIndex(t,u,l)),i+=8,d=this._addrToOffset(i,e),f=s.getUint16(d)}o+=8}else o+=8}},{key:"_extractEventsNew",value:function(o,i,d,f){var c=this;if(o.spaceEventTables){var p=void 0,v=void 0,s=new PP64.adapters.SpaceEventTable;if(o.mainfsEventFile){var e=_slicedToArray(o.mainfsEventFile,2),t=e[0],a=e[1];PP64.fs.mainfs.has(t,a)&&(p=PP64.fs.mainfs.get(t,a),v=new DataView(p),s.parse(p,16))}p||(p=PP64.romhandler.getROMBuffer(),v=PP64.romhandler.getDataView(),o.spaceEventTables.forEach(function(e){var t=void 0;if(e.tableOffset)t=e.tableOffset;else{var a=v.getUint32(e.upper),r=v.getUint32(e.lower);if(!a&&!r)return;var n=$MIPS.getRegSetAddress(a,r);t=c._addrToOffset(n,o)}s.parse(p,t)})),s.forEach(function(e){var s=e.spaceIndex,t=2147483647&e.address,a=void 0;a=t>(2147483647&c.EVENT_RAM_LOC)?c._addrToOffsetBase(t,c.EVENT_RAM_LOC):c._addrToOffset(t,o);var r=new PP64.adapters.SpaceEventList;r.parse(p,a),r.forEach(function(e){var t=2147483647&e.address,a=void 0,r=void 0;t>(2147483647&c.EVENT_RAM_LOC)?(a=c._addrToOffsetBase(t,c.EVENT_RAM_LOC),r=v):(a=c._addrToOffset(t,o),r=PP64.romhandler.getDataView());var n=PP64.adapters.events.parse(r,{addr:t,offset:a,board:i,boardIndex:d,curSpace:s,curSpaceIndex:s,chains:f,game:PP64.romhandler.getROMGame(),gameVersion:c.gameVersion});n&&!0!==n&&(n.activationType=e.activationType,n.executionType=e.executionType,PP64.boards.addEventByIndex(i,s,n)),$$debug&&Object.values&&-1===Object.values($activationType).indexOf(e.activationType)&&$$log("Unknown event activation type "+$$hex(e.activationType)+", boardIndex: "+d+", spaceIndex: "+$$hex(s))})})}}},{key:"onCreateChainEvents",value:function(e,a){for(var t=0;t<a.length;t++){var r=a[t],n=r[r.length-1],s=PP64.boards.getConnections(n,e),o=void 0;1<s.length?function(){var t=[];s.forEach(function(e){t.push(i(e))}),o=PP64.adapters.events.create("CHAINSPLIT",{inlineArgs:s.concat(65535),chains:t})}():o=PP64.adapters.events.create("CHAINMERGE",{chain:i(s[0])}),PP64.boards.addEventByIndex(e,n,o,!0)}function i(e){for(var t=0;t<a.length;t++)if(0<=a[t].indexOf(e))return t}}},{key:"_createStarEvents",value:function(e){for(var t=0;t<e.spaces.length;t++){var a=e.spaces[t];a&&a.star&&((a.events||[]).some(function(e){e.id})||PP64.boards.addEventToSpace(a,PP64.adapters.events.create("STAR")))}}},{key:"_createGateEvents",value:function(n,e,a){for(var t=0,r=0;r<n.spaces.length;r++){var s=n.spaces[r];if(s&&s.subtype===$spaceSubType.GATE){var o=y(r),i=n.spaces[o];if(!i)throw"Gate did not have entry space";var d=y(o);if(!n.spaces[d])throw"Gate did not have previous space";var f=b(d),c=a[f].indexOf(d),p=A(r),v=n.spaces[p];if(!v)throw"Gate did not have exit space";var u=A(p);if(!n.spaces[u])throw"Gate did not have next space";var l=b(u),g=a[l].indexOf(u),P=PP64.adapters.events.create("GATE",{gatePrevChain:[f,c],gateEntryIndex:o,gateSpaceIndex:r,gateExitIndex:p,gateNextChain:[l,g]});if(PP64.boards.addEventToSpace(i,P),PP64.boards.addEventToSpace(v,P),PP64.boards.addEventToSpace(s,PP64.adapters.events.create("GATECLOSE",{gateIndex:t})),e.gateNeighborsOffset)for(var h=PP64.romhandler.getDataView(),m=0;m<e.gateNeighborsOffset.length;m++){var S=e.gateNeighborsOffset[m];S+=4*t,h.setUint16(S,o),h.setUint16(S+2,p)}t++}}function y(e){for(var t in n.links)for(var a=PP64.boards.getConnections(t,n),r=0;r<a.length;r++)if(a[r]===e)return Number(t);return-1}function A(e){return PP64.boards.getConnections(e,n)[0]}function b(e){for(var t=0;t<a.length;t++)if(0<=a[t].indexOf(e))return t}}},{key:"_getArgsSize",value:function(e){return 2*e+(4-2*e%4)}},{key:"_writeEvents",value:function(a,l,g,e){var P=this;if(l.mainfsEventFile)this._writeEventsNew(a,l,g,e);else{var h=PP64.romhandler.getDataView(),r=PP64.romhandler.getByteArray(),m=l.spaceEventsStartOffset,n=m-8,S=l.eventASMStart;r.fill(0,n,n+8);for(var y={},t=function(p){var e=a.spaces[p];if(!e.events||!e.events.length)return"continue";var t=8*(e.events.length+1);e.events.forEach(function(e){e.inlineArgs&&(t+=P._getArgsSize(e.inlineArgs.length))}),n-=t,r.fill(0,n,n+t);var v=n+8,u=!1;e.events.forEach(function(e){var t=y[e.id]||{},a={boardIndex:g,offset:S,addr:2147483648|P._offsetToAddr(S,l),game:PP64.romhandler.getROMGame(),gameVersion:P.gameVersion,parameterValues:e.parameterValues},r=0,n=0;e.inlineArgs&&(r=e.inlineArgs.length,n=P._getArgsSize(r),a.argsAddr=2147483648|P._offsetToAddr(v,l));for(var s=0;s<r;s++){var o=v+2*s;h.setUint16(o,e.inlineArgs[s])}var i=PP64.adapters.events.write(PP64.romhandler.getROMBuffer(),e,a,t),d=_slicedToArray(i,2),f=d[0],c=d[1];if(y[e.id]=t,h.setUint16(n+v,e.activationType),h.setUint16(n+v+2,e.executionType||e.mystery),h.setUint32(n+v+4,2147483648|P._offsetToAddr(f,l)),u||(h.setUint16(m,p),h.setUint32(m+4,2147483648|P._offsetToAddr(n+v,l)),u=!0),v+=8+n,f===S&&(S+=c),S>l.eventASMEnd)throw PP64.app.showMessage("Oops! This board is too complicated and overflowed the game's available space.\n              Try removing some events or reducing the number of branching paths.\n              The ROM has also been corrupted in memory so please close and open it."),"Overflowed board event ASM region."}),m+=8},s=0;s<a.spaces.length;s++)t(s)}}},{key:"_writeEventsNew",value:function(e,t,a,r){if(!t.mainfsEventFile)throw"No MainFS file specified to place board ASM for board "+a+".";var n=new ArrayBuffer(this.EVENT_MEM_SIZE),s=new DataView(n),o=this.EVENT_HEADER_SIZE;s.setUint32(0,PP64.utils.string.toU32("PP64")),s.setUint32(4,this.EVENT_RAM_LOC);for(var i=new PP64.adapters.SpaceEventTable,d=[],f=0;f<e.spaces.length;f++){var c=e.spaces[f];if(c.events&&c.events.length){i.add(f,0);for(var p=new PP64.adapters.SpaceEventList,v=0;v<c.events.length;v++){var u=c.events[v];p.add(u.activationType,u.executionType||u.mystery,0)}d.push(p)}}var l=$$number.makeDivisibleBy(i.byteLength(),16),g=d.reduce(function(e,t){return e+t.byteLength()},0);o+=l+(g=$$number.makeDivisibleBy(g,16));for(var P={},h=0,m=this.EVENT_HEADER_SIZE+l,S=0;S<e.spaces.length;S++){var y=e.spaces[S];if(y.events&&y.events.length){for(var A=d[h],b=0;b<y.events.length;b++){var E=y.events[b],T=P[E.id]||{},I={boardIndex:a,board:e,curSpaceIndex:S,curSpace:y,chains:r,offset:o,addr:this._offsetToAddrBase(o,this.EVENT_RAM_LOC),game:PP64.romhandler.getROMGame(),gameVersion:this.gameVersion,parameterValues:E.parameterValues},_=PP64.adapters.events.write(n,E,I,T),O=_slicedToArray(_,2),w=O[0],k=O[1];P[E.id]=T;var M=void 0;M=w>this.EVENT_MEM_SIZE?2147483648|this._offsetToAddr(w,t):this._offsetToAddrBase(w,this.EVENT_RAM_LOC),A.setAddress(b,M),o+=k}var U=this._offsetToAddrBase(m,this.EVENT_RAM_LOC);i.add(S,U),m+=A.write(n,m),h++}}i.write(n,this.EVENT_HEADER_SIZE),s.setUint32(8,o),n=n.slice(0,o);var C=_slicedToArray(t.mainfsEventFile,2),$=C[0],B=C[1];PP64.fs.mainfs.write($,B,n),this._writeEventAsmHook(t,a)}},{key:"_writeEventAsmHook",value:function(e,t){var a=this._offsetToAddr(e.eventASMStart,e),r=MIPSInst.parse("JAL "+a),n=PP64.romhandler.getDataView();this._clearSpaceEventTableCalls(n,e);var s=e.spaceEventTables[0].upper;n.setUint32(s,r),$$log("Installed event hook at ROM "+$$hex(s)+", JAL "+a);var o=e.eventASMStart;n.setUint32(o,MIPSInst.parse("ADDIU SP SP 0xFFE8")),n.setUint32(o+=4,MIPSInst.parse("SW RA, 0x0010(SP)"));var i=_slicedToArray(e.mainfsEventFile,2),d=i[0],f=i[1];n.setUint32(o+=4,MIPSInst.parse("LUI A0 "+d)),n.setUint32(o+=4,MIPSInst.parse("JAL "+this.MAINFS_READ_ADDR)),n.setUint32(o+=4,MIPSInst.parse("ADDIU A0 A0 "+f)),n.setUint32(o+=4,MIPSInst.parse("ADDU T4 V0 R0")),n.setUint32(o+=4,MIPSInst.parse("LW T0 0x4(T4)")),n.setUint32(o+=4,MIPSInst.parse("LW T1 0x8(T4)")),n.setUint32(o+=4,MIPSInst.parse("LW T2 0(T4)")),n.setUint32(o+=4,MIPSInst.parse("SW T2 0(T0)")),n.setUint32(o+=4,MIPSInst.parse("ADDIU T4 T4 4")),n.setUint32(o+=4,MIPSInst.parse("ADDIU T0 T0 4")),n.setUint32(o+=4,MIPSInst.parse("ADDIU T1 T1 -4")),n.setUint32(o+=4,MIPSInst.parse("BGTZ T1 -6")),n.setUint32(o+=4,0),n.setUint32(o+=4,MIPSInst.parse("ADDU T9 V0 R0")),n.setUint32(o+=4,MIPSInst.parse("LW T4 4(T9)")),n.setUint32(o+=4,MIPSInst.parse("JAL "+this.TABLE_HYDRATE_ADDR)),n.setUint32(o+=4,MIPSInst.parse("ADDIU A0 T4 16")),n.setUint32(o+=4,MIPSInst.parse("JAL "+this.HEAP_FREE_ADDR)),n.setUint32(o+=4,MIPSInst.parse("ADDU A0 T9 R0")),n.setUint32(o+=4,MIPSInst.parse("LW RA 0x10(SP)")),n.setUint32(o+=4,MIPSInst.parse("JR RA")),n.setUint32(o+=4,MIPSInst.parse("ADDIU SP SP 0x18"))}},{key:"_clearSpaceEventTableCalls",value:function(a,e){e.clearSpaceEventTableCalls?e.clearSpaceEventTableCalls(a):e.spaceEventTables.forEach(function(e){for(var t=e.upper;t<=e.lower;t+=4)a.setUint32(t,0)})}},{key:"onWriteEventAsmHook",value:function(e,t){throw"Adapter does not implement onWriteEventAsmHook"}},{key:"_extractStarGuardians",value:function(e,t){var a=new DataView(PP64.romhandler.getROMBuffer());if(t.toadSpaceInst){var r=a.getUint16(t.toadSpaceInst+2);e.spaces[r]&&(e.spaces[r].subtype=$spaceSubType.TOAD)}if(t.starSpaceCount){var n=t.starSpaceArrOffset;Array.isArray(n)&&(n=n[0]);for(var s=0;s<t.starSpaceCount;s++){var o=a.getUint16(n+2*s);e.spaces[o]&&(e.spaces[o].star=!0)}for(var i=0;i<t.starSpaceCount;i++){var d=t.toadSpaceArrOffset;Array.isArray(d)&&(d=d[0]);var f=a.getUint16(d+2*i);e.spaces[f]&&(e.spaces[f].subtype=$spaceSubType.TOAD)}}}},{key:"_writeStarInfo",value:function(e,t){var a=t.starSpaceCount;if(a){for(var r=PP64.romhandler.getDataView(),n=[],s=0;s<e.spaces.length;s++)e.spaces[s].star&&n.push(s);var o=t.starSpaceArrOffset;Array.isArray(o)||(o=[o]);for(var i=0;i<o.length;i++)for(var d=o[i],f=0;f<a;f++){var c=f<n.length?f:n.length-1;r.setUint16(d+2*f,n[c])}var p=PP64.boards.getSpacesOfSubType($spaceSubType.TOAD,e),v=t.toadSpaceArrOffset;Array.isArray(v)||(v=[v]);for(var u=0;u<v.length;u++)for(var l=v[u],g=0;g<a;g++){for(var P=g<n.length?g:n.length-1,h=e.spaces[n[P]],m=Number.MAX_VALUE,S=n[P],y=0;y<p.length;y++){var A=p[y],b=e.spaces[A],E=PP64.utils.number.distance(h.x,h.y,b.x,b.y);E<m&&(m=E,S=A)}r.setUint16(l+2*g,S)}}}},{key:"_extractBoos",value:function(e,t){var a=PP64.romhandler.getDataView(),r=void 0;if(t.boosLoopFnOffset){var n=t.boosLoopFnOffset,s=a.getUint16(n+42);if(436273148===a.getUint32(n+40)&&(s=1),0===s)return;n=t.boosReadbackFnOffset;var o=a.getInt16(n+210);o=1048576+o;for(var i=t.spaceEventsStartOffset-(t.spaceEventsStartAddr-o),d=0;d<s;d++)r=a.getUint16(i+2*d),e.spaces[r]&&(e.spaces[r].subtype=$spaceSubType.BOO)}else if(t.booSpaceInst)r=a.getUint16(t.booSpaceInst+2),e.spaces[r]&&(e.spaces[r].subtype=$spaceSubType.BOO);else if(t.booCount)for(var f=0;f<t.booArrOffset.length;f++)for(var c=t.booArrOffset[f],p=0;p<t.booCount;p++){var v=a.getUint16(c);e.spaces[v]&&(e.spaces[v].subtype=$spaceSubType.BOO),c+=2}}},{key:"_writeBoos",value:function(e,t){var a=PP64.boards.getSpacesOfSubType($spaceSubType.BOO,e),r=PP64.romhandler.getDataView();if(t.boosLoopFnOffset){var n=t.boosLoopFnOffset,s=r.getUint16(n+42);if(436273148===r.getUint32(n+40)?s=1:a.length&&s>a.length&&r.setUint16(n+42,a.length),0===s)return;n=t.boosReadbackFnOffset;var o=r.getInt16(n+210);o=1048576+o;for(var i=t.spaceEventsStartOffset-(t.spaceEventsStartAddr-o),d=0;d<s;d++){var f=void 0===a[d]?e._deadSpace:a[d];r.setUint16(i+2*d,f)}}else if(t.booSpaceInst){var c=void 0===a[0]?e._deadSpace:a[0];r.setUint16(t.booSpaceInst+2,c)}else if(t.booCount)for(var p=0;p<t.booArrOffset.length;p++)for(var v=t.booArrOffset[p],u=0;u<t.booCount;u++){var l=void 0===a[u]?e._deadSpace:a[u];r.setUint16(v,l),v+=2}}},{key:"_extractBanks",value:function(e,t){if(t.bankCount){for(var a=PP64.romhandler.getDataView(),r=0;r<t.bankArrOffset.length;r++)for(var n=t.bankArrOffset[r],s=0;s<t.bankCount;s++){var o=a.getUint16(n);e.spaces[o]&&(e.spaces[o].subtype=$spaceSubType.BANK),n+=2}for(var i=0;i<t.bankCoinArrOffset.length;i++)for(var d=t.bankCoinArrOffset[i],f=0;f<t.bankCount;f++){var c=a.getUint16(d);e.spaces[c]&&(e.spaces[c].subtype=$spaceSubType.BANKCOIN),d+=2}}}},{key:"_writeBanks",value:function(e,t){var a=PP64.romhandler.getDataView();if(t.bankCount){for(var r=PP64.boards.getSpacesOfSubType($spaceSubType.BANK,e),n=0;n<t.bankArrOffset.length;n++)for(var s=t.bankArrOffset[n],o=0;o<t.bankCount;o++){var i=void 0===r[o]?e._deadSpace:r[o];a.setUint16(s,i),s+=2}for(var d=PP64.boards.getSpacesOfSubType($spaceSubType.BANKCOIN,e),f=0;f<t.bankCoinArrOffset.length;f++)for(var c=t.bankCoinArrOffset[f],p=0;p<t.bankCount;p++){var v=void 0===d[p]?e._deadSpace:d[p];a.setUint16(c,v),c+=2}}}},{key:"_extractItemShops",value:function(e,t){if(t.itemShopCount)for(var a=PP64.romhandler.getDataView(),r=0;r<t.itemShopArrOffset.length;r++)for(var n=t.itemShopArrOffset[r],s=0;s<t.itemShopCount;s++){var o=a.getUint16(n);e.spaces[o]&&(e.spaces[o].subtype=$spaceSubType.ITEMSHOP),n+=2}}},{key:"_writeItemShops",value:function(e,t){var a=PP64.romhandler.getDataView();if(t.itemShopCount)for(var r=PP64.boards.getSpacesOfSubType($spaceSubType.ITEMSHOP,e),n=0;n<t.itemShopArrOffset.length;n++)for(var s=t.itemShopArrOffset[n],o=0;o<t.itemShopCount;o++){var i=void 0===r[o]?e._deadSpace:r[o];a.setUint16(s,i),s+=2}}},{key:"_writeGates",value:function(e,t){var a=PP64.romhandler.getDataView();if(t.gateCount){for(var r=[],n=0;n<e.spaces.length;n++)e.spaces[n].subtype===$spaceSubType.GATE&&r.push(n);for(var s=0;s<t.gateArrOffset.length;s++)for(var o=t.gateArrOffset[s],i=0;i<t.gateCount;i++){var d=void 0===r[i]?e._deadSpace:r[i];a.setUint16(o,d),o+=2}}}},{key:"_writeArrowRotations",value:function(e,t){var a=PP64.romhandler.getDataView(),r=t.arrowRotStartOffset,n=t.arrowRotEndOffset;if(r){for(var s=r;s<n;s+=4)a.setUint32(s,0);for(var o=[],i=0;i<e.spaces.length;i++)e.spaces[i].type===$spaceType.ARROW&&o.push(e.spaces[i].rotation||0);for(var d=PP64.romhandler.getROMGame(),f=PP64.symbols.getSymbol(d,"AddArrowAngle"),c=PP64.adapters.boardinfo.getArrowRotationLimit(t),p=[".orga "+r],v=Math.min(c,o.length),u=0;u<v;u++)p.push("LUI A0 hi("+$$hex(PP64.utils.number.getRawFloat32Format(o[u]))+")"),p.push("JAL "+f),p.push("MTC1 A0 F12");MIPSAssem.assemble(p,{buffer:a.buffer})}}},{key:"_writeBackground",value:function(s,o,i,d){return new Promise(function(t,e){var a=PP64.utils.canvas.createContext(i,d),r=new Image,n=setTimeout(function(){return e("Failed to write bg "+s)},45e3);r.onload=function(){a.drawImage(r,0,0,i,d);var e=a.getImageData(0,0,i,d);PP64.fs.hvqfs.writeBackground(s,e,i,d),clearTimeout(n),t()},r.src=o})}},{key:"onParseBoardSelectImg",value:function(e,t){$$log("Adapter does not implement onParseBoardSelectImg")}},{key:"onWriteBoardSelectImg",value:function(e,t){return $$log("Adapter does not implement onWriteBoardSelectImg"),new Promise(function(e,t){e()})}},{key:"onParseBoardLogoImg",value:function(e,t){$$log("Adapter does not implement onParseBoardLogoImg")}},{key:"onWriteBoardLogoImg",value:function(e,t){return $$log("Adapter does not implement onWriteBoardLogoImgs"),new Promise(function(e,t){e()})}},{key:"_brandBootSplashscreen",value:function(){var o=this;return new Promise(function(r,e){if(PP64.settings.get($setting.writeBranding)){if(!o.nintendoLogoFSEntry||!o.hudsonLogoFSEntry)return $$log("Adapter cannot write branding"),void r();var n=new Image,s=setTimeout(function(){return e("Failed to overwrite boot logo")},45e3);n.onload=function(){o._combineSplashcreenLogos();var e=PP64.utils.img.toArrayBuffer(n,320,240),t=[{src:PP64.utils.img.RGBA5551.fromRGBA32(e,320,240),width:320,height:240,bpp:16}],a=PP64.utils.img.ImgPack.toPack(t,16,8);PP64.fs.mainfs.write(o.hudsonLogoFSEntry[0],o.hudsonLogoFSEntry[1],a),clearTimeout(s),r()},n.src="img/bootsplash.png"}else r()})}},{key:"_combineSplashcreenLogos",value:function(){var e=PP64.fs.mainfs.get(this.nintendoLogoFSEntry[0],this.nintendoLogoFSEntry[1]);if(32===new Uint8Array(e)[26]){var t=PP64.fs.mainfs.get(this.hudsonLogoFSEntry[0],this.hudsonLogoFSEntry[1]),a=PP64.utils.img.ImgPack.fromPack(e)[0],r=PP64.utils.img.ImgPack.fromPack(t)[0],n=new Uint8Array(a.src),s=new Uint8Array(r.src),o=PP64.utils.canvas.createContext(320,240);o.fillStyle="black",o.fillRect(0,0,320,240);for(var i=o.getImageData(0,0,320,240),d=112640;d<197120;d++)i.data[d-51200]=n[d];for(var f=112640;f<197120;f++)i.data[f+64e3]=s[f];var c=[{src:PP64.utils.img.RGBA5551.fromRGBA32(i.data.buffer,320,240),width:320,height:240,bpp:16}],p=PP64.utils.img.ImgPack.toPack(c,16,8);PP64.fs.mainfs.write(this.nintendoLogoFSEntry[0],this.nintendoLogoFSEntry[1],p)}}},{key:"_clearOtherBoardNames",value:function(e){$$log("Adapter does not implement _clearOtherBoardNames")}},{key:"_readPackedFromMainFS",value:function(e,t){var a=PP64.fs.mainfs.get(e,t),r=PP64.utils.img.ImgPack.fromPack(a);if(r&&r.length)return r.map(function(e){return new DataView(e.src)})}},{key:"_readImgsFromMainFS",value:function(e,t){var a=PP64.fs.mainfs.get(e,t),r=PP64.utils.img.ImgPack.fromPack(a);if(r&&r.length)return r}},{key:"_readImgInfoFromMainFS",value:function(e,t,a){return this._readImgsFromMainFS(e,t)[a||0]}},{key:"_readImgFromMainFS",value:function(e,t,a){var r=this._readImgInfoFromMainFS(e,t,a);return PP64.utils.arrays.arrayBufferToDataURL(r.src,r.width,r.height)}},{key:"_parseAudio",value:function(e,t){if(t.audioIndexOffset){var a=PP64.romhandler.getDataView();e.audioIndex=a.getUint16(t.audioIndexOffset)}}},{key:"onWriteAudio",value:function(e,t,a){if(t.audioIndexOffset){var r=PP64.romhandler.getDataView(),n=e.audioIndex;r.setUint16(t.audioIndexOffset,n)}}},{key:"getAudioMap",value:function(){return $$log("Adapter does not implement getAudioMap"),[]}},{key:"getCharacterMap",value:function(){return $$log("Adapter does not implement getCharacterMap"),{}}},{key:"_debugBoardGameCoordsCycle",value:function(e){var t=PP64.boards.getCurrentBoard();this._applyPerspective(t,e),this._reversePerspective(t,e),PP64.renderer.render()}}]),e}(),getROMAdapter:function(){var e=PP64.romhandler.getGameVersion();return e?PP64.adapters.getAdapter(e):null},getAdapter:function(e){switch(e){case 1:return PP64.adapters.MP1;case 2:return PP64.adapters.MP2;case 3:return PP64.adapters.MP3}return null}};
"use strict";PP64.ns("adapters"),PP64.adapters.boarddef=function(){function l(e){var t=new DataView(e);switch(PP64.romhandler.getGameVersion()){case 1:return{spaceCount:t.getUint16(0),chainCount:t.getUint16(4),spaceStartOffset:t.getUint16(6),linkStartOffset:t.getUint16(10)};case 2:case 3:return{spaceCount:t.getUint16(0),chainCount:t.getUint16(2),spaceStartOffset:t.getUint16(4),linkStartOffset:t.getUint16(6)}}}function g(){var e=void 0,t=PP64.romhandler.getGameVersion();switch(t){case 1:e=12;break;case 2:case 3:e=8;break;default:throw"_boardDefHeaderSize: unknown game version "+t}return e}function d(e){var r=(e=PP64.utils.obj.copy(e)).spaces,i=e.links,s=[];function o(e){for(var t=[],n=e,a=void 0;!r[n]._seen;){if(r[n]._seen=!0,t.push(n),a=i[n],Array.isArray(a))return s.push(t),void a.forEach(function(e){o(e)});if("number"!=typeof a)return console.warn("determineChains.parseChain hit a dead end at "+$$hex(n)+" ("+n+")"),void s.push(t);if(c(a,n))return s.push(t),void o(a);n=a}t.length&&s.push(t)}for(var n={},t=0;t<r.length;t++)r[t]&&(n[t]=[]);var a=function(t){PP64.boards.getConnections(t,e).forEach(function(e){n[e].push(Number(t))})};for(var f in i)a(f);function c(e,t){return void 0===t?!!n[e].length:!!n[e].length&&(-1===n[e].indexOf(Number(t))||1<n[e].length)}o(PP64.boards.getStartSpaceIndex(e));for(var u=0;u<r.length;u++)r[u]&&(r[u]._seen||!c(u)&&PP64.boards.hasConnection(u,"*",e)&&o(u));for(var h=0;h<r.length;h++)r[h]&&!r[h]._seen&&PP64.boards.hasConnection(h,"*",e)&&o(h);return $$log("chains: ",s),s}return{parse:function(e,t){var n=l(e);t.spaces=function(e,t){for(var n=new DataView(e,t.spaceStartOffset),a=[],r=0,i=0;i<t.spaceCount;i++)a.push({type:n.getUint8(r+3),x:n.getFloat32(r+4),y:n.getFloat32(r+12),z:n.getFloat32(r+8)}),r+=16;return a}(e,n);var a=function(e,t){for(var n=new Array(t.chainCount),a={},r=new DataView(e,t.linkStartOffset),i=0;i<t.chainCount;i++){var s=r.getUint16(2*i),o=new DataView(e,t.linkStartOffset+s),f=o.getUint16(0);if(n[i]=[],1===f)n[i].push(o.getUint16(2));else for(var c=1;c<f;c++){var u=o.getUint16(2*c),h=o.getUint16(2*(c+1));a.hasOwnProperty(u)?(Array.isArray(a[u])||(a[u]=[a[u]]),-1===a[u].indexOf(h)&&a[u].push(h)):a[u]=h,n[i].push(u),c+1===f&&n[i].push(h)}}return{links:a,chains:n}}(e,n);return t.links=a.links,t._chains=a.chains,$$log("Parsing board def, "+$$hex(n.spaceCount)+" ("+n.spaceCount+") spaces"),t},create:function(e){var t,n,a,r,i,s,o,f,c,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d(e),h=new ArrayBuffer((t=e,n=u,i=r=a=void 0,a=g(),r=16*t.spaces.length,i=2*n.length,n.forEach(function(e){i+=2*(e.length+1)}),a+r+i));return function(e,t,n){var a=new DataView(e),r=PP64.romhandler.getGameVersion(),i=g()+16*t.spaces.length;switch(r){case 1:a.setUint16(0,t.spaces.length),a.setUint16(4,n.length),a.setUint16(6,12),a.setUint16(8,i),a.setUint16(10,i);break;case 2:case 3:a.setUint16(0,t.spaces.length),a.setUint16(2,n.length),a.setUint16(4,8),a.setUint16(6,i)}}(h,e,u),s=h,o=e.spaces,f=new DataView(s),c=g(),o.forEach(function(e){f.setUint32(c,e.type),f.setFloat32(c+4,e.x),f.setFloat32(c+8,e.z),f.setFloat32(c+12,e.y),c+=16}),function(e,t){var n=new DataView(e),a=void 0,r=void 0;a=r=l(e).linkStartOffset;for(var i=2*t.length,s=0;s<t.length;s++){n.setUint16(r,i),n.setUint16(a+i,t[s].length),i+=2;for(var o=0;o<t[s].length;o++)n.setUint16(a+i,t[s][o]),i+=2;r+=2}}(h,u),h},determineChains:d,padChains:function(e,t){for(var n=e.spaces,a=e.links,r=0;r<t.length;r++){var i=t[r];if(1===i.length){var s=i[0],o=n[s],f=a[s],c=void 0,u=void 0;if(Array.isArray(f)&&1<f.length)if(2===f.length){var h=n[f[0]],l=n[f[1]],g=$$number.midpoint(h.x,h.y,l.x,l.y),d=.01/$$number.distance(o.x,o.y,g.x,g.y);c=(1-d)*o.x+d*g.x,u=(1-d)*o.y+d*g.y,$$log("Padding branch x: "+o.x+", y: "+o.y+", padX: "+c+", padY: "+u)}else c=o.x,u=o.y;else if("number"==typeof f){var p=n[f],v=$$number.midpoint(o.x,o.y,p.x,p.y);c=v.x,u=v.y}if("number"==typeof c&&"number"==typeof u){var y=PP64.boards.addSpace(c,u,$spaceType.OTHER,void 0,e);i.push(y),a[s]=y,a[y]=f}}}},trimChains:function(e,t){},getChainIndexValuesFromAbsoluteIndex:function(e,t){for(var n=0;n<e.length;n++){var a=e[n].indexOf(t);if(0<=a)return[n,a]}return[-1,-1]}}}();
"use strict";PP64.ns("adapters"),PP64.adapters.boardinfo=function(){var r=Object.create(null),t={onLoad:function(e){},onOverwrite:function(e){}};function n(e){switch(e){case $gameType.MP1_USA:case $gameType.MP1_JPN:case $gameType.MP1_PAL:return PP64.adapters.boardinfo.MP1.getBoardInfos(e);case $gameType.MP2_USA:case $gameType.MP2_JPN:case $gameType.MP2_PAL:return PP64.adapters.boardinfo.MP2.getBoardInfos(e);case $gameType.MP3_USA:case $gameType.MP3_JPN:case $gameType.MP3_PAL:return PP64.adapters.boardinfo.MP3.getBoardInfos(e)}}return{create:function(e){if(r[e])throw"Cannot create an already existing BoardInfo "+e+".";var a=Object.create(t);return r[e]=a},getBoardInfos:n,getBoardInfoByIndex:function(e,a){return n(e)[a]},getArrowRotationLimit:function(e){var a=e.arrowRotStartOffset,r=e.arrowRotEndOffset;if(!a)return 0;var t=r-a,n=Math.floor(t/4),o=Math.floor(n/3);return Math.min(8,o)}}}();
"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("adapters"),PP64.adapters.SpaceEventTable=function(){function e(){_classCallCheck(this,e),this._entries={}}return _createClass(e,[{key:"parse",value:function(e,t){for(var n=new DataView(e,t),r=0,i=void 0,a=void 0;65535!==(i=n.getUint16(r));)a=n.getUint32(r+4),this.add(i,a),r+=8}},{key:"write",value:function(e,t){var n=new DataView(e,t),r=0;for(var i in this._entries)this._writeEntry(n,r,i,this._entries[i]),r+=8;return this._writeEntry(n,r,65535,0),r+=8}},{key:"_writeEntry",value:function(e,t,n,r){if(e.setUint16(t,n),e.setUint16(t+2,0),!r&&65535!==n)throw"Tried to write null address from SpaceEventTable at space index "+n+".";e.setUint32(t+4,r)}},{key:"add",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._entries[e]=t}},{key:"forEach",value:function(e){for(var t in this._entries){e({spaceIndex:Number(t),address:this._entries[t]})}}},{key:"byteLength",value:function(){return 8*Object.keys(this._entries).length+8}}]),e}();
"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("adapters"),PP64.adapters.SpaceEventList=function(){function e(){_classCallCheck(this,e),this._entries=[]}return _createClass(e,[{key:"parse",value:function(e,t){for(var n=new DataView(e,t),i=0,a=void 0,r=void 0,s=void 0;0!==(a=n.getUint16(i));)r=n.getUint16(i+2),s=n.getUint32(i+4),this.add(a,r,s),i+=8}},{key:"write",value:function(e,t){var n=this,i=new DataView(e,t),a=0;return this.forEach(function(e){n._writeEntry(i,a,e.activationType,e.executionType,e.address),a+=8}),this._writeEntry(i,a,0,0),a+=8}},{key:"_writeEntry",value:function(e,t,n,i,a){if(e.setUint16(t,n),e.setUint16(t+2,i),!a&&(n||i))throw"Tried to write null address from SpaceEventList.";e.setUint32(t+4,a)}},{key:"add",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this._entries.push(new PP64.adapters.SpaceEventListEntry(e,t,n))}},{key:"setAddress",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this._entries[e].address=t>>>0}},{key:"forEach",value:function(e){this._entries.forEach(e)}},{key:"byteLength",value:function(){return 8*this._entries.length+8}}],[{key:"byteLength",value:function(e){return 8*e+8}}]),e}(),PP64.adapters.SpaceEventListEntry=function e(t,n,i){_classCallCheck(this,e),this.activationType=t,this.executionType=n,this.address=i};
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,s=!1,n=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){s=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw n}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("adapters"),PP64.adapters.MP1=new(function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.gameVersion=1,e.nintendoLogoFSEntry=[9,110],e.hudsonLogoFSEntry=[9,111],e.boardDefDirectory=10,e.MAINFS_READ_ADDR=83376,e.HEAP_FREE_ADDR=83760,e.TABLE_HYDRATE_ADDR=313600,e.SCENE_TABLE_ROM=796788,e}return _inherits(t,PP64.adapters.AdapterBase),_createClass(t,[{key:"hydrateSpace",value:function(e){e.type===$spaceType.STAR?e.star=!0:e.type===$spaceType.CHANCE&&PP64.boards.addEventToSpace(e,PP64.adapters.events.create("CHANCETIME"))}},{key:"onLoad",value:function(e,t){this._extractKoopa(e,t),this._extractBowser(e,t),this._extractGoomba(e,t)}},{key:"onAfterOverwrite",value:function(e,t,r){this._writeKoopa(t,r),this._writeBowser(t,r),e.setUint16(245602,32832),e.setUint16(245610,4194304-this.EVENT_MEM_SIZE>>>16),e.setUint16(245622,32),e.setUint16(390134,32);var a=835536,s=832464;e.setUint32(307156,MIPSInst.parse("J "+s)),e.setUint32(a,MIPSInst.parse("LW S5, 0x0(A0)")),e.setUint32(a+=4,MIPSInst.parse("LUI S6, 0x4856")),e.setUint32(a+=4,MIPSInst.parse("ADDIU S6, S6, 0x5120")),e.setUint32(a+=4,MIPSInst.parse("BEQ S5, S6, 12")),e.setUint32(a+=4,0),e.setUint32(a+=4,MIPSInst.parse("ADDU S5, R0, A1")),e.setUint32(a+=4,MIPSInst.parse("ADDIU S6, S5, 0x1800")),e.setUint32(a+=4,MIPSInst.parse("ADDU S7, R0, A0")),e.setUint32(a+=4,MIPSInst.parse("LW GP, 0(S7)")),e.setUint32(a+=4,MIPSInst.parse("SW GP, 0(S5)")),e.setUint32(a+=4,MIPSInst.parse("ADDIU S5, S5, 4")),e.setUint32(a+=4,MIPSInst.parse("ADDIU S7, S7, 4")),e.setUint32(a+=4,MIPSInst.parse("BEQ S5, S6, 9")),e.setUint32(a+=4,0),e.setUint32(a+=4,MIPSInst.parse("J 832496")),e.setUint32(a+=4,0),e.setUint32(a+=4,MIPSInst.parse("ADDU S5, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("ADDU S6, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("ADDU S7, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("ADDU GP, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("JAL 0x7F54C")),e.setUint32(a+=4,0),e.setUint32(a+=4,MIPSInst.parse("ADDU S5, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("ADDU S6, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("ADDU S7, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("ADDU GP, R0, R0")),e.setUint32(a+=4,MIPSInst.parse("J 0x4A3DC")),e.setUint32(a+=4,0)}},{key:"onOverwritePromises",value:function(e,t){var r=t.bgDir,a=[this._writeBackground(r,e.bg.src,e.bg.width,e.bg.height),this._writeBackground(r+1,e.otherbg.largescene,320,240),this._writeBackground(r+2,e.otherbg.conversation,320,240),this._writeBackground(r+3,e.otherbg.conversation,320,240),this._writeBackground(r+4,e.bg.src,320,240),this._writeBackground(r+5,e.bg.src,320,240),this._writeBackground(r+6,e.otherbg.splashscreen,320,240),this.onWriteBoardSelectImg(e,t),this.onWriteBoardLogoImg(e,t),this._brandBootSplashscreen()];return Promise.all(a)}},{key:"onWriteEventAsmHook",value:function(e,t,r){}},{key:"onParseStrings",value:function(e,t){var r=t.str||{};if(r.boardSelect){var a=r.boardSelect;Array.isArray(a)&&(a=a[0]);var s=PP64.fs.strings.read(a),n=s.split("\n"),o=n[0].indexOf("}")+1,i=n[0].indexOf("{",o);e.name=n[0].substring(o,i),e.description=[n[1],n[2]].join("\n");for(var c=0,u=s.indexOf(this.getCharacterMap()[42],0);-1!==u;)c++,u=s.indexOf(this.getCharacterMap()[42],u+1);e.difficulty=c}}},{key:"onWriteStrings",value:function(e,t){var r=t.str||{};if(r.boardSelect){var a=[];if(a.push(11),a.push(5),(a=a.concat(PP64.fs.strings._strToBytes(e.name||""))).push(2),a.push(10),(a=a.concat(PP64.fs.strings._strToBytes(e.description||""))).push(10),(a=a.concat([16,16,16,16,16,16])).push(6),a=a.concat(PP64.fs.strings._strToBytes("Map Difficulty  ")),5<e.difficulty||e.difficulty<1)a.push(42),(a=a.concat(PP64.fs.strings._strToBytes(" "))).push(62),a=a.concat(PP64.fs.strings._strToBytes(" "+e.difficulty.toString()));else for(var s=0;s<e.difficulty;s++)a.push(42);a.push(2),a.push(0);var n=PP64.utils.arrays.arrayToArrayBuffer(a),o=r.boardSelect;if(Array.isArray(o))for(var i=0;i<o.length;i++)PP64.fs.strings.write(o[i],n);else PP64.fs.strings.write(o,n)}if(r.koopaIntro){var c=[];(c=c.concat(PP64.fs.strings._strToBytes("Welcome, everybody!\nI am your guide,\nKoopa Troopa."))).push(255),c.push(11),(c=c.concat(PP64.fs.strings._strToBytes("Now then,\nlet's decide turn order."))).push(255),c.push(0);var u=PP64.utils.arrays.arrayToArrayBuffer(c);PP64.fs.strings.write(r.koopaIntro,u)}if(r.starComments){var l=[];(l=l.concat(PP64.fs.strings._strToBytes("Good luck!\nWith enough stars, you\ncould be the superstar!"))).push(255),l.push(0);for(var f=PP64.utils.arrays.arrayToArrayBuffer(l),p=0;p<r.starComments.length;p++)PP64.fs.strings.write(r.starComments[p],f)}}},{key:"onGetBoardCoordsFromGameCoords",value:function(e,t,r,a,s,n){var o=void 0,i=void 0,c=void 0;switch(n){case 0:o=a/2+e*(1+.13*t/(s/2))+e/(a/2)*30,i=s/2+.9*(t+0),i+=i<s/2?Math.abs(t)/10:Math.abs(t)/40,c=0;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:o=a/2+e,i=s/2+t,c=0;break;default:throw"onGetBoardCoordsFromGameCoords called with bad boardIndex"}return[Math.round(o),Math.round(i),Math.round(c)]}},{key:"onGetGameCoordsFromBoardCoords",value:function(e,t,r,a,s,n){var o=void 0,i=void 0,c=void 0;switch(n){case 0:i=(t-s/2-0)/.9,o=(e-a/2)/(1+.26*(i-=t<s/2?Math.abs(i)/10:Math.abs(i)/40)/s+60/a),c=0;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o=e-a/2,i=t-s/2,c=.048;break;default:throw"_gameCoordsFromBoardCoords called with bad boardIndex"}return[o,i,c]}},{key:"onChangeBoardSpaceTypesFromGameSpaceTypes",value:function(e,t){}},{key:"onChangeGameSpaceTypesFromBoardSpaceTypes",value:function(e){}},{key:"_extractKoopa",value:function(e,t){if(t.koopaSpaceInst){var r=PP64.romhandler.getDataView().getUint16(t.koopaSpaceInst+2);e.spaces[r]&&(e.spaces[r].subtype=$spaceSubType.KOOPA)}}},{key:"_writeKoopa",value:function(e,t){if(t.koopaSpaceInst){for(var r=void 0,a=0;a<e.spaces.length;a++)if(e.spaces[a].subtype===$spaceSubType.KOOPA){r=a;break}r=void 0===r?e._deadSpace:r,PP64.romhandler.getDataView().setUint16(t.koopaSpaceInst+2,r)}}},{key:"_extractBowser",value:function(e,t){if(t.bowserSpaceInst){var r=PP64.romhandler.getDataView().getUint16(t.bowserSpaceInst+2);e.spaces[r]&&(e.spaces[r].subtype=$spaceSubType.BOWSER)}}},{key:"_writeBowser",value:function(e,t){if(t.bowserSpaceInst){for(var r=void 0,a=0;a<e.spaces.length;a++)if(e.spaces[a].subtype===$spaceSubType.BOWSER){r=a;break}r=void 0===r?e._deadSpace:r,PP64.romhandler.getDataView().setUint16(t.bowserSpaceInst+2,r)}}},{key:"_extractGoomba",value:function(e,t){if(t.goombaSpaceInst){var r=PP64.romhandler.getDataView().getUint16(t.goombaSpaceInst+2);e.spaces[r]&&(e.spaces[r].subtype=$spaceSubType.GOOMBA)}}},{key:"onParseBoardSelectImg",value:function(e,t){if(t.img.boardSelectImg){var r=PP64.fs.mainfs.get(9,t.img.boardSelectImg),a=PP64.utils.FORM.unpack(r),s=[new DataView(a.BMP1[0].parsed.src),new DataView(a.BMP1[1].parsed.src),new DataView(a.BMP1[2].parsed.src),new DataView(a.BMP1[3].parsed.src)],n=PP64.utils.img.tiler.fromTiles(s,2,2,256,32);e.otherbg.boardselect=PP64.utils.arrays.arrayBufferToDataURL(n,128,64)}}},{key:"onWriteBoardSelectImg",value:function(t,r){return new Promise(function(i,e){var c=r.img.boardSelectImg;if(c){var u=PP64.utils.canvas.createContext(128,64),l=new Image,f=setTimeout(function(){return e("Failed to write boardselect for "+r.name)},45e3);l.onload=function(){u.drawImage(l,0,0,128,64);for(var e=u.getImageData(0,0,128,64),t=PP64.utils.img.tiler.toTiles(e.data,2,2,256,32).map(function(e){return PP64.utils.img.BMP.fromRGBA(e,32,8)}),r=PP64.fs.mainfs.get(9,c),a=PP64.utils.FORM.unpack(r),s=0;s<4;s++){for(var n=t[s][1];n.colors.length<17;)n.colors.push(0);PP64.utils.FORM.replaceBMP(a,s,t[s][0],n)}var o=PP64.utils.FORM.pack(a);PP64.fs.mainfs.write(9,c,o),clearTimeout(f),i()},l.src=t.otherbg.boardselect}else i()})}},{key:"onParseBoardLogoImg",value:function(e,t){t.img.pauseLogoImg&&(e.otherbg.boardlogo=this._readImgFromMainFS(10,t.img.pauseLogoImg,0))}},{key:"onWriteBoardLogoImg",value:function(r,a){return new Promise(function(l,e){var f=a.img.introLogoImg,p=a.img.pauseLogoImg;if(f||p){var t=_slicedToArray(a.img.introLogoImgDimens,2),P=t[0],d=t[1],g=new Image,h=setTimeout(function(){return e("Failed to write logos for "+a.name)},45e3);g.onload=function(){if(f){var e=PP64.utils.img.toArrayBuffer(g,P,d);Array.isArray(f)||(f=[f]);for(var t=0;t<f.length;t++){var r=f[t],a=PP64.fs.mainfs.get(10,r),s=[{src:e,width:P,height:d,bpp:32}],n=PP64.utils.img.ImgPack.toPack(s,16,0,a);PP64.fs.mainfs.write(10,r,n)}}if(p){var o=PP64.utils.img.toArrayBuffer(g,200,82),i=PP64.fs.mainfs.get(10,p),c=[{src:o,width:200,height:82,bpp:32}],u=PP64.utils.img.ImgPack.toPack(c,16,0,i);PP64.fs.mainfs.write(10,p,u)}clearTimeout(h),l()},g.src=r.otherbg.boardlogo}else l()})}},{key:"_clearOtherBoardNames",value:function(e){var t=PP64.fs.mainfs.get(10,406+e);new Uint8Array(t).fill(0,44),PP64.fs.mainfs.write(10,406+e,t)}},{key:"getAudioMap",value:function(){return["","Mario Party Theme","Peaceful Mushroom Village","","","Option House Theme","Opening","Mini-Game House Theme","DK's Jungle Adventure Theme","Peach's Birthday Cake Theme","Yoshi's Tropical Island Theme","Wario's Battle Canyon Theme","Luigi's Engine Room Theme","Mario's Rainbow Castle Theme","Magma Mountain Theme","Eternal Star Theme","Outcome of Adventure","Start of Adventure","Bowser Meeting","Last 5 Turns","","Play A Mini-Game","Results","","Move to the Mambo","Wide, Wide Ocean","Mushroom Forest","Ducking and Dodging","Full of Danger","Coins of the World","Taking Coins","The Room Underground","Slowly, Slowly","Dodging Danger","Let's Limbo!","Let's Go Lightly","Chance Time","Can It Be Done","Faster Than All","Saving Courage","","","Playing the Game","Where Have The Stars Gone?","","","","The Stolen Star","Bowser's Chance Game","Waterfall?","","","","","","","","","","","","","","","After the Victory","Mini-Game Island","Mini-Game Island","Mini-Game Island","Mini-Game Island","Mini-Game Island","Mini-Game Island (Bowser)","Mini-Game Island","Mini-Game Island (Aquatic)","","","","","","","",""]}},{key:"getCharacterMap",value:function(){return{0:"",1:"<BLACK>",2:"<DEFAULT>",3:"<RED>",4:"<PURPLE>",5:"<GREEN>",6:"<BLUE>",7:"<YELLOW>",8:"<WHITE>",9:"<SEIZURE>",10:"\n",11:"„Äî",12:"‚óã",13:"\t",14:"\t",16:" ",17:"{0}",18:"{1}",19:"{2}",20:"{3}",21:"{4}",22:"{5}",33:"„ÄÄ",34:"„ÄÅ",35:"„ÄÇ",36:"„ÄÉ",37:"„ÄÑ",38:"„ÄÖ",39:"„ÄÜ",40:"„Äá",41:"„Äà",42:"„Äâ",43:"„Äê",44:"„Äë",58:"„Äí",59:"„Äì",60:"+",61:"-",62:"x",63:"->",91:'"',92:"'",93:"(",94:")",95:"/",123:":",128:'"',129:"¬∞",130:",",131:"¬∞",133:".",192:"‚Äú",193:"‚Äù",194:"!",195:"?",255:"„Äï"}}}]),t}());
"use strict";PP64.ns("adapters.boardinfo"),PP64.adapters.boardinfo.MP1=function(){var t=PP64.adapters.boardinfo.create("MP1_USA_DK");t.name="DK's Jungle Adventure",t.boardDefFile=69,t.bgDir=0,t.str={boardSelect:652,koopaIntro:571,starComments:[286,287,288,289,290,291,292]},t.img={boardSelectImg:17,pauseLogoImg:276,introLogoImg:[356,357],introLogoImgDimens:[272,112],titleScreenImg:385},t.sceneIndex=54,t.mainfsEventFile=[10,422],t.eventASMStart=2370780,t.eventASMEnd=2378492,t.spaceEventsStartAddr=1024204,t.spaceEventsStartOffset=2380684,t.spaceEventsEndOffset=2381056,t.spaceEventTables=[{upper:2368624,lower:2368632},{upper:2368652,lower:2368660},{upper:2368680,lower:2368688},{upper:2368708,lower:2368716}],t.koopaSpaceInst=2369012,t.bowserSpaceInst=2368856,t.boosLoopFnOffset=2370168,t.boosReadbackFnOffset=2369904,t.starSpaceArrOffset=2378688,t.starSpaceCount=7,t.toadSpaceArrOffset=[2378704,2378728],t.audioIndexOffset=2368606,t.onLoad=function(e){e.otherbg.largescene=PP64.fs.hvqfs.readBackground(t.bgDir+1).src,e.otherbg.conversation=PP64.fs.hvqfs.readBackground(t.bgDir+2).src,e.otherbg.splashscreen=PP64.fs.hvqfs.readBackground(t.bgDir+6).src},t.onWriteEvents=function(e){for(var t=e.spaces,a=0;a<t.length;a++){var r=e.spaces[a];if(r&&r.star)(r.events||[]).some(function(e){e.id})||PP64.boards.addEventToSpace(r,PP64.adapters.events.create("STARCHANCE"))}},t.onAfterOverwrite=function(e){e.setUint32(2368484,0),e.setUint32(2368492,0),e.setUint32(2790808,3313106944),e.setUint32(2790812,0),e.setUint32(2790816,0);var t=[];(t=t.concat(PP64.fs.strings._strToBytes("You're looking for Stars?\nHow about this instead..."))).push(255),t.push(0);var a=PP64.utils.arrays.arrayToArrayBuffer(t);PP64.fs.strings.write(396,a),PP64.fs.strings.write(399,a),PP64.fs.strings.write(402,a)},t.clearSpaceEventTableCalls=function(e){for(var t=2368624;t<2368720;t+=4)e.setUint32(t,0)};var a=PP64.adapters.boardinfo.create("MP1_JPN_DK");a.name="DK's Jungle Adventure",a.boardDefFile=69,a.bgDir=0,a.str={boardSelect:652,koopaIntro:571,starComments:[286,287,288,289,290,291,292]},a.img={boardSelectImg:17,pauseLogoImg:276,introLogoImg:[356,357],titleScreenImg:385},a.eventASMStart=0,a.eventASMEnd=0,a.spaceEventsStartAddr=1021212,a.spaceEventsStartOffset=2377916,a.spaceEventsEndOffset=2378272;var r=PP64.adapters.boardinfo.create("MP1_USA_PEACH");r.name="Peach's Birthday Cake",r.boardDefFile=70,r.bgDir=7,r.str={boardSelect:653,koopaIntro:572},r.img={boardSelectImg:20,pauseLogoImg:277,introLogoImg:[359],titleScreenImg:382},r.sceneIndex=55,r.eventASMStart=0,r.spaceEventsStartAddr=1014896,r.spaceEventsStartOffset=2387024,r.spaceEventsEndOffset=2387216,r.koopaSpaceInst=2383232,r.bowserSpaceInst=2383688,r.goombaSpaceInst=2383552;var s=PP64.adapters.boardinfo.create("MP1_USA_YOSHI");s.name="Yoshi's Tropical Island",s.boardDefFile=71,s.bgDir=18,s.str={boardSelect:654,koopaIntro:573},s.img={boardSelectImg:18,pauseLogoImg:278,introLogoImg:[362],titleScreenImg:383},s.sceneIndex=56,s.eventASMStart=0,s.spaceEventsStartAddr=1017372,s.spaceEventsStartOffset=2395692,s.spaceEventsEndOffset=2395876;var n=PP64.adapters.boardinfo.create("MP1_USA_WARIO");n.name="Wario's Battle Canyon",n.boardDefFile=72,n.bgDir=27,n.str={boardSelect:655,koopaIntro:574},n.img={boardSelectImg:19,pauseLogoImg:279,introLogoImg:[365],titleScreenImg:384},n.sceneIndex=57,n.eventASMStart=0,n.spaceEventsStartAddr=1022404,n.spaceEventsStartOffset=2409188,n.spaceEventsEndOffset=2409356,n.koopaSpaceInst=2399696,n.bowserSpaceInst=2399400,n.boosLoopFnOffset=2400412,n.boosReadbackFnOffset=2400148,n.starSpaceArrOffset=2408768,n.starSpaceCount=7,n.toadSpaceArrOffset=[2408784,2408816];var o=PP64.adapters.boardinfo.create("MP1_USA_LUIGI");o.name="Luigi's Engine Room",o.boardDefFile=73,o.bgDir=39,o.str={boardSelect:656,koopaIntro:575},o.img={boardSelectImg:21,pauseLogoImg:280,introLogoImg:[368],titleScreenImg:381},o.sceneIndex=58,o.eventASMStart=0,o.spaceEventsStartAddr=1022864,o.spaceEventsStartOffset=2423104,o.spaceEventsEndOffset=2423408,o.starSpaceArrOffset=2421488,o.starSpaceCount=7,o.toadSpaceArrOffset=[2421504,2421636];var c=PP64.adapters.boardinfo.create("MP1_USA_MARIO");c.name="Mario's Rainbow Castle",c.boardDefFile=74,c.bgDir=47,c.str={boardSelect:657,koopaIntro:576},c.img={boardSelectImg:22,pauseLogoImg:281,introLogoImg:[371],titleScreenImg:380},c.sceneIndex=59,c.eventASMStart=0,c.spaceEventsStartAddr=1016720,c.spaceEventsStartOffset=2431024,c.spaceEventsEndOffset=2431184;var d=PP64.adapters.boardinfo.create("MP1_USA_BOWSER");d.name="Bowser's Magma Mountain",d.boardDefFile=75,d.bgDir=56,d.str={boardSelect:658,koopaIntro:577},d.img={boardSelectImg:23,pauseLogoImg:282,introLogoImg:[374]},d.sceneIndex=60,d.eventASMStart=0,d.spaceEventsStartAddr=1020032,d.spaceEventsStartOffset=2442096,d.spaceEventsEndOffset=2442320,d.starSpaceArrOffset=2440040,d.starSpaceCount=7,d.toadSpaceArrOffset=[2440056,2440088];var f=PP64.adapters.boardinfo.create("MP1_USA_ETERNALSTAR");f.name="Eternal Star",f.boardDefFile=76,f.bgDir=68,f.str={boardSelect:[659,660],koopaIntro:578},f.img={boardSelectImg:24,pauseLogoImg:283,introLogoImg:[378]},f.sceneIndex=61,f.eventASMStart=0,f.spaceEventsStartAddr=1019996,f.spaceEventsStartOffset=2453196,f.spaceEventsEndOffset=2453488,f.bowserSpaceInst=2445868,f.starSpaceArrOffset=2452032,f.starSpaceCount=7,f.toadSpaceArrOffset=2452048;var i=PP64.adapters.boardinfo.create("MP1_USA_TRAINING");i.name="Training",i.boardDefFile=77,i.bgDir=77,i.str={},i.img={},i.sceneIndex=62,i.eventASMStart=0,i.spaceEventsStartAddr=1017768,i.spaceEventsStartOffset=2462136,i.spaceEventsEndOffset=2462184,i.bowserSpaceInst=2454300,i.toadSpaceInst=2453852,i.koopaSpaceInst=2453988,i.booSpaceInst=2454164;var S=PP64.adapters.boardinfo.create("MP1_USA_STADIUM");S.name="Mini-Game Stadium",S.boardDefFile=83,S.bgDir=99,S.str={},S.img={};var p=PP64.adapters.boardinfo.create("MP1_USA_ISLAND");return p.name="Mini-Game Island",p.boardDefFile=78,p.bgDir=79,p.str={},p.img={},p.sceneIndex=114,p.eventASMStart=0,p.spaceEventsStartAddr=1016904,p.spaceEventsStartOffset=3116776,p.spaceEventsEndOffset=3117120,{getBoardInfos:function(e){switch(e){case $gameType.MP1_USA:return[t,r,s,n,o,c,d,f,i,p,S];case $gameType.MP1_JPN:return[a]}}}}();
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,n=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(a=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("adapters"),PP64.adapters.MP2=new(function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.gameVersion=2,e.nintendoLogoFSEntry=[9,1],e.hudsonLogoFSEntry=[9,2],e.boardDefDirectory=10,e.MAINFS_READ_ADDR=95872,e.HEAP_FREE_ADDR=96256,e.TABLE_HYDRATE_ADDR=349836,e.SCENE_TABLE_ROM=824436,e}return _inherits(t,PP64.adapters.AdapterBase),_createClass(t,[{key:"onLoad",value:function(e,t){this._extractBanks(e,t),this._extractItemShops(e,t),this._parseBoardSelectIcon(e,t),this._readAnimationBackgrounds(e,t)}},{key:"onAfterOverwrite",value:function(e,t,r){this._writeBanks(t,r),this._writeItemShops(t,r),this._writeGates(t,r),e.setUint16(267778,32832),e.setUint16(267786,4194304-this.EVENT_MEM_SIZE>>>16),e.setUint16(267798,26),e.setUint16(493214,26),isNaN(r.animBgSet)||PP64.fs.animationfs.setSetEntryCount(r.animBgSet,0)}},{key:"onOverwritePromises",value:function(e,t){var r=t.bgDir,a=[this._writeBackground(r,e.bg.src,e.bg.width,e.bg.height),this._writeAnimationBackgrounds(t.animBgSet,e.bg.src,e.animbg,e.bg.width,e.bg.height),this._writeBackground(r+2,e.otherbg.largescene,320,240),this._writeOverviewBackground(r+6,e.bg.src),this.onWriteBoardSelectImg(e,t),this._writeBoardSelectIcon(e,t),this.onWriteBoardLogoImg(e,t),this._brandBootSplashscreen()];return Promise.all(a)}},{key:"hydrateSpace",value:function(e){e.type===$spaceType.BANK&&PP64.boards.addEventToSpace(e,PP64.adapters.events.create("BANK"))}},{key:"onParseStrings",value:function(e,t){var r=t.str||{};if(r.boardSelect){var a=r.boardSelect,n=PP64.fs.strings.read(a),o=n.split("\n"),s=o[0].indexOf(">")+1,i=o[0].indexOf("",s);e.name=o[0].substring(s,i),e.description=[o[1],o[2]].join("\n");for(var c=0,u=n.indexOf(this.getCharacterMap()[59],0);-1!==u;)c++,u=n.indexOf(this.getCharacterMap()[59],u+1);e.difficulty=c}}},{key:"onWriteStrings",value:function(e,t){var r=t.str||{};if(r.boardSelect){var a=[];if(a.push(11),a.push(6),(a=a.concat(PP64.fs.strings._strToBytes(e.name||""))).push(25),a.push(4),(a=(a=a.concat([14,14])).concat(PP64.fs.strings._strToBytes("Difficulty"))).push(25),a=a.concat(PP64.fs.strings._strToBytes(" : ")),5<e.difficulty||e.difficulty<1)a.push(59),(a=a.concat(PP64.fs.strings._strToBytes(" "))).push(62),a=a.concat(PP64.fs.strings._strToBytes(" "+e.difficulty.toString()));else for(var n=0;n<e.difficulty;n++)a.push(59);a.push(10),(a=a.concat(PP64.fs.strings._strToBytes(e.description||""))).push(0);var o=PP64.utils.arrays.arrayToArrayBuffer(a),s=r.boardSelect;PP64.fs.strings.write(s,o)}if(r.boardNames&&r.boardNames.length){var i=[];i.push(11),i.push(6),(i=i.concat(PP64.fs.strings._strToBytes(e.name||""))).push(25),i.push(0);for(var c=PP64.utils.arrays.arrayToArrayBuffer(i),u=0;u<r.boardNames.length;u++){var f=r.boardNames[u];PP64.fs.strings.write(f,c)}}if(r.boardGreeting&&r.boardGreeting.length){var g=[];g.push(11),(g=g.concat(PP64.fs.strings._strToBytes("We're here, everyone!"))).push(10),(g=g.concat(PP64.fs.strings._strToBytes("This is "))).push(6),g.push(15),(g=g.concat(PP64.fs.strings._strToBytes((e.name||"")+"!!!"))).push(22),g.push(25),g.push(255),g.push(0);var d=PP64.utils.arrays.arrayToArrayBuffer(g);PP64.fs.strings.write(r.boardGreeting[0],d),(g=[]).push(11),(g=g.concat(PP64.fs.strings._strToBytes("Now, before this adventure begins,"))).push(10),(g=g.concat(PP64.fs.strings._strToBytes("we must decide turn order."))).push(255),g.push(0),d=PP64.utils.arrays.arrayToArrayBuffer(g),PP64.fs.strings.write(r.boardGreeting[1],d)}if(r.boardWinner){var l=[];l.push(11),(l=l.concat(PP64.fs.strings._strToBytes("Well done, "))).push(17),(l=l.concat(PP64.fs.strings._strToBytes("!"))).push(10),(l=l.concat(PP64.fs.strings._strToBytes("You are the "))).push(7),l.push(15),(l=l.concat(PP64.fs.strings._strToBytes("Super Star"))).push(22),l.push(25),l.push(10),(l=l.concat(PP64.fs.strings._strToBytes("of "))).push(6),l.push(15),(l=l.concat(PP64.fs.strings._strToBytes((e.name||"")+"!!!"))).push(22),l.push(25),l.push(0);var h=PP64.utils.arrays.arrayToArrayBuffer(l);PP64.fs.strings.write(r.boardWinner,h)}if(r.boardPlayCount){var P=[];P.push(11),(P=(P=P.concat(PP64.fs.strings._strToBytes(e.name||""))).concat([14,14,14,14,14,14])).push(17),(P=P.concat(PP64.fs.strings._strToBytes(" Time(s)"))).push(0);var m=PP64.utils.arrays.arrayToArrayBuffer(P);PP64.fs.strings.write(r.boardPlayCount,m)}}},{key:"onChangeBoardSpaceTypesFromGameSpaceTypes",value:function(e,t){var r=PP64.types.Space,a={0:r.OTHER,3:r.OTHER,5:r.CHANCE,6:r.ITEM,7:r.BANK,8:r.OTHER,9:r.BATTLE,12:r.BOWSER,14:r.STAR,15:r.BLACKSTAR,16:r.OTHER,17:r.OTHER};if(e.spaces.forEach(function(e){var t=e.type,r=a[t];void 0!==r&&(e.type=r)}),t.length){var n=t[0][0];isNaN(n)||(e.spaces[n].type=r.START)}}},{key:"onChangeGameSpaceTypesFromBoardSpaceTypes",value:function(e){var t=PP64.types.Space,r={};r[t.OTHER]=0,r[t.BLUE]=1,r[t.RED]=2,r[t.MINIGAME]=0,r[t.HAPPENING]=4,r[t.STAR]=14,r[t.CHANCE]=5,r[t.START]=0,r[t.SHROOM]=0,r[t.BOWSER]=12,r[t.ITEM]=6,r[t.BATTLE]=9,r[t.BANK]=7,r[t.ARROW]=13,r[t.BLACKSTAR]=15,r[t.GAMEGUY]=0,e.spaces.forEach(function(e){var t=r[e.type];void 0!==t&&(e.type=t)})}},{key:"onGetBoardCoordsFromGameCoords",value:function(e,t,r,a,n,o){var s=void 0,i=void 0,c=void 0;switch(o){case 0:case 1:case 2:case 3:case 4:case 5:case 6:s=a/2+e*(1+.01*t/(n/2))-e/(a/2)*150,(i=n/2+.6*(t-5))<n/2?i+=Math.abs(t)/10:i-=Math.abs(t)/20,c=0;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:s=a/2+e,i=n/2+t,c=0;break;default:throw"onGetBoardCoordsFromGameCoords called with bad boardIndex"}return[Math.round(s),Math.round(i),Math.round(c)]}},{key:"onGetGameCoordsFromBoardCoords",value:function(e,t,r,a,n,o){var s=void 0,i=void 0,c=void 0;switch(o){case 0:i=-5/6*(n-2*(t+3)),t<n/2?i-=Math.abs(i)/10:i+=Math.abs(i)/20,s=25*n*a*(2*e-a)/(50*n*(a-300)+a*i),c=0;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:s=e-a/2,i=t-n/2,c=0;break;default:throw"onGetGameCoordsFromBoardCoords called with bad boardIndex"}return[s,i,c]}},{key:"_readAnimationBackgrounds",value:function(e,t){if(!isNaN(t.animBgSet)&&t.bgDir){var r=PP64.fs.hvqfs.readBackgroundImgData(t.bgDir),a=PP64.fs.animationfs.readAnimationBackgrounds(t.animBgSet,r,e.bg.width,e.bg.height);a&&a.length&&(e.animbg=a)}}},{key:"_writeAnimationBackgrounds",value:function(c,u,f,g,d){return new Promise(function(r,t){if(!isNaN(c)&&f&&f.length){for(var a=setTimeout(function(){return t("Failed to write animations")},45e3),n=void 0,o=new Array(f.length),s=[new Promise(function(e,t){var r=PP64.utils.canvas.createContext(g,d),a=new Image;a.onload=function(){r.drawImage(a,0,0,g,d),n=r.getImageData(0,0,g,d),e()},a.src=u})],e=function(n){var e=new Promise(function(e,t){var r=PP64.utils.canvas.createContext(g,d),a=new Image;a.onload=function(){r.drawImage(a,0,0,g,d),o[this.index]=r.getImageData(0,0,g,d),e()}.bind({index:n}),a.src=f[this.index]}.bind({index:n}));s.push(e)},i=0;i<f.length;i++)e(i);Promise.all(s).then(function(e){for(var t=0;t<o.length;t++)PP64.fs.animationfs.writeAnimationBackground(c,t,n,o[t],g,d);$$log("Wrote animations"),clearTimeout(a),r()},function(e){$$log("Error writing animations: "+e),t()})}else r()})}},{key:"onParseBoardSelectImg",value:function(e,t){t.img.boardSelectImg&&(e.otherbg.boardselect=this._readImgFromMainFS(9,t.img.boardSelectImg,0))}},{key:"onWriteBoardSelectImg",value:function(t,r){return new Promise(function(n,e){var o=r.img.boardSelectImg;if(o){var s=new Image,i=setTimeout(function(){return e("Failed to write board select for "+r.name)},45e3);s.onload=function(){var e=PP64.utils.img.toArrayBuffer(s,64,48),t=PP64.fs.mainfs.get(9,o),r=[{src:e,width:64,height:48,bpp:32}],a=PP64.utils.img.ImgPack.toPack(r,16,0,t);PP64.fs.mainfs.write(9,o,a),clearTimeout(i),n()},s.src=t.otherbg.boardselect}else n()})}},{key:"_parseBoardSelectIcon",value:function(e,t){if(t.img.boardSelectIconCoords){var r=this._readImgInfoFromMainFS(9,15,0),a=_slicedToArray(t.img.boardSelectIconCoords,2),n=a[0],o=a[1],s=PP64.utils.img.cutFromWhole(r.src,r.width,r.height,32,n,o,32,32),i=PP64.utils.arrays.arrayBufferToDataURL(s,32,32);e.otherbg.boardselecticon=i}}},{key:"_writeBoardSelectIcon",value:function(a,v){var b=this;return new Promise(function(P,t){if(v.img.boardSelectIconCoords){var r=a.otherbg.boardselecticon;if(r){var m=setTimeout(function(){return t("Failed to write board select icon for "+v.name)},45e3),p=void 0,y=void 0,e=[new Promise(function(e,t){(p=new Image).onload=function(){e()},p.src="img/details/mp2boardselectblank1.png"}),new Promise(function(e,t){(y=new Image).onload=function(){e()},y.src=r})];Promise.all(e).then(function(e){var t=b._readImgInfoFromMainFS(9,15,0),r=PP64.utils.canvas.createContext(t.width,t.height),a=PP64.utils.arrays.arrayBufferToImageData(t.src,t.width,t.height);r.putImageData(a,0,0);var n=_slicedToArray(v.img.boardSelectIconCoords,2),o=n[0],s=n[1];r.drawImage(p,o,s,32,32),r.drawImage(y,o,s,32,32);var i=r.getImageData(0,0,t.width,t.height).data.buffer,c=PP64.fs.mainfs.get(9,15),u=[{src:i,width:t.width,height:t.height,bpp:32}],f=PP64.utils.img.ImgPack.toPack(u,16,0,c);if(PP64.fs.mainfs.write(9,15,f),v.img.boardSelectIconMask){var g=b._createBoardSelectIconHoverMask(y),d=PP64.fs.mainfs.get(9,v.img.boardSelectIconMask),l=[{src:g,width:32,height:32,bpp:32}],h=PP64.utils.img.ImgPack.toPack(l,16,0,d);PP64.fs.mainfs.write(9,v.img.boardSelectIconMask,h)}$$log("Wrote board select icon"),clearTimeout(m),P()},function(e){$$log("Error writing board select icon: "+e),t()})}else P()}else P()})}},{key:"_createBoardSelectIconHoverMask",value:function(e){for(var t=PP64.utils.img.toArrayBuffer(e,32,32),r=new ArrayBuffer(t.byteLength),a=new DataView(t),n=new DataView(r),o=!1,s=0;s<r.byteLength;s+=4)0===a.getUint32(s)?(n.setUint32(s,0),o=!0):n.setUint32(s,3149642751);return o?r:new ArrayBuffer(t.byteLength)}},{key:"onParseBoardLogoImg",value:function(e,t){t.img.introLogoImg&&(e.otherbg.boardlogo=this._readImgFromMainFS(10,t.img.introLogoImg,0))}},{key:"onWriteBoardLogoImg",value:function(u,f){return new Promise(function(n,e){var o=f.img.introLogoImg;if(o){var s=new Image,i=setTimeout(function(){return e("Failed to write logos for "+f.name)},45e3);s.onload=function(){var e=PP64.utils.img.toArrayBuffer(s,260,120),t=PP64.fs.mainfs.get(10,o),r=[{src:e,width:260,height:120,bpp:32}],a=PP64.utils.img.ImgPack.toPack(r,16,0,t);PP64.fs.mainfs.write(10,o,a),clearTimeout(i),n()},s.src=u.otherbg.boardlogo;var t=f.img.pauseLogoImg;if(t){var r=PP64.fs.mainfs.get(10,t),a=[{src:new ArrayBuffer(31200),width:130,height:60,bpp:32}],c=PP64.utils.img.ImgPack.toPack(a,16,0,r);PP64.fs.mainfs.write(10,t,c)}}else n()})}},{key:"_writeOverviewBackground",value:function(o,s){return new Promise(function(t,e){var r=PP64.utils.canvas.createContext(320,240),a=new Image,n=setTimeout(function(){return e("Failed to write bg "+o)},45e3);a.onload=function(){r.drawImage(a,0,-10,320,240);var e=r.getImageData(0,0,320,240);PP64.fs.hvqfs.writeBackground(o,e,320,240),clearTimeout(n),t()},a.src=s})}},{key:"getAudioMap",value:function(){return["","Story One","Go Lucky","Welcome to Mario Land","Laboratory","Rules Land","Credits","In the Pipe","Western Land","Pirate Land","Space Land","Horror Land","Mystery Land","Bowser Land","Adventure Begins","The Adventure Ends","Ending","Star Spot","Bowser's Theme","A Ways to Go","How Many","Take the Coin","Let the Game Begin","","","","","Going for the Coins","Not Gonna Lose","Keepin' on the Path","Couldn't be Better","Know What I Mean?","That's All of It","Let's Have Some Fun","The Blue Skies Yonder","Chance Time","Going Somewhere","Duel!","No Fright, No Fear","Don't Look Back","Got an Item","This Way That","Walking Underwater","Spinning Polka","Spinning Polka 2","Spinning Polka 3","","","","","Mini-Game Land","","","Battle Start","","","","","The Way to Play","The Star Appears","Bowser Appears","I Can Do It!"]}},{key:"getCharacterMap",value:function(){return{0:"",1:"<BLACK>",2:"<DEFAULT>",3:"<RED>",4:"<PURPLE>",5:"<GREEN>",6:"<BLUE>",7:"<YELLOW>",8:"<WHITE>",9:"<SEIZURE>",10:"\n",11:"„Äî",12:"‚óã",13:"\t",14:"\t",16:" ",17:"{0}",18:"{1}",19:"{2}",20:"{3}",21:"{4}",22:"{5}",33:"„ÄÄ",34:"„ÄÅ",35:"„ÄÇ",36:"„ÄÉ",37:"„ÄÑ",38:"„ÄÖ",39:"„ÄÜ",40:"„Äá",41:"„Äà",42:"„Äâ",43:"„Äê",44:"„Äë",58:"„Äí",59:"„Äì",60:"+",61:"-",62:"x",63:"->",91:'"',92:"'",93:"(",94:")",95:"/",123:":",128:'"',129:"¬∞",130:",",131:"¬∞",133:".",192:"‚Äú",193:"‚Äù",194:"!",195:"?",255:"„Äï"}}}]),t}());
"use strict";PP64.ns("adapters.boardinfo"),PP64.adapters.boardinfo.MP2=function(){var r=PP64.adapters.boardinfo.create("MP2_WESTERN");r.name="Western Land",r.boardDefFile=64,r.bgDir=2,r.animBgSet=0,r.str={boardSelect:197,boardNames:[190,210],boardGreeting:[1248,1249],boardWinner:707,boardPlayCount:1327},r.img={introLogoImg:406,pauseLogoImg:380,boardSelectImg:30,boardSelectIconCoords:[39,20],boardSelectIconMask:20},r.mainfsEventFile=[10,682],r.sceneIndex=62,r.eventASMStart=2772512,r.eventASMEnd=2778548,r.spaceEventsStartAddr=1124364,r.spaceEventsStartOffset=2783964,r.spaceEventsEndOffset=2784224,r.spaceEventTables=[{upper:2731708,lower:2731716},{upper:2731720,lower:2731728,primary:!0},{upper:2731732,lower:2731740}],r.starSpaceArrOffset=[2780244,2780356],r.starSpaceCount=7,r.toadSpaceArrOffset=[2780260,2780436],r.bankArrOffset=[2780760],r.bankCoinArrOffset=[2780476],r.bankCount=2,r.itemShopArrOffset=[2780764],r.itemShopCount=1,r.booArrOffset=[2780472],r.booCount=2,r.audioIndexOffset=2731642,r.onLoad=function(e){e.otherbg.largescene=PP64.fs.hvqfs.readBackground(r.bgDir+2).src},r.onWriteEvents=function(e){},r.onAfterOverwrite=function(e,r){e.setUint32(2731576,0),e.setUint32(2731600,0),e.setUint16(3521518,81);var t=[];t.push(11),(t=t.concat(PP64.fs.strings._strToBytes("Don't listen to Toad!"))).push(10),(t=t.concat(PP64.fs.strings._strToBytes("I've got the results. Follow me!"))).push(0),PP64.fs.strings.write(697,PP64.utils.arrays.arrayToArrayBuffer(t));for(var a=2;a<=7;a++)PP64.fs.mainfs.write(a,212,PP64.fs.mainfs.get(a,211)),PP64.fs.mainfs.write(a,213,PP64.fs.mainfs.get(a,209));for(var o=0;o<6;o++)PP64.fs.mainfs.write(10,612+o,PP64.fs.mainfs.get(10,642+o)),PP64.fs.mainfs.write(10,648+o,PP64.fs.mainfs.get(10,666+o));var s=PP64.fs.mainfs.get(10,410),n=[{src:new ArrayBuffer(73728),width:144,height:128,bpp:32}],i=PP64.utils.img.ImgPack.toPack(n,16,0,s);PP64.fs.mainfs.write(10,410,i),s=PP64.fs.mainfs.get(10,411),n=[{src:new ArrayBuffer(2048),width:32,height:16,bpp:32}],i=PP64.utils.img.ImgPack.toPack(n,16,0,s),PP64.fs.mainfs.write(10,411,i),s=PP64.fs.mainfs.get(10,412),n=[{src:new ArrayBuffer(16384),width:64,height:64,bpp:32}],i=PP64.utils.img.ImgPack.toPack(n,16,0,s),PP64.fs.mainfs.write(10,412,i);var f=PP64.fs.mainfs.get(10,394),P=new DataView(f);P.setUint16(508,0),P.setUint16(4358,0),PP64.fs.mainfs.write(10,394,f),f=PP64.fs.mainfs.get(10,395),(P=new DataView(f)).setUint16(516,0),P.setUint16(1558,0),PP64.fs.mainfs.write(10,395,f)};var t=PP64.adapters.boardinfo.create("MP2_PIRATE");t.name="Pirate Land",t.boardDefFile=65,t.bgDir=10,t.animBgSet=1,t.str={boardSelect:198},t.img={introLogoImg:422,pauseLogoImg:381,boardSelectImg:31,boardSelectIconCoords:[35,61]},t.arrowRotStartOffset=0,t.arrowRotEndOffset=0;var a=PP64.adapters.boardinfo.create("MP2_HORROR");a.name="Horror Land",a.boardDefFile=66,a.bgDir=21,a.animBgSet=2,a.str={boardSelect:201},a.img={introLogoImg:581,pauseLogoImg:382,boardSelectImg:32,boardSelectIconCoords:[133,60]},a.sceneIndex=67,a.eventASMStart=0,a.eventASMEnd=0,a.spaceEventsStartAddr=1132140,a.spaceEventsStartOffset=2988892,a.spaceEventsEndOffset=2989268,a.spaceEventTables=[{upper:2929988,lower:2929996},{upper:293e4,lower:2930008},{upper:2930056,lower:2930064},{upper:2930068,lower:2930072}];var o=PP64.adapters.boardinfo.create("MP2_SPACE");o.name="Space Land",o.boardDefFile=67,o.bgDir=24,o.animBgSet=3,o.str={boardSelect:199,boardNames:[193,212]},o.img={introLogoImg:500,pauseLogoImg:383,boardSelectImg:33,boardSelectIconCoords:[93,10]};var s=PP64.adapters.boardinfo.create("MP2_MYSTERY");s.name="Mystery Land",s.boardDefFile=68,s.bgDir=16,s.str={boardSelect:200},s.img={introLogoImg:502,pauseLogoImg:384,boardSelectImg:34,boardSelectIconCoords:[139,19]};var n=PP64.adapters.boardinfo.create("MP2_BOWSER");return n.name="Bowser Land",n.boardDefFile=69,n.bgDir=37,n.animBgSet=4,n.str={boardSelect:202},n.img={introLogoImg:547,pauseLogoImg:385,boardSelectImg:35},{getBoardInfos:function(e){switch(e){case $gameType.MP2_USA:return[r,t,a,o,s,n]}}}}();
"use strict";var _createClass=function(){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}}(),_get=function e(t,r,a){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,r);if(void 0===s){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,r,a)}if("value"in s)return s.value;var o=s.get;return void 0!==o?o.call(a):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}PP64.ns("adapters"),PP64.adapters.MP3=new(function(e){function n(){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.gameVersion=3,e.nintendoLogoFSEntry=[17,1],e.hudsonLogoFSEntry=[17,2],e.boardDefDirectory=19,e.MAINFS_READ_ADDR=39952,e.HEAP_FREE_ADDR=40556,e.TABLE_HYDRATE_ADDR=965216,e.SCENE_TABLE_ROM=618228,e}return _inherits(n,PP64.adapters.AdapterBase),_createClass(n,[{key:"onLoad",value:function(e,t){this._extractBanks(e,t),this._extractItemShops(e,t)}},{key:"onAfterOverwrite",value:function(e,t,r){this._writeBanks(t,r),this._writeItemShops(t,r),this._writeGates(t,r),this._writeArrowRotations(t,r),e.setUint16(221422,32832),e.setUint16(221430,4194304-this.EVENT_MEM_SIZE>>>16),e.setUint16(221442,26),e.setUint16(300502,26),e.setUint32(5298784,604110849),e.setUint32(5298816,604110849);for(var a=0,s=0,n=0;n<t.spaces.length;n++){var o=t.spaces[n];o.type===$spaceType.BLUE&&a++,o.type===$spaceType.RED&&s++}(a<14||s<1)&&(e.setUint32(1114564,268435589),$$log("Patching for low space count."))}},{key:"onOverwritePromises",value:function(e,t){var r=t.bgDir,a=[this._writeBackground(r,e.bg.src,e.bg.width,e.bg.height),this._writeBackground(r+1,e.otherbg.largescene,320,240),this._writeBackground(r+2,e.bg.src,320,240),this.onWriteBoardSelectImg(e,t),this.onWriteBoardLogoImg(e,t),this.onWriteBoardLogoTextImg(e,t),this._onWriteGateImg(e,t),this._brandBootSplashscreen()];return Promise.all(a)}},{key:"onAfterSave",value:function(e){e.setUint32(52928,0),e.setUint32(523352,0),e.setUint32(523360,0),e.setUint32(1122052,276824073)}},{key:"hydrateSpace",value:function(e){e.type===$spaceType.BANK&&PP64.boards.addEventToSpace(e,PP64.adapters.events.create("BANK"))}},{key:"onChangeBoardSpaceTypesFromGameSpaceTypes",value:function(e,t){var r=void 0,a=!e.type||e.type===PP64.types.BoardType.NORMAL;if(a)r={0:$spaceType.OTHER,3:$spaceType.OTHER,5:$spaceType.CHANCE,6:$spaceType.ITEM,7:$spaceType.BANK,8:$spaceType.OTHER,9:$spaceType.BATTLE,12:$spaceType.BOWSER,14:$spaceType.STAR,15:$spaceType.GAMEGUY,16:$spaceType.OTHER,17:$spaceType.OTHER};else{if(e.type!==PP64.types.BoardType.DUEL)throw new Error("Unrecongized board type: "+e.type);r={1:$spaceType.OTHER,2:$spaceType.HAPPENING,3:$spaceType.GAMEGUY,4:$spaceType.OTHER,5:$spaceType.DUEL_REVERSE,6:$spaceType.DUEL_BASIC,7:$spaceType.DUEL_START_RED,8:$spaceType.MINIGAME,9:$spaceType.DUEL_START_BLUE,10:$spaceType.DUEL_POWERUP}}if(e.spaces.forEach(function(e){var t=r[e.type];void 0!==t&&(e.type=t)}),a&&t.length){var s=t[0][0];isNaN(s)||(e.spaces[s].type=$spaceType.START)}}},{key:"onChangeGameSpaceTypesFromBoardSpaceTypes",value:function(e){var t=PP64.types.Space,r={};r[t.OTHER]=0,r[t.BLUE]=1,r[t.RED]=2,r[t.MINIGAME]=0,r[t.HAPPENING]=4,r[t.STAR]=14,r[t.CHANCE]=5,r[t.START]=0,r[t.SHROOM]=0,r[t.BOWSER]=12,r[t.ITEM]=6,r[t.BATTLE]=9,r[t.BANK]=7,r[t.ARROW]=13,r[t.GAMEGUY]=15,e.spaces.forEach(function(e){var t=r[e.type];void 0!==t&&(e.type=t)})}},{key:"onGetBoardCoordsFromGameCoords",value:function(e,t,r,a,s,n){var o=void 0,i=void 0,u=void 0;switch(n){case 0:case 1:case 2:case 3:case 4:case 5:o=a/2+e*(1+.05*t/(s/2))-e/(a/2)*130,(i=s/2+.4*(t+100))<s/2?i-=Math.abs(t)/11.5:i+=Math.abs(t)/4.8,u=0;break;case 6:case 7:case 8:case 9:case 10:case 11:o=a/2+e*(1+.05*t/(s/2))-e/(a/2)*130,(i=s/2+.4*(t+100))<s/2?i-=Math.abs(t)/11.5:i+=Math.abs(t)/4.8,u=0;break;default:console.warn("onGetBoardCoordsFromGameCoords called with bad boardIndex"),o=a/2+e,i=s/2+t,u=0}return[Math.round(o),Math.round(i),Math.round(u)]}},{key:"onGetGameCoordsFromBoardCoords",value:function(e,t,r,a,s,n){var o=void 0,i=void 0,u=void 0;switch(n){case 0:i=-5/4*(s-2*t+80),t<s/2+35?(i+=Math.abs(i)/7.7,i+=105):(i-=Math.abs(i)/2.91,i+=69),o=5*s*a*(2*e-a)/(10*s*(a-260)+a*i),u=0;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o=e-a/2,i=t-s/2,u=0;break;default:throw"onGetGameCoordsFromBoardCoords called with bad boardIndex"}return[o,i,u]}},{key:"onCreateChainEvents",value:function(s,n){for(var o=0;o<n.length;o++){var i=n[o],a=i[0],u=i[1],c=i[i.length-1],p=i[i.length-2],h=PP64.boards.getConnections(c,s),l=void 0;1<h.length?function(){if(2<h.length)throw"MP3 cannot support more than 2 split directions";var t=[];h.forEach(function(e){t.push(g(e))});var e=[];e.push(h[0]),e.push(h[1]),e.push(65535),e.push(p),e.push(h[1]),e.push(65535),e.push(p),e.push(h[0]),e.push(65535),e.push(0),e.push(t[0]),e.push(0),e.push(0),e.push(t[1]),e.push(0),e.push(0),e.push(o),e.push(i.length-2),e.push(1),e.push(t[1]),e.push(0),e.push(0),e.push(o),e.push(i.length-2),e.push(1),e.push(t[0]),e.push(0),e.push(0);var r={inlineArgs:e,chains:t},a=d(t);null!=a?(r.prevSpace=n[a][0],r.altChain=[t.find(function(e){return e!==a}),0],$$log("GATECHAINSPLIT args ",r),l=PP64.adapters.events.create("GATECHAINSPLIT",r)):l=PP64.adapters.events.create("CHAINSPLIT",r),PP64.boards.addEventByIndex(s,c,l,!0)}():(l=PP64.adapters.events.create("CHAINMERGE",{chain:g(h[0]),prevSpace:p}),PP64.boards.addEventByIndex(s,c,l,!0));var f=e(a);f.length?function(){var t=[];f.forEach(function(e){t.push(g(e))});var r=[];if(t.forEach(function(e){r.push(n[e])}),2<=f.length){var e=[];e.push(u),e.push(f[0]),e.push(65535),e.push(f[1]),e.push(f[0]),e.push(65535),e.push(f[1]),e.push(u),e.push(65535),e.push(0),e.push(o),e.push(1),e.push(0),e.push(t[0]),e.push(r[0].length-1),e.push(1),e.push(t[1]),e.push(r[1].length-1),e.push(1),e.push(t[0]),e.push(r[0].length-1),e.push(1),e.push(t[1]),e.push(r[1].length-1),e.push(1),e.push(o),e.push(1),e.push(0),l=PP64.adapters.events.create("REVERSECHAINSPLIT",{inlineArgs:e,chains:t}),PP64.boards.addEventByIndex(s,a,l,!0)}else 1===f.length&&(l=PP64.adapters.events.create("CHAINMERGE",{chain:t[0],spaceIndex:r[0].length-1,prevSpace:u}),PP64.boards.addEventByIndex(s,a,l,!0))}():1<PP64.boards.getConnections(a,s).length?$$log("FIXME: branching isolated chain?"):((l=PP64.adapters.events.create("CHAINMERGE",{chain:o,spaceIndex:1,prevSpace:65535})).activationType=$activationType.BEGINORWALKOVER,PP64.boards.addEventByIndex(s,a,l,!0))}function g(e){for(var t=0;t<n.length;t++)if(0<=n[t].indexOf(e))return t}function e(e){for(var t=[],r=0;r<s.spaces.length;r++)0<=PP64.boards.getConnections(r,s).indexOf(e)&&t.push(r);return t}function d(e){var t=null;return e.forEach(function(e){"number"==typeof n[e].find(function(e){return s.spaces[e].subtype===$spaceSubType.GATE})&&(t=e)}),t}}},{key:"onParseStrings",value:function(e,t){var r=t.str||{};if(r.boardSelect){var a=r.boardSelect[0],s=PP64.fs.strings3.read("en",a[0],a[1]),n=s.split("\n"),o=n[0].indexOf(">")+2,i=n[0].indexOf("{",o);e.name=n[0].substring(o,i),e.description=[n[1],n[2]].join("\n");for(var u=0,c=s.indexOf(this.getCharacterMap()[59],0);-1!==c;)u++,c=s.indexOf(this.getCharacterMap()[59],c+1);e.difficulty=u}}},{key:"onWriteStrings",value:function(e,t){var r=t.str||{};if(r.boardSelect&&r.boardSelect.length){var a=[];if(a.push(11),a.push(5),a.push(15),(a=a.concat(PP64.fs.strings._strToBytes(e.name||""))).push(22),a.push(25),a.push(15),(a=a.concat([32,32,32,32])).push(22),a.push(3),a.push(15),a=a.concat(PP64.fs.strings._strToBytes("Difficulty: ")),5<e.difficulty||e.difficulty<1)a.push(59),(a=a.concat(PP64.fs.strings._strToBytes(" "))).push(62),a=a.concat(PP64.fs.strings._strToBytes(" "+e.difficulty.toString()));else for(var s=0;s<e.difficulty;s++)a.push(59);a.push(22),a.push(25),a.push(10),(a=a.concat(PP64.fs.strings._strToBytes(e.description||""))).push(0);var n=PP64.utils.arrays.arrayToArrayBuffer(a),o=r.boardSelect[0];PP64.fs.strings3.write("en",o[0],o[1],n),a.pop(),a.push(25),a.push(255),a.push(0),n=PP64.utils.arrays.arrayToArrayBuffer(a),o=r.boardSelect[1],PP64.fs.strings3.write("en",o[0],o[1],n)}if(r.boardGreeting){var i=[];i.push(11),(i=i.concat(PP64.fs.strings._strToBytes("You're all here!"))).push(10),(i=i.concat(this._createBoardGreetingBase(e.name))).push(11),(i=i.concat(PP64.fs.strings._strToBytes("Now, before we begin, we need\nto determine the turn order."))).push(25),i.push(255),i.push(0);var u=PP64.utils.arrays.arrayToArrayBuffer(i);PP64.fs.strings3.write("en",r.boardGreeting[0],r.boardGreeting[1],u)}if(r.boardGreetingDuel){var c=[];c.push(11),(c=c.concat(PP64.fs.strings._strToBytes("I've been waiting for you, "))).push(17),c.push(194),c.push(10),(c=c.concat(this._createBoardGreetingBase(e.name))).push(11),(c=c.concat(PP64.fs.strings._strToBytes("And just as promised, if you win here..."))).push(25),c.push(255),c.push(0);var p=PP64.utils.arrays.arrayToArrayBuffer(c);PP64.fs.strings3.write("en",r.boardGreetingDuel[0],r.boardGreetingDuel[1],p)}if(r.boardNames&&r.boardNames.length){var h=[];h.push(11),(h=h.concat(PP64.fs.strings._strToBytes(e.name))).push(0);for(var l=PP64.utils.arrays.arrayToArrayBuffer(h),f=0;f<r.boardNames.length;f++){var g=r.boardNames[f];PP64.fs.strings3.write("en",g[0],g[1],l)}}}},{key:"_createBoardGreetingBase",value:function(e){var t=PP64.fs.strings._strToBytes("Welcome to the legendary ");return t.push(5),t.push(15),(t=t.concat(PP64.fs.strings._strToBytes(e))).push(22),t.push(25),t.push(194),t.push(25),t.push(255),t.push(11),(t=t.concat(PP64.fs.strings._strToBytes("Here, you'll battle to become\nthe Superstar."))).push(25),t.push(255),t}},{key:"onParseBoardSelectImg",value:function(e,t){t.img&&t.img.boardSelectImg&&(e.otherbg.boardselect=this._readImgFromMainFS(20,t.img.boardSelectImg,0))}},{key:"onWriteBoardSelectImg",value:function(t,r){return new Promise(function(s,e){var n=r.img&&r.img.boardSelectImg;if(n){var o=new Image,i=setTimeout(function(){return e("Failed to write board select for "+r.name)},45e3);o.onload=function(){var e=PP64.utils.img.toArrayBuffer(o,64,64),t=PP64.fs.mainfs.get(20,n),r=[{src:e,width:64,height:64,bpp:32}],a=PP64.utils.img.ImgPack.toPack(r,16,0,t);PP64.fs.mainfs.write(20,n,a),clearTimeout(i),s()},o.src=t.otherbg.boardselect}else s()})}},{key:"onParseBoardLogoImg",value:function(e,t){t.img&&t.img.splashLogoImg&&(e.otherbg.boardlogo=this._readImgFromMainFS(19,t.img.splashLogoImg,0),e.otherbg.boardlogotext=this._readImgFromMainFS(19,t.img.splashLogoTextImg,0))}},{key:"onWriteBoardLogoImg",value:function(c,p){return new Promise(function(s,e){var n=p.img&&p.img.splashLogoImg;if(n){var o=new Image,i=setTimeout(function(){return e("Failed to write logos for "+p.name)},45e3);o.onload=function(){var e=PP64.utils.img.toArrayBuffer(o,226,120),t=PP64.fs.mainfs.get(19,n),r=[{src:e,width:226,height:120,bpp:32}],a=PP64.utils.img.ImgPack.toPack(r,16,0,t);PP64.fs.mainfs.write(19,n,a),clearTimeout(i),s()},o.src=c.otherbg.boardlogo;var t=p.img.pauseLogoImg;if(t){var r=PP64.fs.mainfs.get(19,t),a=[{src:new ArrayBuffer(3e4),width:150,height:50,bpp:32}],u=PP64.utils.img.ImgPack.toPack(a,16,0,r);PP64.fs.mainfs.write(19,t,u)}}else s()})}},{key:"onWriteBoardLogoTextImg",value:function(t,r){return new Promise(function(s,e){var n=r.img&&r.img.splashLogoTextImg;if(n){var o=new Image,i=setTimeout(function(){return e("Failed to write logo text for "+r.name)},45e3);o.onload=function(){var e=PP64.utils.img.toArrayBuffer(o,226,36),t=PP64.fs.mainfs.get(19,n),r=[{src:e,width:226,height:36,bpp:32}],a=PP64.utils.img.ImgPack.toPack(r,16,0,t);PP64.fs.mainfs.write(19,n,a),clearTimeout(i),s()},o.src=t.otherbg.boardlogotext}else s()})}},{key:"_onWriteGateImg",value:function(e,t){return new Promise(function(n,e){var o=t.img&&t.img.gateImg;if(o){var i=PP64.utils.canvas.createContext(64,64),u=new Image,c=setTimeout(function(){return e("Failed to write gate image for "+t.name)},45e3);u.onload=function(){i.drawImage(u,0,0,64,64);var e=i.getImageData(0,0,64,64),t=PP64.utils.img.BMP.fromRGBA(e.data.buffer,32,8),r=PP64.fs.mainfs.get(19,366),a=PP64.utils.FORM.unpack(r);PP64.utils.FORM.replaceBMP(a,0,t[0],t[1]);var s=PP64.utils.FORM.pack(a);PP64.fs.mainfs.write(19,o,s),clearTimeout(c),n()},u.src="img/assets/genericgate.png"}else n()})}},{key:"onWriteAudio",value:function(e,t,r){if(_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"onWriteAudio",this).call(this,e,t,r),t.audioIndexOffset){var a=PP64.romhandler.getDataView(),s=e.audioIndex;a.setUint16(t.audioIndexOffset+4,s),a.setUint16(t.audioIndexOffset+20,s)}}},{key:"getAudioMap",value:function(){return["Opening","Opening Demo","Title Screen","Select File","Castle Grounds","","Staff Roll","Inside the Castle","Free-Play Room","Star Lift","Preparations","Rules Map","","The Adventure Begins","","The Adventure Ends","Begin Mini-Game","","Here's the Star","Still Going","Mini-Game End 1","Mini-Game End 2","Mini-Game End 3","Commence Attack!","Chilly Waters","Deep Bloober Sea","Spiny Desert","Woody Woods","Creepy Cavern","Waluigi","Good Luck!","The Winner is... Me!","Swingsy laid back","Foolish Bowser","","","Bowser Event","","Victory!","","Bowser Song","Intense fight song","Peaceful song, bells","","Defeat...","Aim","Don't Hurry","Panic!","Fighting Spirit","Got It?","Let's Get a Move On","Looking Ahead","Big Trouble!","What To Do!?!","Mustn't Panic","Nice and Easy","On Your Toes","Prologue 1","Prologue 2","Prologue 3","Genie's Theme","Jeanie's Theme","Start Battle","","","Electronic upbeat","Chance Time","Game Guy Mini-Game","Item Mini-Game","Mushroom Power-Up!","Game Guy Winner!","Game Guy Loser!","Game Guy Dance","Drumroll","Inside the Castle","","Battle Theme","Electronic beat","Ocean + Birds","","","","","","",""]}},{key:"getCharacterMap",value:function(){return{0:"",1:"<BLACK>",2:"<DEFAULT>",3:"<RED>",4:"<PURPLE>",5:"<GREEN>",6:"<BLUE>",7:"<YELLOW>",8:"<WHITE>",9:"<SEIZURE>",10:"\n",11:"„Äî",12:"‚óã",13:"\t",14:"\t",17:"{0}",18:"{1}",19:"{2}",20:"{3}",21:"{4}",22:"{5}",32:" ",33:"„ÄÄ",34:"„ÄÅ",35:"„ÄÇ",36:"„ÄÉ",37:"„ÄÑ",38:"„ÄÖ",39:"„ÄÜ",40:"„Äá",41:"„Äà",42:"„Äâ",43:"„Äê",44:"„Äë",58:"„Äí",59:"„Äì",60:"+",61:"-",62:"x",63:"->",91:'"',92:"'",93:"(",94:")",95:"/",123:":",126:"&",128:'"',129:"¬∞",130:",",131:"¬∞",133:".",192:"‚Äú",193:"‚Äù",194:"!",195:"?",255:"„Äï"}}}]),n}());
"use strict";PP64.ns("adapters.boardinfo"),PP64.adapters.boardinfo.MP3=function(){var a=PP64.adapters.boardinfo.create("MP3_CHILLY");a.name="Chilly Waters",a.boardDefFile=570,a.bgDir=3,a.str={boardSelect:[[21,30],[26,17]],boardGreeting:[24,12],boardGreetingDuel:[24,0],boardNames:[[49,39],[83,43]]},a.img={boardSelectImg:72,splashLogoImg:22,splashLogoTextImg:28,pauseLogoImg:125,gateImg:354},a.mainfsEventFile=[19,618],a.eventASMStart=3342336,a.eventASMEnd=3350780,a.spaceEventsStartAddr=1173272,a.spaceEventsStartOffset=3359368,a.spaceEventTables=[{upper:3267512,lower:3267520},{upper:3267524,lower:3267532},{upper:3267548,lower:3267556}],a.spaceEventsEndOffset=3359784,a.starSpaceArrOffset=[3354144,3354256],a.starSpaceCount=8,a.toadSpaceArrOffset=[3354160,3354348],a.bankArrOffset=[3354740],a.bankCoinArrOffset=[3354384],a.bankCount=2,a.itemShopArrOffset=[3354744],a.itemShopCount=2,a.booArrOffset=[3354380],a.booCount=1,a.gateNeighborsOffset=[3354340],a.gateArrOffset=[3354508],a.gateCount=2,a.arrowRotStartOffset=3266728,a.arrowRotEndOffset=3266896,a.audioIndexOffset=3267474,a.onLoad=function(e){e.otherbg.largescene=PP64.fs.hvqfs.readBackground(a.bgDir+1).src},a.onAfterOverwrite=function(e,a){e.setUint32(3267536,0),e.setUint32(3267540,0),e.setUint32(3267544,0),e.setUint16(3335982,a._deadSpace),e.setUint16(3336014,a._deadSpace)};var r=PP64.adapters.boardinfo.create("MP3_BLOOBER");r.name="Deep Bloober Sea",r.boardDefFile=571,r.bgDir=6,r.str={boardSelect:[[21,31],[26,18]]},r.img={boardSelectImg:73,splashLogoImg:23,splashLogoTextImg:29,gateImg:359};var t=PP64.adapters.boardinfo.create("MP3_SPINY");t.name="Spiny Desert",t.boardDefFile=572,t.bgDir=9,t.str={boardSelect:[[21,32],[26,19]]},t.img={boardSelectImg:74,splashLogoImg:24,splashLogoTextImg:30,gateImg:366};var o=PP64.adapters.boardinfo.create("MP3_WOODY");o.name="Woody Woods",o.boardDefFile=573,o.bgDir=12,o.str={boardSelect:[[21,33],[26,20]]},o.img={boardSelectImg:75,splashLogoImg:25,splashLogoTextImg:31,gateImg:373};var s=PP64.adapters.boardinfo.create("MP3_CAVERN");s.name="Creepy Cavern",s.boardDefFile=574,s.bgDir=15,s.str={boardSelect:[[21,34],[26,21]]},s.img={boardSelectImg:76,splashLogoImg:26,splashLogoTextImg:32};var g=PP64.adapters.boardinfo.create("MP3_WALUIGI");g.name="Waluigi's Land",g.boardDefFile=575,g.bgDir=18,g.str={boardSelect:[[21,35],[26,22]]},g.img={boardSelectImg:77,splashLogoImg:27,splashLogoTextImg:33};var i=PP64.adapters.boardinfo.create("MP3U_GATEGUY");i.name="Gate Guy",i.type="DUEL",i.boardDefFile=577,i.bgDir=24,i.img={boardSelectImg:81,splashLogoImg:34,splashLogoTextImg:40,miniMapWithBg:279,miniMapDots:280},i.spaceEventsStartAddr=1149204,i.spaceEventsStartOffset=4110852,i.spaceEventTables=[{upper:4066220,lower:4066228},{upper:4066232,lower:4066240}],i.onAfterOverwrite=function(e,a){};var n=PP64.adapters.boardinfo.create("MP3U_ARROWHEAD");n.name="Arrowhead",n.type="DUEL",n.boardDefFile=578,n.bgDir=25,n.img={boardSelectImg:82,splashLogoImg:35,splashLogoTextImg:41,miniMapWithBg:310,miniMapDots:311};var p=PP64.adapters.boardinfo.create("MP3U_PIPESQUEAK");p.name="Pipesqueak",p.type="DUEL",p.boardDefFile=579,p.bgDir=26,p.img={boardSelectImg:83,splashLogoImg:36,splashLogoTextImg:42,miniMapWithBg:312,miniMapDots:313};var d=PP64.adapters.boardinfo.create("MP3U_BLOWHARD");d.name="Blowhard",d.type="DUEL",d.boardDefFile=580,d.bgDir=27,d.img={boardSelectImg:84,splashLogoImg:37,splashLogoTextImg:43,miniMapWithBg:315,miniMapDots:316};var m=PP64.adapters.boardinfo.create("MP3U_MRMOVER");m.name="Mr. Mover",m.type="DUEL",m.boardDefFile=581,m.bgDir=28,m.img={boardSelectImg:85,splashLogoImg:38,splashLogoTextImg:44,miniMapWithBg:317,miniMapDots:318};var b=PP64.adapters.boardinfo.create("MP3U_BACKTRACK");return b.name="Backtrack",b.type="DUEL",b.boardDefFile=582,b.bgDir=29,b.img={boardSelectImg:86,splashLogoImg:39,splashLogoTextImg:45,miniMapWithBg:319,miniMapDots:320},{getBoardInfos:function(e){switch(e){case $gameType.MP3_USA:return[a,r,t,o,s,g,i,n,p,d,m,b]}}}}();
"use strict";PP64.ns("adapters.events"),Object.assign(PP64.adapters.events,function(){var n=Object.create(null),e={get:function(e){return n[e]},set:function(e,t){n[e]=t}},p=Object.create(null),r={parse:function(e,t){throw"parse not implemented"},write:function(e,t,n,r){throw(t.id||"event")+".write not implemented"},sizeOf:function(e){throw"sizeOf not implemented"},activationType:$activationType.WALKOVER,executionType:$executionType.DIRECT,fakeEvent:!1,supportedGames:[],sharedAsm:!1};function i(e,t){for(var n=0;n<e.length;n++)switch(e[n]){case $gameType.MP1_USA:case $gameType.MP1_JPN:case $gameType.MP1_PAL:if(1===t)return!0;break;case $gameType.MP2_USA:case $gameType.MP2_JPN:case $gameType.MP2_PAL:if(2===t)return!0;break;case $gameType.MP3_USA:case $gameType.MP3_JPN:case $gameType.MP3_PAL:if(3===t)return!0}return!1}return{EventCache:e,createEvent:function(e,t){var n=Object.create(r);return n.id=e,n.name=t,p[e]=n},create:function(e,t){var n=p[e];if(!n)throw"Requesting to create invalid event "+e+".";var r=t?PP64.utils.obj.copy(t):{};return r.id=e,r.activationType=n.activationType,r.executionType=n.executionType,r},parse:function(e,t){var n=PP64.romhandler.getROMGame();for(var r in p)if(-1!==p[r].supportedGames.indexOf(n)){var a=p[r].parse(e,t);if(a){if(p[r].fakeEvent)return!0;var i={id:r};return!0!==a&&(i.args=a),i}}return!1},getAvailableEvents:function(){var e=[],t=PP64.adapters.events.getEvents(),n=PP64.boards.getCurrentBoard().game||1;for(var r in t){var a=t[r];i(a.supportedGames,n)&&!a.fakeEvent&&e.push(PP64.utils.obj.copy(a))}return e},getCustomEvents:function(){var e=[],t=PP64.adapters.events.getEvents();for(var n in t){var r=t[n];r.custom&&e.push(PP64.utils.obj.copy(r))}return e},write:function(e,t,n,r){var a,i=0,s=0;if(t.inlineArgs){i=t.inlineArgs.length,a=i,s=$$number.makeDivisibleBy(2*a,4);for(var o=new DataView(e,n.offset),u=0;u<i;u++){var c=2*u;o.setUint16(c,t.inlineArgs[u])}n.argsAddr=n.addr,n.addr+=s,n.offset+=s}var f=new DataView(e,n.offset),v=p[t.id].write(f,t,n,r);if(!1===v)throw"Could not write ${event.id} for game ${info.gameVersion}";return v[1]+=s,v},removeEvent:function(e){delete p[e]},isUnsupported:function(e,t){return-1===p[e].supportedGames.indexOf(t)},sharesAsm:function(e){return p[e].sharedAsm},getName:function(e){return p[e]&&p[e].name||""},getEvent:function(e){return p[e]},getEvents:function(){return p}}}());
"use strict";PP64.ns("adapters.events"),PP64.adapters.events.common=function(){var f=PP64.utils.arrays.hashEqual,v=PP64.adapters.events.EventCache,p=PP64.adapters.events.createEvent("CHAINMERGE","");p.activationType=$activationType.WALKOVER,p.executionType=$executionType.DIRECT,p.fakeEvent=!0,p.supportedGames=[$gameType.MP1_USA,$gameType.MP2_USA,$gameType.MP3_USA],p.parse=function(e,t){if(3===t.gameVersion)return PP64.adapters.events.getEvent(p.id)._parse3(e,t);var r="d218c758ea3247b6e5ec2ae0c3568a92",a="560c69d6e851f4a22984b74c660e8536",n="BABAF76D201027AE882BEB58BB38B4EB",s=void 0,i=void 0;if(f([e.buffer,t.offset,12],r)&&f([e.buffer,t.offset+24,12],a)){s=1e3<(s=e.getUint16(t.offset+14))?0:s,i=0===e.getUint16(t.offset+20)?t.chains[s][0]:t.chains[s][e.getUint16(t.offset+22)],isNaN(i)||PP64.boards.addConnection(t.curSpace,i,t.board);var o=v.get(p.id)||{};if(!o[t.game]){o[t.game]={asm:e.buffer.slice(t.offset,t.offset+36)};var c=new DataView(o[t.game].asm);c.setUint32(12,0),c.setUint32(20,0),v.set(p.id,o)}return!0}return!(!f([e.buffer,t.offset,24],n)||!f([e.buffer,t.offset+36,12],a))&&(s=1e3<(s=e.getUint16(t.offset+26))?0:s,"number"==typeof(i=0===e.getUint16(t.offset+32)?t.chains[s][0]:t.chains[s][e.getUint16(t.offset+34)])&&PP64.boards.addConnection(t.curSpace,i,t.board),!0)},p.write=function(e,t,r,a){var n=v.get(p.id);if(!n||!n[r.game])throw"Cannot write "+p.id+", no cache entry present.";var s=n[r.game].asm;if(PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),3===r.gameVersion)if(e.setUint32(8,$MIPS.makeInst("ADDIU",$MIPS.REG.A0,$MIPS.REG.R0,t.prevSpace)),65535===t.prevSpace)e.setUint32(16,201569894);else{if(0!==r.boardIndex)throw"ChainMerge for ${info.boardIndex} needs work";e.setUint32(16,201597703)}return e.setUint32(12,$MIPS.makeInst("ADDIU",$MIPS.REG.A1,$MIPS.REG.R0,t.chain)),e.setUint32(20,$MIPS.makeInst("ADDIU",$MIPS.REG.A2,$MIPS.REG.R0,t.spaceIndex||0)),[r.offset,36]},p.sizeOf=function(){return 36*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)};var d=PP64.adapters.events.createEvent("CHAINSPLIT","");d.activationType=$activationType.WALKOVER,d.executionType=$executionType.PROCESS,d.fakeEvent=!0,d.supportedGames=[$gameType.MP1_USA,$gameType.MP2_USA,$gameType.MP3_USA],d.parse=function(e,t){var r=PP64.adapters.events.getEvent(d.id);switch(t.gameVersion){case 1:return r._parse1(e,t);case 2:return r._parse2(e,t);case 3:return r._parse3(e,t)}return!1},d.write=function(e,t,r,a){if(3===r.gameVersion)return PP64.adapters.events.getEvent(d.id)._write3(e,t,r,a);var n=v.get(d.id);if(!(n&&n[r.game]&&n[r.game].asm&&n[r.game].helper1&&n[r.game].helper2))throw"Cannot write "+d.id+", missing cache entry values.";var s=0,i=2147483647&r.addr,o=n[r.game].asm;if(PP64.utils.arrays.copyRange(e,o,s,0,o.byteLength),s+=o.byteLength,!a.helper1addr){var c=n[r.game].helper1[r.boardIndex];if(!c)throw"Cannot write "+d.id+", missing helper1["+r.boardIndex+"].";PP64.utils.arrays.copyRange(e,c,s,0,c.byteLength),a.helper1addr=i+s,s+=c.byteLength}if(!a.helper2addr){var f=n[r.game].helper2[r.boardIndex];if(!f)throw"Cannot write "+d.id+", missing helper2["+r.boardIndex+"].";PP64.utils.arrays.copyRange(e,f,s,0,f.byteLength),a.helper2addr=i+s,s+=f.byteLength}var p=65535&r.argsAddr,u=r.argsAddr>>>16;switch(32768&p&&(u+=1),r.game){case $gameType.MP1_USA:e.setUint32(44,$MIPS.makeInst("JAL",a.helper1addr)),e.setUint32(64,$MIPS.makeInst("LUI",$MIPS.REG.A1,u)),e.setUint32(72,$MIPS.makeInst("ADDIU",$MIPS.REG.A1,$MIPS.REG.A1,p)),e.setUint32(196,$MIPS.makeInst("JAL",a.helper2addr)),e.setUint32(212,$MIPS.makeInst("J",i+224)),e.setUint16(218,t.chains[0]),e.setUint16(222,t.chains[1]);break;case $gameType.MP2_USA:e.setUint32(44,$MIPS.makeInst("JAL",a.helper1addr)),e.setUint32(64,$MIPS.makeInst("LUI",$MIPS.REG.A1,u)),e.setUint32(72,$MIPS.makeInst("ADDIU",$MIPS.REG.A1,$MIPS.REG.A1,p)),e.setUint32(212,$MIPS.makeInst("JAL",a.helper2addr)),e.setUint32(228,$MIPS.makeInst("J",i+240)),e.setUint16(234,t.chains[0]),e.setUint16(238,t.chains[1]);break;default:throw"Writing ChainSplit for unknown game"}return[r.offset,s]},d.sizeOf=function(){return 252+264*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)};var c=PP64.adapters.events.createEvent("BOO","Visit Boo");c.activationType=$activationType.WALKOVER,c.executionType=$executionType.DIRECT,c.supportedGames=[$gameType.MP1_USA,$gameType.MP2_USA,$gameType.MP3_USA],c.parse=function(e,t){var r=PP64.adapters.events.getEvent(c.id);switch(t.gameVersion){case 2:return r._parse2(e,t);case 3:return r._parse3(e,t)}var a="DAD5E635FE90ED982D02B3F1D5C0CE21",n="FF104A680C0ECE615B5A24AD95A908CC",s="94A87B51D2478E81AAC34F7D3C5C37F2";if(f([e.buffer,t.offset+28,24],n)&&f([e.buffer,t.offset,20],a)){var i=101===e.getUint16(t.offset+26);if(i){var o=v.get(c.id);if(!o)o={asm:e.buffer.slice(t.offset,t.offset+52)},new DataView(o.asm).setUint16(22,0),v.set(c.id,o)}return i}return!(!f([e.buffer,t.offset+84,24],n)||!f([e.buffer,t.offset,40],s))},c.write=function(e,t,r,a){var n=PP64.adapters.events.getEvent(c.id);switch(r.gameVersion){case 2:return n._write2(e,t,r,a);case 3:return n._write3(e,t,r,a)}var s=v.get(c.id);if(!s)throw"Cannot write "+c.id+", no cache entry present.";var i=s.asm;return PP64.utils.arrays.copyRange(e,i,0,0,i.byteLength),e.setUint32(8,0),e.setUint32(12,0),e.setUint32(16,0),e.setUint32(20,0),[r.offset,52]},c.sizeOf=function(){return 52*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)};var u=PP64.adapters.events.createEvent("BOWSER","Visit Bowser");u.activationType=$activationType.WALKOVER,u.executionType=$executionType.DIRECT,u.supportedGames=[$gameType.MP1_USA],u.parse=function(e,t){var r="DAD5E635FE90ED982D02B3F1D5C0CE21",a="8A835D982BE35F1804E9ABD65C5699F4";if(f([e.buffer,t.offset,20],r)&&f([e.buffer,t.offset+28,28],a)){var n=e.getUint16(t.offset+26),s=-1!==[72,73,79,83,84,91,93].indexOf(n);if(s){var i=v.get(u.id);if(!i){i={asm:e.buffer.slice(t.offset,t.offset+56)};var o=new DataView(i.asm);o.setUint32(8,0),o.setUint32(12,0),o.setUint32(16,0),o.setUint32(20,0),o.setUint32(26,0),v.set(u.id,i)}}return s}return!1},u.write=function(e,t,r,a){var n=v.get(u.id);if(!n)throw"Cannot write "+u.id+", no cache entry present.";var s=n.asm;PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength);var i=[72,73,79,83,84,91,93][r.boardIndex];return e.setUint16(26,i),[r.offset,56]},u.sizeOf=function(){return 56*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)};var s=PP64.adapters.events.createEvent("STAR","Buy star");s.activationType=$activationType.WALKOVER,s.executionType=$executionType.DIRECT,s.fakeEvent=!0,s.supportedGames=[$gameType.MP1_USA,$gameType.MP2_USA,$gameType.MP3_USA],s.parse=function(e,t){var r=PP64.adapters.events.getEvent(s.id);switch(t.gameVersion){case 1:return r._parse1(e,t);case 2:return r._parse2(e,t)}return!1},s.write=function(e,t,r,a){var n=PP64.adapters.events.getEvent(s.id);switch(r.gameVersion){case 1:return n._write1(e,t,r,a);case 2:return n._write2(e,t,r,a);case 3:return n._write3(e,t,r,a)}return!1},s.sizeOf=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 100};var i=PP64.adapters.events.createEvent("CHANCETIME","Chance Time");i.activationType=$activationType.LANDON,i.executionType=$executionType.DIRECT,i.supportedGames=[$gameType.MP1_USA],i.parse=function(e,t){if(f([e.buffer,t.offset,108],"18F44B4AA1F4AAAA839C100E3B0FD863")){var r=v.get(i.id);return r||(r={asm:e.buffer.slice(t.offset,t.offset+108)},v.set(i.id,r)),!0}return!1},i.write=function(e,t,r,a){var n=v.get(i.id);if(!n)throw"Cannot write "+i.id+", no cache entry present.";if(a.writtenOffset)return[a.writtenOffset,0];var s=n.asm;return PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),a.writtenOffset=r.offset,[r.offset,108]},i.sizeOf=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 108};var o=PP64.adapters.events.createEvent("BANK","Visit Bank");o.activationType=$activationType.WALKOVER,o.executionType=$executionType.DIRECT,o.supportedGames=[$gameType.MP2_USA,$gameType.MP3_USA],o.parse=function(e,t){var r=PP64.adapters.events.getEvent(o.id);switch(t.gameVersion){case 1:return!1;case 2:return r._parse2(e,t);case 3:return r._parse3(e,t)}return!1},o.write=function(e,t,r,a){var n=PP64.adapters.events.getEvent(o.id);switch(r.gameVersion){case 1:return!1;case 2:return n._write2(e,t,r,a);case 3:return n._write3(e,t,r,a)}return!1},o.sizeOf=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 0};var P=PP64.adapters.events.createEvent("ITEMSHOP","Visit Item Shop");P.activationType=$activationType.WALKOVER,P.executionType=$executionType.DIRECT,P.supportedGames=[$gameType.MP2_USA,$gameType.MP3_USA],P.parse=function(e,t){var r=PP64.adapters.events.getEvent(P.id);switch(t.gameVersion){case 1:return!1;case 2:return r._parse2(e,t);case 3:return r._parse3(e,t)}return!1},P.write=function(e,t,r,a){var n=PP64.adapters.events.getEvent(P.id);switch(r.gameVersion){case 1:return!1;case 2:return n._write2(e,t,r,a);case 3:return n._write3(e,t,r,a)}return!1},P.sizeOf=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 0};var g=PP64.adapters.events.createEvent("GATE","Skeleton Key Gate");g.activationType=$activationType.WALKOVER,g.executionType=$executionType.PROCESS,g.fakeEvent=!0,g.supportedGames=[$gameType.MP3_USA],g.parse=function(e,t){var r=PP64.adapters.events.getEvent(g.id);switch(t.gameVersion){case 1:return!1;case 2:return r._parse2(e,t);case 3:return r._parse3(e,t)}return!1},g.write=function(e,t,r,a){var n=PP64.adapters.events.getEvent(g.id);switch(r.gameVersion){case 1:return!1;case 2:return n._write2(e,t,r,a);case 3:return n._write3(e,t,r,a)}return!1},g.sizeOf=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 0};var m=PP64.adapters.events.createEvent("GATECLOSE","Skeleton Key Gate Close");return m.activationType=$activationType.WALKOVER,m.executionType=$executionType.DIRECT,m.fakeEvent=!0,m.supportedGames=[$gameType.MP3_USA],m.parse=function(e,t){var r=PP64.adapters.events.getEvent(m.id);switch(t.gameVersion){case 1:return!1;case 2:return r._parse2(e,t);case 3:return r._parse3(e,t)}return!1},m.write=function(e,t,r,a){var n=PP64.adapters.events.getEvent(m.id);switch(r.gameVersion){case 1:return!1;case 2:return n._write2(e,t,r,a);case 3:return n._write3(e,t,r,a)}return!1},m.sizeOf=function(){return 28*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)},{}}();
"use strict";PP64.ns("adapters.events"),PP64.adapters.events.MP1=function(){var l=PP64.utils.arrays.hashEqual,v=PP64.adapters.events.EventCache,u=PP64.adapters.events.getEvent("CHAINSPLIT");u._parse1=function(e,t){var r="597324F65BC9A4D0BCA9527477258625",a="24FBEBD7FA3B256016D536690EF70AD8",n="F153076BBD19ECBB4967EFC92CD738DF";if(l([e.buffer,t.offset,44],r)&&l([e.buffer,t.offset+76,28],a)&&l([e.buffer,t.offset+224,40],n)){var s=e.getUint16(t.offset+218),f=e.getUint16(t.offset+222),i=t.chains[s][0],o=t.chains[f][0];PP64.boards.addConnection(t.curSpace,i,t.board),PP64.boards.addConnection(t.curSpace,o,t.board);var d=v.get(u.id);if(d||(d={}),d[t.game]||(d[t.game]={}),!d[t.game].asm){d[t.game].asm=e.buffer.slice(t.offset,t.offset+264);var p=new DataView(d[t.game].asm);p.setUint32(44,0),p.setUint32(196,0),p.setUint32(64,0),p.setUint32(72,0),p.setUint16(212,0),p.setUint16(218,0),p.setUint16(222,0)}return v.set(u.id,d),!0}return!1};var e=PP64.adapters.events.createEvent("THWOMPCHAINSPLIT","");e.fakeEvent=!0,e.supportedGames=[$gameType.MP1_USA],e.parse=function(e,t){if(l([e.buffer,t.offset,64],"A45C16B1E285427C790C6FAD1EC78394")){var r=v.get(u.id);if(r||(r={}),r[t.game]||(r[t.game]={}),!r[t.game].helper1){r[t.game].helper1=[];var a=e.getUint32(t.offset+64),n=$MIPS.getJALAddr(a),s=t.offset-(t.addr-n);r[t.game].helper1[t.boardIndex]=e.buffer.slice(s,s+176),r[t.game].helper2=[];var f=e.getUint32(t.offset+208),i=$MIPS.getJALAddr(f),o=t.offset-(t.addr-i);r[t.game].helper2[t.boardIndex]=e.buffer.slice(o,o+76)}return v.set(u.id,r),!0}return!1};var f=PP64.adapters.events.getEvent("STAR");f._parse1=function(e,t){var r="14A3FD0F13B034F8C90659FF589A17DB",a="B48ABB1B1FDBF7B5EF9765FD61C3940E",n="5FEE3364FDCA8B0E9247BFB37A391358";if(l([e.buffer,t.offset,20],r)&&l([e.buffer,t.offset+24,16],a)&&l([e.buffer,t.offset+48,52],n)){var s=v.get(f.id);if(!s)s={asm:e.buffer.slice(t.offset,t.offset+100)},new DataView(s.asm).setUint32(20,0);return s.methodCallsByBoard=s.methodCallsByBoard||{},s.methodCallsByBoard[t.boardIndex]||(s.methodCallsByBoard[t.boardIndex]=e.getUint32(t.offset+20)),v.set(f.id,s),!0}return!1},f._write1=function(e,t,r,a){var n=v.get(f.id);if(!n)throw"Cannot write "+f.id+", no cache entry present.";if(a.writtenOffset)return[a.writtenOffset,0];var s=n.asm;if(PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),!n.methodCallsByBoard[r.boardIndex])throw"StarEvent cache.methodCallsByBoard["+r.boardIndex+"] is not defined";return e.setUint32(20,n.methodCallsByBoard[r.boardIndex]),a.writtenOffset=r.offset,[r.offset,100]};var B=PP64.adapters.events.createEvent("PASSSTART","Pass start");B.activationType=$activationType.WALKOVER,B.executionType=$executionType.PROCESS,B.supportedGames=[$gameType.MP1_USA],B.parse=function(e,t){var r="D87057256E3E3CA9A6878AA03EF4C486",a="9AB28DCC38CFBE9AE8FEA4515E86D7B2";if(l([e.buffer,t.offset,22],r)&&l([e.buffer,t.offset+28,24],a)){var n=v.get(B.id);if(!n){n={asm:e.buffer.slice(t.offset,t.offset+52)};var s=new DataView(n.asm);s.setUint32(8,0),s.setUint32(12,0),s.setUint32(16,0),s.setUint32(20,0),s.setUint32(24,0)}if(n.helpersByBoard=n.helpersByBoard||{},!n.helpersByBoard[t.boardIndex]){n.helpersByBoard[t.boardIndex]={};var f=e.getUint32(t.offset+24),i=$MIPS.getJALAddr(f),o=t.offset-(t.addr-i);n.helpersByBoard[t.boardIndex].helper1=e.buffer.slice(o,o+208);var d=e.getUint32(o+184),p=$MIPS.getJALAddr(d),u=t.offset-(t.addr-p);n.helpersByBoard[t.boardIndex].helper2=e.buffer.slice(u,u+308)}return v.set(B.id,n),!0}return!1},B.write=function(e,t,r,a){var n=v.get(B.id);if(!(n&&n.asm&&n.helpersByBoard&&n.helpersByBoard[r.boardIndex]))throw"Cannot write "+B.id+", missing cache entry values.";var s=0,f=2147483647&r.addr,i=n.asm;if(PP64.utils.arrays.copyRange(e,i,s,0,i.byteLength),s+=i.byteLength,!a.helper2addr){var o=n.helpersByBoard[r.boardIndex].helper2;if(!o)throw"Cannot write "+B.id+", missing helper2["+r.boardIndex+"].";PP64.utils.arrays.copyRange(e,o,s,0,o.byteLength),a.helper2addr=f+s,e.setUint32(s+120,$MIPS.makeInst("J",a.helper2addr+120+56)),s+=o.byteLength}if(!a.helper1addr){var d=n.helpersByBoard[r.boardIndex].helper1;if(!d)throw"Cannot write "+B.id+", missing helper1["+r.boardIndex+"].";PP64.utils.arrays.copyRange(e,d,s,0,d.byteLength),a.helper1addr=f+s,e.setUint32(s+184,$MIPS.makeInst("JAL",a.helper2addr)),e.setUint32(s+176,$MIPS.makeInst("J",a.helper1addr+176+16)),s+=d.byteLength}return e.setUint32(24,$MIPS.makeInst("JAL",a.helper1addr)),[r.offset,s]},B.sizeOf=function(){return 516+52*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)};var i=PP64.adapters.events.createEvent("STARCHANCE","Chance Time from old star space");i.activationType=$activationType.LANDON,i.executionType=$executionType.DIRECT,i.fakeEvent=!0,i.supportedGames=[$gameType.MP1_USA],i.parse=function(e,t){if(l([e.buffer,t.offset,140],"7E32BF9C855085A03CF3A8D208A6AB94")){var r=v.get(i.id);return r||(r={asm:e.buffer.slice(t.offset,t.offset+140)},v.set(i.id,r)),!0}return!1},i.write=function(e,t,r,a){var n=v.get(i.id);if(!n)throw"Cannot write "+i.id+", no cache entry present.";if(a.writtenOffset)return[a.writtenOffset,0];var s=n.asm;return PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),a.writtenOffset=r.offset,[r.offset,140]},i.sizeOf=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 140};var t=PP64.adapters.events.createEvent("BOULDER","Boulder chase");return t.activationType=$activationType.LANDON,t.executionType=$executionType.DIRECT,t.fakeEvent=!0,t.supportedGames=[$gameType.MP1_USA],t.parse=function(e,t){return!!l([e.buffer,t.offset,116],"6E26BAB74BC8411901472C0A40E2FC1D")},{getAvailableEvents:function(){var e=[],t=PP64.adapters.events.getEvents();for(var r in t){var a=t[r];a.unsupported||a.fakeEvent||e.push(PP64.utils.obj.copy(a))}return e}}}();
"use strict";PP64.ns("adapters.events"),PP64.adapters.events.MP2=function(){var S=PP64.utils.arrays.hashEqual,I=PP64.adapters.events.EventCache,x=PP64.adapters.events.getEvent("CHAINSPLIT");x._parse2=function(e,r){var t="0C01A009C54E209652DA667F464FB7C0",a="FC606B8F8BD2C8D39BB9581B0E4D8398",n="2F3A0045D0AC927FF23ACD73B5B62E1C";if(S([e.buffer,r.offset,44],t)&&S([e.buffer,r.offset+76,28],a)&&S([e.buffer,r.offset+240,40],n)){var s=e.getUint16(r.offset+234),o=e.getUint16(r.offset+238),d=r.chains[s][0],i=r.chains[o][0];PP64.boards.addConnection(r.curSpace,d,r.board),PP64.boards.addConnection(r.curSpace,i,r.board);var u=I.get(x.id);if(u||(u={}),u[r.game]||(u[r.game]={}),!u[r.game].asm){u[r.game].asm=e.buffer.slice(r.offset,r.offset+280);var f=new DataView(u[r.game].asm);f.setUint32(44,0),f.setUint32(212,0),f.setUint32(64,0),f.setUint32(72,0),f.setUint16(228,0),f.setUint16(234,0),f.setUint16(238,0)}if(!u[r.game].helper1){u[r.game].helper1=[];var c=e.getUint32(r.offset+44),p=$MIPS.getJALAddr(c),P=r.offset-(r.addr-p);u[r.game].helper1[r.boardIndex]=e.buffer.slice(P,P+208),u[r.game].helper2=[];var b=e.getUint32(r.offset+212),v=$MIPS.getJALAddr(b),g=r.offset-(r.addr-v);u[r.game].helper2[r.boardIndex]=e.buffer.slice(g,g+96)}return I.set(x.id,u),!0}return!1};var e=PP64.adapters.events.getEvent("STAR");e._parse2=function(e,r){return!!S([e.buffer,r.offset,2112],"D52AD53C2FED642C3001C3579B4299C3")},e._write2=function(e,r,t,a){return[2744540,0]};var r=PP64.adapters.events.getEvent("BOO");r._parse2=function(e,r){var t=!1;if(0===r.boardIndex){if(2755864!==r.offset)return!1;t=!0}return!!t},r._write2=function(e,r,t,a){var n=a.curBoo=a.curBoo||1;a.curBoo++;for(var s=PP64.boards.getSpacesOfSubType($spaceSubType.BOO,t.board),o=t.curSpace,d=Number.MAX_VALUE,i=t.curSpaceIndex,u=0;u<s.length;u++){var f=s[u],c=t.board.spaces[f],p=PP64.utils.number.distance(o.x,o.y,c.x,c.y);p<d&&(d=p,i=f)}if(0===t.boardIndex){var P=PP64.romhandler.getDataView();return 1===n?(P.setUint16(2755994,t.curSpaceIndex),P.setUint16(2756030,i)):2===n&&(P.setUint16(2756002,t.curSpaceIndex),P.setUint16(2756038,i)),[2755864,0]}throw"Can't write Boo to board index "+t.boardIndex};var t=PP64.adapters.events.getEvent("BANK");t._parse2=function(e,r){var t=!1;if(0===r.boardIndex){if(2746652!==r.offset)return!1;t=!0}return!!t},t._write2=function(e,r,t,a){var n=a.curBank=a.curBank||1;a.curBank++;for(var s=PP64.boards.getSpacesOfSubType($spaceSubType.BANK,t.board),o=t.curSpace,d=Number.MAX_VALUE,i=t.curSpaceIndex,u=0;u<s.length;u++){var f=s[u],c=t.board.spaces[f],p=PP64.utils.number.distance(o.x,o.y,c.x,c.y);p<d&&(d=p,i=f)}if(0===t.boardIndex){var P=PP64.romhandler.getDataView();return 1===n?(P.setUint16(2746758,t.curSpaceIndex),P.setUint16(2746798,i)):2===n&&(P.setUint16(2746766,t.curSpaceIndex),P.setUint16(2746786,i)),[2746652,0]}throw"Can't write Bank to board index "+t.boardIndex};var a=PP64.adapters.events.getEvent("ITEMSHOP");return a._parse2=function(e,r){var t=!1;if(0===r.boardIndex){if(2747904!==r.offset)return!1;t=!0}return!!t},a._write2=function(e,r,t,a){var n=a.curItemShop=a.curItemShop||1;a.curItemShop++;for(var s=PP64.boards.getSpacesOfSubType($spaceSubType.ITEMSHOP,t.board),o=t.curSpace,d=Number.MAX_VALUE,i=t.curSpaceIndex,u=0;u<s.length;u++){var f=s[u],c=t.board.spaces[f],p=PP64.utils.number.distance(o.x,o.y,c.x,c.y);p<d&&(d=p,i=f)}if(0===t.boardIndex){var P=PP64.romhandler.getDataView();return 1===n&&P.setUint16(2748002,i),[2747904,0]}throw"Can't write Item Shop to board index "+t.boardIndex},{getAvailableEvents:function(){var e=[],r=PP64.adapters.events.getEvents();for(var t in r){var a=r[t];a.unsupported||a.fakeEvent||e.push(PP64.utils.obj.copy(a))}return e}}}();
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw s}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};PP64.ns("adapters.events"),PP64.adapters.events.MP3=function(){var d=PP64.utils.arrays.hashEqual,g=PP64.adapters.events.EventCache,f=PP64.adapters.events.getEvent("CHAINMERGE");f._parse3=function(e,t){var n="16092DD153432852C141C78807ECCBF0",a="0855E7309F121915D7A762AB85A7FDB6",r=void 0,s=void 0;if(d([e.buffer,t.offset,8],n)&&0<=[201569894,201597703].indexOf(e.getUint32(t.offset+16))&&d([e.buffer,t.offset+24,8],a)){if(r=1e3<(r=e.getUint16(t.offset+14))?0:r,s=0===e.getUint16(t.offset+20)?t.chains[r][0]:t.chains[r][e.getUint16(t.offset+22)],!isNaN(s)){if(t.board.links.hasOwnProperty(t.curSpace))return!1;PP64.boards.addConnection(t.curSpace,s,t.board)}var i=g.get(f.id)||{};if(!i[t.game]){i[t.game]={asm:e.buffer.slice(t.offset,t.offset+36)};var o=new DataView(i[t.game].asm);o.setUint32(8,0),o.setUint32(12,0),o.setUint32(20,0),g.set(f.id,i)}return!0}return!1};var c=PP64.adapters.events.getEvent("CHAINSPLIT");c._parse3=function(e,t){var n="16092DD153432852C141C78807ECCBF0",a="6FF6DF70CDC85862F8F129303009A544";if(d([e.buffer,t.offset,8],n)&&d([e.buffer,t.offset+36,20],a)){var r=2147483647&(e.getUint16(t.offset+10)<<16|e.getUint16(t.offset+14));32768&r&&(r-=65536);for(var s=t.offset-(t.addr-r),i=e.getUint16(s);65535!==i;)PP64.boards.addConnection(t.curSpace,i,t.board),s+=2,i=e.getUint16(s);var o=g.get(c.id);if(o||(o={}),o[t.game]||(o[t.game]={}),!o[t.game].asm){o[t.game].asm=e.buffer.slice(t.offset,t.offset+56);var f=new DataView(o[t.game].asm);f.setUint32(8,0),f.setUint32(12,0),f.setUint32(16,0),f.setUint32(20,0),f.setUint32(24,0),f.setUint32(32,0)}return g.set(c.id,o),!0}return!1},c._write3=function(e,t,n,a){var r=g.get(c.id);if(!r||!r[n.game]||!r[n.game].asm)throw"Cannot write "+c.id+", missing cache entry values.";var s=r[n.game].asm;PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength);var i=$MIPS.getRegSetUpperAndLower(n.argsAddr),o=_slicedToArray(i,2),f=o[0],d=o[1];e.setUint32(8,$MIPS.makeInst("LUI",$MIPS.REG.A0,f)),e.setUint32(12,$MIPS.makeInst("ADDIU",$MIPS.REG.A0,$MIPS.REG.A0,d));var I=$MIPS.getRegSetUpperAndLower(n.argsAddr+20),u=_slicedToArray(I,2);return f=u[0],d=u[1],e.setUint32(16,$MIPS.makeInst("LUI",$MIPS.REG.A1,f)),e.setUint32(20,$MIPS.makeInst("ADDIU",$MIPS.REG.A1,$MIPS.REG.A1,d)),e.setUint32(24,$MIPS.makeInst("LUI",$MIPS.REG.A2,32786)),e.setUint32(32,$MIPS.makeInst("ADDIU",$MIPS.REG.A2,$MIPS.REG.A2,55380)),t._reverse&&(e.setUint32(36,0),e.setUint32(40,0)),[n.offset,s.byteLength]};var I=PP64.adapters.events.createEvent("REVERSECHAINSPLIT","");I.fakeEvent=!0,I.activationType=$activationType.WALKOVER,I.executionType=$executionType.DIRECT,I.supportedGames=[$gameType.MP3_USA],I.parse=function(e,t){if(!d([e.buffer,t.offset,48],"0909C95D982B8A9B1F096AC54FFFB816"))return!1;var n=g.get(I.id)||{};return n[t.game]||(n[t.game]={asm:e.buffer.slice(t.offset,t.offset+$MIPS.getFunctionLength(e,t.offset))},g.set(I.id,n)),!0},I.write=function(e,t,n,a){var r=g.get(I.id);if(!r||!r[n.game]||!r[n.game].asm)throw"Cannot write "+I.id+", missing cache entry values.";t._reverse=!0;var s=c._write3(e,t,n,a),i=_slicedToArray(s,2),o=(i[0],i[1]),f=r[n.game].asm;PP64.utils.arrays.copyRange(e,f,o,0,f.byteLength);var d=2147483647&n.addr;return e.setUint32(o+48,$MIPS.makeInst("JAL",d)),[n.offset+o,o+f.byteLength]};var P=PP64.adapters.events.createEvent("GATECHAINSPLIT","");P.fakeEvent=!0,P.activationType=$activationType.WALKOVER,P.executionType=$executionType.PROCESS,P.supportedGames=[$gameType.MP3_USA],P.parse=function(e,t){if(!d([e.buffer,t.offset,68],"A99A70CBC4A1F9509AAB966831FC584E"))return!1;var n=2147483647&(e.getUint16(t.offset+126)<<16|e.getUint16(t.offset+130));32768&n&&(n-=65536);for(var a=t.offset-(t.addr-n),r=e.getUint16(a);65535!==r;)PP64.boards.addConnection(t.curSpace,r,t.board),a+=2,r=e.getUint16(a);var s=g.get(P.id)||{};return s[t.game]||(s[t.game]={asm:e.buffer.slice(t.offset,t.offset+$MIPS.getFunctionLength(e,t.offset))},g.set(P.id,s)),!0},P.write=function(e,t,n,a){var r=g.get(P.id);if(!r||!r[n.game]||!r[n.game].asm)throw"Cannot write "+P.id+", missing cache entry values.";var s=r[n.game].asm;PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),e.setUint16(70,t.prevSpace),e.setUint32(92,$MIPS.makeInst("ADDIU",$MIPS.REG.A1,$MIPS.REG.R0,t.altChain[0])),e.setUint32(104,$MIPS.makeInst("ADDIU",$MIPS.REG.A2,$MIPS.REG.R0,t.altChain[1]));var i=$MIPS.getRegSetUpperAndLower(n.argsAddr),o=_slicedToArray(i,2),f=o[0],d=o[1];e.setUint32(124,$MIPS.makeInst("LUI",$MIPS.REG.A0,f)),e.setUint32(128,$MIPS.makeInst("ADDIU",$MIPS.REG.A0,$MIPS.REG.A0,d));var I=$MIPS.getRegSetUpperAndLower(n.argsAddr+20),u=_slicedToArray(I,2);return f=u[0],d=u[1],e.setUint32(132,$MIPS.makeInst("LUI",$MIPS.REG.A1,f)),e.setUint32(136,$MIPS.makeInst("ADDIU",$MIPS.REG.A1,$MIPS.REG.A1,d)),[n.offset,s.byteLength]};var e=PP64.adapters.events.getEvent("STAR");e._parse3=function(e,t){return!!d([e.buffer,t.offset,956],"E9B6C28983AAE724AC187EA8E0CBC79D")},e._write3=function(e,t,n,a){return[3276836,0]};var t=PP64.adapters.events.getEvent("BOO");t._parse3=function(e,t){var n=!1;if(0===t.boardIndex){if(3291628!==t.offset)return!1;if(201568050!==e.getUint32(t.offset+76))return!1;n=4564===$MIPS.getFunctionLength(e,t.offset)}return!!n},t._write3=function(e,t,n,a){if(0===n.boardIndex){var r=PP64.romhandler.getDataView();r.setUint16(3291818,n.curSpaceIndex);for(var s=PP64.boards.getSpacesOfSubType($spaceSubType.BOO,n.board),i=n.curSpace,o=Number.MAX_VALUE,f=n.board._deadSpace,d=0;d<s.length;d++){var I=s[d],u=n.board.spaces[I],g=PP64.utils.number.distance(i.x,i.y,u.x,u.y);g<o&&(o=g,f=I)}return r.setUint16(3291946,f),r.setUint16(3291958,f),[3291628,0]}throw"Can't write Boo to board index "+n.boardIndex};var n=PP64.adapters.events.getEvent("BANK");n._parse3=function(e,t){return!!d([e.buffer,t.offset,180],"FCA0025616E8B2BE4CD60F47EE60DC30")},n._write3=function(e,t,n,a){var r=a.curBank=a.curBank||1;a.curBank++;for(var s=PP64.boards.getSpacesOfSubType($spaceSubType.BANK,n.board),i=n.curSpace,o=Number.MAX_VALUE,f=n.board._deadSpace,d=0;d<s.length;d++){var I=s[d],u=n.board.spaces[I],g=PP64.utils.number.distance(i.x,i.y,u.x,u.y);g<o&&(o=g,f=I)}if(0===n.boardIndex){var c=PP64.romhandler.getDataView();return 1===r?(c.setUint16(3277914,n.curSpaceIndex),c.setUint16(3277994,n.curSpaceIndex),c.setUint16(3277978,f),c.setUint16(3277986,f)):2===r&&(c.setUint16(3277922,n.curSpaceIndex),c.setUint16(3277962,n.curSpaceIndex),c.setUint16(3277942,f),c.setUint16(3277950,f)),[3277776,0]}throw"Can't write Bank to board index "+n.boardIndex};var a=PP64.adapters.events.getEvent("ITEMSHOP");a._parse3=function(e,t){var n=!1;if(0===t.boardIndex){if(3281356!==t.offset)return!1;if(201574479!==e.getUint32(t.offset+68))return!1;n=!0}return!!n},a._write3=function(e,t,n,a){var r=a.curItemShop=a.curItemShop||1;a.curItemShop++;for(var s=PP64.boards.getSpacesOfSubType($spaceSubType.ITEMSHOP,n.board),i=n.curSpace,o=Number.MAX_VALUE,f=n.board._deadSpace,d=0;d<s.length;d++){var I=s[d],u=n.board.spaces[I],g=PP64.utils.number.distance(i.x,i.y,u.x,u.y);g<o&&(o=g,f=I)}if(0===n.boardIndex){var c=PP64.romhandler.getDataView(),P=3281356;return 1===r?(c.setUint16(P+162,n.curSpaceIndex),c.setUint16(P+214,n.curSpaceIndex),c.setUint16(P+190,f),c.setUint16(P+202,f)):2===r&&(c.setUint16(P+170,n.curSpaceIndex),c.setUint16(P+254,n.curSpaceIndex),c.setUint16(P+178,f),c.setUint16(P+242,f)),[P,0]}throw"Can't write Item Shop to board index "+n.boardIndex};var r=PP64.adapters.events.getEvent("GATE");r._parse3=function(e,t){if(0===t.boardIndex){if(3274312!==t.offset)return!1;if(e.getUint16(t.offset+98)===t.curSpaceIndex)return t.board.spaces[e.getUint16(t.offset+262)].subtype=$spaceSubType.GATE,!0;if(e.getUint16(t.offset+106)===t.curSpaceIndex)return t.board.spaces[e.getUint16(t.offset+270)].subtype=$spaceSubType.GATE,!0}return!1},r._write3=function(e,t,n,a){var r=[3274312][n.boardIndex];if(n.curSpaceIndex!==t.gateEntryIndex)return[r,0];var s=a.curGate=a.curGate||1;if($$log("curGate "+s),a.curGate++,0===n.boardIndex){var i=PP64.romhandler.getDataView();return 1===s?(i.setUint16(3275130,t.gatePrevChain[0]),i.setUint32(3275136,$MIPS.makeInst("ADDIU",$MIPS.REG.A2,$MIPS.REG.R0,t.gatePrevChain[1])),i.setUint16(r+98,t.gateEntryIndex),i.setUint16(r+238,t.gateEntryIndex),i.setUint16(r+554,t.gateEntryIndex),i.setUint16(r+806,t.gateEntryIndex),i.setUint32(3274836,$MIPS.makeInst("ADDIU",$MIPS.REG.V0,$MIPS.REG.R0,t.gateEntryIndex)),i.setUint32(3274840,$MIPS.makeInst("BEQ",$MIPS.REG.S1,$MIPS.REG.V0,20)),i.setUint32(3275088,$MIPS.makeInst("ADDIU",$MIPS.REG.V0,$MIPS.REG.R0,t.gateEntryIndex)),i.setUint32(3275092,$MIPS.makeInst("BEQ",$MIPS.REG.S1,$MIPS.REG.V0,20)),i.setUint16(r+262,t.gateSpaceIndex),i.setUint16(r+122,t.gateExitIndex),i.setUint16(r+230,t.gateExitIndex),i.setUint16(r+534,t.gateExitIndex),i.setUint16(r+786,t.gateExitIndex),i.setUint16(3275106,t.gateNextChain[0]),i.setUint16(3275158,t.gateNextChain[1])):2===s&&(i.setUint16(3275162,t.gatePrevChain[0]),i.setUint16(3275170,t.gatePrevChain[1]),i.setUint16(r+106,t.gateEntryIndex),i.setUint16(r+518,t.gateEntryIndex),i.setUint16(r+766,t.gateEntryIndex),i.setUint16(r+270,t.gateSpaceIndex),i.setUint16(r+146,t.gateExitIndex),i.setUint16(3275114,t.gateNextChain[0]),i.setUint16(3275190,t.gateNextChain[1]),i.setUint16(3275186,t.gateNextChain[0])),[r,0]}throw"Can't write Gate to board index "+n.boardIndex};var i=PP64.adapters.events.getEvent("GATECLOSE");i._parse3=function(e,t){var n=$MIPS.getFunctionLength(e,t.offset);if(28!==n)return!1;if(e.getUint32(t.offset+8)!==[201597626][t.boardIndex])return!1;var a=g.get(i.id);return a||(a={}),a[t.game]||(a[t.game]={}),a[t.game][t.boardIndex]||(a[t.game][t.boardIndex]={}),a[t.game][t.boardIndex].asm||(a[t.game][t.boardIndex].asm=e.buffer.slice(t.offset,t.offset+n)),g.set(i.id,a),!0},i._write3=function(e,t,n,a){var r=g.get(i.id);if(!r||!r[n.game]||!r[n.game][n.boardIndex])throw"Cannot write "+i.id+", missing cache entry.";var s=r[n.game][n.boardIndex].asm;return PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),e.setUint32(12,$MIPS.makeInst("ADDIU",$MIPS.REG.A0,$MIPS.REG.R0,t.gateIndex)),[n.offset,s.byteLength]}}();
"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var r=0,a=Array(e.length);r<e.length;r++)a[r]=e[r];return a}return Array.from(e)}PP64.ns("adapters.events"),Object.assign(PP64.adapters.events,function(){var u={readDiscreteProperty:function(e,r){var a=new RegExp("^\\s*[;\\/]+\\s*"+r+":(.+)$","gim").exec(e);return a?a[1]:null},readDiscretePropertySet:function(e,r){for(var a=new RegExp("^\\s*[;\\/]+\\s*"+r+":(.+)$","gim"),t=null,n=[];(t=a.exec(e))&&n.push(t[1].trim()),t;);return n},readSupportedGames:function(e){var r=u.readDiscreteProperty(e,"GAMES");if(null!==r){for(var a=r.trim().split(","),t=[],n=0;n<a.length;n++){var s=a[n];$gameType[s]&&t.push($gameType[s])}return t}return null},readExecutionType:function(e){var r=u.readDiscreteProperty(e,"EXECUTION");return PP64.types.getExecutionTypeByName(r.trim())},readParameters:function(e){var r=u.readDiscretePropertySet(e,"PARAM"),t=[];return r.forEach(function(e){var r=e.split("|");if(2===r.length){var a={name:r[1],type:r[0]};try{u.validateParameters([a]),t.push(a)}catch(e){}}}),t},validParameterNameRegex:/^[\w\?\!]*$/,validateParameters:function(e){e&&e.forEach(function(e){if(!e.name)throw new Error("An event parameter didn't have a name");if(!e.type)throw new Error("An event parameter didn't have a type");if(!e.name.match(u.validParameterNameRegex))throw new Error("Event parameter name '"+e.name+"' is not valid");if(-1===PP64.types.EventParameterTypes.indexOf(e.type))throw new Error("Event parameter type "+e.type+" is not recognized")})},testAssemble:function(e,r){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},t={};r&&r.length&&r.forEach(function(e){t[e.name]=0});var n=c(e,r,Object.assign({addr:0,parameterValues:t},a));return MIPSAssem.assemble(n)}};function r(r){var e=u.readDiscreteProperty(r,"NAME");if(!e||!e.trim())throw new Error("Custom event must have a name");var a=(e=e.trim()).toUpperCase(),t=u.readExecutionType(r);if(!t)throw new Error("Custom even must have execution type");var n=u.readSupportedGames(r);if(!n)throw new Error("Custom even must have supported games list");var s=u.readParameters(r);u.validateParameters(s);for(var i=0;i<n.length;i++){var o=n[i];try{u.testAssemble(r,s,{game:o})}catch(e){throw new Error("Failed a test assembly for "+PP64.types.getGameName(o)+". The event may need adjustments before it can be used.\n\n"+e.toString())}}var m=PP64.adapters.events.createEvent(a,e);return m.custom=!0,m.asm=r,m.activationType=$activationType.LANDON,m.executionType=t,m.supportedGames=n,m.parameters=s,m.parse=function(e,r){return!1},m.write=function(e,r,a,t){$$log("Writing custom event",r,a);var n=c(r.asm,r.parameters,a),s=MIPSAssem.assemble(n);return PP64.utils.arrays.copyRange(e,s,0,0,s.byteLength),[a.offset,s.byteLength]},m.sizeOf=function(e){return u.testAssemble(r).byteLength},m}function c(e,r,t){var a=".org 0x"+t.addr.toString(16),n=PP64.symbols.getSymbols(t.game);n=n.map(function(e){return".definelabel "+e.name+",0x"+e.addr.toString(16)});var s=[];return r&&r.length&&t.parameterValues&&r.forEach(function(e){var r=t.parameterValues[e.name];switch(e.type){case"Boolean":s.push(".definelabel "+e.name+","+(r?1:0));break;case"Space":if(s.push(".definelabel "+e.name+","+r),t.chains){var a=PP64.adapters.boarddef.getChainIndexValuesFromAbsoluteIndex(t.chains,r);s.push(".definelabel "+e.name+"_chain_index,"+a[0]),s.push(".definelabel "+e.name+"_chain_space_index,"+a[1])}else s.push(".definelabel "+e.name+"_chain_index,-1"),s.push(".definelabel "+e.name+"_chain_space_index,-1");break;default:s.push(".definelabel "+e.name+","+r)}}),[a].concat(_toConsumableArray(n),s,[e,".align 4"]).join("\n")}var e=PP64.utils.localstorage.getSavedEvents();return e&&e.length&&e.forEach(function(e){if(e&&e.asm)try{r(e.asm)}catch(e){console.error("Error reading cached event: "+e.toString())}}),{createCustomEvent:r,CustomAsmHelper:u}}());
"use strict";var _createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.FORM=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"unpack",value:function(e){if(e instanceof DataView||(e=new DataView(e)),!PP64.utils.FORM.isForm(e))return null;var t=Object.create(null);t.entries=[];for(var r=8;r<e.byteLength-2;){var n=e.getUint32(r);"HBIN"===(n=PP64.utils.string.fromU32(n))&&(r+=4,n+=PP64.utils.string.fromU32(e.getUint32(r))),t.entries.push(n),r+=4;var a=e.getUint32(r);r+=4;var i={raw:e.buffer.slice(r,r+a)},s=PP64.utils.FORM.parseType(n,i.raw);s&&(i.parsed=s),t[n]=t[n]||[],t[n].push(i),r+=a+a%2}if(t.BMP1)for(var o=0;o<t.BMP1.length;o++){var l=t.BMP1[o];l.parsed=PP64.utils.FORM.parseBMP(l.raw,t.PAL1)}return t}},{key:"pack",value:function(e){var t=new ArrayBuffer(PP64.utils.FORM.getByteLength(e)),r=new DataView(t);r.setUint32(0,1179603533),r.setUint32(4,t.byteLength-8);for(var n={},a=8,i=0;i<e.entries.length;i++){var s=e.entries[i],o=n[s]||0;n[s]=o+1;for(var l=PP64.utils.string.toCharCodes(s),g=0;g<l.length;g++)r.setUint8(a,l[g]),a++;var u=e[s][o],c=u.raw.byteLength;r.setUint32(a,c),a+=4,PP64.utils.arrays.copyRange(r,u.raw,a,0,c),a+=c+c%2}return t}},{key:"isForm",value:function(e){return!!e&&(e instanceof DataView||(e=new DataView(e)),1179603533===e.getUint32(0))}},{key:"getByteLength",value:function(e){var t=0;for(var r in e)if("entries"!==r)for(var n=0;n<e[r].length;n++){var a=e[r][n].raw.byteLength;t+=a+a%2+r.length+4}return t+8}},{key:"parseType",value:function(e,t){switch(e){case"HBINMODE":return PP64.utils.FORM.parseHBINMODE(t);case"OBJ1":return PP64.utils.FORM.parseOBJ1(t);case"COL1":return PP64.utils.FORM.parseCOL1(t);case"MAT1":return PP64.utils.FORM.parseMAT1(t);case"ATR1":return PP64.utils.FORM.parseATR1(t);case"VTX1":return PP64.utils.FORM.parseVTX1(t);case"FAC1":return PP64.utils.FORM.parseFAC1(t);case"PAL1":return PP64.utils.FORM.parsePAL1(t);case"SKL1":return PP64.utils.FORM.parseSKL1(t);case"STRG":return PP64.utils.FORM.parseSTRG(t)}return null}},{key:"parseHBINMODE",value:function(e){var t=new DataView(e),r={E:t.getUint8(20),F:t.getUint8(21),G:t.getUint8(22)};return 69===r.E&&70===r.F&&71===r.G||console.warn("HBINMODE unexpected EFG => ",r),r}},{key:"parseOBJ1",value:function(e){for(var t=new DataView(e),r={objects:[],mystery1:t.getUint16(2)},n=t.getUint16(0),a=4,i=0;i<n;i++){var s=t.getUint16(a),o=t.getUint8(a+2),l=t.getUint16(a+3);a+=5;var g=void 0;switch(o){case 61:g={children:[]};for(var u=t.getUint16(a),c=0;c<u;c++)g.children.push(t.getUint16(a+2+2*c));Object.assign(g,PP64.utils.FORM._parseOBJ1Transforms(t,a+2+2*u));break;case 58:g={mystery1:t.getUint8(a),faceIndex:t.getUint16(a+1),faceCount:t.getUint16(a+3)},Object.assign(g,PP64.utils.FORM._parseOBJ1Transforms(t,a+5));break;case 16:g={skeletonGlobalIndex:t.getUint16(a)},Object.assign(g,PP64.utils.FORM._parseOBJ1Transforms(t,a+2));break;case 59:g={},console.warn("Object type 0x3B");break;case 62:g={};break;case 97:g={},Object.assign(g,PP64.utils.FORM._parseOBJ1Transforms(t,a));break;case 93:g={},console.warn("Object type 0x5D");break;default:console.warn("Unrecognized object type "+$$hex(o)),g={}}g.objType=o,g.globalIndex=l,r.objects.push(g),a+=s-3}return r}},{key:"_parseOBJ1Transforms",value:function(e,t){return{posX:e.getFloat32(t),posY:e.getFloat32(t+4),posZ:e.getFloat32(t+8),rotX:e.getFloat32(t+12),rotY:e.getFloat32(t+16),rotZ:e.getFloat32(t+20),scaleX:e.getFloat32(t+24),scaleY:e.getFloat32(t+28),scaleZ:e.getFloat32(t+32)}}},{key:"parseCOL1",value:function(e){for(var t=new DataView(e),r=[],n=t.getUint16(0),a=2,i=0;i<n;i++)r.push(t.getUint32(a)),a+=4;return r}},{key:"parseMAT1",value:function(e){for(var t=new DataView(e),r={materials:[]},n=t.getUint16(0),a=2,i=0;i<n;i++){var s={mystery1:t.getUint16(a),colorIndex:t.getUint16(a+2),mystery3:t.getUint16(a+4),mystery4:t.getFloat32(a+6),mystery5:t.getUint16(a+10)};r.materials.push(s),a+=12}return r}},{key:"parseATR1",value:function(e){for(var t=new DataView(e),r={atrs:[]},n=t.getUint16(0),a=2,i=0;i<n;i++){var s={size:t.getUint16(a),xBehavior:t.getUint8(a+5),yBehavior:t.getUint8(a+6),bmpGlobalIndex:t.getUint16(a+10)};r.atrs.push(s),a+=s.size+2}return r}},{key:"parseVTX1",value:function(e){for(var t=new DataView(e),r={vertices:[],scale:t.getFloat32(4)},n=t.getUint16(0),a=8,i=0;i<n;i++){var s={x:t.getInt16(a),y:t.getInt16(a+2),z:t.getInt16(a+4),normalX:t.getInt8(a+6),normalY:t.getInt8(a+7),normalZ:t.getInt8(a+8)};r.vertices.push(s),a+=9}return r}},{key:"parseFAC1",value:function(e){for(var t=new DataView(e),r={faces:[]},n=t.getUint16(0),a=8,i=0;i<n;i++){var s=t.getUint8(a);if(53!==s&&22!==s&&48!==s)throw new Error("Unrecognized faceType in FAC1: "+$$hex(s));var o={vtxEntries:[]};if(r.faces.push(o),a+=1,48===s)console.warn("Unsupported face type 0x30"),a+=6;else for(var l=53===s?4:3,g=0;g<l;g++)o.vtxEntries[g]={vertexIndex:t.getUint16(a),materialIndex:t.getInt16(a+2),u:t.getFloat32(a+4),v:t.getFloat32(a+8)},a+=12;o.materialIndex=t.getInt16(a),o.atrIndex=t.getInt16(a+2),o.mystery3=t.getUint8(a+4),54!==o.mystery3&&console.warn("Unsupported FAC1 mystery3 ",$$hex(o.mystery3)),a+=5}return r}},{key:"parsePAL1",value:function(e){var t=new DataView(e),r={colors:[],bpp:0,globalIndex:t.getUint16(0)},n=t.getUint16(2);r.bpp=8*Math.floor((e.byteLength-4)/n);for(var a=4,i=0;i<n;i++){if(32===r.bpp)r.colors.push(t.getUint32(a));else if(16===r.bpp)r.colors.push(t.getUint16(a));else{if(8!==r.bpp)throw"FORM.parseType(PAL1): bpp: "+r.bpp;r.colors.push(t.getUint8(a))}a+=r.bpp/8}return r}},{key:"parseSKL1",value:function(e){for(var t=new DataView(e),r=t.getUint8(2),n={globalIndex:t.getUint16(0),skls:[]},a=3,i=0;i<r;i++){var s={mystery1:t.getUint8(a),objGlobalIndex:t.getUint16(a+1),nextSiblingRelativeIndex:t.getUint16(a+51),isParentNode:t.getUint16(a+53),mystery2:t.getUint8(a+54)};Object.assign(s,PP64.utils.FORM._parseOBJ1Transforms(t,a+3)),n.skls.push(s),a+=56}return n}},{key:"parseSTRG",value:function(e){for(var t=new DataView(e),r=[],n=t.getUint16(0),a=2+n,i=0;i<n;i++){for(var s="",o=t.getUint8(2+i),l=0;l<o;l++)s+=String.fromCharCode(t.getUint8(a+l));a+=o,r.push(s)}return r}},{key:"parseBMP",value:function(e,t){var r=new DataView(e),n=r.getUint16(2),a=r.getUint16(5),i=r.getUint16(7);if(296===n||552===n){if(!t)throw"Palette needed for BMP format "+$$hex(n);for(var s=r.getUint16(9),o=r.getUint16(15),l=void 0,g=0;g<t.length;g++)if(t[g].parsed.globalIndex===s){l=t[g].parsed;break}if(!l)throw"Could not locate palette at global index "+s;var u=8/(a*i/o),c=l.bpp,f=new DataView(e,17,o);return{globalIndex:r.getUint16(0),origFormat:n,paletteGlobalIndex:s,width:a,height:i,src:PP64.utils.img.BMP.toRGBA(f,l.colors,u,c)}}if(295===n){var p=r.getUint8(4),v=r.getUint16(11);switch(p){case 16:return{globalIndex:r.getUint16(0),origFormat:n,width:a,height:i,src:PP64.utils.img.RGBA5551.toRGBA32(e.slice(13,13+v),a,i)};case 32:return{globalIndex:r.getUint16(0),origFormat:n,width:a,height:i,src:e.slice(13,13+v)};default:console.warn("BMP1 0x127 had unsupported bpp "+p)}}else{if(294===n){for(var h=r.getUint16(11),U=new ArrayBuffer(a*i*4),w=new DataView(U),y=0;y<h/3;y++){var P=r.getUint8(13+y)<<24|r.getUint8(13+y+1)<<16|r.getUint8(13+y+2)<<8|255,b=4*y;w.setUint32(b,P)}return{globalIndex:r.getUint16(0),origFormat:n,width:a,height:i,src:U}}if(293===n){for(var d=r.getUint16(11),F=new ArrayBuffer(4*d),O=new DataView(F),x=0;x<d;x++){var m=r.getUint8(13+x),B=240&m|(240&m)>>>4,I=B<<24|B<<16|B<<8|(15&m|(15&m)<<4),M=4*x;O.setUint32(M,I)}return{globalIndex:r.getUint16(0),origFormat:n,width:a,height:i,src:F}}if(292===n){for(var k=r.getUint16(11),R=new ArrayBuffer(8*k),A=new DataView(R),D=0,T=0;T<k;T++){var V=r.getUint8(13+T),C=(240&V)>>>4;C|=240&V,A.setUint32(D,C<<24|C<<16|C<<8|255),D+=4;var L=15&V;L|=L<<4,A.setUint32(D,L<<24|L<<16|L<<8|255),D+=4}return{globalIndex:r.getUint16(0),origFormat:n,width:a,height:i,src:R}}}return console.warn("Could not parse BMP format "+$$hex(n)),{globalIndex:r.getUint16(0),origFormat:n,width:a,height:i,src:new ArrayBuffer(a*i*4)}}},{key:"replaceBMP",value:function(e,t,r,n){PP64.utils.arrays.copyRange(e.BMP1[t].raw,r,17,0,r.byteLength),e.PAL1[t].parsed=n;var a=new DataView(e.PAL1[t].raw).getUint16(0),i=e.PAL1[t].raw=new ArrayBuffer(4+4*n.colors.length),s=new DataView(i);s.setUint16(0,a),s.setUint16(2,n.colors.length);for(var o=4,l=0;l<n.colors.length;l++)s.setUint32(o,n.colors[l]),o+=4}},{key:"getByGlobalIndex",value:function(e,t,r){if(!e[t])return null;for(var n=[],a=0;a<e[t].length;a++){var i=e[t][a].parsed;if(!i)throw"No parsed value for "+t;if(i.hasOwnProperty("globalIndex"))i.globalIndex===r&&n.push(i);else{var s=i;switch(t){case"OBJ1":s=i.objects}for(var o=0;o<s.length;o++){var l=s[o];if(!l.hasOwnProperty("globalIndex"))throw new Error("globalIndex is not a property of the searched "+t+" array in getByGlobalIndex");l.globalIndex===r&&n.push(l)}}}return n.length?1===n.length?n[0]:n:null}},{key:"getObjectsByType",value:function(e,t){for(var r=e.OBJ1[0].parsed.objects,n=[],a=0;a<r.length;a++)r[a].objType===t&&n.push(r[a]);return n}}]),e}();
"use strict";var _createClass=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.MTNX=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"isMtnx",value:function(e){return!!e&&(e instanceof DataView||(e=new DataView(e)),1297370712===e.getUint32(0))}},{key:"unpack",value:function(e){if(e instanceof DataView||(e=new DataView(e)),!PP64.utils.MTNX.isMtnx(e))return null;var t=Object.create(null);t.totalFrames=e.getUint16(10),t.tracks=[];for(var n=e.getUint16(8),a=e.getUint32(12),r=e.getUint32(16),i=e.getUint32(20),u=new DataView(e.buffer,e.byteOffset+a),l=new DataView(e.buffer,e.byteOffset+r),s=new DataView(e.buffer,e.byteOffset+i),f=0;f<n;f++){var c=e.getUint32(24+4*f),o=new DataView(e.buffer,e.byteOffset+c);t.tracks.push(PP64.utils.MTNX.parseTrack(o,f,u,l,s))}return t}},{key:"parseTrack",value:function(e,t,n,a,r){var i=Object.create(null);i.type=e.getUint8(0),i.dimension=e.getUint8(1),i.mystery1=e.getUint8(2),i.mystery2=e.getUint8(3),i.mystery3=e.getUint16(4),i.totalFrames=e.getUint16(6),i.mystery4=e.getUint8(8),i.objIndex=e.getUint8(9),i.keyframeCount=e.getUint16(14),i.d=n.getUint8(t);var u=e.getUint16(10),l=e.getUint16(12);i.keyframes=Object.create(null);for(var s=0;s<i.keyframeCount;s++){var f=a.getUint16(2*u+2*s);i.keyframes[f]=PP64.utils.MTNX.parseData(r,l,s)}return i}},{key:"parseData",value:function(e,t,n){var a=Object.create(null);return a.value1=e.getFloat32(4*t+12*n),a.value2=e.getFloat32(4*t+12*n+4),a.value3=e.getFloat32(4*t+12*n+8),a}},{key:"TrackType",get:function(){return{Transform:23,Rotation:76,Scale:27}}},{key:"Dimension",get:function(){return{X:69,Y:70,Z:71}}}]),e}();
"use strict";var _createClass=function(){function a(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,r,t){return r&&a(e.prototype,r),t&&a(e,t),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.FormToThreeJs=function(){function e(){_classCallCheck(this,e),this.bgColor=0,this.showTextures=!0,this.showWireframe=!1,this.showVertexNormals=!1,this.useFormCamera=!1}return _createClass(e,[{key:"createModel",value:function(e){var r=this._parseMaterials(e);return this._parseForm(e,r)}},{key:"_parseForm",value:function(e,r){var t=this._parseFormObj(e,r,0);return 1!==t.length&&console.warn("Expected 1 return object from _parseForm, got "+t.length),t[0]}},{key:"_parseFormObj",value:function(a,o,e){var n=this,r=PP64.utils.FORM.getByGlobalIndex(a,"OBJ1",e);if(null===r&&(0===e&&(r=a.OBJ1[0].parsed.objects[0],console.warn("Using first object rather than global index 0 object")),!r))throw"Attempted to get unavailable OBJ "+e;Array.isArray(r)||(r=[r]);for(var s=[],t=0;t<r.length;t++){var i=r[t];if(61===i.objType)!function(){for(var r=n._createObject3DFromOBJ1Entry(i),e=0;e<i.children.length;e++){var t=n._parseFormObj(a,o,i.children[e]);t&&t.length&&t.forEach(function(e){r.add(e)})}s.push(r)}();else if(16===i.objType){var l=this._createObject3DFromOBJ1Entry(i),u=i.skeletonGlobalIndex,c=this._parseFormSkl(a,o,u);l.add(c),s.push(l)}else if(58===i.objType){for(var h=this._createObject3DFromOBJ1Entry(i),m=new THREE.Geometry,d=i.faceIndex;d<i.faceIndex+i.faceCount;d++){var p=a.FAC1[0].parsed.faces[d];this._populateGeometryWithFace(a,m,p)}if(this.showTextures){var v=new THREE.Mesh(m,o);h.add(v)}if(this.showWireframe){var f=new THREE.LineBasicMaterial({color:PP64.utils.img.invertColor(this.bgColor),linewidth:this.showTexture?2:1}),x=new THREE.LineSegments(new THREE.EdgesGeometry(m),f);h.add(x)}if(this.showVertexNormals){var y=new THREE.VertexNormalsHelper(new THREE.Mesh(m,o),8,65280,1);h.add(y)}s.push(h)}}return s}},{key:"_createObject3DFromOBJ1Entry",value:function(e){var r=new THREE.Object3D;return e.hasOwnProperty("globalIndex")&&(r.name=this._getObjNameFromId(e.globalIndex)),r.position.x=e.posX,r.position.y=e.posY,r.position.z=e.posZ,r.rotation.x=$$number.degreesToRadians(e.rotX),r.rotation.y=$$number.degreesToRadians(e.rotY),r.rotation.z=$$number.degreesToRadians(e.rotZ),r.rotation.order="ZYX",r.scale.x=e.scaleX,r.scale.y=e.scaleY,r.scale.z=e.scaleZ,r}},{key:"_getObjNameFromId",value:function(e){return $$hex(e)}},{key:"_parseFormSkl",value:function(e,r,t){var a=PP64.utils.FORM.getByGlobalIndex(e,"SKL1",t);if(null===a||Array.isArray(a))throw"Unexpected SKL1 search result";return this._parseFormSklNode(e,r,a.skls,0)}},{key:"_parseFormSklNode",value:function(e,r,t,a){var o=t[a],n=this._createObject3DFromOBJ1Entry(o),s=o.objGlobalIndex,i=this._parseFormObj(e,r,s);if(i&&i.length&&i.forEach(function(e){n.add(e)}),o.isParentNode)for(var l=a+1;l;){var u=t[l],c=this._parseFormSklNode(e,r,t,l);if(n.add(c),!u.nextSiblingRelativeIndex)break;l+=u.nextSiblingRelativeIndex}return n}},{key:"_populateGeometryWithFace",value:function(e,r,t){if(t.vtxEntries.length){for(var a=e.VTX1[0].parsed.scale,o=t.vtxEntries,n=[],s=0;s<3;s++){var i=o[s],l=e.VTX1[0].parsed.vertices[i.vertexIndex];n.push(r.vertices.length),r.vertices.push(this._makeVertex(l,a))}if(4===o.length)for(var u=0;u<4;u++)if(1!==u){var c=o[u],h=e.VTX1[0].parsed.vertices[c.vertexIndex];n.push(r.vertices.length),r.vertices.push(this._makeVertex(h,a))}3===o.length?this._addFace(r,e,t,[n[0],n[1],n[2]],[o[0],o[1],o[2]]):4===o.length&&(this._addFace(r,e,t,[n[0],n[1],n[2]],[o[0],o[1],o[2]]),this._addFace(r,e,t,[n[3],n[4],n[5]],[o[0],o[2],o[3]]))}}},{key:"_addFace",value:function(e,r,t,a,o){var n=new THREE.Face3;n.a=a[0],n.b=a[1],n.c=a[2],n.vertexNormals=this._makeVertexNormals(r,o[0].vertexIndex,o[1].vertexIndex,o[2].vertexIndex),n.materialIndex=this._getMaterialIndex(t),n.color=new THREE.Color(this._getColorBytes(r,t)),n.vertexColors=this._makeVertexColors(r,t,o[0],o[1],o[2]),e.faceVertexUvs[0].push(this._makeVertexUVs(o[0],o[1],o[2])),e.faces.push(n)}},{key:"_parseMaterials",value:function(e){var r=[new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors}),new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors})];if(e.BMP1)if(e.ATR1&&e.ATR1[0])for(var t=e.ATR1[0].parsed.atrs,a=0;a<t.length;a++){var o=t[a],n=PP64.utils.FORM.getByGlobalIndex(e,"BMP1",o.bmpGlobalIndex);if(null===n||Array.isArray(n))console.warn("Unexpected bitmap result from global index lookup");else{var s=this._createTextureMaterial(o,n);r.push(s)}}else console.warn("BMPs, but no ATRs");return r}},{key:"_createTextureMaterial",value:function(e,r){var t=PP64.utils.arrays.arrayBufferToDataURL(r.src,r.width,r.height);$$log("Texture",t);var a=new THREE.TextureLoader;a.crossOrigin="";var o=a.load(t);return o.flipY=!1,o.wrapS=this._getWrappingBehavior(e.xBehavior),o.wrapT=this._getWrappingBehavior(e.yBehavior),new THREE.MeshBasicMaterial({alphaTest:.5,map:o,transparent:!0,vertexColors:THREE.VertexColors})}},{key:"_getWrappingBehavior",value:function(e){switch(e){case 44:return THREE.MirroredRepeatWrapping;case 45:return THREE.RepeatWrapping;case 46:return THREE.ClampToEdgeWrapping;default:return console.warn("Unknown behavior "+$$hex(e)),THREE.ClampToEdgeWrapping}}},{key:"_makeVertex",value:function(e,r){return new THREE.Vector3(e.x*r,e.y*r,e.z*r)}},{key:"_makeVertexNormals",value:function(e,r,t,a){return[this._makeVertexNormal(e,r),this._makeVertexNormal(e,t),this._makeVertexNormal(e,a)]}},{key:"_makeVertexNormal",value:function(e,r){var t=e.VTX1[0].parsed.vertices[r];return new THREE.Vector3(t.normalX/(127+(t.normalX<0?1:0)),t.normalY/(127+(t.normalY<0?1:0)),t.normalZ/(127+(t.normalZ<0?1:0)))}},{key:"_makeVertexUVs",value:function(e,r,t){return[this._makeVertexUV(e),this._makeVertexUV(r),this._makeVertexUV(t)]}},{key:"_makeVertexUV",value:function(e){return new THREE.Vector2(e.u,e.v)}},{key:"_getMaterialIndex",value:function(e){return 0<=e.atrIndex||54===e.mystery3?e.atrIndex+2:55===e.mystery3?0:void 0}},{key:"_getColorBytes",value:function(e,r){if(54===r.mystery3){var t=r.materialIndex;return this._getColorFromMaterial(e,t)}if(55===r.mystery3)return 16776192;console.warn("Could not determine color for face")}},{key:"_getColorFromMaterial",value:function(e,r){if(e.MAT1&&e.MAT1[0]&&e.MAT1[0].parsed){var t=e.MAT1[0].parsed.materials[r].colorIndex;if(e.COL1&&e.COL1[0]&&e.COL1[0].parsed&&e.COL1[0].parsed.hasOwnProperty(t))return e.COL1[0].parsed[t]>>>8}return console.warn("Could not find color "+colorIndex+" specified by material "+r),16776192}},{key:"_makeVertexColors",value:function(e,r,t,a,o){return 55!==r.mystery3?[]:[this._makeVertexColor(e,t),this._makeVertexColor(e,a),this._makeVertexColor(e,o)]}},{key:"_makeVertexColor",value:function(e,r){return r.materialIndex<0?null:new THREE.Color(this._getColorFromMaterial(e,r.materialIndex))}},{key:"createCamera",value:function(e,r,t){var a=new THREE.PerspectiveCamera(75,r/t,1,999999);if(this.useFormCamera){var o=PP64.utils.FORM.getObjectsByType(e,97);if(3===o.length){var n=o[0],s=o[1];return a.position.set(n.posX,n.posY,n.posZ),a.lookAt(new THREE.Vector3(s.posX,s.posY,s.posZ)),a}console.warn("Unexpected camera object count: "+o.length)}return a.position.z=500,a}}]),e}();
"use strict";var _createClass=function(){function t(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.MtnxToThreeJs=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"createClip",value:function(e){var r=this._createTracks(e),a=this._framesToSeconds(e.totalFrames);return new THREE.AnimationClip("MTNX",a,r)}},{key:"_createTracks",value:function(e){for(var r=[],a=0;a<e.tracks.length;a++){var t=this._createTrack(e.tracks[a]);t&&r.push(t)}return this._adjustTrackOrder(r),r}},{key:"_createTrack",value:function(e){var r=PP64.utils.MTNX.TrackType;switch(e.type){case r.Transform:return this._createTransformTrack(e);case r.Rotation:return this._createRotationTrack(e);case r.Scale:return this._createScaleTrack(e)}console.warn("Unsupported track type "+$$hex(e.type))}},{key:"_createTransformTrack",value:function(e){var r=this._createTransformTrackName(e),a=this._createKeyframeSecsArr(e.keyframes),t=this._createTransformTrackData(e);return new THREE.VectorKeyframeTrack(r,a,t)}},{key:"_createTransformTrackName",value:function(e){return this._getObjNameFromIndex(e.objIndex)+".position["+this._getDimensionProperty(e.dimension)+"]"}},{key:"_createTransformTrackData",value:function(e){var r=[];for(var a in e.keyframes){var t=e.keyframes[a].value1;r.push(t)}return r}},{key:"_createRotationTrack",value:function(e){var r=this._createRotationTrackName(e),a=this._createKeyframeSecsArr(e.keyframes),t=this._createRotationTrackData(e);return new THREE.VectorKeyframeTrack(r,a,t)}},{key:"_createRotationTrackName",value:function(e){return this._getObjNameFromIndex(e.objIndex)+".rotation["+this._getDimensionProperty(e.dimension)+"]"}},{key:"_createRotationTrackData",value:function(e){var r=[];for(var a in e.keyframes){var t=e.keyframes[a].value1,n=$$number.degreesToRadians(t);r.push(n)}return r}},{key:"_createQuaternion",value:function(e,r){var a=new THREE.Quaternion,t=$$number.degreesToRadians(r),n=PP64.utils.MTNX.Dimension;switch(e){case n.X:a.setFromAxisAngle(new THREE.Vector3(1,0,0),t);break;case n.Y:a.setFromAxisAngle(new THREE.Vector3(0,1,0),t);break;case n.Z:a.setFromAxisAngle(new THREE.Vector3(0,0,1),t);break;default:console.warn("Didn't set quaternion value for "+$$hex(e))}return a}},{key:"_createScaleTrack",value:function(e){var r=this._createScaleTrackName(e),a=this._createKeyframeSecsArr(e.keyframes),t=this._createScaleTrackData(e);return new THREE.VectorKeyframeTrack(r,a,t)}},{key:"_createScaleTrackName",value:function(e){return this._getObjNameFromIndex(e.objIndex)+".scale["+this._getDimensionProperty(e.dimension)+"]"}},{key:"_createScaleTrackData",value:function(e){var r=[];for(var a in e.keyframes){var t=e.keyframes[a].value1;r.push(t)}return r}},{key:"_createKeyframeSecsArr",value:function(e){var r=[];for(var a in e)r.push(this._framesToSeconds(parseInt(a)));return r}},{key:"_getDimensionProperty",value:function(e){var r=PP64.utils.MTNX.Dimension;switch(e){case r.X:return"x";case r.Y:return"y";case r.Z:return"z"}throw"Unknown dimension "+$$hex(e)}},{key:"_getObjNameFromIndex",value:function(e){for(var r=-1,a=this.form.OBJ1[0].parsed.objects,t=0;t<a.length;t++)if(61===a[t].objType&&++r===e)return $$hex(a[t].globalIndex);return console.warn("Couldn't find associated object "+e+" for track"),$$hex(e)}},{key:"_framesToSeconds",value:function(e){return e/60}},{key:"_adjustTrackOrder",value:function(e){}}]),e}();
"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils"),PP64.utils.dump=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e){for(var t=new JSZip,n=t.folder("mainfs"),i=PP64.fs.mainfs.getDirectoryCount(),a=0;a<i;a++)for(var r=n.folder(a.toString()),s=PP64.fs.mainfs.getFileCount(a),o=0;o<s;o++){var f=PP64.fs.mainfs.get(a,o),P=o.toString();PP64.utils.FORM.isForm(f)?P+=".form":PP64.utils.MTNX.isMtnx(f)&&(P+=".mtnx"),r.file(P,f)}t.generateAsync({type:"blob"}).then(e)}},{key:"load",value:function(e){(new JSZip).loadAsync(e).then(function(e){e.folder("mainfs").forEach(function(e,t){var n=e.match(/(\d+)\/(\d+)/);if(n){var i=parseInt(n[1]),a=parseInt(n[2]);isNaN(i)||isNaN(a)||t.async("arraybuffer").then(function(e){$$log("Overwriting MainFS "+i+"/"+a),PP64.fs.mainfs.write(i,a,e)})}})},function(e){$$log(e),PP64.app.showMessage("Something went wrong while loading the zip. "+e)})}},{key:"images",value:function(){for(var e=new JSZip,i=e.folder("mainfs"),t=PP64.fs.mainfs.getDirectoryCount(),n=function(s){for(var o=i.folder(s.toString()),e=PP64.fs.mainfs.getFileCount(s),t=function(i){try{var e=PP64.fs.mainfs.get(s,i);if(PP64.utils.FORM.isForm(e)){var t=PP64.utils.FORM.unpack(e);t.BMP1.length&&t.BMP1.forEach(function(e,t){var n=PP64.utils.arrays.arrayBufferToDataURL(e.parsed.src,e.parsed.width,e.parsed.height);o.file(i+"."+t+".png",n.substr(n.indexOf(",")+1),{base64:!0})})}else{var n=function(e,t){var n=PP64.fs.mainfs.get(e,t),i=PP64.utils.img.ImgPack.fromPack(n);if(!i||!i.length)return;return i}(s,i);if(n.forEach(function(e,t){var n=PP64.utils.arrays.arrayBufferToDataURL(e.src,e.width,e.height);o.file(i+"."+t+".png",n.substr(n.indexOf(",")+1),{base64:!0})}),1<n.length){var a=PP64.utils.img.tiler.fromTiles(function(e,t){var n=PP64.fs.mainfs.get(e,t),i=PP64.utils.img.ImgPack.fromPack(n);if(!i||!i.length)return;return i.map(function(e){return new DataView(e.src)})}(s,i),n.length,1,4*n[0].width,n[0].height),r=PP64.utils.arrays.arrayBufferToDataURL(a,n[0].width*n.length,n[0].height);o.file(i+".all.png",r.substr(r.indexOf(",")+1),{base64:!0})}}}catch(e){}},n=0;n<e;n++)t(n)},a=0;a<t;a++)n(a);e.generateAsync({type:"blob"}).then(function(e){saveAs(e,"mp"+PP64.romhandler.getGameVersion()+"-images.zip")})}},{key:"formImages",value:function(){for(var e=PP64.fs.mainfs.getDirectoryCount(),t=function(i){for(var e=PP64.fs.mainfs.getFileCount(i),t=function(n){var e=PP64.fs.mainfs.get(i,n);if(!PP64.utils.FORM.isForm(e))return"continue";try{var t=PP64.utils.FORM.unpack(e);t.BMP1.length&&t.BMP1.forEach(function(e){var t=PP64.utils.arrays.arrayBufferToDataURL(e.parsed.src,e.parsed.width,e.parsed.height);console.log(i+"/"+n+":"),console.log(t)})}catch(e){}},n=0;n<e;n++)t(n)},n=0;n<e;n++)t(n)}},{key:"strings3",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=PP64.fs.strings3.getDirectoryCount("en"),i=0;i<n;i++)for(var a=PP64.fs.strings3.getStringCount("en",i),r=0;r<a;r++){var s=PP64.fs.strings3.read("en",i,r);if(!(s.indexOf(e)<0)){var o=i+"/"+r+":\n"+s;t&&(o+="\n"+PP64.utils.arrays.toHexString(PP64.fs.strings3.read("en",i,r,!0))),console.log(o)}}}},{key:"strings",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=PP64.fs.strings.getStringCount(),i=0;i<n;i++){var a=PP64.fs.strings.read(i);if(!(a.indexOf(e)<0)){var r=i+":\n"+a;t&&(r+="\n"+PP64.utils.arrays.toHexString(PP64.fs.strings.read(i,!0))),console.log(r)}}}},{key:"saveWaluigi",value:function(){if(3!==PP64.romhandler.getGameVersion())throw"Waluigi is not in game "+PP64.romhandler.getGameVersion();window.waluigiParts=[];for(var e=0;e<163;e++)window.waluigiParts.push(PP64.fs.mainfs.get(8,e));return window.waluigiParts}},{key:"writeWaluigi",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;if(1!==PP64.romhandler.getGameVersion())throw"Waluigi cannot write to MP"+PP64.romhandler.getGameVersion();if(!window.waluigiParts)throw"Need to call saveWaluigi first!";163===window.waluigiParts.length&&window.waluigiParts.splice(158,2);for(var t=0;t<window.waluigiParts.length;t++)PP64.fs.mainfs.write(e,t,window.waluigiParts[t])}},{key:"saveDaisy",value:function(){if(3!==PP64.romhandler.getGameVersion())throw"Daisy is not in game "+PP64.romhandler.getGameVersion();return window.daisyParts=[],window.daisyParts.push(PP64.fs.mainfs.get(9,1)),window.daisyParts.push(PP64.fs.mainfs.get(9,3)),window.daisyParts}},{key:"writeDaisy",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:6;if(1!==PP64.romhandler.getGameVersion())throw"Daisy cannot write to MP"+PP64.romhandler.getGameVersion();if(!window.daisyParts)throw"Need to call saveDaisy first!";PP64.fs.mainfs.write(e,158,window.daisyParts[0]),PP64.fs.mainfs.write(e,159,window.daisyParts[1])}},{key:"searchForPatchLocations",value:function(e){if(!e)throw"Please pass a ROM offset the game tries to read at runtime";for(var t=(4294901760&e)>>>16,n=65535&e,i=0,a=PP64.romhandler.getDataView(),r=a.byteLength-10,s=2;s<r;s+=2){var o=a.getUint16(s);if(o===t||o+1===t||o-1===t){var f=0;(8<s&&a.getUint16(f=s-8)===n||4<s&&a.getUint16(f=s-4)===n||a.getUint16(f=s+2)===n||a.getUint16(f=s+3)===n||a.getUint16(f=s+4)===n||a.getUint16(f=s+5)===n||a.getUint16(f=s+6)===n||a.getUint16(f=s+7)===n||a.getUint16(f=s+8)===n||a.getUint16(f=s+9)===n||a.getUint16(f=s+10)===n||a.getUint16(f=s+12)===n||a.getUint16(f=s+16)===n||a.getUint16(f=s+20)===n)&&(console.log("Found "+$$hex(s)+", "+$$hex(f)+" ("+(f-s)+") Lower inst: "+$$hex(a.getUint16(f-2))),i++)}}console.log("Found "+i+" possible locations")}},{key:"printSceneTable",value:function(){var e=PP64.adapters.getROMAdapter();if(e&&e.SCENE_TABLE_ROM){for(var t=PP64.fs.scenes.count(),n=[],i=0;i<t;i++){var a=PP64.fs.scenes.getInfo(i);n.push({i:$$hex(i),rom_start:$$hex(a.rom_start),rom_end:$$hex(a.rom_end),code_start:$$hex(a.code_start),rodata_start:$$hex(a.rodata_start),bss_start:$$hex(a.bss_start),bss_end:$$hex(a.bss_end)})}console.table(n)}else console.log("ROM is not loaded, or scene table location is unknown")}},{key:"printAsm",value:function(e,t){for(var n=PP64.romhandler.getDataView(),i=e,a=[];i<=t;){var r=n.getUint32(i),s="? "+$$hex(r);try{s=MIPSInst.print(r)}catch(e){console.log("UNRECOGNIZED: "+$$hex(r))}a.push($$hex(i)+": "+s),i+=4}console.log(a.join("\n"))}},{key:"printSceneAsm",value:function(e){for(var t=PP64.fs.scenes.getInfo(e),n=t.code_start,i=PP64.fs.scenes.getCodeDataView(e),a=[],r=0;r<i.byteLength;r+=4){var s=i.getUint32(r),o="? "+$$hex(s);try{o=MIPSInst.print(s)}catch(e){console.log("UNRECOGNIZED: "+$$hex(s))}a.push($$hex(n)+": "+o),n+=4}console.log(a.join("\n"));var f=PP64.fs.scenes.getRoDataView(e),P=[];n=t.rodata_start;for(var l=0;l<f.byteLength;)P.push($$hex(n)+": "+PP64.utils.string.pad($$hex(f.getUint32(l),""),8,"0")+" "+PP64.utils.string.pad($$hex(f.getUint32(l+4),""),8,"0")+" "+PP64.utils.string.pad($$hex(f.getUint32(l+8),""),8,"0")+" "+PP64.utils.string.pad($$hex(f.getUint32(l+12),""),8,"0")),n+=16,l+=16;console.log(P.join("\n"))}}]),e}();
"use strict";var _createClass=function(){function n(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,e,t){return e&&n(r.prototype,e),t&&n(r,t),r}}();function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.tiler=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"fromTiles",value:function(r,e,t,n,o){for(var a=e*n,i=t*o,l=new ArrayBuffer(a*i),f=new DataView(l),u=void 0,s=void 0,c=void 0,v=void 0,h=void 0,d=void 0,w=void 0,y=void 0,C=0;C<i;C++){s=C%o,v=Math.floor(C/o)*e,d=s*n,y=C*a;for(var p=0;p<a;p+=4)u=p%n,c=v+Math.floor(p/n),h=d+u,w=y+p,f.setUint32(w,r[c].getUint32(h))}return l}},{key:"toTiles",value:function(r,e,t,n,o){for(var a=e*n,i=t*o,l=[],f=[],u=e*t,s=0;s<u;s++)l.push(new ArrayBuffer(n*o)),f.push(new DataView(l[s]));for(var c=void 0,v=0;v<i;v++){c=Math.floor(v/o)*e;for(var h=0;h<a;h++){var d=v%o*n+h%n,w=v*a+h;f[c+Math.floor(h/n)].setUint8(d,r[w])}}return l}}]),r}();
"use strict";var _createClass=function(){function a(r,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}return function(r,e,n){return e&&a(r.prototype,e),n&&a(r,n),r}}();function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.RGBA5551=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"toRGBA32",value:function(r,e,n){for(var a=new ArrayBuffer(e*n*4),t=new Uint8Array(a),i=new DataView(r),u=0,l=0;l<e*n;l++){var o=i.getUint16(2*l);t[u]=8*((63488&o)>>>11),t[u+1]=8*((1984&o)>>>6),t[u+2]=8*((62&o)>>>1),t[u+3]=1&o?255:0,u+=4}return a}},{key:"fromRGBA32",value:function(r,e,n){for(var a=new ArrayBuffer(e*n*2),t=new DataView(a),i=new Uint8Array(r),u=0,l=0;l<e*n;l++){var o=i[u]/8;o<<=11;var c=i[u+1]/8;c<<=6;var f=i[u+2]/8;f<<=1;var s=i[u+3]>>>7;t.setUint16(2*l,65535&(o|c|f|s)),u+=4}return a}}]),r}();
"use strict";var _createClass=function(){function a(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.RGBA32=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"make8Bit",value:function(e,n,t){for(var a=0;a<n*t;a++){var r=e[a];r&=3233857728,r|=r>>>2,r|=r>>>2,r|=r>>>2,e[a]=r}}}]),e}();
"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.HVQ=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"decode",value:function(e){var t=e.getUint32(0),n=1213616384==(4294967040&t);if(3===t){var r=new DataView(e.buffer,8),i=e.getUint32(4);return PP64.utils.compression.decompress(3,r,i)}if(!n)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(!window.PP64.utils.img.HVQ._blackRGB16){window.PP64.utils.img.HVQ._blackRGB16=new ArrayBuffer(6144);for(var a=new DataView(window.PP64.utils.img.HVQ._blackRGB16),u=0;u<3072;u++)a.setUint16(2*u,1)}return window.PP64.utils.img.HVQ._blackRGB16}},{key:"_getChunkOffset",value:function(e,t){return e.getUint32(32+4*t)}},{key:"_recursiveHuffmanBuild",value:function(e,t){if(1===PP64.utils.arrays.readBitAtOffset(e,t)){var n=a._recursiveHuffmanBuild(e,t+1);t=n.nextOffset;var r=a._recursiveHuffmanBuild(e,t),i=Object.create(null);return i[1]=n.node,i[0]=r.node,{nextOffset:r.nextOffset,node:i}}return{nextOffset:t+9,node:PP64.utils.arrays.readByteAtBitOffset(e,t+1)}}},{key:"encode",value:function(e,t,n){if(1<PP64.romhandler.getGameVersion()){var r=PP64.utils.compression.compress(3,new DataView(e)),i=new ArrayBuffer(r.byteLength+8),a=new DataView(i);return a.setUint32(0,3),a.setUint32(4,e.byteLength),PP64.utils.arrays.copyRange(a,r,8,0,r.byteLength),i}return e}}]),a}();
"use strict";var _createClass=function(){function t(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.Grayscale=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"toRGBA32",value:function(e,r,n,t){for(var a=new ArrayBuffer(r*n*4),i=new Uint8Array(a),l=new DataView(e),o=0,u=0;u<r*n;u++){var c;if(8===t)c=l.getUint8(u);else{if(4!==t)throw"bpp must be 4 or 8";c=l.getUint8(u/2)&(u%2?15:240),u%2==0&&(c>>=4,c&=15),c=c/15*255}i[o]=c,i[o+1]=c,i[o+2]=c,i[o+3]=255,o+=4}return a}},{key:"fromRGBA32",value:function(e,r,n,t){throw"Grayscale.fromRGBA32ArrayBuffer not implemented"}}]),e}();
"use strict";var _createClass=function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.BMP=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"toRGBA",value:function(t,e,n,r){var a=t;a instanceof DataView||(a=new DataView(t));for(var i=a.byteLength*(r/n),o=new ArrayBuffer(i),l=new DataView(o),s=0,c=0,f=void 0,u=r/8,g="setUint"+r;c<i;)if(8===n)f=a.getUint8(s),l[g](c,e[f]),s+=1,c+=u;else if(4===n)f=(240&a.getUint8(s))>>4,l[g](c,e[f]),c+=u,f=15&a.getUint8(s),l[g](c,e[f]),c+=u,s+=1;else{if(2!==n)throw"Cannot decode palette with bpp: "+n;f=(192&a.getUint8(s))>>6,l[g](c,e[f]),c+=u,f=(48&a.getUint8(s))>>4,l[g](c,e[f]),c+=u,f=(12&a.getUint8(s))>>2,l[g](c,e[f]),c+=u,f=3&a.getUint8(s),l[g](c,e[f]),c+=u,s+=1}return o}},{key:"fromRGBA",value:function(t,e,n){var r=t;r instanceof DataView||(r=new DataView(t));for(var a={colors:[],bpp:e},i={},o=e/8,l="getUint"+e,s=0;s<t.byteLength;){var c=r[l](s);i.hasOwnProperty(c.toString(16))?s+=o:(i[c.toString(16)]=a.colors.length,a.colors.push(c),s+=o)}var f=new ArrayBuffer(t.byteLength/o*(n/8)),u=new DataView(f),g="setUint"+n,w=0;for(s=0;w<f.byteLength;){if(8!==n)throw"Cannot encode palette with bpp: "+n;var h=i[r[l](s).toString(16)];u[g](w,h),s+=o,w++}return[f,a]}}]),t}();
"use strict";var _slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}PP64.ns("utils.img"),PP64.utils.img.ImgPack=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"fromPack",value:function(t){var e=new DataView(t),n=e.getUint32(0),i=e.getUint32(12),r=e.getUint16(16),a=e.getUint8(25),s=i!==e.byteLength,o=void 0;if(s)for(o=[];i!==e.byteLength;)o.push(e.getUint16(i)),i+=2;for(var l=[],c=n,g=new DataView(t,c),u=0;u<r;u++){var h=g.getUint32(0),f=g.getUint16(4),y=g.getUint16(6),v=void 0;v=8<=a?a*f*y/8*2:f*y/(8/a);var w=t.slice(h,h+v);s&&(w=PP64.utils.img.BMP.toRGBA(w,o,a,16));var U={width:f,height:y};32===a?U.src=w:16===a||s?U.src=PP64.utils.img.RGBA5551.toRGBA32(w,f,y):4!==a&&8!==a||(U.src=PP64.utils.img.Grayscale.toRGBA32(w,f,y,a)),l.push(U),c+=12,g=new DataView(t,c)}return l}},{key:"toPack",value:function(t,e,n,i){var r=PP64.utils.img.ImgPack.getByteLength(t,e),a=void 0,s=void 0;if(n){var o=PP64.utils.img.BMP.fromRGBA(t[0].src,t[0].bpp,8),l=_slicedToArray(o,2);a=l[0],s=l[1],t[0]._bmpData=a,r+=s.colors.length*(e/n),r-=t[0].src.byteLength-a.byteLength}var c=new ArrayBuffer(r),g=new DataView(c),u=void 0;i&&(u=new DataView(i)),g.setUint32(0,32),g.setUint32(4,44),g.setUint32(8,44),s?g.setUint32(12,r-s.colors.length*(e/n)):g.setUint32(12,r),g.setUint16(16,t.length),g.setUint16(18,0);for(var h=0,f=0,y=0;y<t.length;y++)h+=t[y].width,f+=t[y].height;if(g.setUint16(20,h),g.setUint16(22,f),u?g.setUint8(24,u.getUint8(24)):g.setUint8(24,0),g.setUint8(25,n||e),s){g.setUint8(26,s.colors.length);for(var v=r-s.colors.length*(e/n),w=0;w<s.colors.length;w++)g.setUint16(v+2*w,s.colors[w])}for(var U=32,p=0;p<t.length;p++)U=PP64.utils.img.ImgPack._writeEntry(g,U,t[p],e,u);return c}},{key:"getByteLength",value:function(t,e){for(var n=32,i=0;i<t.length;i++)n+=12,t[i].bpp===e?n+=t[i].src.byteLength:32===t[i].bpp&&16===e&&(n+=t[i].src.byteLength/2);return n}},{key:"_writeEntry",value:function(t,e,n,i,r){t.setUint32(e,e+12),t.setUint16(e+=4,n.width),t.setUint16(e+=2,n.height),r?(t.setUint32(e+=2,r.getUint32(e)),e+=4):(t.setUint16(e+=2,n.width/2),t.setUint16(e+=2,n.height/2),e+=2);var a=void 0;if(n._bmpData)a=new DataView(n._bmpData);else if(n.bpp===i)a=new DataView(n.src);else{if(32!==n.bpp||16!==i)throw"Cannot create ImgPack (yet) with inBpp="+n.bpp+" and outBpp="+i+".";var s=PP64.utils.img.RGBA5551.fromRGBA32(n.src,n.width,n.height);a=new DataView(s)}return PP64.utils.arrays.copyRange(t,a,e,0,a.byteLength),e+a.byteLength}}]),t}());
"use strict";var _createClass=function(){function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}PP64.app=new(function(){function n(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document.getElementById("body");_classCallCheck(this,n),this.showMessage=function(e){t._instance.setState({blocked:!!e,message:e||"",messageHTML:""})},this.showMessageHTML=function(e){t._instance.setState({blocked:!!e,message:"",messageHTML:e||""})};var a=function(e){function i(){var e,t,a;_classCallCheck(this,i);for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=a=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(r)))).state={currentView:window.PP64.types.View.EDITOR,boards:window.PP64.boards.getBoards(),currentBoard:window.PP64.boards.getCurrentBoard(),romLoaded:!1,currentAction:window.PP64.types.Action.MOVE,selectedSpaces:null,blocked:!1,message:"",messageHTML:"",error:!1,errorInfo:null},_possibleConstructorReturn(a,t)}return _inherits(i,React.Component),_createClass(i,[{key:"render",value:function(){if(this.state.error)return React.createElement("div",{className:"errorDiv selectable"},React.createElement("h2",null,"Hey, it seeems like something's wrong in¬†",React.createElement("span",{className:"errorStrikeoutText"},"Mushroom Village"),"¬† PartyPlanner64."),React.createElement("p",null,"Please ¬†",React.createElement("a",{href:"https://github.com/PartyPlanner64/PartyPlanner64/issues",target:"_blank"},"file an issue"),"¬† with the following details, and refresh the page."),React.createElement("pre",null,this.state.error.toString()),this.state.error.stack?React.createElement(React.Fragment,null,React.createElement("div",null,"Stack Error Details:"),React.createElement("pre",null,this.state.error.stack)):null,React.createElement("div",null,"Component Stack Error Details:"),React.createElement("pre",null,this.state.errorInfo.componentStack,">"));window.PP64.utils.browser.updateWindowTitle(this.state.currentBoard.name);var e=void 0;switch(this.state.currentView){case window.PP64.types.View.EDITOR:e=React.createElement(window.PP64.renderer.Editor,{board:this.state.currentBoard,selectedSpaces:this.state.selectedSpaces});break;case window.PP64.types.View.DETAILS:e=React.createElement(window.PP64.details.Details,{board:this.state.currentBoard});break;case window.PP64.types.View.SETTINGS:e=React.createElement(window.PP64.settings.Settings,null);break;case window.PP64.types.View.ABOUT:e=React.createElement(window.PP64.about.About,null);break;case window.PP64.types.View.MODELS:e=React.createElement(window.PP64.models.ModelViewer,null);break;case window.PP64.types.View.EVENTS:e=React.createElement(window.PP64.events.EventsView,null);break;case window.PP64.types.View.CREATEEVENT:e=React.createElement(window.PP64.events.CreateEventView,null);break;case window.PP64.types.View.STRINGS:e=React.createElement(window.PP64.strings.StringsViewer,null);break;case window.PP64.types.View.PATCHES:e=[React.createElement(window.PP64.patches.PatchView,{key:"PatchView"})],PP64.patches.gameshark.romSupportsCheats()&&e.push(React.createElement(window.PP64.patches.gameshark.GamesharkView,{key:"GamesharkView"}))}var t=void 0;switch(this.state.currentView){case window.PP64.types.View.EDITOR:case window.PP64.types.View.DETAILS:t=React.createElement("div",{className:"sidebar"},React.createElement(window.PP64.boardmenu.BoardMenu,{boards:this.state.boards,currentBoard:this.state.currentBoard}))}var a=void 0;if(this.state.blocked){var n=void 0;if(this.state.message||this.state.messageHTML){var r=void 0;r=this.state.message?React.createElement("span",{className:"loadingMsgTxt selectable"},this.state.message):React.createElement("span",{className:"loadingMsgTxt selectable",dangerouslySetInnerHTML:{__html:this.state.messageHTML}}),n=React.createElement("div",{className:"loadingMsg"},r,React.createElement("br",null),React.createElement("br",null),React.createElement("button",{onClick:function(){PP64.app.showMessage()}},"OK"))}else n=React.createElement("img",{className:"loadingGif swing",src:"img/pencil.png",alt:"Loading"});a=React.createElement("div",{className:"loading"},React.createElement("img",{className:"loadingLogo",src:"img/logoloading.png",alt:"Loading"}),React.createElement("br",null),n)}var s="body";return this.state.currentAction===$actType.ERASE&&(s+=" eraser"),React.createElement("div",{className:s},React.createElement(window.PP64.header.Header,{view:this.state.currentView,romLoaded:this.state.romLoaded,board:this.state.currentBoard}),React.createElement("div",{className:"content"},t,React.createElement("div",{className:"main"},e,React.createElement("div",{id:"dragZone"})),React.createElement("div",{className:"mainOverlay"},React.createElement(window.PP64.toolwindow.ToolWindow,{name:"Toolbox",position:"TopRight",visible:this.state.currentView===$viewType.EDITOR},React.createElement(window.PP64.toolbar.Toolbar,{currentAction:this.state.currentAction,gameVersion:this.state.currentBoard.game,boardType:this.state.currentBoard.type})),React.createElement(window.PP64.toolwindow.ToolWindow,{name:"Space Properties",position:"BottomRight",visible:this.state.currentView===$viewType.EDITOR},React.createElement(window.PP64.properties.SpaceProperties,{selectedSpaces:this.state.selectedSpaces,gameVersion:this.state.currentBoard.game,boardType:this.state.currentBoard.type})),React.createElement(window.PP64.toolwindow.ToolWindow,{name:"Board Properties",position:"BottomLeft",visible:this.state.currentView===$viewType.EDITOR},React.createElement(window.PP64.properties.BoardProperties,{currentBoard:this.state.currentBoard})))),a)}},{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t}),console.error(e,t)}}]),i}();this._instance=ReactDOM.render(React.createElement(a,null),e)}return _createClass(n,[{key:"changeView",value:function(e){this._instance.setState({currentView:e})}},{key:"currentBoardChanged",value:function(){this._instance.setState({currentBoard:window.PP64.boards.getCurrentBoard(),selectedSpaces:null,currentAction:PP64.types.Action.MOVE})}},{key:"boardsChanged",value:function(){this._instance.setState({boards:window.PP64.boards.getBoards()})}},{key:"romLoadedChanged",value:function(){this._instance.setState({romLoaded:window.PP64.romhandler.romIsLoaded()})}},{key:"changeCurrentAction",value:function(e){this._instance.setState({currentAction:e})}},{key:"getCurrentAction",value:function(){return this._instance.state.currentAction}},{key:"changeSelectedSpaces",value:function(e){this._instance.setState({selectedSpaces:e})}},{key:"getSelectedSpaces",value:function(){return this._instance.state.selectedSpaces}},{key:"changeCurrentEvent",value:function(e){this._instance.setState({currentEvent:e})}},{key:"getCurrentEvent",value:function(){return this._instance.state.currentEvent}},{key:"blockUI",value:function(e){this._instance.setState({blocked:!!e})}},{key:"refresh",value:function(){this._instance.forceUpdate()}}]),n}());